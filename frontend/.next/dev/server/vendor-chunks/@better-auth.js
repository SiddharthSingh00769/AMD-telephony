"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
exports.id = "vendor-chunks/@better-auth";
exports.ids = ["vendor-chunks/@better-auth"];
exports.modules = {

/***/ "(action-browser)/./node_modules/@better-auth/core/dist/db/adapter/index.mjs":
/*!******************************************************************!*\
  !*** ./node_modules/@better-auth/core/dist/db/adapter/index.mjs ***!
  \******************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);



/***/ }),

/***/ "(action-browser)/./node_modules/@better-auth/core/dist/db/index.mjs":
/*!**********************************************************!*\
  !*** ./node_modules/@better-auth/core/dist/db/index.mjs ***!
  \**********************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   accountSchema: () => (/* binding */ accountSchema),\n/* harmony export */   coreSchema: () => (/* binding */ coreSchema),\n/* harmony export */   rateLimitSchema: () => (/* binding */ rateLimitSchema),\n/* harmony export */   sessionSchema: () => (/* binding */ sessionSchema),\n/* harmony export */   userSchema: () => (/* binding */ userSchema),\n/* harmony export */   verificationSchema: () => (/* binding */ verificationSchema)\n/* harmony export */ });\n/* harmony import */ var zod__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! zod */ \"(action-browser)/./node_modules/zod/v4/classic/external.js\");\n\n\nconst coreSchema = zod__WEBPACK_IMPORTED_MODULE_0__.object({\n  id: zod__WEBPACK_IMPORTED_MODULE_0__.string(),\n  createdAt: zod__WEBPACK_IMPORTED_MODULE_0__.date().default(() => /* @__PURE__ */ new Date()),\n  updatedAt: zod__WEBPACK_IMPORTED_MODULE_0__.date().default(() => /* @__PURE__ */ new Date())\n});\n\nconst userSchema = coreSchema.extend({\n  email: zod__WEBPACK_IMPORTED_MODULE_0__.string().transform((val) => val.toLowerCase()),\n  emailVerified: zod__WEBPACK_IMPORTED_MODULE_0__.boolean().default(false),\n  name: zod__WEBPACK_IMPORTED_MODULE_0__.string(),\n  image: zod__WEBPACK_IMPORTED_MODULE_0__.string().nullish()\n});\n\nconst accountSchema = coreSchema.extend({\n  providerId: zod__WEBPACK_IMPORTED_MODULE_0__.string(),\n  accountId: zod__WEBPACK_IMPORTED_MODULE_0__.string(),\n  userId: zod__WEBPACK_IMPORTED_MODULE_0__.coerce.string(),\n  accessToken: zod__WEBPACK_IMPORTED_MODULE_0__.string().nullish(),\n  refreshToken: zod__WEBPACK_IMPORTED_MODULE_0__.string().nullish(),\n  idToken: zod__WEBPACK_IMPORTED_MODULE_0__.string().nullish(),\n  /**\n   * Access token expires at\n   */\n  accessTokenExpiresAt: zod__WEBPACK_IMPORTED_MODULE_0__.date().nullish(),\n  /**\n   * Refresh token expires at\n   */\n  refreshTokenExpiresAt: zod__WEBPACK_IMPORTED_MODULE_0__.date().nullish(),\n  /**\n   * The scopes that the user has authorized\n   */\n  scope: zod__WEBPACK_IMPORTED_MODULE_0__.string().nullish(),\n  /**\n   * Password is only stored in the credential provider\n   */\n  password: zod__WEBPACK_IMPORTED_MODULE_0__.string().nullish()\n});\n\nconst sessionSchema = coreSchema.extend({\n  userId: zod__WEBPACK_IMPORTED_MODULE_0__.coerce.string(),\n  expiresAt: zod__WEBPACK_IMPORTED_MODULE_0__.date(),\n  token: zod__WEBPACK_IMPORTED_MODULE_0__.string(),\n  ipAddress: zod__WEBPACK_IMPORTED_MODULE_0__.string().nullish(),\n  userAgent: zod__WEBPACK_IMPORTED_MODULE_0__.string().nullish()\n});\n\nconst verificationSchema = coreSchema.extend({\n  value: zod__WEBPACK_IMPORTED_MODULE_0__.string(),\n  expiresAt: zod__WEBPACK_IMPORTED_MODULE_0__.date(),\n  identifier: zod__WEBPACK_IMPORTED_MODULE_0__.string()\n});\n\nconst rateLimitSchema = zod__WEBPACK_IMPORTED_MODULE_0__.object({\n  /**\n   * The key to use for rate limiting\n   */\n  key: zod__WEBPACK_IMPORTED_MODULE_0__.string(),\n  /**\n   * The number of requests made\n   */\n  count: zod__WEBPACK_IMPORTED_MODULE_0__.number(),\n  /**\n   * The last request time in milliseconds\n   */\n  lastRequest: zod__WEBPACK_IMPORTED_MODULE_0__.number()\n});\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFjdGlvbi1icm93c2VyKS8uL25vZGVfbW9kdWxlcy9AYmV0dGVyLWF1dGgvY29yZS9kaXN0L2RiL2luZGV4Lm1qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7O0FBQXlCOztBQUV6QixtQkFBbUIsdUNBQVE7QUFDM0IsTUFBTSx1Q0FBUTtBQUNkLGFBQWEscUNBQU07QUFDbkIsYUFBYSxxQ0FBTTtBQUNuQixDQUFDOztBQUVEO0FBQ0EsU0FBUyx1Q0FBUTtBQUNqQixpQkFBaUIsd0NBQVM7QUFDMUIsUUFBUSx1Q0FBUTtBQUNoQixTQUFTLHVDQUFRO0FBQ2pCLENBQUM7O0FBRUQ7QUFDQSxjQUFjLHVDQUFRO0FBQ3RCLGFBQWEsdUNBQVE7QUFDckIsVUFBVSw4Q0FBZTtBQUN6QixlQUFlLHVDQUFRO0FBQ3ZCLGdCQUFnQix1Q0FBUTtBQUN4QixXQUFXLHVDQUFRO0FBQ25CO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QixxQ0FBTTtBQUM5QjtBQUNBO0FBQ0E7QUFDQSx5QkFBeUIscUNBQU07QUFDL0I7QUFDQTtBQUNBO0FBQ0EsU0FBUyx1Q0FBUTtBQUNqQjtBQUNBO0FBQ0E7QUFDQSxZQUFZLHVDQUFRO0FBQ3BCLENBQUM7O0FBRUQ7QUFDQSxVQUFVLDhDQUFlO0FBQ3pCLGFBQWEscUNBQU07QUFDbkIsU0FBUyx1Q0FBUTtBQUNqQixhQUFhLHVDQUFRO0FBQ3JCLGFBQWEsdUNBQVE7QUFDckIsQ0FBQzs7QUFFRDtBQUNBLFNBQVMsdUNBQVE7QUFDakIsYUFBYSxxQ0FBTTtBQUNuQixjQUFjLHVDQUFRO0FBQ3RCLENBQUM7O0FBRUQsd0JBQXdCLHVDQUFRO0FBQ2hDO0FBQ0E7QUFDQTtBQUNBLE9BQU8sdUNBQVE7QUFDZjtBQUNBO0FBQ0E7QUFDQSxTQUFTLHVDQUFRO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBLGVBQWUsdUNBQVE7QUFDdkIsQ0FBQzs7QUFFb0ciLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcc2lkMDFcXE9uZURyaXZlXFxEZXNrdG9wXFxhbWQtdGVsZXBob255LXN5c3RlbVxcZnJvbnRlbmRcXG5vZGVfbW9kdWxlc1xcQGJldHRlci1hdXRoXFxjb3JlXFxkaXN0XFxkYlxcaW5kZXgubWpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCAqIGFzIHogZnJvbSAnem9kJztcblxuY29uc3QgY29yZVNjaGVtYSA9IHoub2JqZWN0KHtcbiAgaWQ6IHouc3RyaW5nKCksXG4gIGNyZWF0ZWRBdDogei5kYXRlKCkuZGVmYXVsdCgoKSA9PiAvKiBAX19QVVJFX18gKi8gbmV3IERhdGUoKSksXG4gIHVwZGF0ZWRBdDogei5kYXRlKCkuZGVmYXVsdCgoKSA9PiAvKiBAX19QVVJFX18gKi8gbmV3IERhdGUoKSlcbn0pO1xuXG5jb25zdCB1c2VyU2NoZW1hID0gY29yZVNjaGVtYS5leHRlbmQoe1xuICBlbWFpbDogei5zdHJpbmcoKS50cmFuc2Zvcm0oKHZhbCkgPT4gdmFsLnRvTG93ZXJDYXNlKCkpLFxuICBlbWFpbFZlcmlmaWVkOiB6LmJvb2xlYW4oKS5kZWZhdWx0KGZhbHNlKSxcbiAgbmFtZTogei5zdHJpbmcoKSxcbiAgaW1hZ2U6IHouc3RyaW5nKCkubnVsbGlzaCgpXG59KTtcblxuY29uc3QgYWNjb3VudFNjaGVtYSA9IGNvcmVTY2hlbWEuZXh0ZW5kKHtcbiAgcHJvdmlkZXJJZDogei5zdHJpbmcoKSxcbiAgYWNjb3VudElkOiB6LnN0cmluZygpLFxuICB1c2VySWQ6IHouY29lcmNlLnN0cmluZygpLFxuICBhY2Nlc3NUb2tlbjogei5zdHJpbmcoKS5udWxsaXNoKCksXG4gIHJlZnJlc2hUb2tlbjogei5zdHJpbmcoKS5udWxsaXNoKCksXG4gIGlkVG9rZW46IHouc3RyaW5nKCkubnVsbGlzaCgpLFxuICAvKipcbiAgICogQWNjZXNzIHRva2VuIGV4cGlyZXMgYXRcbiAgICovXG4gIGFjY2Vzc1Rva2VuRXhwaXJlc0F0OiB6LmRhdGUoKS5udWxsaXNoKCksXG4gIC8qKlxuICAgKiBSZWZyZXNoIHRva2VuIGV4cGlyZXMgYXRcbiAgICovXG4gIHJlZnJlc2hUb2tlbkV4cGlyZXNBdDogei5kYXRlKCkubnVsbGlzaCgpLFxuICAvKipcbiAgICogVGhlIHNjb3BlcyB0aGF0IHRoZSB1c2VyIGhhcyBhdXRob3JpemVkXG4gICAqL1xuICBzY29wZTogei5zdHJpbmcoKS5udWxsaXNoKCksXG4gIC8qKlxuICAgKiBQYXNzd29yZCBpcyBvbmx5IHN0b3JlZCBpbiB0aGUgY3JlZGVudGlhbCBwcm92aWRlclxuICAgKi9cbiAgcGFzc3dvcmQ6IHouc3RyaW5nKCkubnVsbGlzaCgpXG59KTtcblxuY29uc3Qgc2Vzc2lvblNjaGVtYSA9IGNvcmVTY2hlbWEuZXh0ZW5kKHtcbiAgdXNlcklkOiB6LmNvZXJjZS5zdHJpbmcoKSxcbiAgZXhwaXJlc0F0OiB6LmRhdGUoKSxcbiAgdG9rZW46IHouc3RyaW5nKCksXG4gIGlwQWRkcmVzczogei5zdHJpbmcoKS5udWxsaXNoKCksXG4gIHVzZXJBZ2VudDogei5zdHJpbmcoKS5udWxsaXNoKClcbn0pO1xuXG5jb25zdCB2ZXJpZmljYXRpb25TY2hlbWEgPSBjb3JlU2NoZW1hLmV4dGVuZCh7XG4gIHZhbHVlOiB6LnN0cmluZygpLFxuICBleHBpcmVzQXQ6IHouZGF0ZSgpLFxuICBpZGVudGlmaWVyOiB6LnN0cmluZygpXG59KTtcblxuY29uc3QgcmF0ZUxpbWl0U2NoZW1hID0gei5vYmplY3Qoe1xuICAvKipcbiAgICogVGhlIGtleSB0byB1c2UgZm9yIHJhdGUgbGltaXRpbmdcbiAgICovXG4gIGtleTogei5zdHJpbmcoKSxcbiAgLyoqXG4gICAqIFRoZSBudW1iZXIgb2YgcmVxdWVzdHMgbWFkZVxuICAgKi9cbiAgY291bnQ6IHoubnVtYmVyKCksXG4gIC8qKlxuICAgKiBUaGUgbGFzdCByZXF1ZXN0IHRpbWUgaW4gbWlsbGlzZWNvbmRzXG4gICAqL1xuICBsYXN0UmVxdWVzdDogei5udW1iZXIoKVxufSk7XG5cbmV4cG9ydCB7IGFjY291bnRTY2hlbWEsIGNvcmVTY2hlbWEsIHJhdGVMaW1pdFNjaGVtYSwgc2Vzc2lvblNjaGVtYSwgdXNlclNjaGVtYSwgdmVyaWZpY2F0aW9uU2NoZW1hIH07XG4iXSwibmFtZXMiOltdLCJpZ25vcmVMaXN0IjpbMF0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(action-browser)/./node_modules/@better-auth/core/dist/db/index.mjs\n");

/***/ }),

/***/ "(action-browser)/./node_modules/@better-auth/core/dist/env/index.mjs":
/*!***********************************************************!*\
  !*** ./node_modules/@better-auth/core/dist/env/index.mjs ***!
  \***********************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   ENV: () => (/* binding */ ENV),\n/* harmony export */   TTY_COLORS: () => (/* binding */ TTY_COLORS),\n/* harmony export */   createLogger: () => (/* binding */ createLogger),\n/* harmony export */   env: () => (/* binding */ env),\n/* harmony export */   getBooleanEnvVar: () => (/* binding */ getBooleanEnvVar),\n/* harmony export */   getColorDepth: () => (/* binding */ getColorDepth),\n/* harmony export */   getEnvVar: () => (/* binding */ getEnvVar),\n/* harmony export */   isDevelopment: () => (/* binding */ isDevelopment),\n/* harmony export */   isProduction: () => (/* binding */ isProduction),\n/* harmony export */   isTest: () => (/* binding */ isTest),\n/* harmony export */   levels: () => (/* binding */ levels),\n/* harmony export */   logger: () => (/* binding */ logger),\n/* harmony export */   nodeENV: () => (/* binding */ nodeENV),\n/* harmony export */   shouldPublishLog: () => (/* binding */ shouldPublishLog)\n/* harmony export */ });\nconst _envShim = /* @__PURE__ */ Object.create(null);\nconst _getEnv = (useShim) => globalThis.process?.env || //@ts-expect-error\nglobalThis.Deno?.env.toObject() || //@ts-expect-error\nglobalThis.__env__ || (useShim ? _envShim : globalThis);\nconst env = new Proxy(_envShim, {\n  get(_, prop) {\n    const env2 = _getEnv();\n    return env2[prop] ?? _envShim[prop];\n  },\n  has(_, prop) {\n    const env2 = _getEnv();\n    return prop in env2 || prop in _envShim;\n  },\n  set(_, prop, value) {\n    const env2 = _getEnv(true);\n    env2[prop] = value;\n    return true;\n  },\n  deleteProperty(_, prop) {\n    if (!prop) {\n      return false;\n    }\n    const env2 = _getEnv(true);\n    delete env2[prop];\n    return true;\n  },\n  ownKeys() {\n    const env2 = _getEnv(true);\n    return Object.keys(env2);\n  }\n});\nfunction toBoolean(val) {\n  return val ? val !== \"false\" : false;\n}\nconst nodeENV = typeof process !== \"undefined\" && process.env && \"development\" || \"\";\nconst isProduction = nodeENV === \"production\";\nconst isDevelopment = () => nodeENV === \"dev\" || nodeENV === \"development\";\nconst isTest = () => nodeENV === \"test\" || toBoolean(env.TEST);\nfunction getEnvVar(key, fallback) {\n  if (typeof process !== \"undefined\" && process.env) {\n    return process.env[key] ?? fallback;\n  }\n  if (typeof Deno !== \"undefined\") {\n    return Deno.env.get(key) ?? fallback;\n  }\n  if (typeof Bun !== \"undefined\") {\n    return Bun.env[key] ?? fallback;\n  }\n  return fallback;\n}\nfunction getBooleanEnvVar(key, fallback = true) {\n  const value = getEnvVar(key);\n  if (!value) return fallback;\n  return value !== \"0\" && value.toLowerCase() !== \"false\" && value !== \"\";\n}\nconst ENV = Object.freeze({\n  get BETTER_AUTH_SECRET() {\n    return getEnvVar(\"BETTER_AUTH_SECRET\");\n  },\n  get AUTH_SECRET() {\n    return getEnvVar(\"AUTH_SECRET\");\n  },\n  get BETTER_AUTH_TELEMETRY() {\n    return getEnvVar(\"BETTER_AUTH_TELEMETRY\");\n  },\n  get BETTER_AUTH_TELEMETRY_ID() {\n    return getEnvVar(\"BETTER_AUTH_TELEMETRY_ID\");\n  },\n  get NODE_ENV() {\n    return getEnvVar(\"NODE_ENV\", \"development\");\n  },\n  get PACKAGE_VERSION() {\n    return getEnvVar(\"PACKAGE_VERSION\", \"0.0.0\");\n  },\n  get BETTER_AUTH_TELEMETRY_ENDPOINT() {\n    return getEnvVar(\n      \"BETTER_AUTH_TELEMETRY_ENDPOINT\",\n      \"https://telemetry.better-auth.com/v1/track\"\n    );\n  }\n});\n\nconst COLORS_2 = 1;\nconst COLORS_16 = 4;\nconst COLORS_256 = 8;\nconst COLORS_16m = 24;\nconst TERM_ENVS = {\n  eterm: COLORS_16,\n  cons25: COLORS_16,\n  console: COLORS_16,\n  cygwin: COLORS_16,\n  dtterm: COLORS_16,\n  gnome: COLORS_16,\n  hurd: COLORS_16,\n  jfbterm: COLORS_16,\n  konsole: COLORS_16,\n  kterm: COLORS_16,\n  mlterm: COLORS_16,\n  mosh: COLORS_16m,\n  putty: COLORS_16,\n  st: COLORS_16,\n  // http://lists.schmorp.de/pipermail/rxvt-unicode/2016q2/002261.html\n  \"rxvt-unicode-24bit\": COLORS_16m,\n  // https://bugs.launchpad.net/terminator/+bug/1030562\n  terminator: COLORS_16m,\n  \"xterm-kitty\": COLORS_16m\n};\nconst CI_ENVS_MAP = new Map(\n  Object.entries({\n    APPVEYOR: COLORS_256,\n    BUILDKITE: COLORS_256,\n    CIRCLECI: COLORS_16m,\n    DRONE: COLORS_256,\n    GITEA_ACTIONS: COLORS_16m,\n    GITHUB_ACTIONS: COLORS_16m,\n    GITLAB_CI: COLORS_256,\n    TRAVIS: COLORS_256\n  })\n);\nconst TERM_ENVS_REG_EXP = [\n  /ansi/,\n  /color/,\n  /linux/,\n  /direct/,\n  /^con[0-9]*x[0-9]/,\n  /^rxvt/,\n  /^screen/,\n  /^xterm/,\n  /^vt100/,\n  /^vt220/\n];\nfunction getColorDepth() {\n  if (getEnvVar(\"FORCE_COLOR\") !== void 0) {\n    switch (getEnvVar(\"FORCE_COLOR\")) {\n      case \"\":\n      case \"1\":\n      case \"true\":\n        return COLORS_16;\n      case \"2\":\n        return COLORS_256;\n      case \"3\":\n        return COLORS_16m;\n      default:\n        return COLORS_2;\n    }\n  }\n  if (getEnvVar(\"NODE_DISABLE_COLORS\") !== void 0 && getEnvVar(\"NODE_DISABLE_COLORS\") !== \"\" || // See https://no-color.org/\n  getEnvVar(\"NO_COLOR\") !== void 0 && getEnvVar(\"NO_COLOR\") !== \"\" || // The \"dumb\" special terminal, as defined by terminfo, doesn't support\n  // ANSI color control codes.\n  // See https://invisible-island.net/ncurses/terminfo.ti.html#toc-_Specials\n  getEnvVar(\"TERM\") === \"dumb\") {\n    return COLORS_2;\n  }\n  if (getEnvVar(\"TMUX\")) {\n    return COLORS_16m;\n  }\n  if (\"TF_BUILD\" in env && \"AGENT_NAME\" in env) {\n    return COLORS_16;\n  }\n  if (\"CI\" in env) {\n    for (const { 0: envName, 1: colors } of CI_ENVS_MAP) {\n      if (envName in env) {\n        return colors;\n      }\n    }\n    if (getEnvVar(\"CI_NAME\") === \"codeship\") {\n      return COLORS_256;\n    }\n    return COLORS_2;\n  }\n  if (\"TEAMCITY_VERSION\" in env) {\n    return /^(9\\.(0*[1-9]\\d*)\\.|\\d{2,}\\.)/.exec(\n      getEnvVar(\"TEAMCITY_VERSION\")\n    ) !== null ? COLORS_16 : COLORS_2;\n  }\n  switch (getEnvVar(\"TERM_PROGRAM\")) {\n    case \"iTerm.app\":\n      if (!getEnvVar(\"TERM_PROGRAM_VERSION\") || /^[0-2]\\./.exec(getEnvVar(\"TERM_PROGRAM_VERSION\")) !== null) {\n        return COLORS_256;\n      }\n      return COLORS_16m;\n    case \"HyperTerm\":\n    case \"MacTerm\":\n      return COLORS_16m;\n    case \"Apple_Terminal\":\n      return COLORS_256;\n  }\n  if (getEnvVar(\"COLORTERM\") === \"truecolor\" || getEnvVar(\"COLORTERM\") === \"24bit\") {\n    return COLORS_16m;\n  }\n  if (getEnvVar(\"TERM\")) {\n    if (/truecolor/.exec(getEnvVar(\"TERM\")) !== null) {\n      return COLORS_16m;\n    }\n    if (/^xterm-256/.exec(getEnvVar(\"TERM\")) !== null) {\n      return COLORS_256;\n    }\n    const termEnv = getEnvVar(\"TERM\").toLowerCase();\n    if (TERM_ENVS[termEnv]) {\n      return TERM_ENVS[termEnv];\n    }\n    if (TERM_ENVS_REG_EXP.some((term) => term.exec(termEnv) !== null)) {\n      return COLORS_16;\n    }\n  }\n  if (getEnvVar(\"COLORTERM\")) {\n    return COLORS_16;\n  }\n  return COLORS_2;\n}\n\nconst TTY_COLORS = {\n  reset: \"\\x1B[0m\",\n  bright: \"\\x1B[1m\",\n  dim: \"\\x1B[2m\",\n  undim: \"\\x1B[22m\",\n  underscore: \"\\x1B[4m\",\n  blink: \"\\x1B[5m\",\n  reverse: \"\\x1B[7m\",\n  hidden: \"\\x1B[8m\",\n  fg: {\n    black: \"\\x1B[30m\",\n    red: \"\\x1B[31m\",\n    green: \"\\x1B[32m\",\n    yellow: \"\\x1B[33m\",\n    blue: \"\\x1B[34m\",\n    magenta: \"\\x1B[35m\",\n    cyan: \"\\x1B[36m\",\n    white: \"\\x1B[37m\"\n  },\n  bg: {\n    black: \"\\x1B[40m\",\n    red: \"\\x1B[41m\",\n    green: \"\\x1B[42m\",\n    yellow: \"\\x1B[43m\",\n    blue: \"\\x1B[44m\",\n    magenta: \"\\x1B[45m\",\n    cyan: \"\\x1B[46m\",\n    white: \"\\x1B[47m\"\n  }\n};\nconst levels = [\"info\", \"success\", \"warn\", \"error\", \"debug\"];\nfunction shouldPublishLog(currentLogLevel, logLevel) {\n  return levels.indexOf(logLevel) <= levels.indexOf(currentLogLevel);\n}\nconst levelColors = {\n  info: TTY_COLORS.fg.blue,\n  success: TTY_COLORS.fg.green,\n  warn: TTY_COLORS.fg.yellow,\n  error: TTY_COLORS.fg.red,\n  debug: TTY_COLORS.fg.magenta\n};\nconst formatMessage = (level, message, colorsEnabled) => {\n  const timestamp = (/* @__PURE__ */ new Date()).toISOString();\n  if (colorsEnabled) {\n    return `${TTY_COLORS.dim}${timestamp}${TTY_COLORS.reset} ${levelColors[level]}${level.toUpperCase()}${TTY_COLORS.reset} ${TTY_COLORS.bright}[Better Auth]:${TTY_COLORS.reset} ${message}`;\n  }\n  return `${timestamp} ${level.toUpperCase()} [Better Auth]: ${message}`;\n};\nconst createLogger = (options) => {\n  const enabled = options?.disabled !== true;\n  const logLevel = options?.level ?? \"error\";\n  const isDisableColorsSpecified = options?.disableColors !== void 0;\n  const colorsEnabled = isDisableColorsSpecified ? !options.disableColors : getColorDepth() !== 1;\n  const LogFunc = (level, message, args = []) => {\n    if (!enabled || !shouldPublishLog(logLevel, level)) {\n      return;\n    }\n    const formattedMessage = formatMessage(level, message, colorsEnabled);\n    if (!options || typeof options.log !== \"function\") {\n      if (level === \"error\") {\n        console.error(formattedMessage, ...args);\n      } else if (level === \"warn\") {\n        console.warn(formattedMessage, ...args);\n      } else {\n        console.log(formattedMessage, ...args);\n      }\n      return;\n    }\n    options.log(level === \"success\" ? \"info\" : level, message, ...args);\n  };\n  const logger2 = Object.fromEntries(\n    levels.map((level) => [\n      level,\n      (...[message, ...args]) => LogFunc(level, message, args)\n    ])\n  );\n  return {\n    ...logger2,\n    get level() {\n      return logLevel;\n    }\n  };\n};\nconst logger = createLogger();\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFjdGlvbi1icm93c2VyKS8uL25vZGVfbW9kdWxlcy9AYmV0dGVyLWF1dGgvY29yZS9kaXN0L2Vudi9pbmRleC5tanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQSxpRUFBaUUsYUFBb0I7QUFDckY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQzs7QUFFRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQix3QkFBd0I7QUFDekM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtQ0FBbUMsR0FBRztBQUN0QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGNBQWMsZUFBZSxFQUFFLFVBQVUsRUFBRSxrQkFBa0IsRUFBRSxtQkFBbUIsRUFBRSxvQkFBb0IsRUFBRSxrQkFBa0IsRUFBRSxrQkFBa0IsZ0JBQWdCLGtCQUFrQixFQUFFLFFBQVE7QUFDNUw7QUFDQSxZQUFZLFdBQVcsRUFBRSxxQkFBcUIsaUJBQWlCLFFBQVE7QUFDdkU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVE7QUFDUjtBQUNBLFFBQVE7QUFDUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUUwSyIsInNvdXJjZXMiOlsiQzpcXFVzZXJzXFxzaWQwMVxcT25lRHJpdmVcXERlc2t0b3BcXGFtZC10ZWxlcGhvbnktc3lzdGVtXFxmcm9udGVuZFxcbm9kZV9tb2R1bGVzXFxAYmV0dGVyLWF1dGhcXGNvcmVcXGRpc3RcXGVudlxcaW5kZXgubWpzIl0sInNvdXJjZXNDb250ZW50IjpbImNvbnN0IF9lbnZTaGltID0gLyogQF9fUFVSRV9fICovIE9iamVjdC5jcmVhdGUobnVsbCk7XG5jb25zdCBfZ2V0RW52ID0gKHVzZVNoaW0pID0+IGdsb2JhbFRoaXMucHJvY2Vzcz8uZW52IHx8IC8vQHRzLWV4cGVjdC1lcnJvclxuZ2xvYmFsVGhpcy5EZW5vPy5lbnYudG9PYmplY3QoKSB8fCAvL0B0cy1leHBlY3QtZXJyb3Jcbmdsb2JhbFRoaXMuX19lbnZfXyB8fCAodXNlU2hpbSA/IF9lbnZTaGltIDogZ2xvYmFsVGhpcyk7XG5jb25zdCBlbnYgPSBuZXcgUHJveHkoX2VudlNoaW0sIHtcbiAgZ2V0KF8sIHByb3ApIHtcbiAgICBjb25zdCBlbnYyID0gX2dldEVudigpO1xuICAgIHJldHVybiBlbnYyW3Byb3BdID8/IF9lbnZTaGltW3Byb3BdO1xuICB9LFxuICBoYXMoXywgcHJvcCkge1xuICAgIGNvbnN0IGVudjIgPSBfZ2V0RW52KCk7XG4gICAgcmV0dXJuIHByb3AgaW4gZW52MiB8fCBwcm9wIGluIF9lbnZTaGltO1xuICB9LFxuICBzZXQoXywgcHJvcCwgdmFsdWUpIHtcbiAgICBjb25zdCBlbnYyID0gX2dldEVudih0cnVlKTtcbiAgICBlbnYyW3Byb3BdID0gdmFsdWU7XG4gICAgcmV0dXJuIHRydWU7XG4gIH0sXG4gIGRlbGV0ZVByb3BlcnR5KF8sIHByb3ApIHtcbiAgICBpZiAoIXByb3ApIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgY29uc3QgZW52MiA9IF9nZXRFbnYodHJ1ZSk7XG4gICAgZGVsZXRlIGVudjJbcHJvcF07XG4gICAgcmV0dXJuIHRydWU7XG4gIH0sXG4gIG93bktleXMoKSB7XG4gICAgY29uc3QgZW52MiA9IF9nZXRFbnYodHJ1ZSk7XG4gICAgcmV0dXJuIE9iamVjdC5rZXlzKGVudjIpO1xuICB9XG59KTtcbmZ1bmN0aW9uIHRvQm9vbGVhbih2YWwpIHtcbiAgcmV0dXJuIHZhbCA/IHZhbCAhPT0gXCJmYWxzZVwiIDogZmFsc2U7XG59XG5jb25zdCBub2RlRU5WID0gdHlwZW9mIHByb2Nlc3MgIT09IFwidW5kZWZpbmVkXCIgJiYgcHJvY2Vzcy5lbnYgJiYgcHJvY2Vzcy5lbnYuTk9ERV9FTlYgfHwgXCJcIjtcbmNvbnN0IGlzUHJvZHVjdGlvbiA9IG5vZGVFTlYgPT09IFwicHJvZHVjdGlvblwiO1xuY29uc3QgaXNEZXZlbG9wbWVudCA9ICgpID0+IG5vZGVFTlYgPT09IFwiZGV2XCIgfHwgbm9kZUVOViA9PT0gXCJkZXZlbG9wbWVudFwiO1xuY29uc3QgaXNUZXN0ID0gKCkgPT4gbm9kZUVOViA9PT0gXCJ0ZXN0XCIgfHwgdG9Cb29sZWFuKGVudi5URVNUKTtcbmZ1bmN0aW9uIGdldEVudlZhcihrZXksIGZhbGxiYWNrKSB7XG4gIGlmICh0eXBlb2YgcHJvY2VzcyAhPT0gXCJ1bmRlZmluZWRcIiAmJiBwcm9jZXNzLmVudikge1xuICAgIHJldHVybiBwcm9jZXNzLmVudltrZXldID8/IGZhbGxiYWNrO1xuICB9XG4gIGlmICh0eXBlb2YgRGVubyAhPT0gXCJ1bmRlZmluZWRcIikge1xuICAgIHJldHVybiBEZW5vLmVudi5nZXQoa2V5KSA/PyBmYWxsYmFjaztcbiAgfVxuICBpZiAodHlwZW9mIEJ1biAhPT0gXCJ1bmRlZmluZWRcIikge1xuICAgIHJldHVybiBCdW4uZW52W2tleV0gPz8gZmFsbGJhY2s7XG4gIH1cbiAgcmV0dXJuIGZhbGxiYWNrO1xufVxuZnVuY3Rpb24gZ2V0Qm9vbGVhbkVudlZhcihrZXksIGZhbGxiYWNrID0gdHJ1ZSkge1xuICBjb25zdCB2YWx1ZSA9IGdldEVudlZhcihrZXkpO1xuICBpZiAoIXZhbHVlKSByZXR1cm4gZmFsbGJhY2s7XG4gIHJldHVybiB2YWx1ZSAhPT0gXCIwXCIgJiYgdmFsdWUudG9Mb3dlckNhc2UoKSAhPT0gXCJmYWxzZVwiICYmIHZhbHVlICE9PSBcIlwiO1xufVxuY29uc3QgRU5WID0gT2JqZWN0LmZyZWV6ZSh7XG4gIGdldCBCRVRURVJfQVVUSF9TRUNSRVQoKSB7XG4gICAgcmV0dXJuIGdldEVudlZhcihcIkJFVFRFUl9BVVRIX1NFQ1JFVFwiKTtcbiAgfSxcbiAgZ2V0IEFVVEhfU0VDUkVUKCkge1xuICAgIHJldHVybiBnZXRFbnZWYXIoXCJBVVRIX1NFQ1JFVFwiKTtcbiAgfSxcbiAgZ2V0IEJFVFRFUl9BVVRIX1RFTEVNRVRSWSgpIHtcbiAgICByZXR1cm4gZ2V0RW52VmFyKFwiQkVUVEVSX0FVVEhfVEVMRU1FVFJZXCIpO1xuICB9LFxuICBnZXQgQkVUVEVSX0FVVEhfVEVMRU1FVFJZX0lEKCkge1xuICAgIHJldHVybiBnZXRFbnZWYXIoXCJCRVRURVJfQVVUSF9URUxFTUVUUllfSURcIik7XG4gIH0sXG4gIGdldCBOT0RFX0VOVigpIHtcbiAgICByZXR1cm4gZ2V0RW52VmFyKFwiTk9ERV9FTlZcIiwgXCJkZXZlbG9wbWVudFwiKTtcbiAgfSxcbiAgZ2V0IFBBQ0tBR0VfVkVSU0lPTigpIHtcbiAgICByZXR1cm4gZ2V0RW52VmFyKFwiUEFDS0FHRV9WRVJTSU9OXCIsIFwiMC4wLjBcIik7XG4gIH0sXG4gIGdldCBCRVRURVJfQVVUSF9URUxFTUVUUllfRU5EUE9JTlQoKSB7XG4gICAgcmV0dXJuIGdldEVudlZhcihcbiAgICAgIFwiQkVUVEVSX0FVVEhfVEVMRU1FVFJZX0VORFBPSU5UXCIsXG4gICAgICBcImh0dHBzOi8vdGVsZW1ldHJ5LmJldHRlci1hdXRoLmNvbS92MS90cmFja1wiXG4gICAgKTtcbiAgfVxufSk7XG5cbmNvbnN0IENPTE9SU18yID0gMTtcbmNvbnN0IENPTE9SU18xNiA9IDQ7XG5jb25zdCBDT0xPUlNfMjU2ID0gODtcbmNvbnN0IENPTE9SU18xNm0gPSAyNDtcbmNvbnN0IFRFUk1fRU5WUyA9IHtcbiAgZXRlcm06IENPTE9SU18xNixcbiAgY29uczI1OiBDT0xPUlNfMTYsXG4gIGNvbnNvbGU6IENPTE9SU18xNixcbiAgY3lnd2luOiBDT0xPUlNfMTYsXG4gIGR0dGVybTogQ09MT1JTXzE2LFxuICBnbm9tZTogQ09MT1JTXzE2LFxuICBodXJkOiBDT0xPUlNfMTYsXG4gIGpmYnRlcm06IENPTE9SU18xNixcbiAga29uc29sZTogQ09MT1JTXzE2LFxuICBrdGVybTogQ09MT1JTXzE2LFxuICBtbHRlcm06IENPTE9SU18xNixcbiAgbW9zaDogQ09MT1JTXzE2bSxcbiAgcHV0dHk6IENPTE9SU18xNixcbiAgc3Q6IENPTE9SU18xNixcbiAgLy8gaHR0cDovL2xpc3RzLnNjaG1vcnAuZGUvcGlwZXJtYWlsL3J4dnQtdW5pY29kZS8yMDE2cTIvMDAyMjYxLmh0bWxcbiAgXCJyeHZ0LXVuaWNvZGUtMjRiaXRcIjogQ09MT1JTXzE2bSxcbiAgLy8gaHR0cHM6Ly9idWdzLmxhdW5jaHBhZC5uZXQvdGVybWluYXRvci8rYnVnLzEwMzA1NjJcbiAgdGVybWluYXRvcjogQ09MT1JTXzE2bSxcbiAgXCJ4dGVybS1raXR0eVwiOiBDT0xPUlNfMTZtXG59O1xuY29uc3QgQ0lfRU5WU19NQVAgPSBuZXcgTWFwKFxuICBPYmplY3QuZW50cmllcyh7XG4gICAgQVBQVkVZT1I6IENPTE9SU18yNTYsXG4gICAgQlVJTERLSVRFOiBDT0xPUlNfMjU2LFxuICAgIENJUkNMRUNJOiBDT0xPUlNfMTZtLFxuICAgIERST05FOiBDT0xPUlNfMjU2LFxuICAgIEdJVEVBX0FDVElPTlM6IENPTE9SU18xNm0sXG4gICAgR0lUSFVCX0FDVElPTlM6IENPTE9SU18xNm0sXG4gICAgR0lUTEFCX0NJOiBDT0xPUlNfMjU2LFxuICAgIFRSQVZJUzogQ09MT1JTXzI1NlxuICB9KVxuKTtcbmNvbnN0IFRFUk1fRU5WU19SRUdfRVhQID0gW1xuICAvYW5zaS8sXG4gIC9jb2xvci8sXG4gIC9saW51eC8sXG4gIC9kaXJlY3QvLFxuICAvXmNvblswLTldKnhbMC05XS8sXG4gIC9ecnh2dC8sXG4gIC9ec2NyZWVuLyxcbiAgL154dGVybS8sXG4gIC9ednQxMDAvLFxuICAvXnZ0MjIwL1xuXTtcbmZ1bmN0aW9uIGdldENvbG9yRGVwdGgoKSB7XG4gIGlmIChnZXRFbnZWYXIoXCJGT1JDRV9DT0xPUlwiKSAhPT0gdm9pZCAwKSB7XG4gICAgc3dpdGNoIChnZXRFbnZWYXIoXCJGT1JDRV9DT0xPUlwiKSkge1xuICAgICAgY2FzZSBcIlwiOlxuICAgICAgY2FzZSBcIjFcIjpcbiAgICAgIGNhc2UgXCJ0cnVlXCI6XG4gICAgICAgIHJldHVybiBDT0xPUlNfMTY7XG4gICAgICBjYXNlIFwiMlwiOlxuICAgICAgICByZXR1cm4gQ09MT1JTXzI1NjtcbiAgICAgIGNhc2UgXCIzXCI6XG4gICAgICAgIHJldHVybiBDT0xPUlNfMTZtO1xuICAgICAgZGVmYXVsdDpcbiAgICAgICAgcmV0dXJuIENPTE9SU18yO1xuICAgIH1cbiAgfVxuICBpZiAoZ2V0RW52VmFyKFwiTk9ERV9ESVNBQkxFX0NPTE9SU1wiKSAhPT0gdm9pZCAwICYmIGdldEVudlZhcihcIk5PREVfRElTQUJMRV9DT0xPUlNcIikgIT09IFwiXCIgfHwgLy8gU2VlIGh0dHBzOi8vbm8tY29sb3Iub3JnL1xuICBnZXRFbnZWYXIoXCJOT19DT0xPUlwiKSAhPT0gdm9pZCAwICYmIGdldEVudlZhcihcIk5PX0NPTE9SXCIpICE9PSBcIlwiIHx8IC8vIFRoZSBcImR1bWJcIiBzcGVjaWFsIHRlcm1pbmFsLCBhcyBkZWZpbmVkIGJ5IHRlcm1pbmZvLCBkb2Vzbid0IHN1cHBvcnRcbiAgLy8gQU5TSSBjb2xvciBjb250cm9sIGNvZGVzLlxuICAvLyBTZWUgaHR0cHM6Ly9pbnZpc2libGUtaXNsYW5kLm5ldC9uY3Vyc2VzL3Rlcm1pbmZvLnRpLmh0bWwjdG9jLV9TcGVjaWFsc1xuICBnZXRFbnZWYXIoXCJURVJNXCIpID09PSBcImR1bWJcIikge1xuICAgIHJldHVybiBDT0xPUlNfMjtcbiAgfVxuICBpZiAoZ2V0RW52VmFyKFwiVE1VWFwiKSkge1xuICAgIHJldHVybiBDT0xPUlNfMTZtO1xuICB9XG4gIGlmIChcIlRGX0JVSUxEXCIgaW4gZW52ICYmIFwiQUdFTlRfTkFNRVwiIGluIGVudikge1xuICAgIHJldHVybiBDT0xPUlNfMTY7XG4gIH1cbiAgaWYgKFwiQ0lcIiBpbiBlbnYpIHtcbiAgICBmb3IgKGNvbnN0IHsgMDogZW52TmFtZSwgMTogY29sb3JzIH0gb2YgQ0lfRU5WU19NQVApIHtcbiAgICAgIGlmIChlbnZOYW1lIGluIGVudikge1xuICAgICAgICByZXR1cm4gY29sb3JzO1xuICAgICAgfVxuICAgIH1cbiAgICBpZiAoZ2V0RW52VmFyKFwiQ0lfTkFNRVwiKSA9PT0gXCJjb2Rlc2hpcFwiKSB7XG4gICAgICByZXR1cm4gQ09MT1JTXzI1NjtcbiAgICB9XG4gICAgcmV0dXJuIENPTE9SU18yO1xuICB9XG4gIGlmIChcIlRFQU1DSVRZX1ZFUlNJT05cIiBpbiBlbnYpIHtcbiAgICByZXR1cm4gL14oOVxcLigwKlsxLTldXFxkKilcXC58XFxkezIsfVxcLikvLmV4ZWMoXG4gICAgICBnZXRFbnZWYXIoXCJURUFNQ0lUWV9WRVJTSU9OXCIpXG4gICAgKSAhPT0gbnVsbCA/IENPTE9SU18xNiA6IENPTE9SU18yO1xuICB9XG4gIHN3aXRjaCAoZ2V0RW52VmFyKFwiVEVSTV9QUk9HUkFNXCIpKSB7XG4gICAgY2FzZSBcImlUZXJtLmFwcFwiOlxuICAgICAgaWYgKCFnZXRFbnZWYXIoXCJURVJNX1BST0dSQU1fVkVSU0lPTlwiKSB8fCAvXlswLTJdXFwuLy5leGVjKGdldEVudlZhcihcIlRFUk1fUFJPR1JBTV9WRVJTSU9OXCIpKSAhPT0gbnVsbCkge1xuICAgICAgICByZXR1cm4gQ09MT1JTXzI1NjtcbiAgICAgIH1cbiAgICAgIHJldHVybiBDT0xPUlNfMTZtO1xuICAgIGNhc2UgXCJIeXBlclRlcm1cIjpcbiAgICBjYXNlIFwiTWFjVGVybVwiOlxuICAgICAgcmV0dXJuIENPTE9SU18xNm07XG4gICAgY2FzZSBcIkFwcGxlX1Rlcm1pbmFsXCI6XG4gICAgICByZXR1cm4gQ09MT1JTXzI1NjtcbiAgfVxuICBpZiAoZ2V0RW52VmFyKFwiQ09MT1JURVJNXCIpID09PSBcInRydWVjb2xvclwiIHx8IGdldEVudlZhcihcIkNPTE9SVEVSTVwiKSA9PT0gXCIyNGJpdFwiKSB7XG4gICAgcmV0dXJuIENPTE9SU18xNm07XG4gIH1cbiAgaWYgKGdldEVudlZhcihcIlRFUk1cIikpIHtcbiAgICBpZiAoL3RydWVjb2xvci8uZXhlYyhnZXRFbnZWYXIoXCJURVJNXCIpKSAhPT0gbnVsbCkge1xuICAgICAgcmV0dXJuIENPTE9SU18xNm07XG4gICAgfVxuICAgIGlmICgvXnh0ZXJtLTI1Ni8uZXhlYyhnZXRFbnZWYXIoXCJURVJNXCIpKSAhPT0gbnVsbCkge1xuICAgICAgcmV0dXJuIENPTE9SU18yNTY7XG4gICAgfVxuICAgIGNvbnN0IHRlcm1FbnYgPSBnZXRFbnZWYXIoXCJURVJNXCIpLnRvTG93ZXJDYXNlKCk7XG4gICAgaWYgKFRFUk1fRU5WU1t0ZXJtRW52XSkge1xuICAgICAgcmV0dXJuIFRFUk1fRU5WU1t0ZXJtRW52XTtcbiAgICB9XG4gICAgaWYgKFRFUk1fRU5WU19SRUdfRVhQLnNvbWUoKHRlcm0pID0+IHRlcm0uZXhlYyh0ZXJtRW52KSAhPT0gbnVsbCkpIHtcbiAgICAgIHJldHVybiBDT0xPUlNfMTY7XG4gICAgfVxuICB9XG4gIGlmIChnZXRFbnZWYXIoXCJDT0xPUlRFUk1cIikpIHtcbiAgICByZXR1cm4gQ09MT1JTXzE2O1xuICB9XG4gIHJldHVybiBDT0xPUlNfMjtcbn1cblxuY29uc3QgVFRZX0NPTE9SUyA9IHtcbiAgcmVzZXQ6IFwiXFx4MUJbMG1cIixcbiAgYnJpZ2h0OiBcIlxceDFCWzFtXCIsXG4gIGRpbTogXCJcXHgxQlsybVwiLFxuICB1bmRpbTogXCJcXHgxQlsyMm1cIixcbiAgdW5kZXJzY29yZTogXCJcXHgxQls0bVwiLFxuICBibGluazogXCJcXHgxQls1bVwiLFxuICByZXZlcnNlOiBcIlxceDFCWzdtXCIsXG4gIGhpZGRlbjogXCJcXHgxQls4bVwiLFxuICBmZzoge1xuICAgIGJsYWNrOiBcIlxceDFCWzMwbVwiLFxuICAgIHJlZDogXCJcXHgxQlszMW1cIixcbiAgICBncmVlbjogXCJcXHgxQlszMm1cIixcbiAgICB5ZWxsb3c6IFwiXFx4MUJbMzNtXCIsXG4gICAgYmx1ZTogXCJcXHgxQlszNG1cIixcbiAgICBtYWdlbnRhOiBcIlxceDFCWzM1bVwiLFxuICAgIGN5YW46IFwiXFx4MUJbMzZtXCIsXG4gICAgd2hpdGU6IFwiXFx4MUJbMzdtXCJcbiAgfSxcbiAgYmc6IHtcbiAgICBibGFjazogXCJcXHgxQls0MG1cIixcbiAgICByZWQ6IFwiXFx4MUJbNDFtXCIsXG4gICAgZ3JlZW46IFwiXFx4MUJbNDJtXCIsXG4gICAgeWVsbG93OiBcIlxceDFCWzQzbVwiLFxuICAgIGJsdWU6IFwiXFx4MUJbNDRtXCIsXG4gICAgbWFnZW50YTogXCJcXHgxQls0NW1cIixcbiAgICBjeWFuOiBcIlxceDFCWzQ2bVwiLFxuICAgIHdoaXRlOiBcIlxceDFCWzQ3bVwiXG4gIH1cbn07XG5jb25zdCBsZXZlbHMgPSBbXCJpbmZvXCIsIFwic3VjY2Vzc1wiLCBcIndhcm5cIiwgXCJlcnJvclwiLCBcImRlYnVnXCJdO1xuZnVuY3Rpb24gc2hvdWxkUHVibGlzaExvZyhjdXJyZW50TG9nTGV2ZWwsIGxvZ0xldmVsKSB7XG4gIHJldHVybiBsZXZlbHMuaW5kZXhPZihsb2dMZXZlbCkgPD0gbGV2ZWxzLmluZGV4T2YoY3VycmVudExvZ0xldmVsKTtcbn1cbmNvbnN0IGxldmVsQ29sb3JzID0ge1xuICBpbmZvOiBUVFlfQ09MT1JTLmZnLmJsdWUsXG4gIHN1Y2Nlc3M6IFRUWV9DT0xPUlMuZmcuZ3JlZW4sXG4gIHdhcm46IFRUWV9DT0xPUlMuZmcueWVsbG93LFxuICBlcnJvcjogVFRZX0NPTE9SUy5mZy5yZWQsXG4gIGRlYnVnOiBUVFlfQ09MT1JTLmZnLm1hZ2VudGFcbn07XG5jb25zdCBmb3JtYXRNZXNzYWdlID0gKGxldmVsLCBtZXNzYWdlLCBjb2xvcnNFbmFibGVkKSA9PiB7XG4gIGNvbnN0IHRpbWVzdGFtcCA9ICgvKiBAX19QVVJFX18gKi8gbmV3IERhdGUoKSkudG9JU09TdHJpbmcoKTtcbiAgaWYgKGNvbG9yc0VuYWJsZWQpIHtcbiAgICByZXR1cm4gYCR7VFRZX0NPTE9SUy5kaW19JHt0aW1lc3RhbXB9JHtUVFlfQ09MT1JTLnJlc2V0fSAke2xldmVsQ29sb3JzW2xldmVsXX0ke2xldmVsLnRvVXBwZXJDYXNlKCl9JHtUVFlfQ09MT1JTLnJlc2V0fSAke1RUWV9DT0xPUlMuYnJpZ2h0fVtCZXR0ZXIgQXV0aF06JHtUVFlfQ09MT1JTLnJlc2V0fSAke21lc3NhZ2V9YDtcbiAgfVxuICByZXR1cm4gYCR7dGltZXN0YW1wfSAke2xldmVsLnRvVXBwZXJDYXNlKCl9IFtCZXR0ZXIgQXV0aF06ICR7bWVzc2FnZX1gO1xufTtcbmNvbnN0IGNyZWF0ZUxvZ2dlciA9IChvcHRpb25zKSA9PiB7XG4gIGNvbnN0IGVuYWJsZWQgPSBvcHRpb25zPy5kaXNhYmxlZCAhPT0gdHJ1ZTtcbiAgY29uc3QgbG9nTGV2ZWwgPSBvcHRpb25zPy5sZXZlbCA/PyBcImVycm9yXCI7XG4gIGNvbnN0IGlzRGlzYWJsZUNvbG9yc1NwZWNpZmllZCA9IG9wdGlvbnM/LmRpc2FibGVDb2xvcnMgIT09IHZvaWQgMDtcbiAgY29uc3QgY29sb3JzRW5hYmxlZCA9IGlzRGlzYWJsZUNvbG9yc1NwZWNpZmllZCA/ICFvcHRpb25zLmRpc2FibGVDb2xvcnMgOiBnZXRDb2xvckRlcHRoKCkgIT09IDE7XG4gIGNvbnN0IExvZ0Z1bmMgPSAobGV2ZWwsIG1lc3NhZ2UsIGFyZ3MgPSBbXSkgPT4ge1xuICAgIGlmICghZW5hYmxlZCB8fCAhc2hvdWxkUHVibGlzaExvZyhsb2dMZXZlbCwgbGV2ZWwpKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGNvbnN0IGZvcm1hdHRlZE1lc3NhZ2UgPSBmb3JtYXRNZXNzYWdlKGxldmVsLCBtZXNzYWdlLCBjb2xvcnNFbmFibGVkKTtcbiAgICBpZiAoIW9wdGlvbnMgfHwgdHlwZW9mIG9wdGlvbnMubG9nICE9PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgIGlmIChsZXZlbCA9PT0gXCJlcnJvclwiKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoZm9ybWF0dGVkTWVzc2FnZSwgLi4uYXJncyk7XG4gICAgICB9IGVsc2UgaWYgKGxldmVsID09PSBcIndhcm5cIikge1xuICAgICAgICBjb25zb2xlLndhcm4oZm9ybWF0dGVkTWVzc2FnZSwgLi4uYXJncyk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBjb25zb2xlLmxvZyhmb3JtYXR0ZWRNZXNzYWdlLCAuLi5hcmdzKTtcbiAgICAgIH1cbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgb3B0aW9ucy5sb2cobGV2ZWwgPT09IFwic3VjY2Vzc1wiID8gXCJpbmZvXCIgOiBsZXZlbCwgbWVzc2FnZSwgLi4uYXJncyk7XG4gIH07XG4gIGNvbnN0IGxvZ2dlcjIgPSBPYmplY3QuZnJvbUVudHJpZXMoXG4gICAgbGV2ZWxzLm1hcCgobGV2ZWwpID0+IFtcbiAgICAgIGxldmVsLFxuICAgICAgKC4uLlttZXNzYWdlLCAuLi5hcmdzXSkgPT4gTG9nRnVuYyhsZXZlbCwgbWVzc2FnZSwgYXJncylcbiAgICBdKVxuICApO1xuICByZXR1cm4ge1xuICAgIC4uLmxvZ2dlcjIsXG4gICAgZ2V0IGxldmVsKCkge1xuICAgICAgcmV0dXJuIGxvZ0xldmVsO1xuICAgIH1cbiAgfTtcbn07XG5jb25zdCBsb2dnZXIgPSBjcmVhdGVMb2dnZXIoKTtcblxuZXhwb3J0IHsgRU5WLCBUVFlfQ09MT1JTLCBjcmVhdGVMb2dnZXIsIGVudiwgZ2V0Qm9vbGVhbkVudlZhciwgZ2V0Q29sb3JEZXB0aCwgZ2V0RW52VmFyLCBpc0RldmVsb3BtZW50LCBpc1Byb2R1Y3Rpb24sIGlzVGVzdCwgbGV2ZWxzLCBsb2dnZXIsIG5vZGVFTlYsIHNob3VsZFB1Ymxpc2hMb2cgfTtcbiJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOlswXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(action-browser)/./node_modules/@better-auth/core/dist/env/index.mjs\n");

/***/ }),

/***/ "(action-browser)/./node_modules/@better-auth/core/dist/error/index.mjs":
/*!*************************************************************!*\
  !*** ./node_modules/@better-auth/core/dist/error/index.mjs ***!
  \*************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   BASE_ERROR_CODES: () => (/* binding */ BASE_ERROR_CODES),\n/* harmony export */   BetterAuthError: () => (/* binding */ BetterAuthError)\n/* harmony export */ });\n/* harmony import */ var _better_auth_core_utils__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @better-auth/core/utils */ \"(action-browser)/./node_modules/@better-auth/core/dist/utils/index.mjs\");\n\n\nconst BASE_ERROR_CODES = (0,_better_auth_core_utils__WEBPACK_IMPORTED_MODULE_0__.defineErrorCodes)({\n  USER_NOT_FOUND: \"User not found\",\n  FAILED_TO_CREATE_USER: \"Failed to create user\",\n  FAILED_TO_CREATE_SESSION: \"Failed to create session\",\n  FAILED_TO_UPDATE_USER: \"Failed to update user\",\n  FAILED_TO_GET_SESSION: \"Failed to get session\",\n  INVALID_PASSWORD: \"Invalid password\",\n  INVALID_EMAIL: \"Invalid email\",\n  INVALID_EMAIL_OR_PASSWORD: \"Invalid email or password\",\n  SOCIAL_ACCOUNT_ALREADY_LINKED: \"Social account already linked\",\n  PROVIDER_NOT_FOUND: \"Provider not found\",\n  INVALID_TOKEN: \"Invalid token\",\n  ID_TOKEN_NOT_SUPPORTED: \"id_token not supported\",\n  FAILED_TO_GET_USER_INFO: \"Failed to get user info\",\n  USER_EMAIL_NOT_FOUND: \"User email not found\",\n  EMAIL_NOT_VERIFIED: \"Email not verified\",\n  PASSWORD_TOO_SHORT: \"Password too short\",\n  PASSWORD_TOO_LONG: \"Password too long\",\n  USER_ALREADY_EXISTS: \"User already exists.\",\n  USER_ALREADY_EXISTS_USE_ANOTHER_EMAIL: \"User already exists. Use another email.\",\n  EMAIL_CAN_NOT_BE_UPDATED: \"Email can not be updated\",\n  CREDENTIAL_ACCOUNT_NOT_FOUND: \"Credential account not found\",\n  SESSION_EXPIRED: \"Session expired. Re-authenticate to perform this action.\",\n  FAILED_TO_UNLINK_LAST_ACCOUNT: \"You can't unlink your last account\",\n  ACCOUNT_NOT_FOUND: \"Account not found\",\n  USER_ALREADY_HAS_PASSWORD: \"User already has a password. Provide that to delete the account.\"\n});\n\nclass BetterAuthError extends Error {\n  constructor(message, cause) {\n    super(message);\n    this.name = \"BetterAuthError\";\n    this.message = message;\n    this.cause = cause;\n    this.stack = \"\";\n  }\n}\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFjdGlvbi1icm93c2VyKS8uL25vZGVfbW9kdWxlcy9AYmV0dGVyLWF1dGgvY29yZS9kaXN0L2Vycm9yL2luZGV4Lm1qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7QUFBMkQ7O0FBRTNELHlCQUF5Qix5RUFBZ0I7QUFDekM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDOztBQUVEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFNkMiLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcc2lkMDFcXE9uZURyaXZlXFxEZXNrdG9wXFxhbWQtdGVsZXBob255LXN5c3RlbVxcZnJvbnRlbmRcXG5vZGVfbW9kdWxlc1xcQGJldHRlci1hdXRoXFxjb3JlXFxkaXN0XFxlcnJvclxcaW5kZXgubWpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGRlZmluZUVycm9yQ29kZXMgfSBmcm9tICdAYmV0dGVyLWF1dGgvY29yZS91dGlscyc7XG5cbmNvbnN0IEJBU0VfRVJST1JfQ09ERVMgPSBkZWZpbmVFcnJvckNvZGVzKHtcbiAgVVNFUl9OT1RfRk9VTkQ6IFwiVXNlciBub3QgZm91bmRcIixcbiAgRkFJTEVEX1RPX0NSRUFURV9VU0VSOiBcIkZhaWxlZCB0byBjcmVhdGUgdXNlclwiLFxuICBGQUlMRURfVE9fQ1JFQVRFX1NFU1NJT046IFwiRmFpbGVkIHRvIGNyZWF0ZSBzZXNzaW9uXCIsXG4gIEZBSUxFRF9UT19VUERBVEVfVVNFUjogXCJGYWlsZWQgdG8gdXBkYXRlIHVzZXJcIixcbiAgRkFJTEVEX1RPX0dFVF9TRVNTSU9OOiBcIkZhaWxlZCB0byBnZXQgc2Vzc2lvblwiLFxuICBJTlZBTElEX1BBU1NXT1JEOiBcIkludmFsaWQgcGFzc3dvcmRcIixcbiAgSU5WQUxJRF9FTUFJTDogXCJJbnZhbGlkIGVtYWlsXCIsXG4gIElOVkFMSURfRU1BSUxfT1JfUEFTU1dPUkQ6IFwiSW52YWxpZCBlbWFpbCBvciBwYXNzd29yZFwiLFxuICBTT0NJQUxfQUNDT1VOVF9BTFJFQURZX0xJTktFRDogXCJTb2NpYWwgYWNjb3VudCBhbHJlYWR5IGxpbmtlZFwiLFxuICBQUk9WSURFUl9OT1RfRk9VTkQ6IFwiUHJvdmlkZXIgbm90IGZvdW5kXCIsXG4gIElOVkFMSURfVE9LRU46IFwiSW52YWxpZCB0b2tlblwiLFxuICBJRF9UT0tFTl9OT1RfU1VQUE9SVEVEOiBcImlkX3Rva2VuIG5vdCBzdXBwb3J0ZWRcIixcbiAgRkFJTEVEX1RPX0dFVF9VU0VSX0lORk86IFwiRmFpbGVkIHRvIGdldCB1c2VyIGluZm9cIixcbiAgVVNFUl9FTUFJTF9OT1RfRk9VTkQ6IFwiVXNlciBlbWFpbCBub3QgZm91bmRcIixcbiAgRU1BSUxfTk9UX1ZFUklGSUVEOiBcIkVtYWlsIG5vdCB2ZXJpZmllZFwiLFxuICBQQVNTV09SRF9UT09fU0hPUlQ6IFwiUGFzc3dvcmQgdG9vIHNob3J0XCIsXG4gIFBBU1NXT1JEX1RPT19MT05HOiBcIlBhc3N3b3JkIHRvbyBsb25nXCIsXG4gIFVTRVJfQUxSRUFEWV9FWElTVFM6IFwiVXNlciBhbHJlYWR5IGV4aXN0cy5cIixcbiAgVVNFUl9BTFJFQURZX0VYSVNUU19VU0VfQU5PVEhFUl9FTUFJTDogXCJVc2VyIGFscmVhZHkgZXhpc3RzLiBVc2UgYW5vdGhlciBlbWFpbC5cIixcbiAgRU1BSUxfQ0FOX05PVF9CRV9VUERBVEVEOiBcIkVtYWlsIGNhbiBub3QgYmUgdXBkYXRlZFwiLFxuICBDUkVERU5USUFMX0FDQ09VTlRfTk9UX0ZPVU5EOiBcIkNyZWRlbnRpYWwgYWNjb3VudCBub3QgZm91bmRcIixcbiAgU0VTU0lPTl9FWFBJUkVEOiBcIlNlc3Npb24gZXhwaXJlZC4gUmUtYXV0aGVudGljYXRlIHRvIHBlcmZvcm0gdGhpcyBhY3Rpb24uXCIsXG4gIEZBSUxFRF9UT19VTkxJTktfTEFTVF9BQ0NPVU5UOiBcIllvdSBjYW4ndCB1bmxpbmsgeW91ciBsYXN0IGFjY291bnRcIixcbiAgQUNDT1VOVF9OT1RfRk9VTkQ6IFwiQWNjb3VudCBub3QgZm91bmRcIixcbiAgVVNFUl9BTFJFQURZX0hBU19QQVNTV09SRDogXCJVc2VyIGFscmVhZHkgaGFzIGEgcGFzc3dvcmQuIFByb3ZpZGUgdGhhdCB0byBkZWxldGUgdGhlIGFjY291bnQuXCJcbn0pO1xuXG5jbGFzcyBCZXR0ZXJBdXRoRXJyb3IgZXh0ZW5kcyBFcnJvciB7XG4gIGNvbnN0cnVjdG9yKG1lc3NhZ2UsIGNhdXNlKSB7XG4gICAgc3VwZXIobWVzc2FnZSk7XG4gICAgdGhpcy5uYW1lID0gXCJCZXR0ZXJBdXRoRXJyb3JcIjtcbiAgICB0aGlzLm1lc3NhZ2UgPSBtZXNzYWdlO1xuICAgIHRoaXMuY2F1c2UgPSBjYXVzZTtcbiAgICB0aGlzLnN0YWNrID0gXCJcIjtcbiAgfVxufVxuXG5leHBvcnQgeyBCQVNFX0VSUk9SX0NPREVTLCBCZXR0ZXJBdXRoRXJyb3IgfTtcbiJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOlswXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(action-browser)/./node_modules/@better-auth/core/dist/error/index.mjs\n");

/***/ }),

/***/ "(action-browser)/./node_modules/@better-auth/core/dist/index.mjs":
/*!*******************************************************!*\
  !*** ./node_modules/@better-auth/core/dist/index.mjs ***!
  \*******************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);



/***/ }),

/***/ "(action-browser)/./node_modules/@better-auth/core/dist/middleware/index.mjs":
/*!******************************************************************!*\
  !*** ./node_modules/@better-auth/core/dist/middleware/index.mjs ***!
  \******************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createAuthEndpoint: () => (/* binding */ createAuthEndpoint),\n/* harmony export */   createAuthMiddleware: () => (/* binding */ createAuthMiddleware),\n/* harmony export */   optionsMiddleware: () => (/* binding */ optionsMiddleware)\n/* harmony export */ });\n/* harmony import */ var better_call__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! better-call */ \"(action-browser)/./node_modules/better-call/dist/index.js\");\n\n\nconst optionsMiddleware = (0,better_call__WEBPACK_IMPORTED_MODULE_0__.createMiddleware)(async () => {\n  return {};\n});\nconst createAuthMiddleware = better_call__WEBPACK_IMPORTED_MODULE_0__.createMiddleware.create({\n  use: [\n    optionsMiddleware,\n    /**\n     * Only use for post hooks\n     */\n    (0,better_call__WEBPACK_IMPORTED_MODULE_0__.createMiddleware)(async () => {\n      return {};\n    })\n  ]\n});\nconst createAuthEndpoint = better_call__WEBPACK_IMPORTED_MODULE_0__.createEndpoint.create({\n  use: [optionsMiddleware]\n});\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFjdGlvbi1icm93c2VyKS8uL25vZGVfbW9kdWxlcy9AYmV0dGVyLWF1dGgvY29yZS9kaXN0L21pZGRsZXdhcmUvaW5kZXgubWpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7QUFBK0Q7O0FBRS9ELDBCQUEwQiw2REFBZ0I7QUFDMUM7QUFDQSxDQUFDO0FBQ0QsNkJBQTZCLHlEQUFnQjtBQUM3QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSSw2REFBZ0I7QUFDcEI7QUFDQSxLQUFLO0FBQ0w7QUFDQSxDQUFDO0FBQ0QsMkJBQTJCLHVEQUFjO0FBQ3pDO0FBQ0EsQ0FBQzs7QUFFc0UiLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcc2lkMDFcXE9uZURyaXZlXFxEZXNrdG9wXFxhbWQtdGVsZXBob255LXN5c3RlbVxcZnJvbnRlbmRcXG5vZGVfbW9kdWxlc1xcQGJldHRlci1hdXRoXFxjb3JlXFxkaXN0XFxtaWRkbGV3YXJlXFxpbmRleC5tanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgY3JlYXRlTWlkZGxld2FyZSwgY3JlYXRlRW5kcG9pbnQgfSBmcm9tICdiZXR0ZXItY2FsbCc7XG5cbmNvbnN0IG9wdGlvbnNNaWRkbGV3YXJlID0gY3JlYXRlTWlkZGxld2FyZShhc3luYyAoKSA9PiB7XG4gIHJldHVybiB7fTtcbn0pO1xuY29uc3QgY3JlYXRlQXV0aE1pZGRsZXdhcmUgPSBjcmVhdGVNaWRkbGV3YXJlLmNyZWF0ZSh7XG4gIHVzZTogW1xuICAgIG9wdGlvbnNNaWRkbGV3YXJlLFxuICAgIC8qKlxuICAgICAqIE9ubHkgdXNlIGZvciBwb3N0IGhvb2tzXG4gICAgICovXG4gICAgY3JlYXRlTWlkZGxld2FyZShhc3luYyAoKSA9PiB7XG4gICAgICByZXR1cm4ge307XG4gICAgfSlcbiAgXVxufSk7XG5jb25zdCBjcmVhdGVBdXRoRW5kcG9pbnQgPSBjcmVhdGVFbmRwb2ludC5jcmVhdGUoe1xuICB1c2U6IFtvcHRpb25zTWlkZGxld2FyZV1cbn0pO1xuXG5leHBvcnQgeyBjcmVhdGVBdXRoRW5kcG9pbnQsIGNyZWF0ZUF1dGhNaWRkbGV3YXJlLCBvcHRpb25zTWlkZGxld2FyZSB9O1xuIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6WzBdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(action-browser)/./node_modules/@better-auth/core/dist/middleware/index.mjs\n");

/***/ }),

/***/ "(action-browser)/./node_modules/@better-auth/core/dist/oauth2/index.mjs":
/*!**************************************************************!*\
  !*** ./node_modules/@better-auth/core/dist/oauth2/index.mjs ***!
  \**************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   clientCredentialsToken: () => (/* binding */ clientCredentialsToken),\n/* harmony export */   createAuthorizationCodeRequest: () => (/* binding */ createAuthorizationCodeRequest),\n/* harmony export */   createAuthorizationURL: () => (/* binding */ createAuthorizationURL),\n/* harmony export */   createClientCredentialsTokenRequest: () => (/* binding */ createClientCredentialsTokenRequest),\n/* harmony export */   createRefreshAccessTokenRequest: () => (/* binding */ createRefreshAccessTokenRequest),\n/* harmony export */   generateCodeChallenge: () => (/* binding */ generateCodeChallenge),\n/* harmony export */   getOAuth2Tokens: () => (/* binding */ getOAuth2Tokens),\n/* harmony export */   refreshAccessToken: () => (/* binding */ refreshAccessToken),\n/* harmony export */   validateAuthorizationCode: () => (/* binding */ validateAuthorizationCode),\n/* harmony export */   validateToken: () => (/* binding */ validateToken)\n/* harmony export */ });\n/* harmony import */ var _better_auth_utils_base64__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @better-auth/utils/base64 */ \"(action-browser)/./node_modules/@better-auth/utils/dist/base64.mjs\");\n/* harmony import */ var _better_fetch_fetch__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @better-fetch/fetch */ \"(action-browser)/./node_modules/@better-fetch/fetch/dist/index.js\");\n/* harmony import */ var jose__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! jose */ \"(action-browser)/./node_modules/jose/dist/webapi/jwt/verify.js\");\n\n\n\n\nfunction getOAuth2Tokens(data) {\n  const getDate = (seconds) => {\n    const now = /* @__PURE__ */ new Date();\n    return new Date(now.getTime() + seconds * 1e3);\n  };\n  return {\n    tokenType: data.token_type,\n    accessToken: data.access_token,\n    refreshToken: data.refresh_token,\n    accessTokenExpiresAt: data.expires_in ? getDate(data.expires_in) : void 0,\n    refreshTokenExpiresAt: data.refresh_token_expires_in ? getDate(data.refresh_token_expires_in) : void 0,\n    scopes: data?.scope ? typeof data.scope === \"string\" ? data.scope.split(\" \") : data.scope : [],\n    idToken: data.id_token\n  };\n}\nasync function generateCodeChallenge(codeVerifier) {\n  const encoder = new TextEncoder();\n  const data = encoder.encode(codeVerifier);\n  const hash = await crypto.subtle.digest(\"SHA-256\", data);\n  return _better_auth_utils_base64__WEBPACK_IMPORTED_MODULE_0__.base64Url.encode(new Uint8Array(hash), {\n    padding: false\n  });\n}\n\nasync function createAuthorizationURL({\n  id,\n  options,\n  authorizationEndpoint,\n  state,\n  codeVerifier,\n  scopes,\n  claims,\n  redirectURI,\n  duration,\n  prompt,\n  accessType,\n  responseType,\n  display,\n  loginHint,\n  hd,\n  responseMode,\n  additionalParams,\n  scopeJoiner\n}) {\n  const url = new URL(authorizationEndpoint);\n  url.searchParams.set(\"response_type\", responseType || \"code\");\n  const primaryClientId = Array.isArray(options.clientId) ? options.clientId[0] : options.clientId;\n  url.searchParams.set(\"client_id\", primaryClientId);\n  url.searchParams.set(\"state\", state);\n  url.searchParams.set(\"scope\", scopes.join(scopeJoiner || \" \"));\n  url.searchParams.set(\"redirect_uri\", options.redirectURI || redirectURI);\n  duration && url.searchParams.set(\"duration\", duration);\n  display && url.searchParams.set(\"display\", display);\n  loginHint && url.searchParams.set(\"login_hint\", loginHint);\n  prompt && url.searchParams.set(\"prompt\", prompt);\n  hd && url.searchParams.set(\"hd\", hd);\n  accessType && url.searchParams.set(\"access_type\", accessType);\n  responseMode && url.searchParams.set(\"response_mode\", responseMode);\n  if (codeVerifier) {\n    const codeChallenge = await generateCodeChallenge(codeVerifier);\n    url.searchParams.set(\"code_challenge_method\", \"S256\");\n    url.searchParams.set(\"code_challenge\", codeChallenge);\n  }\n  if (claims) {\n    const claimsObj = claims.reduce(\n      (acc, claim) => {\n        acc[claim] = null;\n        return acc;\n      },\n      {}\n    );\n    url.searchParams.set(\n      \"claims\",\n      JSON.stringify({\n        id_token: { email: null, email_verified: null, ...claimsObj }\n      })\n    );\n  }\n  if (additionalParams) {\n    Object.entries(additionalParams).forEach(([key, value]) => {\n      url.searchParams.set(key, value);\n    });\n  }\n  return url;\n}\n\nfunction createAuthorizationCodeRequest({\n  code,\n  codeVerifier,\n  redirectURI,\n  options,\n  authentication,\n  deviceId,\n  headers,\n  additionalParams = {},\n  resource\n}) {\n  const body = new URLSearchParams();\n  const requestHeaders = {\n    \"content-type\": \"application/x-www-form-urlencoded\",\n    accept: \"application/json\",\n    \"user-agent\": \"better-auth\",\n    ...headers\n  };\n  body.set(\"grant_type\", \"authorization_code\");\n  body.set(\"code\", code);\n  codeVerifier && body.set(\"code_verifier\", codeVerifier);\n  options.clientKey && body.set(\"client_key\", options.clientKey);\n  deviceId && body.set(\"device_id\", deviceId);\n  body.set(\"redirect_uri\", options.redirectURI || redirectURI);\n  if (resource) {\n    if (typeof resource === \"string\") {\n      body.append(\"resource\", resource);\n    } else {\n      for (const _resource of resource) {\n        body.append(\"resource\", _resource);\n      }\n    }\n  }\n  if (authentication === \"basic\") {\n    const primaryClientId = Array.isArray(options.clientId) ? options.clientId[0] : options.clientId;\n    const encodedCredentials = _better_auth_utils_base64__WEBPACK_IMPORTED_MODULE_0__.base64.encode(\n      `${primaryClientId}:${options.clientSecret ?? \"\"}`\n    );\n    requestHeaders[\"authorization\"] = `Basic ${encodedCredentials}`;\n  } else {\n    const primaryClientId = Array.isArray(options.clientId) ? options.clientId[0] : options.clientId;\n    body.set(\"client_id\", primaryClientId);\n    if (options.clientSecret) {\n      body.set(\"client_secret\", options.clientSecret);\n    }\n  }\n  for (const [key, value] of Object.entries(additionalParams)) {\n    if (!body.has(key)) body.append(key, value);\n  }\n  return {\n    body,\n    headers: requestHeaders\n  };\n}\nasync function validateAuthorizationCode({\n  code,\n  codeVerifier,\n  redirectURI,\n  options,\n  tokenEndpoint,\n  authentication,\n  deviceId,\n  headers,\n  additionalParams = {},\n  resource\n}) {\n  const { body, headers: requestHeaders } = createAuthorizationCodeRequest({\n    code,\n    codeVerifier,\n    redirectURI,\n    options,\n    authentication,\n    deviceId,\n    headers,\n    additionalParams,\n    resource\n  });\n  const { data, error } = await (0,_better_fetch_fetch__WEBPACK_IMPORTED_MODULE_1__.betterFetch)(tokenEndpoint, {\n    method: \"POST\",\n    body,\n    headers: requestHeaders\n  });\n  if (error) {\n    throw error;\n  }\n  const tokens = getOAuth2Tokens(data);\n  return tokens;\n}\nasync function validateToken(token, jwksEndpoint) {\n  const { data, error } = await (0,_better_fetch_fetch__WEBPACK_IMPORTED_MODULE_1__.betterFetch)(jwksEndpoint, {\n    method: \"GET\",\n    headers: {\n      accept: \"application/json\",\n      \"user-agent\": \"better-auth\"\n    }\n  });\n  if (error) {\n    throw error;\n  }\n  const keys = data[\"keys\"];\n  const header = JSON.parse(atob(token.split(\".\")[0]));\n  const key = keys.find((key2) => key2.kid === header.kid);\n  if (!key) {\n    throw new Error(\"Key not found\");\n  }\n  const verified = await (0,jose__WEBPACK_IMPORTED_MODULE_2__.jwtVerify)(token, key);\n  return verified;\n}\n\nfunction createRefreshAccessTokenRequest({\n  refreshToken,\n  options,\n  authentication,\n  extraParams,\n  resource\n}) {\n  const body = new URLSearchParams();\n  const headers = {\n    \"content-type\": \"application/x-www-form-urlencoded\",\n    accept: \"application/json\"\n  };\n  body.set(\"grant_type\", \"refresh_token\");\n  body.set(\"refresh_token\", refreshToken);\n  if (authentication === \"basic\") {\n    const primaryClientId = Array.isArray(options.clientId) ? options.clientId[0] : options.clientId;\n    if (primaryClientId) {\n      headers[\"authorization\"] = \"Basic \" + _better_auth_utils_base64__WEBPACK_IMPORTED_MODULE_0__.base64.encode(`${primaryClientId}:${options.clientSecret ?? \"\"}`);\n    } else {\n      headers[\"authorization\"] = \"Basic \" + _better_auth_utils_base64__WEBPACK_IMPORTED_MODULE_0__.base64.encode(`:${options.clientSecret ?? \"\"}`);\n    }\n  } else {\n    const primaryClientId = Array.isArray(options.clientId) ? options.clientId[0] : options.clientId;\n    body.set(\"client_id\", primaryClientId);\n    if (options.clientSecret) {\n      body.set(\"client_secret\", options.clientSecret);\n    }\n  }\n  if (resource) {\n    if (typeof resource === \"string\") {\n      body.append(\"resource\", resource);\n    } else {\n      for (const _resource of resource) {\n        body.append(\"resource\", _resource);\n      }\n    }\n  }\n  if (extraParams) {\n    for (const [key, value] of Object.entries(extraParams)) {\n      body.set(key, value);\n    }\n  }\n  return {\n    body,\n    headers\n  };\n}\nasync function refreshAccessToken({\n  refreshToken,\n  options,\n  tokenEndpoint,\n  authentication,\n  extraParams\n}) {\n  const { body, headers } = createRefreshAccessTokenRequest({\n    refreshToken,\n    options,\n    authentication,\n    extraParams\n  });\n  const { data, error } = await (0,_better_fetch_fetch__WEBPACK_IMPORTED_MODULE_1__.betterFetch)(tokenEndpoint, {\n    method: \"POST\",\n    body,\n    headers\n  });\n  if (error) {\n    throw error;\n  }\n  const tokens = {\n    accessToken: data.access_token,\n    refreshToken: data.refresh_token,\n    tokenType: data.token_type,\n    scopes: data.scope?.split(\" \"),\n    idToken: data.id_token\n  };\n  if (data.expires_in) {\n    const now = /* @__PURE__ */ new Date();\n    tokens.accessTokenExpiresAt = new Date(\n      now.getTime() + data.expires_in * 1e3\n    );\n  }\n  return tokens;\n}\n\nfunction createClientCredentialsTokenRequest({\n  options,\n  scope,\n  authentication,\n  resource\n}) {\n  const body = new URLSearchParams();\n  const headers = {\n    \"content-type\": \"application/x-www-form-urlencoded\",\n    accept: \"application/json\"\n  };\n  body.set(\"grant_type\", \"client_credentials\");\n  scope && body.set(\"scope\", scope);\n  if (resource) {\n    if (typeof resource === \"string\") {\n      body.append(\"resource\", resource);\n    } else {\n      for (const _resource of resource) {\n        body.append(\"resource\", _resource);\n      }\n    }\n  }\n  if (authentication === \"basic\") {\n    const primaryClientId = Array.isArray(options.clientId) ? options.clientId[0] : options.clientId;\n    const encodedCredentials = _better_auth_utils_base64__WEBPACK_IMPORTED_MODULE_0__.base64Url.encode(\n      `${primaryClientId}:${options.clientSecret}`\n    );\n    headers[\"authorization\"] = `Basic ${encodedCredentials}`;\n  } else {\n    const primaryClientId = Array.isArray(options.clientId) ? options.clientId[0] : options.clientId;\n    body.set(\"client_id\", primaryClientId);\n    body.set(\"client_secret\", options.clientSecret);\n  }\n  return {\n    body,\n    headers\n  };\n}\nasync function clientCredentialsToken({\n  options,\n  tokenEndpoint,\n  scope,\n  authentication,\n  resource\n}) {\n  const { body, headers } = createClientCredentialsTokenRequest({\n    options,\n    scope,\n    authentication,\n    resource\n  });\n  const { data, error } = await (0,_better_fetch_fetch__WEBPACK_IMPORTED_MODULE_1__.betterFetch)(tokenEndpoint, {\n    method: \"POST\",\n    body,\n    headers\n  });\n  if (error) {\n    throw error;\n  }\n  const tokens = {\n    accessToken: data.access_token,\n    tokenType: data.token_type,\n    scopes: data.scope?.split(\" \")\n  };\n  if (data.expires_in) {\n    const now = /* @__PURE__ */ new Date();\n    tokens.accessTokenExpiresAt = new Date(\n      now.getTime() + data.expires_in * 1e3\n    );\n  }\n  return tokens;\n}\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFjdGlvbi1icm93c2VyKS8uL25vZGVfbW9kdWxlcy9AYmV0dGVyLWF1dGgvY29yZS9kaXN0L29hdXRoMi9pbmRleC5tanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7OztBQUE4RDtBQUNaO0FBQ2pCOztBQUVqQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVMsZ0VBQVM7QUFDbEI7QUFDQSxHQUFHO0FBQ0g7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQkFBb0I7QUFDcEIsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1QkFBdUI7QUFDdkI7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwrQkFBK0IsNkRBQU07QUFDckMsU0FBUyxnQkFBZ0IsR0FBRywyQkFBMkI7QUFDdkQ7QUFDQSwrQ0FBK0MsbUJBQW1CO0FBQ2xFLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUJBQXVCO0FBQ3ZCO0FBQ0EsQ0FBQztBQUNELFVBQVUsZ0NBQWdDO0FBQzFDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSCxVQUFVLGNBQWMsUUFBUSxnRUFBVztBQUMzQztBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVLGNBQWMsUUFBUSxnRUFBVztBQUMzQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlCQUF5QiwrQ0FBUztBQUNsQztBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDRDQUE0Qyw2REFBTSxXQUFXLGdCQUFnQixHQUFHLDJCQUEyQjtBQUMzRyxNQUFNO0FBQ04sNENBQTRDLDZEQUFNLFlBQVksMkJBQTJCO0FBQ3pGO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0QsVUFBVSxnQkFBZ0I7QUFDMUI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0gsVUFBVSxjQUFjLFFBQVEsZ0VBQVc7QUFDM0M7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsK0JBQStCLGdFQUFTO0FBQ3hDLFNBQVMsZ0JBQWdCLEdBQUcscUJBQXFCO0FBQ2pEO0FBQ0Esd0NBQXdDLG1CQUFtQjtBQUMzRCxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNELFVBQVUsZ0JBQWdCO0FBQzFCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNILFVBQVUsY0FBYyxRQUFRLGdFQUFXO0FBQzNDO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFc1EiLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcc2lkMDFcXE9uZURyaXZlXFxEZXNrdG9wXFxhbWQtdGVsZXBob255LXN5c3RlbVxcZnJvbnRlbmRcXG5vZGVfbW9kdWxlc1xcQGJldHRlci1hdXRoXFxjb3JlXFxkaXN0XFxvYXV0aDJcXGluZGV4Lm1qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBiYXNlNjRVcmwsIGJhc2U2NCB9IGZyb20gJ0BiZXR0ZXItYXV0aC91dGlscy9iYXNlNjQnO1xuaW1wb3J0IHsgYmV0dGVyRmV0Y2ggfSBmcm9tICdAYmV0dGVyLWZldGNoL2ZldGNoJztcbmltcG9ydCB7IGp3dFZlcmlmeSB9IGZyb20gJ2pvc2UnO1xuXG5mdW5jdGlvbiBnZXRPQXV0aDJUb2tlbnMoZGF0YSkge1xuICBjb25zdCBnZXREYXRlID0gKHNlY29uZHMpID0+IHtcbiAgICBjb25zdCBub3cgPSAvKiBAX19QVVJFX18gKi8gbmV3IERhdGUoKTtcbiAgICByZXR1cm4gbmV3IERhdGUobm93LmdldFRpbWUoKSArIHNlY29uZHMgKiAxZTMpO1xuICB9O1xuICByZXR1cm4ge1xuICAgIHRva2VuVHlwZTogZGF0YS50b2tlbl90eXBlLFxuICAgIGFjY2Vzc1Rva2VuOiBkYXRhLmFjY2Vzc190b2tlbixcbiAgICByZWZyZXNoVG9rZW46IGRhdGEucmVmcmVzaF90b2tlbixcbiAgICBhY2Nlc3NUb2tlbkV4cGlyZXNBdDogZGF0YS5leHBpcmVzX2luID8gZ2V0RGF0ZShkYXRhLmV4cGlyZXNfaW4pIDogdm9pZCAwLFxuICAgIHJlZnJlc2hUb2tlbkV4cGlyZXNBdDogZGF0YS5yZWZyZXNoX3Rva2VuX2V4cGlyZXNfaW4gPyBnZXREYXRlKGRhdGEucmVmcmVzaF90b2tlbl9leHBpcmVzX2luKSA6IHZvaWQgMCxcbiAgICBzY29wZXM6IGRhdGE/LnNjb3BlID8gdHlwZW9mIGRhdGEuc2NvcGUgPT09IFwic3RyaW5nXCIgPyBkYXRhLnNjb3BlLnNwbGl0KFwiIFwiKSA6IGRhdGEuc2NvcGUgOiBbXSxcbiAgICBpZFRva2VuOiBkYXRhLmlkX3Rva2VuXG4gIH07XG59XG5hc3luYyBmdW5jdGlvbiBnZW5lcmF0ZUNvZGVDaGFsbGVuZ2UoY29kZVZlcmlmaWVyKSB7XG4gIGNvbnN0IGVuY29kZXIgPSBuZXcgVGV4dEVuY29kZXIoKTtcbiAgY29uc3QgZGF0YSA9IGVuY29kZXIuZW5jb2RlKGNvZGVWZXJpZmllcik7XG4gIGNvbnN0IGhhc2ggPSBhd2FpdCBjcnlwdG8uc3VidGxlLmRpZ2VzdChcIlNIQS0yNTZcIiwgZGF0YSk7XG4gIHJldHVybiBiYXNlNjRVcmwuZW5jb2RlKG5ldyBVaW50OEFycmF5KGhhc2gpLCB7XG4gICAgcGFkZGluZzogZmFsc2VcbiAgfSk7XG59XG5cbmFzeW5jIGZ1bmN0aW9uIGNyZWF0ZUF1dGhvcml6YXRpb25VUkwoe1xuICBpZCxcbiAgb3B0aW9ucyxcbiAgYXV0aG9yaXphdGlvbkVuZHBvaW50LFxuICBzdGF0ZSxcbiAgY29kZVZlcmlmaWVyLFxuICBzY29wZXMsXG4gIGNsYWltcyxcbiAgcmVkaXJlY3RVUkksXG4gIGR1cmF0aW9uLFxuICBwcm9tcHQsXG4gIGFjY2Vzc1R5cGUsXG4gIHJlc3BvbnNlVHlwZSxcbiAgZGlzcGxheSxcbiAgbG9naW5IaW50LFxuICBoZCxcbiAgcmVzcG9uc2VNb2RlLFxuICBhZGRpdGlvbmFsUGFyYW1zLFxuICBzY29wZUpvaW5lclxufSkge1xuICBjb25zdCB1cmwgPSBuZXcgVVJMKGF1dGhvcml6YXRpb25FbmRwb2ludCk7XG4gIHVybC5zZWFyY2hQYXJhbXMuc2V0KFwicmVzcG9uc2VfdHlwZVwiLCByZXNwb25zZVR5cGUgfHwgXCJjb2RlXCIpO1xuICBjb25zdCBwcmltYXJ5Q2xpZW50SWQgPSBBcnJheS5pc0FycmF5KG9wdGlvbnMuY2xpZW50SWQpID8gb3B0aW9ucy5jbGllbnRJZFswXSA6IG9wdGlvbnMuY2xpZW50SWQ7XG4gIHVybC5zZWFyY2hQYXJhbXMuc2V0KFwiY2xpZW50X2lkXCIsIHByaW1hcnlDbGllbnRJZCk7XG4gIHVybC5zZWFyY2hQYXJhbXMuc2V0KFwic3RhdGVcIiwgc3RhdGUpO1xuICB1cmwuc2VhcmNoUGFyYW1zLnNldChcInNjb3BlXCIsIHNjb3Blcy5qb2luKHNjb3BlSm9pbmVyIHx8IFwiIFwiKSk7XG4gIHVybC5zZWFyY2hQYXJhbXMuc2V0KFwicmVkaXJlY3RfdXJpXCIsIG9wdGlvbnMucmVkaXJlY3RVUkkgfHwgcmVkaXJlY3RVUkkpO1xuICBkdXJhdGlvbiAmJiB1cmwuc2VhcmNoUGFyYW1zLnNldChcImR1cmF0aW9uXCIsIGR1cmF0aW9uKTtcbiAgZGlzcGxheSAmJiB1cmwuc2VhcmNoUGFyYW1zLnNldChcImRpc3BsYXlcIiwgZGlzcGxheSk7XG4gIGxvZ2luSGludCAmJiB1cmwuc2VhcmNoUGFyYW1zLnNldChcImxvZ2luX2hpbnRcIiwgbG9naW5IaW50KTtcbiAgcHJvbXB0ICYmIHVybC5zZWFyY2hQYXJhbXMuc2V0KFwicHJvbXB0XCIsIHByb21wdCk7XG4gIGhkICYmIHVybC5zZWFyY2hQYXJhbXMuc2V0KFwiaGRcIiwgaGQpO1xuICBhY2Nlc3NUeXBlICYmIHVybC5zZWFyY2hQYXJhbXMuc2V0KFwiYWNjZXNzX3R5cGVcIiwgYWNjZXNzVHlwZSk7XG4gIHJlc3BvbnNlTW9kZSAmJiB1cmwuc2VhcmNoUGFyYW1zLnNldChcInJlc3BvbnNlX21vZGVcIiwgcmVzcG9uc2VNb2RlKTtcbiAgaWYgKGNvZGVWZXJpZmllcikge1xuICAgIGNvbnN0IGNvZGVDaGFsbGVuZ2UgPSBhd2FpdCBnZW5lcmF0ZUNvZGVDaGFsbGVuZ2UoY29kZVZlcmlmaWVyKTtcbiAgICB1cmwuc2VhcmNoUGFyYW1zLnNldChcImNvZGVfY2hhbGxlbmdlX21ldGhvZFwiLCBcIlMyNTZcIik7XG4gICAgdXJsLnNlYXJjaFBhcmFtcy5zZXQoXCJjb2RlX2NoYWxsZW5nZVwiLCBjb2RlQ2hhbGxlbmdlKTtcbiAgfVxuICBpZiAoY2xhaW1zKSB7XG4gICAgY29uc3QgY2xhaW1zT2JqID0gY2xhaW1zLnJlZHVjZShcbiAgICAgIChhY2MsIGNsYWltKSA9PiB7XG4gICAgICAgIGFjY1tjbGFpbV0gPSBudWxsO1xuICAgICAgICByZXR1cm4gYWNjO1xuICAgICAgfSxcbiAgICAgIHt9XG4gICAgKTtcbiAgICB1cmwuc2VhcmNoUGFyYW1zLnNldChcbiAgICAgIFwiY2xhaW1zXCIsXG4gICAgICBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgIGlkX3Rva2VuOiB7IGVtYWlsOiBudWxsLCBlbWFpbF92ZXJpZmllZDogbnVsbCwgLi4uY2xhaW1zT2JqIH1cbiAgICAgIH0pXG4gICAgKTtcbiAgfVxuICBpZiAoYWRkaXRpb25hbFBhcmFtcykge1xuICAgIE9iamVjdC5lbnRyaWVzKGFkZGl0aW9uYWxQYXJhbXMpLmZvckVhY2goKFtrZXksIHZhbHVlXSkgPT4ge1xuICAgICAgdXJsLnNlYXJjaFBhcmFtcy5zZXQoa2V5LCB2YWx1ZSk7XG4gICAgfSk7XG4gIH1cbiAgcmV0dXJuIHVybDtcbn1cblxuZnVuY3Rpb24gY3JlYXRlQXV0aG9yaXphdGlvbkNvZGVSZXF1ZXN0KHtcbiAgY29kZSxcbiAgY29kZVZlcmlmaWVyLFxuICByZWRpcmVjdFVSSSxcbiAgb3B0aW9ucyxcbiAgYXV0aGVudGljYXRpb24sXG4gIGRldmljZUlkLFxuICBoZWFkZXJzLFxuICBhZGRpdGlvbmFsUGFyYW1zID0ge30sXG4gIHJlc291cmNlXG59KSB7XG4gIGNvbnN0IGJvZHkgPSBuZXcgVVJMU2VhcmNoUGFyYW1zKCk7XG4gIGNvbnN0IHJlcXVlc3RIZWFkZXJzID0ge1xuICAgIFwiY29udGVudC10eXBlXCI6IFwiYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkXCIsXG4gICAgYWNjZXB0OiBcImFwcGxpY2F0aW9uL2pzb25cIixcbiAgICBcInVzZXItYWdlbnRcIjogXCJiZXR0ZXItYXV0aFwiLFxuICAgIC4uLmhlYWRlcnNcbiAgfTtcbiAgYm9keS5zZXQoXCJncmFudF90eXBlXCIsIFwiYXV0aG9yaXphdGlvbl9jb2RlXCIpO1xuICBib2R5LnNldChcImNvZGVcIiwgY29kZSk7XG4gIGNvZGVWZXJpZmllciAmJiBib2R5LnNldChcImNvZGVfdmVyaWZpZXJcIiwgY29kZVZlcmlmaWVyKTtcbiAgb3B0aW9ucy5jbGllbnRLZXkgJiYgYm9keS5zZXQoXCJjbGllbnRfa2V5XCIsIG9wdGlvbnMuY2xpZW50S2V5KTtcbiAgZGV2aWNlSWQgJiYgYm9keS5zZXQoXCJkZXZpY2VfaWRcIiwgZGV2aWNlSWQpO1xuICBib2R5LnNldChcInJlZGlyZWN0X3VyaVwiLCBvcHRpb25zLnJlZGlyZWN0VVJJIHx8IHJlZGlyZWN0VVJJKTtcbiAgaWYgKHJlc291cmNlKSB7XG4gICAgaWYgKHR5cGVvZiByZXNvdXJjZSA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgYm9keS5hcHBlbmQoXCJyZXNvdXJjZVwiLCByZXNvdXJjZSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGZvciAoY29uc3QgX3Jlc291cmNlIG9mIHJlc291cmNlKSB7XG4gICAgICAgIGJvZHkuYXBwZW5kKFwicmVzb3VyY2VcIiwgX3Jlc291cmNlKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cbiAgaWYgKGF1dGhlbnRpY2F0aW9uID09PSBcImJhc2ljXCIpIHtcbiAgICBjb25zdCBwcmltYXJ5Q2xpZW50SWQgPSBBcnJheS5pc0FycmF5KG9wdGlvbnMuY2xpZW50SWQpID8gb3B0aW9ucy5jbGllbnRJZFswXSA6IG9wdGlvbnMuY2xpZW50SWQ7XG4gICAgY29uc3QgZW5jb2RlZENyZWRlbnRpYWxzID0gYmFzZTY0LmVuY29kZShcbiAgICAgIGAke3ByaW1hcnlDbGllbnRJZH06JHtvcHRpb25zLmNsaWVudFNlY3JldCA/PyBcIlwifWBcbiAgICApO1xuICAgIHJlcXVlc3RIZWFkZXJzW1wiYXV0aG9yaXphdGlvblwiXSA9IGBCYXNpYyAke2VuY29kZWRDcmVkZW50aWFsc31gO1xuICB9IGVsc2Uge1xuICAgIGNvbnN0IHByaW1hcnlDbGllbnRJZCA9IEFycmF5LmlzQXJyYXkob3B0aW9ucy5jbGllbnRJZCkgPyBvcHRpb25zLmNsaWVudElkWzBdIDogb3B0aW9ucy5jbGllbnRJZDtcbiAgICBib2R5LnNldChcImNsaWVudF9pZFwiLCBwcmltYXJ5Q2xpZW50SWQpO1xuICAgIGlmIChvcHRpb25zLmNsaWVudFNlY3JldCkge1xuICAgICAgYm9keS5zZXQoXCJjbGllbnRfc2VjcmV0XCIsIG9wdGlvbnMuY2xpZW50U2VjcmV0KTtcbiAgICB9XG4gIH1cbiAgZm9yIChjb25zdCBba2V5LCB2YWx1ZV0gb2YgT2JqZWN0LmVudHJpZXMoYWRkaXRpb25hbFBhcmFtcykpIHtcbiAgICBpZiAoIWJvZHkuaGFzKGtleSkpIGJvZHkuYXBwZW5kKGtleSwgdmFsdWUpO1xuICB9XG4gIHJldHVybiB7XG4gICAgYm9keSxcbiAgICBoZWFkZXJzOiByZXF1ZXN0SGVhZGVyc1xuICB9O1xufVxuYXN5bmMgZnVuY3Rpb24gdmFsaWRhdGVBdXRob3JpemF0aW9uQ29kZSh7XG4gIGNvZGUsXG4gIGNvZGVWZXJpZmllcixcbiAgcmVkaXJlY3RVUkksXG4gIG9wdGlvbnMsXG4gIHRva2VuRW5kcG9pbnQsXG4gIGF1dGhlbnRpY2F0aW9uLFxuICBkZXZpY2VJZCxcbiAgaGVhZGVycyxcbiAgYWRkaXRpb25hbFBhcmFtcyA9IHt9LFxuICByZXNvdXJjZVxufSkge1xuICBjb25zdCB7IGJvZHksIGhlYWRlcnM6IHJlcXVlc3RIZWFkZXJzIH0gPSBjcmVhdGVBdXRob3JpemF0aW9uQ29kZVJlcXVlc3Qoe1xuICAgIGNvZGUsXG4gICAgY29kZVZlcmlmaWVyLFxuICAgIHJlZGlyZWN0VVJJLFxuICAgIG9wdGlvbnMsXG4gICAgYXV0aGVudGljYXRpb24sXG4gICAgZGV2aWNlSWQsXG4gICAgaGVhZGVycyxcbiAgICBhZGRpdGlvbmFsUGFyYW1zLFxuICAgIHJlc291cmNlXG4gIH0pO1xuICBjb25zdCB7IGRhdGEsIGVycm9yIH0gPSBhd2FpdCBiZXR0ZXJGZXRjaCh0b2tlbkVuZHBvaW50LCB7XG4gICAgbWV0aG9kOiBcIlBPU1RcIixcbiAgICBib2R5LFxuICAgIGhlYWRlcnM6IHJlcXVlc3RIZWFkZXJzXG4gIH0pO1xuICBpZiAoZXJyb3IpIHtcbiAgICB0aHJvdyBlcnJvcjtcbiAgfVxuICBjb25zdCB0b2tlbnMgPSBnZXRPQXV0aDJUb2tlbnMoZGF0YSk7XG4gIHJldHVybiB0b2tlbnM7XG59XG5hc3luYyBmdW5jdGlvbiB2YWxpZGF0ZVRva2VuKHRva2VuLCBqd2tzRW5kcG9pbnQpIHtcbiAgY29uc3QgeyBkYXRhLCBlcnJvciB9ID0gYXdhaXQgYmV0dGVyRmV0Y2goandrc0VuZHBvaW50LCB7XG4gICAgbWV0aG9kOiBcIkdFVFwiLFxuICAgIGhlYWRlcnM6IHtcbiAgICAgIGFjY2VwdDogXCJhcHBsaWNhdGlvbi9qc29uXCIsXG4gICAgICBcInVzZXItYWdlbnRcIjogXCJiZXR0ZXItYXV0aFwiXG4gICAgfVxuICB9KTtcbiAgaWYgKGVycm9yKSB7XG4gICAgdGhyb3cgZXJyb3I7XG4gIH1cbiAgY29uc3Qga2V5cyA9IGRhdGFbXCJrZXlzXCJdO1xuICBjb25zdCBoZWFkZXIgPSBKU09OLnBhcnNlKGF0b2IodG9rZW4uc3BsaXQoXCIuXCIpWzBdKSk7XG4gIGNvbnN0IGtleSA9IGtleXMuZmluZCgoa2V5MikgPT4ga2V5Mi5raWQgPT09IGhlYWRlci5raWQpO1xuICBpZiAoIWtleSkge1xuICAgIHRocm93IG5ldyBFcnJvcihcIktleSBub3QgZm91bmRcIik7XG4gIH1cbiAgY29uc3QgdmVyaWZpZWQgPSBhd2FpdCBqd3RWZXJpZnkodG9rZW4sIGtleSk7XG4gIHJldHVybiB2ZXJpZmllZDtcbn1cblxuZnVuY3Rpb24gY3JlYXRlUmVmcmVzaEFjY2Vzc1Rva2VuUmVxdWVzdCh7XG4gIHJlZnJlc2hUb2tlbixcbiAgb3B0aW9ucyxcbiAgYXV0aGVudGljYXRpb24sXG4gIGV4dHJhUGFyYW1zLFxuICByZXNvdXJjZVxufSkge1xuICBjb25zdCBib2R5ID0gbmV3IFVSTFNlYXJjaFBhcmFtcygpO1xuICBjb25zdCBoZWFkZXJzID0ge1xuICAgIFwiY29udGVudC10eXBlXCI6IFwiYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkXCIsXG4gICAgYWNjZXB0OiBcImFwcGxpY2F0aW9uL2pzb25cIlxuICB9O1xuICBib2R5LnNldChcImdyYW50X3R5cGVcIiwgXCJyZWZyZXNoX3Rva2VuXCIpO1xuICBib2R5LnNldChcInJlZnJlc2hfdG9rZW5cIiwgcmVmcmVzaFRva2VuKTtcbiAgaWYgKGF1dGhlbnRpY2F0aW9uID09PSBcImJhc2ljXCIpIHtcbiAgICBjb25zdCBwcmltYXJ5Q2xpZW50SWQgPSBBcnJheS5pc0FycmF5KG9wdGlvbnMuY2xpZW50SWQpID8gb3B0aW9ucy5jbGllbnRJZFswXSA6IG9wdGlvbnMuY2xpZW50SWQ7XG4gICAgaWYgKHByaW1hcnlDbGllbnRJZCkge1xuICAgICAgaGVhZGVyc1tcImF1dGhvcml6YXRpb25cIl0gPSBcIkJhc2ljIFwiICsgYmFzZTY0LmVuY29kZShgJHtwcmltYXJ5Q2xpZW50SWR9OiR7b3B0aW9ucy5jbGllbnRTZWNyZXQgPz8gXCJcIn1gKTtcbiAgICB9IGVsc2Uge1xuICAgICAgaGVhZGVyc1tcImF1dGhvcml6YXRpb25cIl0gPSBcIkJhc2ljIFwiICsgYmFzZTY0LmVuY29kZShgOiR7b3B0aW9ucy5jbGllbnRTZWNyZXQgPz8gXCJcIn1gKTtcbiAgICB9XG4gIH0gZWxzZSB7XG4gICAgY29uc3QgcHJpbWFyeUNsaWVudElkID0gQXJyYXkuaXNBcnJheShvcHRpb25zLmNsaWVudElkKSA/IG9wdGlvbnMuY2xpZW50SWRbMF0gOiBvcHRpb25zLmNsaWVudElkO1xuICAgIGJvZHkuc2V0KFwiY2xpZW50X2lkXCIsIHByaW1hcnlDbGllbnRJZCk7XG4gICAgaWYgKG9wdGlvbnMuY2xpZW50U2VjcmV0KSB7XG4gICAgICBib2R5LnNldChcImNsaWVudF9zZWNyZXRcIiwgb3B0aW9ucy5jbGllbnRTZWNyZXQpO1xuICAgIH1cbiAgfVxuICBpZiAocmVzb3VyY2UpIHtcbiAgICBpZiAodHlwZW9mIHJlc291cmNlID09PSBcInN0cmluZ1wiKSB7XG4gICAgICBib2R5LmFwcGVuZChcInJlc291cmNlXCIsIHJlc291cmNlKTtcbiAgICB9IGVsc2Uge1xuICAgICAgZm9yIChjb25zdCBfcmVzb3VyY2Ugb2YgcmVzb3VyY2UpIHtcbiAgICAgICAgYm9keS5hcHBlbmQoXCJyZXNvdXJjZVwiLCBfcmVzb3VyY2UpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuICBpZiAoZXh0cmFQYXJhbXMpIHtcbiAgICBmb3IgKGNvbnN0IFtrZXksIHZhbHVlXSBvZiBPYmplY3QuZW50cmllcyhleHRyYVBhcmFtcykpIHtcbiAgICAgIGJvZHkuc2V0KGtleSwgdmFsdWUpO1xuICAgIH1cbiAgfVxuICByZXR1cm4ge1xuICAgIGJvZHksXG4gICAgaGVhZGVyc1xuICB9O1xufVxuYXN5bmMgZnVuY3Rpb24gcmVmcmVzaEFjY2Vzc1Rva2VuKHtcbiAgcmVmcmVzaFRva2VuLFxuICBvcHRpb25zLFxuICB0b2tlbkVuZHBvaW50LFxuICBhdXRoZW50aWNhdGlvbixcbiAgZXh0cmFQYXJhbXNcbn0pIHtcbiAgY29uc3QgeyBib2R5LCBoZWFkZXJzIH0gPSBjcmVhdGVSZWZyZXNoQWNjZXNzVG9rZW5SZXF1ZXN0KHtcbiAgICByZWZyZXNoVG9rZW4sXG4gICAgb3B0aW9ucyxcbiAgICBhdXRoZW50aWNhdGlvbixcbiAgICBleHRyYVBhcmFtc1xuICB9KTtcbiAgY29uc3QgeyBkYXRhLCBlcnJvciB9ID0gYXdhaXQgYmV0dGVyRmV0Y2godG9rZW5FbmRwb2ludCwge1xuICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgYm9keSxcbiAgICBoZWFkZXJzXG4gIH0pO1xuICBpZiAoZXJyb3IpIHtcbiAgICB0aHJvdyBlcnJvcjtcbiAgfVxuICBjb25zdCB0b2tlbnMgPSB7XG4gICAgYWNjZXNzVG9rZW46IGRhdGEuYWNjZXNzX3Rva2VuLFxuICAgIHJlZnJlc2hUb2tlbjogZGF0YS5yZWZyZXNoX3Rva2VuLFxuICAgIHRva2VuVHlwZTogZGF0YS50b2tlbl90eXBlLFxuICAgIHNjb3BlczogZGF0YS5zY29wZT8uc3BsaXQoXCIgXCIpLFxuICAgIGlkVG9rZW46IGRhdGEuaWRfdG9rZW5cbiAgfTtcbiAgaWYgKGRhdGEuZXhwaXJlc19pbikge1xuICAgIGNvbnN0IG5vdyA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgRGF0ZSgpO1xuICAgIHRva2Vucy5hY2Nlc3NUb2tlbkV4cGlyZXNBdCA9IG5ldyBEYXRlKFxuICAgICAgbm93LmdldFRpbWUoKSArIGRhdGEuZXhwaXJlc19pbiAqIDFlM1xuICAgICk7XG4gIH1cbiAgcmV0dXJuIHRva2Vucztcbn1cblxuZnVuY3Rpb24gY3JlYXRlQ2xpZW50Q3JlZGVudGlhbHNUb2tlblJlcXVlc3Qoe1xuICBvcHRpb25zLFxuICBzY29wZSxcbiAgYXV0aGVudGljYXRpb24sXG4gIHJlc291cmNlXG59KSB7XG4gIGNvbnN0IGJvZHkgPSBuZXcgVVJMU2VhcmNoUGFyYW1zKCk7XG4gIGNvbnN0IGhlYWRlcnMgPSB7XG4gICAgXCJjb250ZW50LXR5cGVcIjogXCJhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWRcIixcbiAgICBhY2NlcHQ6IFwiYXBwbGljYXRpb24vanNvblwiXG4gIH07XG4gIGJvZHkuc2V0KFwiZ3JhbnRfdHlwZVwiLCBcImNsaWVudF9jcmVkZW50aWFsc1wiKTtcbiAgc2NvcGUgJiYgYm9keS5zZXQoXCJzY29wZVwiLCBzY29wZSk7XG4gIGlmIChyZXNvdXJjZSkge1xuICAgIGlmICh0eXBlb2YgcmVzb3VyY2UgPT09IFwic3RyaW5nXCIpIHtcbiAgICAgIGJvZHkuYXBwZW5kKFwicmVzb3VyY2VcIiwgcmVzb3VyY2UpO1xuICAgIH0gZWxzZSB7XG4gICAgICBmb3IgKGNvbnN0IF9yZXNvdXJjZSBvZiByZXNvdXJjZSkge1xuICAgICAgICBib2R5LmFwcGVuZChcInJlc291cmNlXCIsIF9yZXNvdXJjZSk7XG4gICAgICB9XG4gICAgfVxuICB9XG4gIGlmIChhdXRoZW50aWNhdGlvbiA9PT0gXCJiYXNpY1wiKSB7XG4gICAgY29uc3QgcHJpbWFyeUNsaWVudElkID0gQXJyYXkuaXNBcnJheShvcHRpb25zLmNsaWVudElkKSA/IG9wdGlvbnMuY2xpZW50SWRbMF0gOiBvcHRpb25zLmNsaWVudElkO1xuICAgIGNvbnN0IGVuY29kZWRDcmVkZW50aWFscyA9IGJhc2U2NFVybC5lbmNvZGUoXG4gICAgICBgJHtwcmltYXJ5Q2xpZW50SWR9OiR7b3B0aW9ucy5jbGllbnRTZWNyZXR9YFxuICAgICk7XG4gICAgaGVhZGVyc1tcImF1dGhvcml6YXRpb25cIl0gPSBgQmFzaWMgJHtlbmNvZGVkQ3JlZGVudGlhbHN9YDtcbiAgfSBlbHNlIHtcbiAgICBjb25zdCBwcmltYXJ5Q2xpZW50SWQgPSBBcnJheS5pc0FycmF5KG9wdGlvbnMuY2xpZW50SWQpID8gb3B0aW9ucy5jbGllbnRJZFswXSA6IG9wdGlvbnMuY2xpZW50SWQ7XG4gICAgYm9keS5zZXQoXCJjbGllbnRfaWRcIiwgcHJpbWFyeUNsaWVudElkKTtcbiAgICBib2R5LnNldChcImNsaWVudF9zZWNyZXRcIiwgb3B0aW9ucy5jbGllbnRTZWNyZXQpO1xuICB9XG4gIHJldHVybiB7XG4gICAgYm9keSxcbiAgICBoZWFkZXJzXG4gIH07XG59XG5hc3luYyBmdW5jdGlvbiBjbGllbnRDcmVkZW50aWFsc1Rva2VuKHtcbiAgb3B0aW9ucyxcbiAgdG9rZW5FbmRwb2ludCxcbiAgc2NvcGUsXG4gIGF1dGhlbnRpY2F0aW9uLFxuICByZXNvdXJjZVxufSkge1xuICBjb25zdCB7IGJvZHksIGhlYWRlcnMgfSA9IGNyZWF0ZUNsaWVudENyZWRlbnRpYWxzVG9rZW5SZXF1ZXN0KHtcbiAgICBvcHRpb25zLFxuICAgIHNjb3BlLFxuICAgIGF1dGhlbnRpY2F0aW9uLFxuICAgIHJlc291cmNlXG4gIH0pO1xuICBjb25zdCB7IGRhdGEsIGVycm9yIH0gPSBhd2FpdCBiZXR0ZXJGZXRjaCh0b2tlbkVuZHBvaW50LCB7XG4gICAgbWV0aG9kOiBcIlBPU1RcIixcbiAgICBib2R5LFxuICAgIGhlYWRlcnNcbiAgfSk7XG4gIGlmIChlcnJvcikge1xuICAgIHRocm93IGVycm9yO1xuICB9XG4gIGNvbnN0IHRva2VucyA9IHtcbiAgICBhY2Nlc3NUb2tlbjogZGF0YS5hY2Nlc3NfdG9rZW4sXG4gICAgdG9rZW5UeXBlOiBkYXRhLnRva2VuX3R5cGUsXG4gICAgc2NvcGVzOiBkYXRhLnNjb3BlPy5zcGxpdChcIiBcIilcbiAgfTtcbiAgaWYgKGRhdGEuZXhwaXJlc19pbikge1xuICAgIGNvbnN0IG5vdyA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgRGF0ZSgpO1xuICAgIHRva2Vucy5hY2Nlc3NUb2tlbkV4cGlyZXNBdCA9IG5ldyBEYXRlKFxuICAgICAgbm93LmdldFRpbWUoKSArIGRhdGEuZXhwaXJlc19pbiAqIDFlM1xuICAgICk7XG4gIH1cbiAgcmV0dXJuIHRva2Vucztcbn1cblxuZXhwb3J0IHsgY2xpZW50Q3JlZGVudGlhbHNUb2tlbiwgY3JlYXRlQXV0aG9yaXphdGlvbkNvZGVSZXF1ZXN0LCBjcmVhdGVBdXRob3JpemF0aW9uVVJMLCBjcmVhdGVDbGllbnRDcmVkZW50aWFsc1Rva2VuUmVxdWVzdCwgY3JlYXRlUmVmcmVzaEFjY2Vzc1Rva2VuUmVxdWVzdCwgZ2VuZXJhdGVDb2RlQ2hhbGxlbmdlLCBnZXRPQXV0aDJUb2tlbnMsIHJlZnJlc2hBY2Nlc3NUb2tlbiwgdmFsaWRhdGVBdXRob3JpemF0aW9uQ29kZSwgdmFsaWRhdGVUb2tlbiB9O1xuIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6WzBdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(action-browser)/./node_modules/@better-auth/core/dist/oauth2/index.mjs\n");

/***/ }),

/***/ "(action-browser)/./node_modules/@better-auth/core/dist/social-providers/index.mjs":
/*!************************************************************************!*\
  !*** ./node_modules/@better-auth/core/dist/social-providers/index.mjs ***!
  \************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   SocialProviderListEnum: () => (/* binding */ SocialProviderListEnum),\n/* harmony export */   apple: () => (/* binding */ apple),\n/* harmony export */   atlassian: () => (/* binding */ atlassian),\n/* harmony export */   cognito: () => (/* binding */ cognito),\n/* harmony export */   discord: () => (/* binding */ discord),\n/* harmony export */   dropbox: () => (/* binding */ dropbox),\n/* harmony export */   facebook: () => (/* binding */ facebook),\n/* harmony export */   figma: () => (/* binding */ figma),\n/* harmony export */   getApplePublicKey: () => (/* binding */ getApplePublicKey),\n/* harmony export */   getCognitoPublicKey: () => (/* binding */ getCognitoPublicKey),\n/* harmony export */   github: () => (/* binding */ github),\n/* harmony export */   gitlab: () => (/* binding */ gitlab),\n/* harmony export */   google: () => (/* binding */ google),\n/* harmony export */   huggingface: () => (/* binding */ huggingface),\n/* harmony export */   kakao: () => (/* binding */ kakao),\n/* harmony export */   kick: () => (/* binding */ kick),\n/* harmony export */   line: () => (/* binding */ line),\n/* harmony export */   linear: () => (/* binding */ linear),\n/* harmony export */   linkedin: () => (/* binding */ linkedin),\n/* harmony export */   microsoft: () => (/* binding */ microsoft),\n/* harmony export */   naver: () => (/* binding */ naver),\n/* harmony export */   notion: () => (/* binding */ notion),\n/* harmony export */   paypal: () => (/* binding */ paypal),\n/* harmony export */   reddit: () => (/* binding */ reddit),\n/* harmony export */   roblox: () => (/* binding */ roblox),\n/* harmony export */   salesforce: () => (/* binding */ salesforce),\n/* harmony export */   slack: () => (/* binding */ slack),\n/* harmony export */   socialProviderList: () => (/* binding */ socialProviderList),\n/* harmony export */   socialProviders: () => (/* binding */ socialProviders),\n/* harmony export */   spotify: () => (/* binding */ spotify),\n/* harmony export */   tiktok: () => (/* binding */ tiktok),\n/* harmony export */   twitch: () => (/* binding */ twitch),\n/* harmony export */   twitter: () => (/* binding */ twitter),\n/* harmony export */   vk: () => (/* binding */ vk),\n/* harmony export */   zoom: () => (/* binding */ zoom)\n/* harmony export */ });\n/* harmony import */ var zod__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! zod */ \"(action-browser)/./node_modules/zod/v4/classic/external.js\");\n/* harmony import */ var _better_fetch_fetch__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @better-fetch/fetch */ \"(action-browser)/./node_modules/@better-fetch/fetch/dist/index.js\");\n/* harmony import */ var better_call__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! better-call */ \"(action-browser)/./node_modules/better-call/dist/index.js\");\n/* harmony import */ var jose__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! jose */ \"(action-browser)/./node_modules/jose/dist/webapi/util/decode_protected_header.js\");\n/* harmony import */ var jose__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! jose */ \"(action-browser)/./node_modules/jose/dist/webapi/jwt/verify.js\");\n/* harmony import */ var jose__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! jose */ \"(action-browser)/./node_modules/jose/dist/webapi/util/decode_jwt.js\");\n/* harmony import */ var jose__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! jose */ \"(action-browser)/./node_modules/jose/dist/webapi/key/import.js\");\n/* harmony import */ var jose__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! jose */ \"(action-browser)/./node_modules/jose/dist/webapi/jwks/remote.js\");\n/* harmony import */ var _better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @better-auth/core/oauth2 */ \"(action-browser)/./node_modules/@better-auth/core/dist/oauth2/index.mjs\");\n/* harmony import */ var _error_index_mjs__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../error/index.mjs */ \"(action-browser)/./node_modules/@better-auth/core/dist/error/index.mjs\");\n/* harmony import */ var _better_auth_core_env__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @better-auth/core/env */ \"(action-browser)/./node_modules/@better-auth/core/dist/env/index.mjs\");\n/* harmony import */ var _better_auth_utils_base64__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @better-auth/utils/base64 */ \"(action-browser)/./node_modules/@better-auth/utils/dist/base64.mjs\");\n/* harmony import */ var _better_auth_core_utils__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @better-auth/core/utils */ \"(action-browser)/./node_modules/@better-auth/core/dist/utils/index.mjs\");\n\n\n\n\n\n\n\n\n\n\nconst apple = (options) => {\n  const tokenEndpoint = \"https://appleid.apple.com/auth/token\";\n  return {\n    id: \"apple\",\n    name: \"Apple\",\n    async createAuthorizationURL({ state, scopes, redirectURI }) {\n      const _scope = options.disableDefaultScope ? [] : [\"email\", \"name\"];\n      options.scope && _scope.push(...options.scope);\n      scopes && _scope.push(...scopes);\n      const url = await (0,_better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.createAuthorizationURL)({\n        id: \"apple\",\n        options,\n        authorizationEndpoint: \"https://appleid.apple.com/auth/authorize\",\n        scopes: _scope,\n        state,\n        redirectURI,\n        responseMode: \"form_post\",\n        responseType: \"code id_token\"\n      });\n      return url;\n    },\n    validateAuthorizationCode: async ({ code, codeVerifier, redirectURI }) => {\n      return (0,_better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.validateAuthorizationCode)({\n        code,\n        codeVerifier,\n        redirectURI,\n        options,\n        tokenEndpoint\n      });\n    },\n    async verifyIdToken(token, nonce) {\n      if (options.disableIdTokenSignIn) {\n        return false;\n      }\n      if (options.verifyIdToken) {\n        return options.verifyIdToken(token, nonce);\n      }\n      const decodedHeader = (0,jose__WEBPACK_IMPORTED_MODULE_7__.decodeProtectedHeader)(token);\n      const { kid, alg: jwtAlg } = decodedHeader;\n      if (!kid || !jwtAlg) return false;\n      const publicKey = await getApplePublicKey(kid);\n      const { payload: jwtClaims } = await (0,jose__WEBPACK_IMPORTED_MODULE_8__.jwtVerify)(token, publicKey, {\n        algorithms: [jwtAlg],\n        issuer: \"https://appleid.apple.com\",\n        audience: options.audience && options.audience.length ? options.audience : options.appBundleIdentifier ? options.appBundleIdentifier : options.clientId,\n        maxTokenAge: \"1h\"\n      });\n      [\"email_verified\", \"is_private_email\"].forEach((field) => {\n        if (jwtClaims[field] !== void 0) {\n          jwtClaims[field] = Boolean(jwtClaims[field]);\n        }\n      });\n      if (nonce && jwtClaims.nonce !== nonce) {\n        return false;\n      }\n      return !!jwtClaims;\n    },\n    refreshAccessToken: options.refreshAccessToken ? options.refreshAccessToken : async (refreshToken) => {\n      return (0,_better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.refreshAccessToken)({\n        refreshToken,\n        options: {\n          clientId: options.clientId,\n          clientKey: options.clientKey,\n          clientSecret: options.clientSecret\n        },\n        tokenEndpoint: \"https://appleid.apple.com/auth/token\"\n      });\n    },\n    async getUserInfo(token) {\n      if (options.getUserInfo) {\n        return options.getUserInfo(token);\n      }\n      if (!token.idToken) {\n        return null;\n      }\n      const profile = (0,jose__WEBPACK_IMPORTED_MODULE_9__.decodeJwt)(token.idToken);\n      if (!profile) {\n        return null;\n      }\n      const name = token.user ? `${token.user.name?.firstName} ${token.user.name?.lastName}` : profile.name || profile.email;\n      const emailVerified = typeof profile.email_verified === \"boolean\" ? profile.email_verified : profile.email_verified === \"true\";\n      const enrichedProfile = {\n        ...profile,\n        name\n      };\n      const userMap = await options.mapProfileToUser?.(enrichedProfile);\n      return {\n        user: {\n          id: profile.sub,\n          name: enrichedProfile.name,\n          emailVerified,\n          email: profile.email,\n          ...userMap\n        },\n        data: enrichedProfile\n      };\n    },\n    options\n  };\n};\nconst getApplePublicKey = async (kid) => {\n  const APPLE_BASE_URL = \"https://appleid.apple.com\";\n  const JWKS_APPLE_URI = \"/auth/keys\";\n  const { data } = await (0,_better_fetch_fetch__WEBPACK_IMPORTED_MODULE_0__.betterFetch)(`${APPLE_BASE_URL}${JWKS_APPLE_URI}`);\n  if (!data?.keys) {\n    throw new better_call__WEBPACK_IMPORTED_MODULE_1__.APIError(\"BAD_REQUEST\", {\n      message: \"Keys not found\"\n    });\n  }\n  const jwk = data.keys.find((key) => key.kid === kid);\n  if (!jwk) {\n    throw new Error(`JWK with kid ${kid} not found`);\n  }\n  return await (0,jose__WEBPACK_IMPORTED_MODULE_10__.importJWK)(jwk, jwk.alg);\n};\n\nconst atlassian = (options) => {\n  return {\n    id: \"atlassian\",\n    name: \"Atlassian\",\n    async createAuthorizationURL({ state, scopes, codeVerifier, redirectURI }) {\n      if (!options.clientId || !options.clientSecret) {\n        _better_auth_core_env__WEBPACK_IMPORTED_MODULE_4__.logger.error(\"Client Id and Secret are required for Atlassian\");\n        throw new _error_index_mjs__WEBPACK_IMPORTED_MODULE_3__.BetterAuthError(\"CLIENT_ID_AND_SECRET_REQUIRED\");\n      }\n      if (!codeVerifier) {\n        throw new _error_index_mjs__WEBPACK_IMPORTED_MODULE_3__.BetterAuthError(\"codeVerifier is required for Atlassian\");\n      }\n      const _scopes = options.disableDefaultScope ? [] : [\"read:jira-user\", \"offline_access\"];\n      options.scope && _scopes.push(...options.scope);\n      scopes && _scopes.push(...scopes);\n      return (0,_better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.createAuthorizationURL)({\n        id: \"atlassian\",\n        options,\n        authorizationEndpoint: \"https://auth.atlassian.com/authorize\",\n        scopes: _scopes,\n        state,\n        codeVerifier,\n        redirectURI,\n        additionalParams: {\n          audience: \"api.atlassian.com\"\n        },\n        prompt: options.prompt\n      });\n    },\n    validateAuthorizationCode: async ({ code, codeVerifier, redirectURI }) => {\n      return (0,_better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.validateAuthorizationCode)({\n        code,\n        codeVerifier,\n        redirectURI,\n        options,\n        tokenEndpoint: \"https://auth.atlassian.com/oauth/token\"\n      });\n    },\n    refreshAccessToken: options.refreshAccessToken ? options.refreshAccessToken : async (refreshToken) => {\n      return (0,_better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.refreshAccessToken)({\n        refreshToken,\n        options: {\n          clientId: options.clientId,\n          clientSecret: options.clientSecret\n        },\n        tokenEndpoint: \"https://auth.atlassian.com/oauth/token\"\n      });\n    },\n    async getUserInfo(token) {\n      if (options.getUserInfo) {\n        return options.getUserInfo(token);\n      }\n      if (!token.accessToken) {\n        return null;\n      }\n      try {\n        const { data: profile } = await (0,_better_fetch_fetch__WEBPACK_IMPORTED_MODULE_0__.betterFetch)(\"https://api.atlassian.com/me\", {\n          headers: { Authorization: `Bearer ${token.accessToken}` }\n        });\n        if (!profile) return null;\n        const userMap = await options.mapProfileToUser?.(profile);\n        return {\n          user: {\n            id: profile.account_id,\n            name: profile.name,\n            email: profile.email,\n            image: profile.picture,\n            emailVerified: false,\n            ...userMap\n          },\n          data: profile\n        };\n      } catch (error) {\n        _better_auth_core_env__WEBPACK_IMPORTED_MODULE_4__.logger.error(\"Failed to fetch user info from Figma:\", error);\n        return null;\n      }\n    },\n    options\n  };\n};\n\nconst cognito = (options) => {\n  if (!options.domain || !options.region || !options.userPoolId) {\n    _better_auth_core_env__WEBPACK_IMPORTED_MODULE_4__.logger.error(\n      \"Domain, region and userPoolId are required for Amazon Cognito. Make sure to provide them in the options.\"\n    );\n    throw new _error_index_mjs__WEBPACK_IMPORTED_MODULE_3__.BetterAuthError(\"DOMAIN_AND_REGION_REQUIRED\");\n  }\n  const cleanDomain = options.domain.replace(/^https?:\\/\\//, \"\");\n  const authorizationEndpoint = `https://${cleanDomain}/oauth2/authorize`;\n  const tokenEndpoint = `https://${cleanDomain}/oauth2/token`;\n  const userInfoEndpoint = `https://${cleanDomain}/oauth2/userinfo`;\n  return {\n    id: \"cognito\",\n    name: \"Cognito\",\n    async createAuthorizationURL({ state, scopes, codeVerifier, redirectURI }) {\n      if (!options.clientId) {\n        _better_auth_core_env__WEBPACK_IMPORTED_MODULE_4__.logger.error(\n          \"ClientId is required for Amazon Cognito. Make sure to provide them in the options.\"\n        );\n        throw new _error_index_mjs__WEBPACK_IMPORTED_MODULE_3__.BetterAuthError(\"CLIENT_ID_AND_SECRET_REQUIRED\");\n      }\n      if (options.requireClientSecret && !options.clientSecret) {\n        _better_auth_core_env__WEBPACK_IMPORTED_MODULE_4__.logger.error(\n          \"Client Secret is required when requireClientSecret is true. Make sure to provide it in the options.\"\n        );\n        throw new _error_index_mjs__WEBPACK_IMPORTED_MODULE_3__.BetterAuthError(\"CLIENT_SECRET_REQUIRED\");\n      }\n      const _scopes = options.disableDefaultScope ? [] : [\"openid\", \"profile\", \"email\"];\n      options.scope && _scopes.push(...options.scope);\n      scopes && _scopes.push(...scopes);\n      const url = await (0,_better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.createAuthorizationURL)({\n        id: \"cognito\",\n        options: {\n          ...options\n        },\n        authorizationEndpoint,\n        scopes: _scopes,\n        state,\n        codeVerifier,\n        redirectURI,\n        prompt: options.prompt\n      });\n      return url;\n    },\n    validateAuthorizationCode: async ({ code, codeVerifier, redirectURI }) => {\n      return (0,_better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.validateAuthorizationCode)({\n        code,\n        codeVerifier,\n        redirectURI,\n        options,\n        tokenEndpoint\n      });\n    },\n    refreshAccessToken: options.refreshAccessToken ? options.refreshAccessToken : async (refreshToken) => {\n      return (0,_better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.refreshAccessToken)({\n        refreshToken,\n        options: {\n          clientId: options.clientId,\n          clientKey: options.clientKey,\n          clientSecret: options.clientSecret\n        },\n        tokenEndpoint\n      });\n    },\n    async verifyIdToken(token, nonce) {\n      if (options.disableIdTokenSignIn) {\n        return false;\n      }\n      if (options.verifyIdToken) {\n        return options.verifyIdToken(token, nonce);\n      }\n      try {\n        const decodedHeader = (0,jose__WEBPACK_IMPORTED_MODULE_7__.decodeProtectedHeader)(token);\n        const { kid, alg: jwtAlg } = decodedHeader;\n        if (!kid || !jwtAlg) return false;\n        const publicKey = await getCognitoPublicKey(\n          kid,\n          options.region,\n          options.userPoolId\n        );\n        const expectedIssuer = `https://cognito-idp.${options.region}.amazonaws.com/${options.userPoolId}`;\n        const { payload: jwtClaims } = await (0,jose__WEBPACK_IMPORTED_MODULE_8__.jwtVerify)(token, publicKey, {\n          algorithms: [jwtAlg],\n          issuer: expectedIssuer,\n          audience: options.clientId,\n          maxTokenAge: \"1h\"\n        });\n        if (nonce && jwtClaims.nonce !== nonce) {\n          return false;\n        }\n        return true;\n      } catch (error) {\n        _better_auth_core_env__WEBPACK_IMPORTED_MODULE_4__.logger.error(\"Failed to verify ID token:\", error);\n        return false;\n      }\n    },\n    async getUserInfo(token) {\n      if (options.getUserInfo) {\n        return options.getUserInfo(token);\n      }\n      if (token.idToken) {\n        try {\n          const profile = (0,jose__WEBPACK_IMPORTED_MODULE_9__.decodeJwt)(token.idToken);\n          if (!profile) {\n            return null;\n          }\n          const name = profile.name || profile.given_name || profile.username || profile.email;\n          const enrichedProfile = {\n            ...profile,\n            name\n          };\n          const userMap = await options.mapProfileToUser?.(enrichedProfile);\n          return {\n            user: {\n              id: profile.sub,\n              name: enrichedProfile.name,\n              email: profile.email,\n              image: profile.picture,\n              emailVerified: profile.email_verified,\n              ...userMap\n            },\n            data: enrichedProfile\n          };\n        } catch (error) {\n          _better_auth_core_env__WEBPACK_IMPORTED_MODULE_4__.logger.error(\"Failed to decode ID token:\", error);\n        }\n      }\n      if (token.accessToken) {\n        try {\n          const { data: userInfo } = await (0,_better_fetch_fetch__WEBPACK_IMPORTED_MODULE_0__.betterFetch)(\n            userInfoEndpoint,\n            {\n              headers: {\n                Authorization: `Bearer ${token.accessToken}`\n              }\n            }\n          );\n          if (userInfo) {\n            const userMap = await options.mapProfileToUser?.(userInfo);\n            return {\n              user: {\n                id: userInfo.sub,\n                name: userInfo.name || userInfo.given_name || userInfo.username,\n                email: userInfo.email,\n                image: userInfo.picture,\n                emailVerified: userInfo.email_verified,\n                ...userMap\n              },\n              data: userInfo\n            };\n          }\n        } catch (error) {\n          _better_auth_core_env__WEBPACK_IMPORTED_MODULE_4__.logger.error(\"Failed to fetch user info from Cognito:\", error);\n        }\n      }\n      return null;\n    },\n    options\n  };\n};\nconst getCognitoPublicKey = async (kid, region, userPoolId) => {\n  const COGNITO_JWKS_URI = `https://cognito-idp.${region}.amazonaws.com/${userPoolId}/.well-known/jwks.json`;\n  try {\n    const { data } = await (0,_better_fetch_fetch__WEBPACK_IMPORTED_MODULE_0__.betterFetch)(COGNITO_JWKS_URI);\n    if (!data?.keys) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_1__.APIError(\"BAD_REQUEST\", {\n        message: \"Keys not found\"\n      });\n    }\n    const jwk = data.keys.find((key) => key.kid === kid);\n    if (!jwk) {\n      throw new Error(`JWK with kid ${kid} not found`);\n    }\n    return await (0,jose__WEBPACK_IMPORTED_MODULE_10__.importJWK)(jwk, jwk.alg);\n  } catch (error) {\n    _better_auth_core_env__WEBPACK_IMPORTED_MODULE_4__.logger.error(\"Failed to fetch Cognito public key:\", error);\n    throw error;\n  }\n};\n\nconst discord = (options) => {\n  return {\n    id: \"discord\",\n    name: \"Discord\",\n    createAuthorizationURL({ state, scopes, redirectURI }) {\n      const _scopes = options.disableDefaultScope ? [] : [\"identify\", \"email\"];\n      scopes && _scopes.push(...scopes);\n      options.scope && _scopes.push(...options.scope);\n      const hasBotScope = _scopes.includes(\"bot\");\n      const permissionsParam = hasBotScope && options.permissions !== void 0 ? `&permissions=${options.permissions}` : \"\";\n      return new URL(\n        `https://discord.com/api/oauth2/authorize?scope=${_scopes.join(\n          \"+\"\n        )}&response_type=code&client_id=${options.clientId}&redirect_uri=${encodeURIComponent(\n          options.redirectURI || redirectURI\n        )}&state=${state}&prompt=${options.prompt || \"none\"}${permissionsParam}`\n      );\n    },\n    validateAuthorizationCode: async ({ code, redirectURI }) => {\n      return (0,_better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.validateAuthorizationCode)({\n        code,\n        redirectURI,\n        options,\n        tokenEndpoint: \"https://discord.com/api/oauth2/token\"\n      });\n    },\n    refreshAccessToken: options.refreshAccessToken ? options.refreshAccessToken : async (refreshToken) => {\n      return (0,_better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.refreshAccessToken)({\n        refreshToken,\n        options: {\n          clientId: options.clientId,\n          clientKey: options.clientKey,\n          clientSecret: options.clientSecret\n        },\n        tokenEndpoint: \"https://discord.com/api/oauth2/token\"\n      });\n    },\n    async getUserInfo(token) {\n      if (options.getUserInfo) {\n        return options.getUserInfo(token);\n      }\n      const { data: profile, error } = await (0,_better_fetch_fetch__WEBPACK_IMPORTED_MODULE_0__.betterFetch)(\n        \"https://discord.com/api/users/@me\",\n        {\n          headers: {\n            authorization: `Bearer ${token.accessToken}`\n          }\n        }\n      );\n      if (error) {\n        return null;\n      }\n      if (profile.avatar === null) {\n        const defaultAvatarNumber = profile.discriminator === \"0\" ? Number(BigInt(profile.id) >> BigInt(22)) % 6 : parseInt(profile.discriminator) % 5;\n        profile.image_url = `https://cdn.discordapp.com/embed/avatars/${defaultAvatarNumber}.png`;\n      } else {\n        const format = profile.avatar.startsWith(\"a_\") ? \"gif\" : \"png\";\n        profile.image_url = `https://cdn.discordapp.com/avatars/${profile.id}/${profile.avatar}.${format}`;\n      }\n      const userMap = await options.mapProfileToUser?.(profile);\n      return {\n        user: {\n          id: profile.id,\n          name: profile.global_name || profile.username || \"\",\n          email: profile.email,\n          emailVerified: profile.verified,\n          image: profile.image_url,\n          ...userMap\n        },\n        data: profile\n      };\n    },\n    options\n  };\n};\n\nconst facebook = (options) => {\n  return {\n    id: \"facebook\",\n    name: \"Facebook\",\n    async createAuthorizationURL({ state, scopes, redirectURI, loginHint }) {\n      const _scopes = options.disableDefaultScope ? [] : [\"email\", \"public_profile\"];\n      options.scope && _scopes.push(...options.scope);\n      scopes && _scopes.push(...scopes);\n      return await (0,_better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.createAuthorizationURL)({\n        id: \"facebook\",\n        options,\n        authorizationEndpoint: \"https://www.facebook.com/v21.0/dialog/oauth\",\n        scopes: _scopes,\n        state,\n        redirectURI,\n        loginHint,\n        additionalParams: options.configId ? {\n          config_id: options.configId\n        } : {}\n      });\n    },\n    validateAuthorizationCode: async ({ code, redirectURI }) => {\n      return (0,_better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.validateAuthorizationCode)({\n        code,\n        redirectURI,\n        options,\n        tokenEndpoint: \"https://graph.facebook.com/oauth/access_token\"\n      });\n    },\n    async verifyIdToken(token, nonce) {\n      if (options.disableIdTokenSignIn) {\n        return false;\n      }\n      if (options.verifyIdToken) {\n        return options.verifyIdToken(token, nonce);\n      }\n      if (token.split(\".\").length === 3) {\n        try {\n          const { payload: jwtClaims } = await (0,jose__WEBPACK_IMPORTED_MODULE_8__.jwtVerify)(\n            token,\n            (0,jose__WEBPACK_IMPORTED_MODULE_11__.createRemoteJWKSet)(\n              // https://developers.facebook.com/docs/facebook-login/limited-login/token/#jwks\n              new URL(\n                \"https://limited.facebook.com/.well-known/oauth/openid/jwks/\"\n              )\n            ),\n            {\n              algorithms: [\"RS256\"],\n              audience: options.clientId,\n              issuer: \"https://www.facebook.com\"\n            }\n          );\n          if (nonce && jwtClaims.nonce !== nonce) {\n            return false;\n          }\n          return !!jwtClaims;\n        } catch (error) {\n          return false;\n        }\n      }\n      return true;\n    },\n    refreshAccessToken: options.refreshAccessToken ? options.refreshAccessToken : async (refreshToken) => {\n      return (0,_better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.refreshAccessToken)({\n        refreshToken,\n        options: {\n          clientId: options.clientId,\n          clientKey: options.clientKey,\n          clientSecret: options.clientSecret\n        },\n        tokenEndpoint: \"https://graph.facebook.com/v18.0/oauth/access_token\"\n      });\n    },\n    async getUserInfo(token) {\n      if (options.getUserInfo) {\n        return options.getUserInfo(token);\n      }\n      if (token.idToken && token.idToken.split(\".\").length === 3) {\n        const profile2 = (0,jose__WEBPACK_IMPORTED_MODULE_9__.decodeJwt)(token.idToken);\n        const user = {\n          id: profile2.sub,\n          name: profile2.name,\n          email: profile2.email,\n          picture: {\n            data: {\n              url: profile2.picture,\n              height: 100,\n              width: 100,\n              is_silhouette: false\n            }\n          }\n        };\n        const userMap2 = await options.mapProfileToUser?.({\n          ...user,\n          email_verified: true\n        });\n        return {\n          user: {\n            ...user,\n            emailVerified: true,\n            ...userMap2\n          },\n          data: profile2\n        };\n      }\n      const fields = [\n        \"id\",\n        \"name\",\n        \"email\",\n        \"picture\",\n        ...options?.fields || []\n      ];\n      const { data: profile, error } = await (0,_better_fetch_fetch__WEBPACK_IMPORTED_MODULE_0__.betterFetch)(\n        \"https://graph.facebook.com/me?fields=\" + fields.join(\",\"),\n        {\n          auth: {\n            type: \"Bearer\",\n            token: token.accessToken\n          }\n        }\n      );\n      if (error) {\n        return null;\n      }\n      const userMap = await options.mapProfileToUser?.(profile);\n      return {\n        user: {\n          id: profile.id,\n          name: profile.name,\n          email: profile.email,\n          image: profile.picture.data.url,\n          emailVerified: profile.email_verified,\n          ...userMap\n        },\n        data: profile\n      };\n    },\n    options\n  };\n};\n\nconst figma = (options) => {\n  return {\n    id: \"figma\",\n    name: \"Figma\",\n    async createAuthorizationURL({ state, scopes, codeVerifier, redirectURI }) {\n      if (!options.clientId || !options.clientSecret) {\n        _better_auth_core_env__WEBPACK_IMPORTED_MODULE_4__.logger.error(\n          \"Client Id and Client Secret are required for Figma. Make sure to provide them in the options.\"\n        );\n        throw new _error_index_mjs__WEBPACK_IMPORTED_MODULE_3__.BetterAuthError(\"CLIENT_ID_AND_SECRET_REQUIRED\");\n      }\n      if (!codeVerifier) {\n        throw new _error_index_mjs__WEBPACK_IMPORTED_MODULE_3__.BetterAuthError(\"codeVerifier is required for Figma\");\n      }\n      const _scopes = options.disableDefaultScope ? [] : [\"file_read\"];\n      options.scope && _scopes.push(...options.scope);\n      scopes && _scopes.push(...scopes);\n      const url = await (0,_better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.createAuthorizationURL)({\n        id: \"figma\",\n        options,\n        authorizationEndpoint: \"https://www.figma.com/oauth\",\n        scopes: _scopes,\n        state,\n        codeVerifier,\n        redirectURI\n      });\n      return url;\n    },\n    validateAuthorizationCode: async ({ code, codeVerifier, redirectURI }) => {\n      return (0,_better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.validateAuthorizationCode)({\n        code,\n        codeVerifier,\n        redirectURI,\n        options,\n        tokenEndpoint: \"https://www.figma.com/api/oauth/token\"\n      });\n    },\n    refreshAccessToken: options.refreshAccessToken ? options.refreshAccessToken : async (refreshToken) => {\n      return (0,_better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.refreshAccessToken)({\n        refreshToken,\n        options: {\n          clientId: options.clientId,\n          clientKey: options.clientKey,\n          clientSecret: options.clientSecret\n        },\n        tokenEndpoint: \"https://www.figma.com/api/oauth/token\"\n      });\n    },\n    async getUserInfo(token) {\n      if (options.getUserInfo) {\n        return options.getUserInfo(token);\n      }\n      try {\n        const { data: profile } = await (0,_better_fetch_fetch__WEBPACK_IMPORTED_MODULE_0__.betterFetch)(\n          \"https://api.figma.com/v1/me\",\n          {\n            headers: {\n              Authorization: `Bearer ${token.accessToken}`\n            }\n          }\n        );\n        if (!profile) {\n          _better_auth_core_env__WEBPACK_IMPORTED_MODULE_4__.logger.error(\"Failed to fetch user from Figma\");\n          return null;\n        }\n        const userMap = await options.mapProfileToUser?.(profile);\n        return {\n          user: {\n            id: profile.id,\n            name: profile.handle,\n            email: profile.email,\n            image: profile.img_url,\n            emailVerified: !!profile.email,\n            ...userMap\n          },\n          data: profile\n        };\n      } catch (error) {\n        _better_auth_core_env__WEBPACK_IMPORTED_MODULE_4__.logger.error(\"Failed to fetch user info from Figma:\", error);\n        return null;\n      }\n    },\n    options\n  };\n};\n\nconst github = (options) => {\n  const tokenEndpoint = \"https://github.com/login/oauth/access_token\";\n  return {\n    id: \"github\",\n    name: \"GitHub\",\n    createAuthorizationURL({ state, scopes, loginHint, redirectURI }) {\n      const _scopes = options.disableDefaultScope ? [] : [\"read:user\", \"user:email\"];\n      options.scope && _scopes.push(...options.scope);\n      scopes && _scopes.push(...scopes);\n      return (0,_better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.createAuthorizationURL)({\n        id: \"github\",\n        options,\n        authorizationEndpoint: \"https://github.com/login/oauth/authorize\",\n        scopes: _scopes,\n        state,\n        redirectURI,\n        loginHint,\n        prompt: options.prompt\n      });\n    },\n    validateAuthorizationCode: async ({ code, redirectURI }) => {\n      return (0,_better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.validateAuthorizationCode)({\n        code,\n        redirectURI,\n        options,\n        tokenEndpoint\n      });\n    },\n    refreshAccessToken: options.refreshAccessToken ? options.refreshAccessToken : async (refreshToken) => {\n      return (0,_better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.refreshAccessToken)({\n        refreshToken,\n        options: {\n          clientId: options.clientId,\n          clientKey: options.clientKey,\n          clientSecret: options.clientSecret\n        },\n        tokenEndpoint: \"https://github.com/login/oauth/access_token\"\n      });\n    },\n    async getUserInfo(token) {\n      if (options.getUserInfo) {\n        return options.getUserInfo(token);\n      }\n      const { data: profile, error } = await (0,_better_fetch_fetch__WEBPACK_IMPORTED_MODULE_0__.betterFetch)(\n        \"https://api.github.com/user\",\n        {\n          headers: {\n            \"User-Agent\": \"better-auth\",\n            authorization: `Bearer ${token.accessToken}`\n          }\n        }\n      );\n      if (error) {\n        return null;\n      }\n      const { data: emails } = await (0,_better_fetch_fetch__WEBPACK_IMPORTED_MODULE_0__.betterFetch)(\"https://api.github.com/user/emails\", {\n        headers: {\n          Authorization: `Bearer ${token.accessToken}`,\n          \"User-Agent\": \"better-auth\"\n        }\n      });\n      if (!profile.email && emails) {\n        profile.email = (emails.find((e) => e.primary) ?? emails[0])?.email;\n      }\n      const emailVerified = emails?.find((e) => e.email === profile.email)?.verified ?? false;\n      const userMap = await options.mapProfileToUser?.(profile);\n      return {\n        user: {\n          id: profile.id,\n          name: profile.name || profile.login,\n          email: profile.email,\n          image: profile.avatar_url,\n          emailVerified,\n          ...userMap\n        },\n        data: profile\n      };\n    },\n    options\n  };\n};\n\nconst google = (options) => {\n  return {\n    id: \"google\",\n    name: \"Google\",\n    async createAuthorizationURL({\n      state,\n      scopes,\n      codeVerifier,\n      redirectURI,\n      loginHint,\n      display\n    }) {\n      if (!options.clientId || !options.clientSecret) {\n        _better_auth_core_env__WEBPACK_IMPORTED_MODULE_4__.logger.error(\n          \"Client Id and Client Secret is required for Google. Make sure to provide them in the options.\"\n        );\n        throw new _error_index_mjs__WEBPACK_IMPORTED_MODULE_3__.BetterAuthError(\"CLIENT_ID_AND_SECRET_REQUIRED\");\n      }\n      if (!codeVerifier) {\n        throw new _error_index_mjs__WEBPACK_IMPORTED_MODULE_3__.BetterAuthError(\"codeVerifier is required for Google\");\n      }\n      const _scopes = options.disableDefaultScope ? [] : [\"email\", \"profile\", \"openid\"];\n      options.scope && _scopes.push(...options.scope);\n      scopes && _scopes.push(...scopes);\n      const url = await (0,_better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.createAuthorizationURL)({\n        id: \"google\",\n        options,\n        authorizationEndpoint: \"https://accounts.google.com/o/oauth2/auth\",\n        scopes: _scopes,\n        state,\n        codeVerifier,\n        redirectURI,\n        prompt: options.prompt,\n        accessType: options.accessType,\n        display: display || options.display,\n        loginHint,\n        hd: options.hd,\n        additionalParams: {\n          include_granted_scopes: \"true\"\n        }\n      });\n      return url;\n    },\n    validateAuthorizationCode: async ({ code, codeVerifier, redirectURI }) => {\n      return (0,_better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.validateAuthorizationCode)({\n        code,\n        codeVerifier,\n        redirectURI,\n        options,\n        tokenEndpoint: \"https://oauth2.googleapis.com/token\"\n      });\n    },\n    refreshAccessToken: options.refreshAccessToken ? options.refreshAccessToken : async (refreshToken) => {\n      return (0,_better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.refreshAccessToken)({\n        refreshToken,\n        options: {\n          clientId: options.clientId,\n          clientKey: options.clientKey,\n          clientSecret: options.clientSecret\n        },\n        tokenEndpoint: \"https://www.googleapis.com/oauth2/v4/token\"\n      });\n    },\n    async verifyIdToken(token, nonce) {\n      if (options.disableIdTokenSignIn) {\n        return false;\n      }\n      if (options.verifyIdToken) {\n        return options.verifyIdToken(token, nonce);\n      }\n      const googlePublicKeyUrl = `https://www.googleapis.com/oauth2/v3/tokeninfo?id_token=${token}`;\n      const { data: tokenInfo } = await (0,_better_fetch_fetch__WEBPACK_IMPORTED_MODULE_0__.betterFetch)(googlePublicKeyUrl);\n      if (!tokenInfo) {\n        return false;\n      }\n      const isValid = tokenInfo.aud === options.clientId && (tokenInfo.iss === \"https://accounts.google.com\" || tokenInfo.iss === \"accounts.google.com\");\n      return isValid;\n    },\n    async getUserInfo(token) {\n      if (options.getUserInfo) {\n        return options.getUserInfo(token);\n      }\n      if (!token.idToken) {\n        return null;\n      }\n      const user = (0,jose__WEBPACK_IMPORTED_MODULE_9__.decodeJwt)(token.idToken);\n      const userMap = await options.mapProfileToUser?.(user);\n      return {\n        user: {\n          id: user.sub,\n          name: user.name,\n          email: user.email,\n          image: user.picture,\n          emailVerified: user.email_verified,\n          ...userMap\n        },\n        data: user\n      };\n    },\n    options\n  };\n};\n\nconst kick = (options) => {\n  return {\n    id: \"kick\",\n    name: \"Kick\",\n    createAuthorizationURL({ state, scopes, redirectURI, codeVerifier }) {\n      const _scopes = options.disableDefaultScope ? [] : [\"user:read\"];\n      options.scope && _scopes.push(...options.scope);\n      scopes && _scopes.push(...scopes);\n      return (0,_better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.createAuthorizationURL)({\n        id: \"kick\",\n        redirectURI,\n        options,\n        authorizationEndpoint: \"https://id.kick.com/oauth/authorize\",\n        scopes: _scopes,\n        codeVerifier,\n        state\n      });\n    },\n    async validateAuthorizationCode({ code, redirectURI, codeVerifier }) {\n      return (0,_better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.validateAuthorizationCode)({\n        code,\n        redirectURI,\n        options,\n        tokenEndpoint: \"https://id.kick.com/oauth/token\",\n        codeVerifier\n      });\n    },\n    async getUserInfo(token) {\n      if (options.getUserInfo) {\n        return options.getUserInfo(token);\n      }\n      const { data, error } = await (0,_better_fetch_fetch__WEBPACK_IMPORTED_MODULE_0__.betterFetch)(\"https://api.kick.com/public/v1/users\", {\n        method: \"GET\",\n        headers: {\n          Authorization: `Bearer ${token.accessToken}`\n        }\n      });\n      if (error) {\n        return null;\n      }\n      const profile = data.data[0];\n      const userMap = await options.mapProfileToUser?.(profile);\n      return {\n        user: {\n          id: profile.user_id,\n          name: profile.name,\n          email: profile.email,\n          image: profile.profile_picture,\n          emailVerified: true,\n          ...userMap\n        },\n        data: profile\n      };\n    },\n    options\n  };\n};\n\nconst huggingface = (options) => {\n  return {\n    id: \"huggingface\",\n    name: \"Hugging Face\",\n    createAuthorizationURL({ state, scopes, codeVerifier, redirectURI }) {\n      const _scopes = options.disableDefaultScope ? [] : [\"openid\", \"profile\", \"email\"];\n      options.scope && _scopes.push(...options.scope);\n      scopes && _scopes.push(...scopes);\n      return (0,_better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.createAuthorizationURL)({\n        id: \"huggingface\",\n        options,\n        authorizationEndpoint: \"https://huggingface.co/oauth/authorize\",\n        scopes: _scopes,\n        state,\n        codeVerifier,\n        redirectURI\n      });\n    },\n    validateAuthorizationCode: async ({ code, codeVerifier, redirectURI }) => {\n      return (0,_better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.validateAuthorizationCode)({\n        code,\n        codeVerifier,\n        redirectURI,\n        options,\n        tokenEndpoint: \"https://huggingface.co/oauth/token\"\n      });\n    },\n    refreshAccessToken: options.refreshAccessToken ? options.refreshAccessToken : async (refreshToken) => {\n      return (0,_better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.refreshAccessToken)({\n        refreshToken,\n        options: {\n          clientId: options.clientId,\n          clientKey: options.clientKey,\n          clientSecret: options.clientSecret\n        },\n        tokenEndpoint: \"https://huggingface.co/oauth/token\"\n      });\n    },\n    async getUserInfo(token) {\n      if (options.getUserInfo) {\n        return options.getUserInfo(token);\n      }\n      const { data: profile, error } = await (0,_better_fetch_fetch__WEBPACK_IMPORTED_MODULE_0__.betterFetch)(\n        \"https://huggingface.co/oauth/userinfo\",\n        {\n          method: \"GET\",\n          headers: {\n            Authorization: `Bearer ${token.accessToken}`\n          }\n        }\n      );\n      if (error) {\n        return null;\n      }\n      const userMap = await options.mapProfileToUser?.(profile);\n      return {\n        user: {\n          id: profile.sub,\n          name: profile.name || profile.preferred_username,\n          email: profile.email,\n          image: profile.picture,\n          emailVerified: profile.email_verified ?? false,\n          ...userMap\n        },\n        data: profile\n      };\n    },\n    options\n  };\n};\n\nconst microsoft = (options) => {\n  const tenant = options.tenantId || \"common\";\n  const authority = options.authority || \"https://login.microsoftonline.com\";\n  const authorizationEndpoint = `${authority}/${tenant}/oauth2/v2.0/authorize`;\n  const tokenEndpoint = `${authority}/${tenant}/oauth2/v2.0/token`;\n  return {\n    id: \"microsoft\",\n    name: \"Microsoft EntraID\",\n    createAuthorizationURL(data) {\n      const scopes = options.disableDefaultScope ? [] : [\"openid\", \"profile\", \"email\", \"User.Read\", \"offline_access\"];\n      options.scope && scopes.push(...options.scope);\n      data.scopes && scopes.push(...data.scopes);\n      return (0,_better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.createAuthorizationURL)({\n        id: \"microsoft\",\n        options,\n        authorizationEndpoint,\n        state: data.state,\n        codeVerifier: data.codeVerifier,\n        scopes,\n        redirectURI: data.redirectURI,\n        prompt: options.prompt,\n        loginHint: data.loginHint\n      });\n    },\n    validateAuthorizationCode({ code, codeVerifier, redirectURI }) {\n      return (0,_better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.validateAuthorizationCode)({\n        code,\n        codeVerifier,\n        redirectURI,\n        options,\n        tokenEndpoint\n      });\n    },\n    async getUserInfo(token) {\n      if (options.getUserInfo) {\n        return options.getUserInfo(token);\n      }\n      if (!token.idToken) {\n        return null;\n      }\n      const user = (0,jose__WEBPACK_IMPORTED_MODULE_9__.decodeJwt)(token.idToken);\n      const profilePhotoSize = options.profilePhotoSize || 48;\n      await (0,_better_fetch_fetch__WEBPACK_IMPORTED_MODULE_0__.betterFetch)(\n        `https://graph.microsoft.com/v1.0/me/photos/${profilePhotoSize}x${profilePhotoSize}/$value`,\n        {\n          headers: {\n            Authorization: `Bearer ${token.accessToken}`\n          },\n          async onResponse(context) {\n            if (options.disableProfilePhoto || !context.response.ok) {\n              return;\n            }\n            try {\n              const response = context.response.clone();\n              const pictureBuffer = await response.arrayBuffer();\n              const pictureBase64 = _better_auth_utils_base64__WEBPACK_IMPORTED_MODULE_5__.base64.encode(pictureBuffer);\n              user.picture = `data:image/jpeg;base64, ${pictureBase64}`;\n            } catch (e) {\n              _better_auth_core_env__WEBPACK_IMPORTED_MODULE_4__.logger.error(\n                e && typeof e === \"object\" && \"name\" in e ? e.name : \"\",\n                e\n              );\n            }\n          }\n        }\n      );\n      const userMap = await options.mapProfileToUser?.(user);\n      return {\n        user: {\n          id: user.sub,\n          name: user.name,\n          email: user.email,\n          image: user.picture,\n          emailVerified: true,\n          ...userMap\n        },\n        data: user\n      };\n    },\n    refreshAccessToken: options.refreshAccessToken ? options.refreshAccessToken : async (refreshToken) => {\n      const scopes = options.disableDefaultScope ? [] : [\"openid\", \"profile\", \"email\", \"User.Read\", \"offline_access\"];\n      options.scope && scopes.push(...options.scope);\n      return (0,_better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.refreshAccessToken)({\n        refreshToken,\n        options: {\n          clientId: options.clientId,\n          clientSecret: options.clientSecret\n        },\n        extraParams: {\n          scope: scopes.join(\" \")\n          // Include the scopes in request to microsoft\n        },\n        tokenEndpoint\n      });\n    },\n    options\n  };\n};\n\nconst slack = (options) => {\n  return {\n    id: \"slack\",\n    name: \"Slack\",\n    createAuthorizationURL({ state, scopes, redirectURI }) {\n      const _scopes = options.disableDefaultScope ? [] : [\"openid\", \"profile\", \"email\"];\n      scopes && _scopes.push(...scopes);\n      options.scope && _scopes.push(...options.scope);\n      const url = new URL(\"https://slack.com/openid/connect/authorize\");\n      url.searchParams.set(\"scope\", _scopes.join(\" \"));\n      url.searchParams.set(\"response_type\", \"code\");\n      url.searchParams.set(\"client_id\", options.clientId);\n      url.searchParams.set(\"redirect_uri\", options.redirectURI || redirectURI);\n      url.searchParams.set(\"state\", state);\n      return url;\n    },\n    validateAuthorizationCode: async ({ code, redirectURI }) => {\n      return (0,_better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.validateAuthorizationCode)({\n        code,\n        redirectURI,\n        options,\n        tokenEndpoint: \"https://slack.com/api/openid.connect.token\"\n      });\n    },\n    refreshAccessToken: options.refreshAccessToken ? options.refreshAccessToken : async (refreshToken) => {\n      return (0,_better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.refreshAccessToken)({\n        refreshToken,\n        options: {\n          clientId: options.clientId,\n          clientKey: options.clientKey,\n          clientSecret: options.clientSecret\n        },\n        tokenEndpoint: \"https://slack.com/api/openid.connect.token\"\n      });\n    },\n    async getUserInfo(token) {\n      if (options.getUserInfo) {\n        return options.getUserInfo(token);\n      }\n      const { data: profile, error } = await (0,_better_fetch_fetch__WEBPACK_IMPORTED_MODULE_0__.betterFetch)(\n        \"https://slack.com/api/openid.connect.userInfo\",\n        {\n          headers: {\n            authorization: `Bearer ${token.accessToken}`\n          }\n        }\n      );\n      if (error) {\n        return null;\n      }\n      const userMap = await options.mapProfileToUser?.(profile);\n      return {\n        user: {\n          id: profile[\"https://slack.com/user_id\"],\n          name: profile.name || \"\",\n          email: profile.email,\n          emailVerified: profile.email_verified,\n          image: profile.picture || profile[\"https://slack.com/user_image_512\"],\n          ...userMap\n        },\n        data: profile\n      };\n    },\n    options\n  };\n};\n\nconst notion = (options) => {\n  const tokenEndpoint = \"https://api.notion.com/v1/oauth/token\";\n  return {\n    id: \"notion\",\n    name: \"Notion\",\n    createAuthorizationURL({ state, scopes, loginHint, redirectURI }) {\n      const _scopes = options.disableDefaultScope ? [] : [];\n      options.scope && _scopes.push(...options.scope);\n      scopes && _scopes.push(...scopes);\n      return (0,_better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.createAuthorizationURL)({\n        id: \"notion\",\n        options,\n        authorizationEndpoint: \"https://api.notion.com/v1/oauth/authorize\",\n        scopes: _scopes,\n        state,\n        redirectURI,\n        loginHint,\n        additionalParams: {\n          owner: \"user\"\n        }\n      });\n    },\n    validateAuthorizationCode: async ({ code, redirectURI }) => {\n      return (0,_better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.validateAuthorizationCode)({\n        code,\n        redirectURI,\n        options,\n        tokenEndpoint,\n        authentication: \"basic\"\n      });\n    },\n    refreshAccessToken: options.refreshAccessToken ? options.refreshAccessToken : async (refreshToken) => {\n      return (0,_better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.refreshAccessToken)({\n        refreshToken,\n        options: {\n          clientId: options.clientId,\n          clientKey: options.clientKey,\n          clientSecret: options.clientSecret\n        },\n        tokenEndpoint\n      });\n    },\n    async getUserInfo(token) {\n      if (options.getUserInfo) {\n        return options.getUserInfo(token);\n      }\n      const { data: profile, error } = await (0,_better_fetch_fetch__WEBPACK_IMPORTED_MODULE_0__.betterFetch)(\"https://api.notion.com/v1/users/me\", {\n        headers: {\n          Authorization: `Bearer ${token.accessToken}`,\n          \"Notion-Version\": \"2022-06-28\"\n        }\n      });\n      if (error || !profile) {\n        return null;\n      }\n      const userProfile = profile.bot?.owner?.user;\n      if (!userProfile) {\n        return null;\n      }\n      const userMap = await options.mapProfileToUser?.(userProfile);\n      return {\n        user: {\n          id: userProfile.id,\n          name: userProfile.name || \"Notion User\",\n          email: userProfile.person?.email || null,\n          image: userProfile.avatar_url,\n          emailVerified: !!userProfile.person?.email,\n          ...userMap\n        },\n        data: userProfile\n      };\n    },\n    options\n  };\n};\n\nconst spotify = (options) => {\n  return {\n    id: \"spotify\",\n    name: \"Spotify\",\n    createAuthorizationURL({ state, scopes, codeVerifier, redirectURI }) {\n      const _scopes = options.disableDefaultScope ? [] : [\"user-read-email\"];\n      options.scope && _scopes.push(...options.scope);\n      scopes && _scopes.push(...scopes);\n      return (0,_better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.createAuthorizationURL)({\n        id: \"spotify\",\n        options,\n        authorizationEndpoint: \"https://accounts.spotify.com/authorize\",\n        scopes: _scopes,\n        state,\n        codeVerifier,\n        redirectURI\n      });\n    },\n    validateAuthorizationCode: async ({ code, codeVerifier, redirectURI }) => {\n      return (0,_better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.validateAuthorizationCode)({\n        code,\n        codeVerifier,\n        redirectURI,\n        options,\n        tokenEndpoint: \"https://accounts.spotify.com/api/token\"\n      });\n    },\n    refreshAccessToken: options.refreshAccessToken ? options.refreshAccessToken : async (refreshToken) => {\n      return (0,_better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.refreshAccessToken)({\n        refreshToken,\n        options: {\n          clientId: options.clientId,\n          clientKey: options.clientKey,\n          clientSecret: options.clientSecret\n        },\n        tokenEndpoint: \"https://accounts.spotify.com/api/token\"\n      });\n    },\n    async getUserInfo(token) {\n      if (options.getUserInfo) {\n        return options.getUserInfo(token);\n      }\n      const { data: profile, error } = await (0,_better_fetch_fetch__WEBPACK_IMPORTED_MODULE_0__.betterFetch)(\n        \"https://api.spotify.com/v1/me\",\n        {\n          method: \"GET\",\n          headers: {\n            Authorization: `Bearer ${token.accessToken}`\n          }\n        }\n      );\n      if (error) {\n        return null;\n      }\n      const userMap = await options.mapProfileToUser?.(profile);\n      return {\n        user: {\n          id: profile.id,\n          name: profile.display_name,\n          email: profile.email,\n          image: profile.images[0]?.url,\n          emailVerified: false,\n          ...userMap\n        },\n        data: profile\n      };\n    },\n    options\n  };\n};\n\nconst twitch = (options) => {\n  return {\n    id: \"twitch\",\n    name: \"Twitch\",\n    createAuthorizationURL({ state, scopes, redirectURI }) {\n      const _scopes = options.disableDefaultScope ? [] : [\"user:read:email\", \"openid\"];\n      options.scope && _scopes.push(...options.scope);\n      scopes && _scopes.push(...scopes);\n      return (0,_better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.createAuthorizationURL)({\n        id: \"twitch\",\n        redirectURI,\n        options,\n        authorizationEndpoint: \"https://id.twitch.tv/oauth2/authorize\",\n        scopes: _scopes,\n        state,\n        claims: options.claims || [\n          \"email\",\n          \"email_verified\",\n          \"preferred_username\",\n          \"picture\"\n        ]\n      });\n    },\n    validateAuthorizationCode: async ({ code, redirectURI }) => {\n      return (0,_better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.validateAuthorizationCode)({\n        code,\n        redirectURI,\n        options,\n        tokenEndpoint: \"https://id.twitch.tv/oauth2/token\"\n      });\n    },\n    refreshAccessToken: options.refreshAccessToken ? options.refreshAccessToken : async (refreshToken) => {\n      return (0,_better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.refreshAccessToken)({\n        refreshToken,\n        options: {\n          clientId: options.clientId,\n          clientKey: options.clientKey,\n          clientSecret: options.clientSecret\n        },\n        tokenEndpoint: \"https://id.twitch.tv/oauth2/token\"\n      });\n    },\n    async getUserInfo(token) {\n      if (options.getUserInfo) {\n        return options.getUserInfo(token);\n      }\n      const idToken = token.idToken;\n      if (!idToken) {\n        _better_auth_core_env__WEBPACK_IMPORTED_MODULE_4__.logger.error(\"No idToken found in token\");\n        return null;\n      }\n      const profile = (0,jose__WEBPACK_IMPORTED_MODULE_9__.decodeJwt)(idToken);\n      const userMap = await options.mapProfileToUser?.(profile);\n      return {\n        user: {\n          id: profile.sub,\n          name: profile.preferred_username,\n          email: profile.email,\n          image: profile.picture,\n          emailVerified: profile.email_verified,\n          ...userMap\n        },\n        data: profile\n      };\n    },\n    options\n  };\n};\n\nconst twitter = (options) => {\n  return {\n    id: \"twitter\",\n    name: \"Twitter\",\n    createAuthorizationURL(data) {\n      const _scopes = options.disableDefaultScope ? [] : [\"users.read\", \"tweet.read\", \"offline.access\", \"users.email\"];\n      options.scope && _scopes.push(...options.scope);\n      data.scopes && _scopes.push(...data.scopes);\n      return (0,_better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.createAuthorizationURL)({\n        id: \"twitter\",\n        options,\n        authorizationEndpoint: \"https://x.com/i/oauth2/authorize\",\n        scopes: _scopes,\n        state: data.state,\n        codeVerifier: data.codeVerifier,\n        redirectURI: data.redirectURI\n      });\n    },\n    validateAuthorizationCode: async ({ code, codeVerifier, redirectURI }) => {\n      return (0,_better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.validateAuthorizationCode)({\n        code,\n        codeVerifier,\n        authentication: \"basic\",\n        redirectURI,\n        options,\n        tokenEndpoint: \"https://api.x.com/2/oauth2/token\"\n      });\n    },\n    refreshAccessToken: options.refreshAccessToken ? options.refreshAccessToken : async (refreshToken) => {\n      return (0,_better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.refreshAccessToken)({\n        refreshToken,\n        options: {\n          clientId: options.clientId,\n          clientKey: options.clientKey,\n          clientSecret: options.clientSecret\n        },\n        authentication: \"basic\",\n        tokenEndpoint: \"https://api.x.com/2/oauth2/token\"\n      });\n    },\n    async getUserInfo(token) {\n      if (options.getUserInfo) {\n        return options.getUserInfo(token);\n      }\n      const { data: profile, error: profileError } = await (0,_better_fetch_fetch__WEBPACK_IMPORTED_MODULE_0__.betterFetch)(\n        \"https://api.x.com/2/users/me?user.fields=profile_image_url\",\n        {\n          method: \"GET\",\n          headers: {\n            Authorization: `Bearer ${token.accessToken}`\n          }\n        }\n      );\n      if (profileError) {\n        return null;\n      }\n      const { data: emailData, error: emailError } = await (0,_better_fetch_fetch__WEBPACK_IMPORTED_MODULE_0__.betterFetch)(\"https://api.x.com/2/users/me?user.fields=confirmed_email\", {\n        method: \"GET\",\n        headers: {\n          Authorization: `Bearer ${token.accessToken}`\n        }\n      });\n      let emailVerified = false;\n      if (!emailError && emailData?.data?.confirmed_email) {\n        profile.data.email = emailData.data.confirmed_email;\n        emailVerified = true;\n      }\n      const userMap = await options.mapProfileToUser?.(profile);\n      return {\n        user: {\n          id: profile.data.id,\n          name: profile.data.name,\n          email: profile.data.email || profile.data.username || null,\n          image: profile.data.profile_image_url,\n          emailVerified,\n          ...userMap\n        },\n        data: profile\n      };\n    },\n    options\n  };\n};\n\nconst dropbox = (options) => {\n  const tokenEndpoint = \"https://api.dropboxapi.com/oauth2/token\";\n  return {\n    id: \"dropbox\",\n    name: \"Dropbox\",\n    createAuthorizationURL: async ({\n      state,\n      scopes,\n      codeVerifier,\n      redirectURI\n    }) => {\n      const _scopes = options.disableDefaultScope ? [] : [\"account_info.read\"];\n      options.scope && _scopes.push(...options.scope);\n      scopes && _scopes.push(...scopes);\n      const additionalParams = {};\n      if (options.accessType) {\n        additionalParams.token_access_type = options.accessType;\n      }\n      return await (0,_better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.createAuthorizationURL)({\n        id: \"dropbox\",\n        options,\n        authorizationEndpoint: \"https://www.dropbox.com/oauth2/authorize\",\n        scopes: _scopes,\n        state,\n        redirectURI,\n        codeVerifier,\n        additionalParams\n      });\n    },\n    validateAuthorizationCode: async ({ code, codeVerifier, redirectURI }) => {\n      return await (0,_better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.validateAuthorizationCode)({\n        code,\n        codeVerifier,\n        redirectURI,\n        options,\n        tokenEndpoint\n      });\n    },\n    refreshAccessToken: options.refreshAccessToken ? options.refreshAccessToken : async (refreshToken) => {\n      return (0,_better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.refreshAccessToken)({\n        refreshToken,\n        options: {\n          clientId: options.clientId,\n          clientKey: options.clientKey,\n          clientSecret: options.clientSecret\n        },\n        tokenEndpoint: \"https://api.dropbox.com/oauth2/token\"\n      });\n    },\n    async getUserInfo(token) {\n      if (options.getUserInfo) {\n        return options.getUserInfo(token);\n      }\n      const { data: profile, error } = await (0,_better_fetch_fetch__WEBPACK_IMPORTED_MODULE_0__.betterFetch)(\n        \"https://api.dropboxapi.com/2/users/get_current_account\",\n        {\n          method: \"POST\",\n          headers: {\n            Authorization: `Bearer ${token.accessToken}`\n          }\n        }\n      );\n      if (error) {\n        return null;\n      }\n      const userMap = await options.mapProfileToUser?.(profile);\n      return {\n        user: {\n          id: profile.account_id,\n          name: profile.name?.display_name,\n          email: profile.email,\n          emailVerified: profile.email_verified || false,\n          image: profile.profile_photo_url,\n          ...userMap\n        },\n        data: profile\n      };\n    },\n    options\n  };\n};\n\nconst linear = (options) => {\n  const tokenEndpoint = \"https://api.linear.app/oauth/token\";\n  return {\n    id: \"linear\",\n    name: \"Linear\",\n    createAuthorizationURL({ state, scopes, loginHint, redirectURI }) {\n      const _scopes = options.disableDefaultScope ? [] : [\"read\"];\n      options.scope && _scopes.push(...options.scope);\n      scopes && _scopes.push(...scopes);\n      return (0,_better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.createAuthorizationURL)({\n        id: \"linear\",\n        options,\n        authorizationEndpoint: \"https://linear.app/oauth/authorize\",\n        scopes: _scopes,\n        state,\n        redirectURI,\n        loginHint\n      });\n    },\n    validateAuthorizationCode: async ({ code, redirectURI }) => {\n      return (0,_better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.validateAuthorizationCode)({\n        code,\n        redirectURI,\n        options,\n        tokenEndpoint\n      });\n    },\n    refreshAccessToken: options.refreshAccessToken ? options.refreshAccessToken : async (refreshToken) => {\n      return (0,_better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.refreshAccessToken)({\n        refreshToken,\n        options: {\n          clientId: options.clientId,\n          clientKey: options.clientKey,\n          clientSecret: options.clientSecret\n        },\n        tokenEndpoint\n      });\n    },\n    async getUserInfo(token) {\n      if (options.getUserInfo) {\n        return options.getUserInfo(token);\n      }\n      const { data: profile, error } = await (0,_better_fetch_fetch__WEBPACK_IMPORTED_MODULE_0__.betterFetch)(\n        \"https://api.linear.app/graphql\",\n        {\n          method: \"POST\",\n          headers: {\n            \"Content-Type\": \"application/json\",\n            Authorization: `Bearer ${token.accessToken}`\n          },\n          body: JSON.stringify({\n            query: `\n\t\t\t\t\t\t\tquery {\n\t\t\t\t\t\t\t\tviewer {\n\t\t\t\t\t\t\t\t\tid\n\t\t\t\t\t\t\t\t\tname\n\t\t\t\t\t\t\t\t\temail\n\t\t\t\t\t\t\t\t\tavatarUrl\n\t\t\t\t\t\t\t\t\tactive\n\t\t\t\t\t\t\t\t\tcreatedAt\n\t\t\t\t\t\t\t\t\tupdatedAt\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t`\n          })\n        }\n      );\n      if (error || !profile?.data?.viewer) {\n        return null;\n      }\n      const userData = profile.data.viewer;\n      const userMap = await options.mapProfileToUser?.(userData);\n      return {\n        user: {\n          id: profile.data.viewer.id,\n          name: profile.data.viewer.name,\n          email: profile.data.viewer.email,\n          image: profile.data.viewer.avatarUrl,\n          emailVerified: true,\n          ...userMap\n        },\n        data: userData\n      };\n    },\n    options\n  };\n};\n\nconst linkedin = (options) => {\n  const authorizationEndpoint = \"https://www.linkedin.com/oauth/v2/authorization\";\n  const tokenEndpoint = \"https://www.linkedin.com/oauth/v2/accessToken\";\n  return {\n    id: \"linkedin\",\n    name: \"Linkedin\",\n    createAuthorizationURL: async ({\n      state,\n      scopes,\n      redirectURI,\n      loginHint\n    }) => {\n      const _scopes = options.disableDefaultScope ? [] : [\"profile\", \"email\", \"openid\"];\n      options.scope && _scopes.push(...options.scope);\n      scopes && _scopes.push(...scopes);\n      return await (0,_better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.createAuthorizationURL)({\n        id: \"linkedin\",\n        options,\n        authorizationEndpoint,\n        scopes: _scopes,\n        state,\n        loginHint,\n        redirectURI\n      });\n    },\n    validateAuthorizationCode: async ({ code, redirectURI }) => {\n      return await (0,_better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.validateAuthorizationCode)({\n        code,\n        redirectURI,\n        options,\n        tokenEndpoint\n      });\n    },\n    refreshAccessToken: options.refreshAccessToken ? options.refreshAccessToken : async (refreshToken) => {\n      return (0,_better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.refreshAccessToken)({\n        refreshToken,\n        options: {\n          clientId: options.clientId,\n          clientKey: options.clientKey,\n          clientSecret: options.clientSecret\n        },\n        tokenEndpoint\n      });\n    },\n    async getUserInfo(token) {\n      if (options.getUserInfo) {\n        return options.getUserInfo(token);\n      }\n      const { data: profile, error } = await (0,_better_fetch_fetch__WEBPACK_IMPORTED_MODULE_0__.betterFetch)(\n        \"https://api.linkedin.com/v2/userinfo\",\n        {\n          method: \"GET\",\n          headers: {\n            Authorization: `Bearer ${token.accessToken}`\n          }\n        }\n      );\n      if (error) {\n        return null;\n      }\n      const userMap = await options.mapProfileToUser?.(profile);\n      return {\n        user: {\n          id: profile.sub,\n          name: profile.name,\n          email: profile.email,\n          emailVerified: profile.email_verified || false,\n          image: profile.picture,\n          ...userMap\n        },\n        data: profile\n      };\n    },\n    options\n  };\n};\n\nconst cleanDoubleSlashes = (input = \"\") => {\n  return input.split(\"://\").map((str) => str.replace(/\\/{2,}/g, \"/\")).join(\"://\");\n};\nconst issuerToEndpoints = (issuer) => {\n  let baseUrl = issuer || \"https://gitlab.com\";\n  return {\n    authorizationEndpoint: cleanDoubleSlashes(`${baseUrl}/oauth/authorize`),\n    tokenEndpoint: cleanDoubleSlashes(`${baseUrl}/oauth/token`),\n    userinfoEndpoint: cleanDoubleSlashes(`${baseUrl}/api/v4/user`)\n  };\n};\nconst gitlab = (options) => {\n  const { authorizationEndpoint, tokenEndpoint, userinfoEndpoint } = issuerToEndpoints(options.issuer);\n  const issuerId = \"gitlab\";\n  const issuerName = \"Gitlab\";\n  return {\n    id: issuerId,\n    name: issuerName,\n    createAuthorizationURL: async ({\n      state,\n      scopes,\n      codeVerifier,\n      loginHint,\n      redirectURI\n    }) => {\n      const _scopes = options.disableDefaultScope ? [] : [\"read_user\"];\n      options.scope && _scopes.push(...options.scope);\n      scopes && _scopes.push(...scopes);\n      return await (0,_better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.createAuthorizationURL)({\n        id: issuerId,\n        options,\n        authorizationEndpoint,\n        scopes: _scopes,\n        state,\n        redirectURI,\n        codeVerifier,\n        loginHint\n      });\n    },\n    validateAuthorizationCode: async ({ code, redirectURI, codeVerifier }) => {\n      return (0,_better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.validateAuthorizationCode)({\n        code,\n        redirectURI,\n        options,\n        codeVerifier,\n        tokenEndpoint\n      });\n    },\n    refreshAccessToken: options.refreshAccessToken ? options.refreshAccessToken : async (refreshToken) => {\n      return (0,_better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.refreshAccessToken)({\n        refreshToken,\n        options: {\n          clientId: options.clientId,\n          clientKey: options.clientKey,\n          clientSecret: options.clientSecret\n        },\n        tokenEndpoint\n      });\n    },\n    async getUserInfo(token) {\n      if (options.getUserInfo) {\n        return options.getUserInfo(token);\n      }\n      const { data: profile, error } = await (0,_better_fetch_fetch__WEBPACK_IMPORTED_MODULE_0__.betterFetch)(\n        userinfoEndpoint,\n        { headers: { authorization: `Bearer ${token.accessToken}` } }\n      );\n      if (error || profile.state !== \"active\" || profile.locked) {\n        return null;\n      }\n      const userMap = await options.mapProfileToUser?.(profile);\n      return {\n        user: {\n          id: profile.id,\n          name: profile.name ?? profile.username,\n          email: profile.email,\n          image: profile.avatar_url,\n          emailVerified: true,\n          ...userMap\n        },\n        data: profile\n      };\n    },\n    options\n  };\n};\n\nconst tiktok = (options) => {\n  return {\n    id: \"tiktok\",\n    name: \"TikTok\",\n    createAuthorizationURL({ state, scopes, redirectURI }) {\n      const _scopes = options.disableDefaultScope ? [] : [\"user.info.profile\"];\n      options.scope && _scopes.push(...options.scope);\n      scopes && _scopes.push(...scopes);\n      return new URL(\n        `https://www.tiktok.com/v2/auth/authorize?scope=${_scopes.join(\n          \",\"\n        )}&response_type=code&client_key=${options.clientKey}&redirect_uri=${encodeURIComponent(\n          options.redirectURI || redirectURI\n        )}&state=${state}`\n      );\n    },\n    validateAuthorizationCode: async ({ code, redirectURI }) => {\n      return (0,_better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.validateAuthorizationCode)({\n        code,\n        redirectURI: options.redirectURI || redirectURI,\n        options: {\n          clientKey: options.clientKey,\n          clientSecret: options.clientSecret\n        },\n        tokenEndpoint: \"https://open.tiktokapis.com/v2/oauth/token/\"\n      });\n    },\n    refreshAccessToken: options.refreshAccessToken ? options.refreshAccessToken : async (refreshToken) => {\n      return (0,_better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.refreshAccessToken)({\n        refreshToken,\n        options: {\n          clientSecret: options.clientSecret\n        },\n        tokenEndpoint: \"https://open.tiktokapis.com/v2/oauth/token/\",\n        authentication: \"post\",\n        extraParams: {\n          client_key: options.clientKey\n        }\n      });\n    },\n    async getUserInfo(token) {\n      if (options.getUserInfo) {\n        return options.getUserInfo(token);\n      }\n      const fields = [\n        \"open_id\",\n        \"avatar_large_url\",\n        \"display_name\",\n        \"username\"\n      ];\n      const { data: profile, error } = await (0,_better_fetch_fetch__WEBPACK_IMPORTED_MODULE_0__.betterFetch)(\n        `https://open.tiktokapis.com/v2/user/info/?fields=${fields.join(\",\")}`,\n        {\n          headers: {\n            authorization: `Bearer ${token.accessToken}`\n          }\n        }\n      );\n      if (error) {\n        return null;\n      }\n      return {\n        user: {\n          email: profile.data.user.email || profile.data.user.username,\n          id: profile.data.user.open_id,\n          name: profile.data.user.display_name || profile.data.user.username,\n          image: profile.data.user.avatar_large_url,\n          /** @note Tiktok does not provide emailVerified or even email*/\n          emailVerified: profile.data.user.email ? true : false\n        },\n        data: profile\n      };\n    },\n    options\n  };\n};\n\nconst reddit = (options) => {\n  return {\n    id: \"reddit\",\n    name: \"Reddit\",\n    createAuthorizationURL({ state, scopes, redirectURI }) {\n      const _scopes = options.disableDefaultScope ? [] : [\"identity\"];\n      options.scope && _scopes.push(...options.scope);\n      scopes && _scopes.push(...scopes);\n      return (0,_better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.createAuthorizationURL)({\n        id: \"reddit\",\n        options,\n        authorizationEndpoint: \"https://www.reddit.com/api/v1/authorize\",\n        scopes: _scopes,\n        state,\n        redirectURI,\n        duration: options.duration\n      });\n    },\n    validateAuthorizationCode: async ({ code, redirectURI }) => {\n      const body = new URLSearchParams({\n        grant_type: \"authorization_code\",\n        code,\n        redirect_uri: options.redirectURI || redirectURI\n      });\n      const headers = {\n        \"content-type\": \"application/x-www-form-urlencoded\",\n        accept: \"text/plain\",\n        \"user-agent\": \"better-auth\",\n        Authorization: `Basic ${_better_auth_utils_base64__WEBPACK_IMPORTED_MODULE_5__.base64.encode(\n          `${options.clientId}:${options.clientSecret}`\n        )}`\n      };\n      const { data, error } = await (0,_better_fetch_fetch__WEBPACK_IMPORTED_MODULE_0__.betterFetch)(\n        \"https://www.reddit.com/api/v1/access_token\",\n        {\n          method: \"POST\",\n          headers,\n          body: body.toString()\n        }\n      );\n      if (error) {\n        throw error;\n      }\n      return (0,_better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.getOAuth2Tokens)(data);\n    },\n    refreshAccessToken: options.refreshAccessToken ? options.refreshAccessToken : async (refreshToken) => {\n      return (0,_better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.refreshAccessToken)({\n        refreshToken,\n        options: {\n          clientId: options.clientId,\n          clientKey: options.clientKey,\n          clientSecret: options.clientSecret\n        },\n        authentication: \"basic\",\n        tokenEndpoint: \"https://www.reddit.com/api/v1/access_token\"\n      });\n    },\n    async getUserInfo(token) {\n      if (options.getUserInfo) {\n        return options.getUserInfo(token);\n      }\n      const { data: profile, error } = await (0,_better_fetch_fetch__WEBPACK_IMPORTED_MODULE_0__.betterFetch)(\n        \"https://oauth.reddit.com/api/v1/me\",\n        {\n          headers: {\n            Authorization: `Bearer ${token.accessToken}`,\n            \"User-Agent\": \"better-auth\"\n          }\n        }\n      );\n      if (error) {\n        return null;\n      }\n      const userMap = await options.mapProfileToUser?.(profile);\n      return {\n        user: {\n          id: profile.id,\n          name: profile.name,\n          email: profile.oauth_client_id,\n          emailVerified: profile.has_verified_email,\n          image: profile.icon_img?.split(\"?\")[0],\n          ...userMap\n        },\n        data: profile\n      };\n    },\n    options\n  };\n};\n\nconst roblox = (options) => {\n  return {\n    id: \"roblox\",\n    name: \"Roblox\",\n    createAuthorizationURL({ state, scopes, redirectURI }) {\n      const _scopes = options.disableDefaultScope ? [] : [\"openid\", \"profile\"];\n      options.scope && _scopes.push(...options.scope);\n      scopes && _scopes.push(...scopes);\n      return new URL(\n        `https://apis.roblox.com/oauth/v1/authorize?scope=${_scopes.join(\n          \"+\"\n        )}&response_type=code&client_id=${options.clientId}&redirect_uri=${encodeURIComponent(\n          options.redirectURI || redirectURI\n        )}&state=${state}&prompt=${options.prompt || \"select_account consent\"}`\n      );\n    },\n    validateAuthorizationCode: async ({ code, redirectURI }) => {\n      return (0,_better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.validateAuthorizationCode)({\n        code,\n        redirectURI: options.redirectURI || redirectURI,\n        options,\n        tokenEndpoint: \"https://apis.roblox.com/oauth/v1/token\",\n        authentication: \"post\"\n      });\n    },\n    refreshAccessToken: options.refreshAccessToken ? options.refreshAccessToken : async (refreshToken) => {\n      return (0,_better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.refreshAccessToken)({\n        refreshToken,\n        options: {\n          clientId: options.clientId,\n          clientKey: options.clientKey,\n          clientSecret: options.clientSecret\n        },\n        tokenEndpoint: \"https://apis.roblox.com/oauth/v1/token\"\n      });\n    },\n    async getUserInfo(token) {\n      if (options.getUserInfo) {\n        return options.getUserInfo(token);\n      }\n      const { data: profile, error } = await (0,_better_fetch_fetch__WEBPACK_IMPORTED_MODULE_0__.betterFetch)(\n        \"https://apis.roblox.com/oauth/v1/userinfo\",\n        {\n          headers: {\n            authorization: `Bearer ${token.accessToken}`\n          }\n        }\n      );\n      if (error) {\n        return null;\n      }\n      const userMap = await options.mapProfileToUser?.(profile);\n      return {\n        user: {\n          id: profile.sub,\n          name: profile.nickname || profile.preferred_username || \"\",\n          image: profile.picture,\n          email: profile.preferred_username || null,\n          // Roblox does not provide email\n          emailVerified: true,\n          ...userMap\n        },\n        data: {\n          ...profile\n        }\n      };\n    },\n    options\n  };\n};\n\nconst salesforce = (options) => {\n  const environment = options.environment ?? \"production\";\n  const isSandbox = environment === \"sandbox\";\n  const authorizationEndpoint = options.loginUrl ? `https://${options.loginUrl}/services/oauth2/authorize` : isSandbox ? \"https://test.salesforce.com/services/oauth2/authorize\" : \"https://login.salesforce.com/services/oauth2/authorize\";\n  const tokenEndpoint = options.loginUrl ? `https://${options.loginUrl}/services/oauth2/token` : isSandbox ? \"https://test.salesforce.com/services/oauth2/token\" : \"https://login.salesforce.com/services/oauth2/token\";\n  const userInfoEndpoint = options.loginUrl ? `https://${options.loginUrl}/services/oauth2/userinfo` : isSandbox ? \"https://test.salesforce.com/services/oauth2/userinfo\" : \"https://login.salesforce.com/services/oauth2/userinfo\";\n  return {\n    id: \"salesforce\",\n    name: \"Salesforce\",\n    async createAuthorizationURL({ state, scopes, codeVerifier, redirectURI }) {\n      if (!options.clientId || !options.clientSecret) {\n        _better_auth_core_env__WEBPACK_IMPORTED_MODULE_4__.logger.error(\n          \"Client Id and Client Secret are required for Salesforce. Make sure to provide them in the options.\"\n        );\n        throw new _error_index_mjs__WEBPACK_IMPORTED_MODULE_3__.BetterAuthError(\"CLIENT_ID_AND_SECRET_REQUIRED\");\n      }\n      if (!codeVerifier) {\n        throw new _error_index_mjs__WEBPACK_IMPORTED_MODULE_3__.BetterAuthError(\"codeVerifier is required for Salesforce\");\n      }\n      const _scopes = options.disableDefaultScope ? [] : [\"openid\", \"email\", \"profile\"];\n      options.scope && _scopes.push(...options.scope);\n      scopes && _scopes.push(...scopes);\n      return (0,_better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.createAuthorizationURL)({\n        id: \"salesforce\",\n        options,\n        authorizationEndpoint,\n        scopes: _scopes,\n        state,\n        codeVerifier,\n        redirectURI: options.redirectURI || redirectURI\n      });\n    },\n    validateAuthorizationCode: async ({ code, codeVerifier, redirectURI }) => {\n      return (0,_better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.validateAuthorizationCode)({\n        code,\n        codeVerifier,\n        redirectURI: options.redirectURI || redirectURI,\n        options,\n        tokenEndpoint\n      });\n    },\n    refreshAccessToken: options.refreshAccessToken ? options.refreshAccessToken : async (refreshToken) => {\n      return (0,_better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.refreshAccessToken)({\n        refreshToken,\n        options: {\n          clientId: options.clientId,\n          clientSecret: options.clientSecret\n        },\n        tokenEndpoint\n      });\n    },\n    async getUserInfo(token) {\n      if (options.getUserInfo) {\n        return options.getUserInfo(token);\n      }\n      try {\n        const { data: user } = await (0,_better_fetch_fetch__WEBPACK_IMPORTED_MODULE_0__.betterFetch)(\n          userInfoEndpoint,\n          {\n            headers: {\n              Authorization: `Bearer ${token.accessToken}`\n            }\n          }\n        );\n        if (!user) {\n          _better_auth_core_env__WEBPACK_IMPORTED_MODULE_4__.logger.error(\"Failed to fetch user info from Salesforce\");\n          return null;\n        }\n        const userMap = await options.mapProfileToUser?.(user);\n        return {\n          user: {\n            id: user.user_id,\n            name: user.name,\n            email: user.email,\n            image: user.photos?.picture || user.photos?.thumbnail,\n            emailVerified: user.email_verified ?? false,\n            ...userMap\n          },\n          data: user\n        };\n      } catch (error) {\n        _better_auth_core_env__WEBPACK_IMPORTED_MODULE_4__.logger.error(\"Failed to fetch user info from Salesforce:\", error);\n        return null;\n      }\n    },\n    options\n  };\n};\n\nconst vk = (options) => {\n  return {\n    id: \"vk\",\n    name: \"VK\",\n    async createAuthorizationURL({ state, scopes, codeVerifier, redirectURI }) {\n      const _scopes = options.disableDefaultScope ? [] : [\"email\", \"phone\"];\n      options.scope && _scopes.push(...options.scope);\n      scopes && _scopes.push(...scopes);\n      const authorizationEndpoint = \"https://id.vk.com/authorize\";\n      return (0,_better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.createAuthorizationURL)({\n        id: \"vk\",\n        options,\n        authorizationEndpoint,\n        scopes: _scopes,\n        state,\n        redirectURI,\n        codeVerifier\n      });\n    },\n    validateAuthorizationCode: async ({\n      code,\n      codeVerifier,\n      redirectURI,\n      deviceId\n    }) => {\n      return (0,_better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.validateAuthorizationCode)({\n        code,\n        codeVerifier,\n        redirectURI: options.redirectURI || redirectURI,\n        options,\n        deviceId,\n        tokenEndpoint: \"https://id.vk.com/oauth2/auth\"\n      });\n    },\n    refreshAccessToken: options.refreshAccessToken ? options.refreshAccessToken : async (refreshToken) => {\n      return (0,_better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.refreshAccessToken)({\n        refreshToken,\n        options: {\n          clientId: options.clientId,\n          clientKey: options.clientKey,\n          clientSecret: options.clientSecret\n        },\n        tokenEndpoint: \"https://id.vk.com/oauth2/auth\"\n      });\n    },\n    async getUserInfo(data) {\n      if (options.getUserInfo) {\n        return options.getUserInfo(data);\n      }\n      if (!data.accessToken) {\n        return null;\n      }\n      const formBody = new URLSearchParams({\n        access_token: data.accessToken,\n        client_id: options.clientId\n      }).toString();\n      const { data: profile, error } = await (0,_better_fetch_fetch__WEBPACK_IMPORTED_MODULE_0__.betterFetch)(\n        \"https://id.vk.com/oauth2/user_info\",\n        {\n          method: \"POST\",\n          headers: {\n            \"Content-Type\": \"application/x-www-form-urlencoded\"\n          },\n          body: formBody\n        }\n      );\n      if (error) {\n        return null;\n      }\n      if (!profile.user.email) {\n        return null;\n      }\n      const userMap = await options.mapProfileToUser?.(profile);\n      return {\n        user: {\n          id: profile.user.user_id,\n          first_name: profile.user.first_name,\n          last_name: profile.user.last_name,\n          email: profile.user.email,\n          image: profile.user.avatar,\n          /** @note VK does not provide emailVerified*/\n          emailVerified: !!profile.user.email,\n          birthday: profile.user.birthday,\n          sex: profile.user.sex,\n          name: `${profile.user.first_name} ${profile.user.last_name}`,\n          ...userMap\n        },\n        data: profile\n      };\n    },\n    options\n  };\n};\n\nconst zoom = (userOptions) => {\n  const options = {\n    pkce: true,\n    ...userOptions\n  };\n  return {\n    id: \"zoom\",\n    name: \"Zoom\",\n    createAuthorizationURL: async ({ state, redirectURI, codeVerifier }) => {\n      const params = new URLSearchParams({\n        response_type: \"code\",\n        redirect_uri: options.redirectURI ? options.redirectURI : redirectURI,\n        client_id: options.clientId,\n        state\n      });\n      if (options.pkce) {\n        const codeChallenge = await (0,_better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.generateCodeChallenge)(codeVerifier);\n        params.set(\"code_challenge_method\", \"S256\");\n        params.set(\"code_challenge\", codeChallenge);\n      }\n      const url = new URL(\"https://zoom.us/oauth/authorize\");\n      url.search = params.toString();\n      return url;\n    },\n    validateAuthorizationCode: async ({ code, redirectURI, codeVerifier }) => {\n      return (0,_better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.validateAuthorizationCode)({\n        code,\n        redirectURI: options.redirectURI || redirectURI,\n        codeVerifier,\n        options,\n        tokenEndpoint: \"https://zoom.us/oauth/token\",\n        authentication: \"post\"\n      });\n    },\n    async getUserInfo(token) {\n      if (options.getUserInfo) {\n        return options.getUserInfo(token);\n      }\n      const { data: profile, error } = await (0,_better_fetch_fetch__WEBPACK_IMPORTED_MODULE_0__.betterFetch)(\n        \"https://api.zoom.us/v2/users/me\",\n        {\n          headers: {\n            authorization: `Bearer ${token.accessToken}`\n          }\n        }\n      );\n      if (error) {\n        return null;\n      }\n      const userMap = await options.mapProfileToUser?.(profile);\n      return {\n        user: {\n          id: profile.id,\n          name: profile.display_name,\n          image: profile.pic_url,\n          email: profile.email,\n          emailVerified: Boolean(profile.verified),\n          ...userMap\n        },\n        data: {\n          ...profile\n        }\n      };\n    }\n  };\n};\n\nconst kakao = (options) => {\n  return {\n    id: \"kakao\",\n    name: \"Kakao\",\n    createAuthorizationURL({ state, scopes, redirectURI }) {\n      const _scopes = options.disableDefaultScope ? [] : [\"account_email\", \"profile_image\", \"profile_nickname\"];\n      options.scope && _scopes.push(...options.scope);\n      scopes && _scopes.push(...scopes);\n      return (0,_better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.createAuthorizationURL)({\n        id: \"kakao\",\n        options,\n        authorizationEndpoint: \"https://kauth.kakao.com/oauth/authorize\",\n        scopes: _scopes,\n        state,\n        redirectURI\n      });\n    },\n    validateAuthorizationCode: async ({ code, redirectURI }) => {\n      return (0,_better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.validateAuthorizationCode)({\n        code,\n        redirectURI,\n        options,\n        tokenEndpoint: \"https://kauth.kakao.com/oauth/token\"\n      });\n    },\n    refreshAccessToken: options.refreshAccessToken ? options.refreshAccessToken : async (refreshToken) => {\n      return (0,_better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.refreshAccessToken)({\n        refreshToken,\n        options: {\n          clientId: options.clientId,\n          clientKey: options.clientKey,\n          clientSecret: options.clientSecret\n        },\n        tokenEndpoint: \"https://kauth.kakao.com/oauth/token\"\n      });\n    },\n    async getUserInfo(token) {\n      if (options.getUserInfo) {\n        return options.getUserInfo(token);\n      }\n      const { data: profile, error } = await (0,_better_fetch_fetch__WEBPACK_IMPORTED_MODULE_0__.betterFetch)(\n        \"https://kapi.kakao.com/v2/user/me\",\n        {\n          headers: {\n            Authorization: `Bearer ${token.accessToken}`\n          }\n        }\n      );\n      if (error || !profile) {\n        return null;\n      }\n      const userMap = await options.mapProfileToUser?.(profile);\n      const account = profile.kakao_account || {};\n      const kakaoProfile = account.profile || {};\n      const user = {\n        id: String(profile.id),\n        name: kakaoProfile.nickname || account.name || void 0,\n        email: account.email,\n        image: kakaoProfile.profile_image_url || kakaoProfile.thumbnail_image_url,\n        emailVerified: !!account.is_email_valid && !!account.is_email_verified,\n        ...userMap\n      };\n      return {\n        user,\n        data: profile\n      };\n    },\n    options\n  };\n};\n\nconst naver = (options) => {\n  return {\n    id: \"naver\",\n    name: \"Naver\",\n    createAuthorizationURL({ state, scopes, redirectURI }) {\n      const _scopes = options.disableDefaultScope ? [] : [\"profile\", \"email\"];\n      options.scope && _scopes.push(...options.scope);\n      scopes && _scopes.push(...scopes);\n      return (0,_better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.createAuthorizationURL)({\n        id: \"naver\",\n        options,\n        authorizationEndpoint: \"https://nid.naver.com/oauth2.0/authorize\",\n        scopes: _scopes,\n        state,\n        redirectURI\n      });\n    },\n    validateAuthorizationCode: async ({ code, redirectURI }) => {\n      return (0,_better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.validateAuthorizationCode)({\n        code,\n        redirectURI,\n        options,\n        tokenEndpoint: \"https://nid.naver.com/oauth2.0/token\"\n      });\n    },\n    refreshAccessToken: options.refreshAccessToken ? options.refreshAccessToken : async (refreshToken) => {\n      return (0,_better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.refreshAccessToken)({\n        refreshToken,\n        options: {\n          clientId: options.clientId,\n          clientKey: options.clientKey,\n          clientSecret: options.clientSecret\n        },\n        tokenEndpoint: \"https://nid.naver.com/oauth2.0/token\"\n      });\n    },\n    async getUserInfo(token) {\n      if (options.getUserInfo) {\n        return options.getUserInfo(token);\n      }\n      const { data: profile, error } = await (0,_better_fetch_fetch__WEBPACK_IMPORTED_MODULE_0__.betterFetch)(\n        \"https://openapi.naver.com/v1/nid/me\",\n        {\n          headers: {\n            Authorization: `Bearer ${token.accessToken}`\n          }\n        }\n      );\n      if (error || !profile || profile.resultcode !== \"00\") {\n        return null;\n      }\n      const userMap = await options.mapProfileToUser?.(profile);\n      const res = profile.response || {};\n      const user = {\n        id: res.id,\n        name: res.name || res.nickname,\n        email: res.email,\n        image: res.profile_image,\n        emailVerified: false,\n        ...userMap\n      };\n      return {\n        user,\n        data: profile\n      };\n    },\n    options\n  };\n};\n\nconst line = (options) => {\n  const authorizationEndpoint = \"https://access.line.me/oauth2/v2.1/authorize\";\n  const tokenEndpoint = \"https://api.line.me/oauth2/v2.1/token\";\n  const userInfoEndpoint = \"https://api.line.me/oauth2/v2.1/userinfo\";\n  const verifyIdTokenEndpoint = \"https://api.line.me/oauth2/v2.1/verify\";\n  return {\n    id: \"line\",\n    name: \"LINE\",\n    async createAuthorizationURL({\n      state,\n      scopes,\n      codeVerifier,\n      redirectURI,\n      loginHint\n    }) {\n      const _scopes = options.disableDefaultScope ? [] : [\"openid\", \"profile\", \"email\"];\n      options.scope && _scopes.push(...options.scope);\n      scopes && _scopes.push(...scopes);\n      return await (0,_better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.createAuthorizationURL)({\n        id: \"line\",\n        options,\n        authorizationEndpoint,\n        scopes: _scopes,\n        state,\n        codeVerifier,\n        redirectURI,\n        loginHint\n      });\n    },\n    validateAuthorizationCode: async ({ code, codeVerifier, redirectURI }) => {\n      return (0,_better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.validateAuthorizationCode)({\n        code,\n        codeVerifier,\n        redirectURI,\n        options,\n        tokenEndpoint\n      });\n    },\n    refreshAccessToken: options.refreshAccessToken ? options.refreshAccessToken : async (refreshToken) => {\n      return (0,_better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.refreshAccessToken)({\n        refreshToken,\n        options: {\n          clientId: options.clientId,\n          clientSecret: options.clientSecret\n        },\n        tokenEndpoint\n      });\n    },\n    async verifyIdToken(token, nonce) {\n      if (options.disableIdTokenSignIn) {\n        return false;\n      }\n      if (options.verifyIdToken) {\n        return options.verifyIdToken(token, nonce);\n      }\n      const body = new URLSearchParams();\n      body.set(\"id_token\", token);\n      body.set(\"client_id\", options.clientId);\n      if (nonce) body.set(\"nonce\", nonce);\n      const { data, error } = await (0,_better_fetch_fetch__WEBPACK_IMPORTED_MODULE_0__.betterFetch)(\n        verifyIdTokenEndpoint,\n        {\n          method: \"POST\",\n          headers: {\n            \"content-type\": \"application/x-www-form-urlencoded\"\n          },\n          body\n        }\n      );\n      if (error || !data) {\n        return false;\n      }\n      if (data.aud !== options.clientId) return false;\n      if (nonce && data.nonce && data.nonce !== nonce) return false;\n      return true;\n    },\n    async getUserInfo(token) {\n      if (options.getUserInfo) {\n        return options.getUserInfo(token);\n      }\n      let profile = null;\n      if (token.idToken) {\n        try {\n          profile = (0,jose__WEBPACK_IMPORTED_MODULE_9__.decodeJwt)(token.idToken);\n        } catch {\n        }\n      }\n      if (!profile) {\n        const { data } = await (0,_better_fetch_fetch__WEBPACK_IMPORTED_MODULE_0__.betterFetch)(userInfoEndpoint, {\n          headers: {\n            authorization: `Bearer ${token.accessToken}`\n          }\n        });\n        profile = data || null;\n      }\n      if (!profile) return null;\n      const userMap = await options.mapProfileToUser?.(profile);\n      const id = profile.sub || profile.userId;\n      const name = profile.name || profile.displayName;\n      const image = profile.picture || profile.pictureUrl || void 0;\n      const email = profile.email;\n      return {\n        user: {\n          id,\n          name,\n          email,\n          image,\n          // LINE does not expose email verification status in ID token/userinfo\n          emailVerified: false,\n          ...userMap\n        },\n        data: profile\n      };\n    },\n    options\n  };\n};\n\nconst paypal = (options) => {\n  const environment = options.environment || \"sandbox\";\n  const isSandbox = environment === \"sandbox\";\n  const authorizationEndpoint = isSandbox ? \"https://www.sandbox.paypal.com/signin/authorize\" : \"https://www.paypal.com/signin/authorize\";\n  const tokenEndpoint = isSandbox ? \"https://api-m.sandbox.paypal.com/v1/oauth2/token\" : \"https://api-m.paypal.com/v1/oauth2/token\";\n  const userInfoEndpoint = isSandbox ? \"https://api-m.sandbox.paypal.com/v1/identity/oauth2/userinfo\" : \"https://api-m.paypal.com/v1/identity/oauth2/userinfo\";\n  return {\n    id: \"paypal\",\n    name: \"PayPal\",\n    async createAuthorizationURL({ state, codeVerifier, redirectURI }) {\n      if (!options.clientId || !options.clientSecret) {\n        _better_auth_core_env__WEBPACK_IMPORTED_MODULE_4__.logger.error(\n          \"Client Id and Client Secret is required for PayPal. Make sure to provide them in the options.\"\n        );\n        throw new _error_index_mjs__WEBPACK_IMPORTED_MODULE_3__.BetterAuthError(\"CLIENT_ID_AND_SECRET_REQUIRED\");\n      }\n      const _scopes = [];\n      const url = await (0,_better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.createAuthorizationURL)({\n        id: \"paypal\",\n        options,\n        authorizationEndpoint,\n        scopes: _scopes,\n        state,\n        codeVerifier,\n        redirectURI,\n        prompt: options.prompt\n      });\n      return url;\n    },\n    validateAuthorizationCode: async ({ code, redirectURI }) => {\n      const credentials = _better_auth_utils_base64__WEBPACK_IMPORTED_MODULE_5__.base64.encode(\n        `${options.clientId}:${options.clientSecret}`\n      );\n      try {\n        const response = await (0,_better_fetch_fetch__WEBPACK_IMPORTED_MODULE_0__.betterFetch)(tokenEndpoint, {\n          method: \"POST\",\n          headers: {\n            Authorization: `Basic ${credentials}`,\n            Accept: \"application/json\",\n            \"Accept-Language\": \"en_US\",\n            \"Content-Type\": \"application/x-www-form-urlencoded\"\n          },\n          body: new URLSearchParams({\n            grant_type: \"authorization_code\",\n            code,\n            redirect_uri: redirectURI\n          }).toString()\n        });\n        if (!response.data) {\n          throw new _error_index_mjs__WEBPACK_IMPORTED_MODULE_3__.BetterAuthError(\"FAILED_TO_GET_ACCESS_TOKEN\");\n        }\n        const data = response.data;\n        const result = {\n          accessToken: data.access_token,\n          refreshToken: data.refresh_token,\n          accessTokenExpiresAt: data.expires_in ? new Date(Date.now() + data.expires_in * 1e3) : void 0,\n          idToken: data.id_token\n        };\n        return result;\n      } catch (error) {\n        _better_auth_core_env__WEBPACK_IMPORTED_MODULE_4__.logger.error(\"PayPal token exchange failed:\", error);\n        throw new _error_index_mjs__WEBPACK_IMPORTED_MODULE_3__.BetterAuthError(\"FAILED_TO_GET_ACCESS_TOKEN\");\n      }\n    },\n    refreshAccessToken: options.refreshAccessToken ? options.refreshAccessToken : async (refreshToken) => {\n      const credentials = _better_auth_utils_base64__WEBPACK_IMPORTED_MODULE_5__.base64.encode(\n        `${options.clientId}:${options.clientSecret}`\n      );\n      try {\n        const response = await (0,_better_fetch_fetch__WEBPACK_IMPORTED_MODULE_0__.betterFetch)(tokenEndpoint, {\n          method: \"POST\",\n          headers: {\n            Authorization: `Basic ${credentials}`,\n            Accept: \"application/json\",\n            \"Accept-Language\": \"en_US\",\n            \"Content-Type\": \"application/x-www-form-urlencoded\"\n          },\n          body: new URLSearchParams({\n            grant_type: \"refresh_token\",\n            refresh_token: refreshToken\n          }).toString()\n        });\n        if (!response.data) {\n          throw new _error_index_mjs__WEBPACK_IMPORTED_MODULE_3__.BetterAuthError(\"FAILED_TO_REFRESH_ACCESS_TOKEN\");\n        }\n        const data = response.data;\n        return {\n          accessToken: data.access_token,\n          refreshToken: data.refresh_token,\n          accessTokenExpiresAt: data.expires_in ? new Date(Date.now() + data.expires_in * 1e3) : void 0\n        };\n      } catch (error) {\n        _better_auth_core_env__WEBPACK_IMPORTED_MODULE_4__.logger.error(\"PayPal token refresh failed:\", error);\n        throw new _error_index_mjs__WEBPACK_IMPORTED_MODULE_3__.BetterAuthError(\"FAILED_TO_REFRESH_ACCESS_TOKEN\");\n      }\n    },\n    async verifyIdToken(token, nonce) {\n      if (options.disableIdTokenSignIn) {\n        return false;\n      }\n      if (options.verifyIdToken) {\n        return options.verifyIdToken(token, nonce);\n      }\n      try {\n        const payload = (0,jose__WEBPACK_IMPORTED_MODULE_9__.decodeJwt)(token);\n        return !!payload.sub;\n      } catch (error) {\n        _better_auth_core_env__WEBPACK_IMPORTED_MODULE_4__.logger.error(\"Failed to verify PayPal ID token:\", error);\n        return false;\n      }\n    },\n    async getUserInfo(token) {\n      if (options.getUserInfo) {\n        return options.getUserInfo(token);\n      }\n      if (!token.accessToken) {\n        _better_auth_core_env__WEBPACK_IMPORTED_MODULE_4__.logger.error(\"Access token is required to fetch PayPal user info\");\n        return null;\n      }\n      try {\n        const response = await (0,_better_fetch_fetch__WEBPACK_IMPORTED_MODULE_0__.betterFetch)(\n          `${userInfoEndpoint}?schema=paypalv1.1`,\n          {\n            headers: {\n              Authorization: `Bearer ${token.accessToken}`,\n              Accept: \"application/json\"\n            }\n          }\n        );\n        if (!response.data) {\n          _better_auth_core_env__WEBPACK_IMPORTED_MODULE_4__.logger.error(\"Failed to fetch user info from PayPal\");\n          return null;\n        }\n        const userInfo = response.data;\n        const userMap = await options.mapProfileToUser?.(userInfo);\n        const result = {\n          user: {\n            id: userInfo.user_id,\n            name: userInfo.name,\n            email: userInfo.email,\n            image: userInfo.picture,\n            emailVerified: userInfo.email_verified,\n            ...userMap\n          },\n          data: userInfo\n        };\n        return result;\n      } catch (error) {\n        _better_auth_core_env__WEBPACK_IMPORTED_MODULE_4__.logger.error(\"Failed to fetch user info from PayPal:\", error);\n        return null;\n      }\n    },\n    options\n  };\n};\n\nconst socialProviders = {\n  apple,\n  atlassian,\n  cognito,\n  discord,\n  facebook,\n  figma,\n  github,\n  microsoft,\n  google,\n  huggingface,\n  slack,\n  spotify,\n  twitch,\n  twitter,\n  dropbox,\n  kick,\n  linear,\n  linkedin,\n  gitlab,\n  tiktok,\n  reddit,\n  roblox,\n  salesforce,\n  vk,\n  zoom,\n  notion,\n  kakao,\n  naver,\n  line,\n  paypal\n};\nconst socialProviderList = Object.keys(socialProviders);\nconst SocialProviderListEnum = zod__WEBPACK_IMPORTED_MODULE_12__[\"enum\"](socialProviderList).or(zod__WEBPACK_IMPORTED_MODULE_12__.string());\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFjdGlvbi1icm93c2VyKS8uL25vZGVfbW9kdWxlcy9AYmV0dGVyLWF1dGgvY29yZS9kaXN0L3NvY2lhbC1wcm92aWRlcnMvaW5kZXgubWpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUF5QjtBQUN5QjtBQUNYO0FBQzJEO0FBQ3VEO0FBQ3BHO0FBQ047QUFDSTtBQUNsQjs7QUFFakM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1DQUFtQyw0QkFBNEI7QUFDL0Q7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLGdGQUFzQjtBQUM5QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0EsS0FBSztBQUNMLHdDQUF3QyxpQ0FBaUM7QUFDekUsYUFBYSxtRkFBeUI7QUFDdEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUCxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw0QkFBNEIsMkRBQXFCO0FBQ2pELGNBQWMsbUJBQW1CO0FBQ2pDO0FBQ0E7QUFDQSxjQUFjLHFCQUFxQixRQUFRLCtDQUFTO0FBQ3BEO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsYUFBYSw0RUFBa0I7QUFDL0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBLE9BQU87QUFDUCxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxzQkFBc0IsK0NBQVM7QUFDL0I7QUFDQTtBQUNBO0FBQ0EsbUNBQW1DLDRCQUE0QixFQUFFLDBCQUEwQjtBQUMzRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtB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Q0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBLFFBQVE7QUFDUixRQUFRLHlEQUFNO0FBQ2Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsK0JBQStCLHlDQUFNLHdCQUF3Qix3Q0FBUTs7QUFFbVMiLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcc2lkMDFcXE9uZURyaXZlXFxEZXNrdG9wXFxhbWQtdGVsZXBob255LXN5c3RlbVxcZnJvbnRlbmRcXG5vZGVfbW9kdWxlc1xcQGJldHRlci1hdXRoXFxjb3JlXFxkaXN0XFxzb2NpYWwtcHJvdmlkZXJzXFxpbmRleC5tanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0ICogYXMgeiBmcm9tICd6b2QnO1xuaW1wb3J0IHsgYmV0dGVyRmV0Y2ggfSBmcm9tICdAYmV0dGVyLWZldGNoL2ZldGNoJztcbmltcG9ydCB7IEFQSUVycm9yIH0gZnJvbSAnYmV0dGVyLWNhbGwnO1xuaW1wb3J0IHsgZGVjb2RlSnd0LCBkZWNvZGVQcm90ZWN0ZWRIZWFkZXIsIGp3dFZlcmlmeSwgaW1wb3J0SldLLCBjcmVhdGVSZW1vdGVKV0tTZXQgfSBmcm9tICdqb3NlJztcbmltcG9ydCB7IHJlZnJlc2hBY2Nlc3NUb2tlbiwgdmFsaWRhdGVBdXRob3JpemF0aW9uQ29kZSwgY3JlYXRlQXV0aG9yaXphdGlvblVSTCwgZ2V0T0F1dGgyVG9rZW5zLCBnZW5lcmF0ZUNvZGVDaGFsbGVuZ2UgfSBmcm9tICdAYmV0dGVyLWF1dGgvY29yZS9vYXV0aDInO1xuaW1wb3J0IHsgQmV0dGVyQXV0aEVycm9yIH0gZnJvbSAnLi4vZXJyb3IvaW5kZXgubWpzJztcbmltcG9ydCB7IGxvZ2dlciB9IGZyb20gJ0BiZXR0ZXItYXV0aC9jb3JlL2Vudic7XG5pbXBvcnQgeyBiYXNlNjQgfSBmcm9tICdAYmV0dGVyLWF1dGgvdXRpbHMvYmFzZTY0JztcbmltcG9ydCAnQGJldHRlci1hdXRoL2NvcmUvdXRpbHMnO1xuXG5jb25zdCBhcHBsZSA9IChvcHRpb25zKSA9PiB7XG4gIGNvbnN0IHRva2VuRW5kcG9pbnQgPSBcImh0dHBzOi8vYXBwbGVpZC5hcHBsZS5jb20vYXV0aC90b2tlblwiO1xuICByZXR1cm4ge1xuICAgIGlkOiBcImFwcGxlXCIsXG4gICAgbmFtZTogXCJBcHBsZVwiLFxuICAgIGFzeW5jIGNyZWF0ZUF1dGhvcml6YXRpb25VUkwoeyBzdGF0ZSwgc2NvcGVzLCByZWRpcmVjdFVSSSB9KSB7XG4gICAgICBjb25zdCBfc2NvcGUgPSBvcHRpb25zLmRpc2FibGVEZWZhdWx0U2NvcGUgPyBbXSA6IFtcImVtYWlsXCIsIFwibmFtZVwiXTtcbiAgICAgIG9wdGlvbnMuc2NvcGUgJiYgX3Njb3BlLnB1c2goLi4ub3B0aW9ucy5zY29wZSk7XG4gICAgICBzY29wZXMgJiYgX3Njb3BlLnB1c2goLi4uc2NvcGVzKTtcbiAgICAgIGNvbnN0IHVybCA9IGF3YWl0IGNyZWF0ZUF1dGhvcml6YXRpb25VUkwoe1xuICAgICAgICBpZDogXCJhcHBsZVwiLFxuICAgICAgICBvcHRpb25zLFxuICAgICAgICBhdXRob3JpemF0aW9uRW5kcG9pbnQ6IFwiaHR0cHM6Ly9hcHBsZWlkLmFwcGxlLmNvbS9hdXRoL2F1dGhvcml6ZVwiLFxuICAgICAgICBzY29wZXM6IF9zY29wZSxcbiAgICAgICAgc3RhdGUsXG4gICAgICAgIHJlZGlyZWN0VVJJLFxuICAgICAgICByZXNwb25zZU1vZGU6IFwiZm9ybV9wb3N0XCIsXG4gICAgICAgIHJlc3BvbnNlVHlwZTogXCJjb2RlIGlkX3Rva2VuXCJcbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIHVybDtcbiAgICB9LFxuICAgIHZhbGlkYXRlQXV0aG9yaXphdGlvbkNvZGU6IGFzeW5jICh7IGNvZGUsIGNvZGVWZXJpZmllciwgcmVkaXJlY3RVUkkgfSkgPT4ge1xuICAgICAgcmV0dXJuIHZhbGlkYXRlQXV0aG9yaXphdGlvbkNvZGUoe1xuICAgICAgICBjb2RlLFxuICAgICAgICBjb2RlVmVyaWZpZXIsXG4gICAgICAgIHJlZGlyZWN0VVJJLFxuICAgICAgICBvcHRpb25zLFxuICAgICAgICB0b2tlbkVuZHBvaW50XG4gICAgICB9KTtcbiAgICB9LFxuICAgIGFzeW5jIHZlcmlmeUlkVG9rZW4odG9rZW4sIG5vbmNlKSB7XG4gICAgICBpZiAob3B0aW9ucy5kaXNhYmxlSWRUb2tlblNpZ25Jbikge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9XG4gICAgICBpZiAob3B0aW9ucy52ZXJpZnlJZFRva2VuKSB7XG4gICAgICAgIHJldHVybiBvcHRpb25zLnZlcmlmeUlkVG9rZW4odG9rZW4sIG5vbmNlKTtcbiAgICAgIH1cbiAgICAgIGNvbnN0IGRlY29kZWRIZWFkZXIgPSBkZWNvZGVQcm90ZWN0ZWRIZWFkZXIodG9rZW4pO1xuICAgICAgY29uc3QgeyBraWQsIGFsZzogand0QWxnIH0gPSBkZWNvZGVkSGVhZGVyO1xuICAgICAgaWYgKCFraWQgfHwgIWp3dEFsZykgcmV0dXJuIGZhbHNlO1xuICAgICAgY29uc3QgcHVibGljS2V5ID0gYXdhaXQgZ2V0QXBwbGVQdWJsaWNLZXkoa2lkKTtcbiAgICAgIGNvbnN0IHsgcGF5bG9hZDogand0Q2xhaW1zIH0gPSBhd2FpdCBqd3RWZXJpZnkodG9rZW4sIHB1YmxpY0tleSwge1xuICAgICAgICBhbGdvcml0aG1zOiBband0QWxnXSxcbiAgICAgICAgaXNzdWVyOiBcImh0dHBzOi8vYXBwbGVpZC5hcHBsZS5jb21cIixcbiAgICAgICAgYXVkaWVuY2U6IG9wdGlvbnMuYXVkaWVuY2UgJiYgb3B0aW9ucy5hdWRpZW5jZS5sZW5ndGggPyBvcHRpb25zLmF1ZGllbmNlIDogb3B0aW9ucy5hcHBCdW5kbGVJZGVudGlmaWVyID8gb3B0aW9ucy5hcHBCdW5kbGVJZGVudGlmaWVyIDogb3B0aW9ucy5jbGllbnRJZCxcbiAgICAgICAgbWF4VG9rZW5BZ2U6IFwiMWhcIlxuICAgICAgfSk7XG4gICAgICBbXCJlbWFpbF92ZXJpZmllZFwiLCBcImlzX3ByaXZhdGVfZW1haWxcIl0uZm9yRWFjaCgoZmllbGQpID0+IHtcbiAgICAgICAgaWYgKGp3dENsYWltc1tmaWVsZF0gIT09IHZvaWQgMCkge1xuICAgICAgICAgIGp3dENsYWltc1tmaWVsZF0gPSBCb29sZWFuKGp3dENsYWltc1tmaWVsZF0pO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICAgIGlmIChub25jZSAmJiBqd3RDbGFpbXMubm9uY2UgIT09IG5vbmNlKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH1cbiAgICAgIHJldHVybiAhIWp3dENsYWltcztcbiAgICB9LFxuICAgIHJlZnJlc2hBY2Nlc3NUb2tlbjogb3B0aW9ucy5yZWZyZXNoQWNjZXNzVG9rZW4gPyBvcHRpb25zLnJlZnJlc2hBY2Nlc3NUb2tlbiA6IGFzeW5jIChyZWZyZXNoVG9rZW4pID0+IHtcbiAgICAgIHJldHVybiByZWZyZXNoQWNjZXNzVG9rZW4oe1xuICAgICAgICByZWZyZXNoVG9rZW4sXG4gICAgICAgIG9wdGlvbnM6IHtcbiAgICAgICAgICBjbGllbnRJZDogb3B0aW9ucy5jbGllbnRJZCxcbiAgICAgICAgICBjbGllbnRLZXk6IG9wdGlvbnMuY2xpZW50S2V5LFxuICAgICAgICAgIGNsaWVudFNlY3JldDogb3B0aW9ucy5jbGllbnRTZWNyZXRcbiAgICAgICAgfSxcbiAgICAgICAgdG9rZW5FbmRwb2ludDogXCJodHRwczovL2FwcGxlaWQuYXBwbGUuY29tL2F1dGgvdG9rZW5cIlxuICAgICAgfSk7XG4gICAgfSxcbiAgICBhc3luYyBnZXRVc2VySW5mbyh0b2tlbikge1xuICAgICAgaWYgKG9wdGlvbnMuZ2V0VXNlckluZm8pIHtcbiAgICAgICAgcmV0dXJuIG9wdGlvbnMuZ2V0VXNlckluZm8odG9rZW4pO1xuICAgICAgfVxuICAgICAgaWYgKCF0b2tlbi5pZFRva2VuKSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgICAgfVxuICAgICAgY29uc3QgcHJvZmlsZSA9IGRlY29kZUp3dCh0b2tlbi5pZFRva2VuKTtcbiAgICAgIGlmICghcHJvZmlsZSkge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgIH1cbiAgICAgIGNvbnN0IG5hbWUgPSB0b2tlbi51c2VyID8gYCR7dG9rZW4udXNlci5uYW1lPy5maXJzdE5hbWV9ICR7dG9rZW4udXNlci5uYW1lPy5sYXN0TmFtZX1gIDogcHJvZmlsZS5uYW1lIHx8IHByb2ZpbGUuZW1haWw7XG4gICAgICBjb25zdCBlbWFpbFZlcmlmaWVkID0gdHlwZW9mIHByb2ZpbGUuZW1haWxfdmVyaWZpZWQgPT09IFwiYm9vbGVhblwiID8gcHJvZmlsZS5lbWFpbF92ZXJpZmllZCA6IHByb2ZpbGUuZW1haWxfdmVyaWZpZWQgPT09IFwidHJ1ZVwiO1xuICAgICAgY29uc3QgZW5yaWNoZWRQcm9maWxlID0ge1xuICAgICAgICAuLi5wcm9maWxlLFxuICAgICAgICBuYW1lXG4gICAgICB9O1xuICAgICAgY29uc3QgdXNlck1hcCA9IGF3YWl0IG9wdGlvbnMubWFwUHJvZmlsZVRvVXNlcj8uKGVucmljaGVkUHJvZmlsZSk7XG4gICAgICByZXR1cm4ge1xuICAgICAgICB1c2VyOiB7XG4gICAgICAgICAgaWQ6IHByb2ZpbGUuc3ViLFxuICAgICAgICAgIG5hbWU6IGVucmljaGVkUHJvZmlsZS5uYW1lLFxuICAgICAgICAgIGVtYWlsVmVyaWZpZWQsXG4gICAgICAgICAgZW1haWw6IHByb2ZpbGUuZW1haWwsXG4gICAgICAgICAgLi4udXNlck1hcFxuICAgICAgICB9LFxuICAgICAgICBkYXRhOiBlbnJpY2hlZFByb2ZpbGVcbiAgICAgIH07XG4gICAgfSxcbiAgICBvcHRpb25zXG4gIH07XG59O1xuY29uc3QgZ2V0QXBwbGVQdWJsaWNLZXkgPSBhc3luYyAoa2lkKSA9PiB7XG4gIGNvbnN0IEFQUExFX0JBU0VfVVJMID0gXCJodHRwczovL2FwcGxlaWQuYXBwbGUuY29tXCI7XG4gIGNvbnN0IEpXS1NfQVBQTEVfVVJJID0gXCIvYXV0aC9rZXlzXCI7XG4gIGNvbnN0IHsgZGF0YSB9ID0gYXdhaXQgYmV0dGVyRmV0Y2goYCR7QVBQTEVfQkFTRV9VUkx9JHtKV0tTX0FQUExFX1VSSX1gKTtcbiAgaWYgKCFkYXRhPy5rZXlzKSB7XG4gICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiQkFEX1JFUVVFU1RcIiwge1xuICAgICAgbWVzc2FnZTogXCJLZXlzIG5vdCBmb3VuZFwiXG4gICAgfSk7XG4gIH1cbiAgY29uc3QgandrID0gZGF0YS5rZXlzLmZpbmQoKGtleSkgPT4ga2V5LmtpZCA9PT0ga2lkKTtcbiAgaWYgKCFqd2spIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoYEpXSyB3aXRoIGtpZCAke2tpZH0gbm90IGZvdW5kYCk7XG4gIH1cbiAgcmV0dXJuIGF3YWl0IGltcG9ydEpXSyhqd2ssIGp3ay5hbGcpO1xufTtcblxuY29uc3QgYXRsYXNzaWFuID0gKG9wdGlvbnMpID0+IHtcbiAgcmV0dXJuIHtcbiAgICBpZDogXCJhdGxhc3NpYW5cIixcbiAgICBuYW1lOiBcIkF0bGFzc2lhblwiLFxuICAgIGFzeW5jIGNyZWF0ZUF1dGhvcml6YXRpb25VUkwoeyBzdGF0ZSwgc2NvcGVzLCBjb2RlVmVyaWZpZXIsIHJlZGlyZWN0VVJJIH0pIHtcbiAgICAgIGlmICghb3B0aW9ucy5jbGllbnRJZCB8fCAhb3B0aW9ucy5jbGllbnRTZWNyZXQpIHtcbiAgICAgICAgbG9nZ2VyLmVycm9yKFwiQ2xpZW50IElkIGFuZCBTZWNyZXQgYXJlIHJlcXVpcmVkIGZvciBBdGxhc3NpYW5cIik7XG4gICAgICAgIHRocm93IG5ldyBCZXR0ZXJBdXRoRXJyb3IoXCJDTElFTlRfSURfQU5EX1NFQ1JFVF9SRVFVSVJFRFwiKTtcbiAgICAgIH1cbiAgICAgIGlmICghY29kZVZlcmlmaWVyKSB7XG4gICAgICAgIHRocm93IG5ldyBCZXR0ZXJBdXRoRXJyb3IoXCJjb2RlVmVyaWZpZXIgaXMgcmVxdWlyZWQgZm9yIEF0bGFzc2lhblwiKTtcbiAgICAgIH1cbiAgICAgIGNvbnN0IF9zY29wZXMgPSBvcHRpb25zLmRpc2FibGVEZWZhdWx0U2NvcGUgPyBbXSA6IFtcInJlYWQ6amlyYS11c2VyXCIsIFwib2ZmbGluZV9hY2Nlc3NcIl07XG4gICAgICBvcHRpb25zLnNjb3BlICYmIF9zY29wZXMucHVzaCguLi5vcHRpb25zLnNjb3BlKTtcbiAgICAgIHNjb3BlcyAmJiBfc2NvcGVzLnB1c2goLi4uc2NvcGVzKTtcbiAgICAgIHJldHVybiBjcmVhdGVBdXRob3JpemF0aW9uVVJMKHtcbiAgICAgICAgaWQ6IFwiYXRsYXNzaWFuXCIsXG4gICAgICAgIG9wdGlvbnMsXG4gICAgICAgIGF1dGhvcml6YXRpb25FbmRwb2ludDogXCJodHRwczovL2F1dGguYXRsYXNzaWFuLmNvbS9hdXRob3JpemVcIixcbiAgICAgICAgc2NvcGVzOiBfc2NvcGVzLFxuICAgICAgICBzdGF0ZSxcbiAgICAgICAgY29kZVZlcmlmaWVyLFxuICAgICAgICByZWRpcmVjdFVSSSxcbiAgICAgICAgYWRkaXRpb25hbFBhcmFtczoge1xuICAgICAgICAgIGF1ZGllbmNlOiBcImFwaS5hdGxhc3NpYW4uY29tXCJcbiAgICAgICAgfSxcbiAgICAgICAgcHJvbXB0OiBvcHRpb25zLnByb21wdFxuICAgICAgfSk7XG4gICAgfSxcbiAgICB2YWxpZGF0ZUF1dGhvcml6YXRpb25Db2RlOiBhc3luYyAoeyBjb2RlLCBjb2RlVmVyaWZpZXIsIHJlZGlyZWN0VVJJIH0pID0+IHtcbiAgICAgIHJldHVybiB2YWxpZGF0ZUF1dGhvcml6YXRpb25Db2RlKHtcbiAgICAgICAgY29kZSxcbiAgICAgICAgY29kZVZlcmlmaWVyLFxuICAgICAgICByZWRpcmVjdFVSSSxcbiAgICAgICAgb3B0aW9ucyxcbiAgICAgICAgdG9rZW5FbmRwb2ludDogXCJodHRwczovL2F1dGguYXRsYXNzaWFuLmNvbS9vYXV0aC90b2tlblwiXG4gICAgICB9KTtcbiAgICB9LFxuICAgIHJlZnJlc2hBY2Nlc3NUb2tlbjogb3B0aW9ucy5yZWZyZXNoQWNjZXNzVG9rZW4gPyBvcHRpb25zLnJlZnJlc2hBY2Nlc3NUb2tlbiA6IGFzeW5jIChyZWZyZXNoVG9rZW4pID0+IHtcbiAgICAgIHJldHVybiByZWZyZXNoQWNjZXNzVG9rZW4oe1xuICAgICAgICByZWZyZXNoVG9rZW4sXG4gICAgICAgIG9wdGlvbnM6IHtcbiAgICAgICAgICBjbGllbnRJZDogb3B0aW9ucy5jbGllbnRJZCxcbiAgICAgICAgICBjbGllbnRTZWNyZXQ6IG9wdGlvbnMuY2xpZW50U2VjcmV0XG4gICAgICAgIH0sXG4gICAgICAgIHRva2VuRW5kcG9pbnQ6IFwiaHR0cHM6Ly9hdXRoLmF0bGFzc2lhbi5jb20vb2F1dGgvdG9rZW5cIlxuICAgICAgfSk7XG4gICAgfSxcbiAgICBhc3luYyBnZXRVc2VySW5mbyh0b2tlbikge1xuICAgICAgaWYgKG9wdGlvbnMuZ2V0VXNlckluZm8pIHtcbiAgICAgICAgcmV0dXJuIG9wdGlvbnMuZ2V0VXNlckluZm8odG9rZW4pO1xuICAgICAgfVxuICAgICAgaWYgKCF0b2tlbi5hY2Nlc3NUb2tlbikge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgIH1cbiAgICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IHsgZGF0YTogcHJvZmlsZSB9ID0gYXdhaXQgYmV0dGVyRmV0Y2goXCJodHRwczovL2FwaS5hdGxhc3NpYW4uY29tL21lXCIsIHtcbiAgICAgICAgICBoZWFkZXJzOiB7IEF1dGhvcml6YXRpb246IGBCZWFyZXIgJHt0b2tlbi5hY2Nlc3NUb2tlbn1gIH1cbiAgICAgICAgfSk7XG4gICAgICAgIGlmICghcHJvZmlsZSkgcmV0dXJuIG51bGw7XG4gICAgICAgIGNvbnN0IHVzZXJNYXAgPSBhd2FpdCBvcHRpb25zLm1hcFByb2ZpbGVUb1VzZXI/Lihwcm9maWxlKTtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICB1c2VyOiB7XG4gICAgICAgICAgICBpZDogcHJvZmlsZS5hY2NvdW50X2lkLFxuICAgICAgICAgICAgbmFtZTogcHJvZmlsZS5uYW1lLFxuICAgICAgICAgICAgZW1haWw6IHByb2ZpbGUuZW1haWwsXG4gICAgICAgICAgICBpbWFnZTogcHJvZmlsZS5waWN0dXJlLFxuICAgICAgICAgICAgZW1haWxWZXJpZmllZDogZmFsc2UsXG4gICAgICAgICAgICAuLi51c2VyTWFwXG4gICAgICAgICAgfSxcbiAgICAgICAgICBkYXRhOiBwcm9maWxlXG4gICAgICAgIH07XG4gICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICBsb2dnZXIuZXJyb3IoXCJGYWlsZWQgdG8gZmV0Y2ggdXNlciBpbmZvIGZyb20gRmlnbWE6XCIsIGVycm9yKTtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICB9XG4gICAgfSxcbiAgICBvcHRpb25zXG4gIH07XG59O1xuXG5jb25zdCBjb2duaXRvID0gKG9wdGlvbnMpID0+IHtcbiAgaWYgKCFvcHRpb25zLmRvbWFpbiB8fCAhb3B0aW9ucy5yZWdpb24gfHwgIW9wdGlvbnMudXNlclBvb2xJZCkge1xuICAgIGxvZ2dlci5lcnJvcihcbiAgICAgIFwiRG9tYWluLCByZWdpb24gYW5kIHVzZXJQb29sSWQgYXJlIHJlcXVpcmVkIGZvciBBbWF6b24gQ29nbml0by4gTWFrZSBzdXJlIHRvIHByb3ZpZGUgdGhlbSBpbiB0aGUgb3B0aW9ucy5cIlxuICAgICk7XG4gICAgdGhyb3cgbmV3IEJldHRlckF1dGhFcnJvcihcIkRPTUFJTl9BTkRfUkVHSU9OX1JFUVVJUkVEXCIpO1xuICB9XG4gIGNvbnN0IGNsZWFuRG9tYWluID0gb3B0aW9ucy5kb21haW4ucmVwbGFjZSgvXmh0dHBzPzpcXC9cXC8vLCBcIlwiKTtcbiAgY29uc3QgYXV0aG9yaXphdGlvbkVuZHBvaW50ID0gYGh0dHBzOi8vJHtjbGVhbkRvbWFpbn0vb2F1dGgyL2F1dGhvcml6ZWA7XG4gIGNvbnN0IHRva2VuRW5kcG9pbnQgPSBgaHR0cHM6Ly8ke2NsZWFuRG9tYWlufS9vYXV0aDIvdG9rZW5gO1xuICBjb25zdCB1c2VySW5mb0VuZHBvaW50ID0gYGh0dHBzOi8vJHtjbGVhbkRvbWFpbn0vb2F1dGgyL3VzZXJpbmZvYDtcbiAgcmV0dXJuIHtcbiAgICBpZDogXCJjb2duaXRvXCIsXG4gICAgbmFtZTogXCJDb2duaXRvXCIsXG4gICAgYXN5bmMgY3JlYXRlQXV0aG9yaXphdGlvblVSTCh7IHN0YXRlLCBzY29wZXMsIGNvZGVWZXJpZmllciwgcmVkaXJlY3RVUkkgfSkge1xuICAgICAgaWYgKCFvcHRpb25zLmNsaWVudElkKSB7XG4gICAgICAgIGxvZ2dlci5lcnJvcihcbiAgICAgICAgICBcIkNsaWVudElkIGlzIHJlcXVpcmVkIGZvciBBbWF6b24gQ29nbml0by4gTWFrZSBzdXJlIHRvIHByb3ZpZGUgdGhlbSBpbiB0aGUgb3B0aW9ucy5cIlxuICAgICAgICApO1xuICAgICAgICB0aHJvdyBuZXcgQmV0dGVyQXV0aEVycm9yKFwiQ0xJRU5UX0lEX0FORF9TRUNSRVRfUkVRVUlSRURcIik7XG4gICAgICB9XG4gICAgICBpZiAob3B0aW9ucy5yZXF1aXJlQ2xpZW50U2VjcmV0ICYmICFvcHRpb25zLmNsaWVudFNlY3JldCkge1xuICAgICAgICBsb2dnZXIuZXJyb3IoXG4gICAgICAgICAgXCJDbGllbnQgU2VjcmV0IGlzIHJlcXVpcmVkIHdoZW4gcmVxdWlyZUNsaWVudFNlY3JldCBpcyB0cnVlLiBNYWtlIHN1cmUgdG8gcHJvdmlkZSBpdCBpbiB0aGUgb3B0aW9ucy5cIlxuICAgICAgICApO1xuICAgICAgICB0aHJvdyBuZXcgQmV0dGVyQXV0aEVycm9yKFwiQ0xJRU5UX1NFQ1JFVF9SRVFVSVJFRFwiKTtcbiAgICAgIH1cbiAgICAgIGNvbnN0IF9zY29wZXMgPSBvcHRpb25zLmRpc2FibGVEZWZhdWx0U2NvcGUgPyBbXSA6IFtcIm9wZW5pZFwiLCBcInByb2ZpbGVcIiwgXCJlbWFpbFwiXTtcbiAgICAgIG9wdGlvbnMuc2NvcGUgJiYgX3Njb3Blcy5wdXNoKC4uLm9wdGlvbnMuc2NvcGUpO1xuICAgICAgc2NvcGVzICYmIF9zY29wZXMucHVzaCguLi5zY29wZXMpO1xuICAgICAgY29uc3QgdXJsID0gYXdhaXQgY3JlYXRlQXV0aG9yaXphdGlvblVSTCh7XG4gICAgICAgIGlkOiBcImNvZ25pdG9cIixcbiAgICAgICAgb3B0aW9uczoge1xuICAgICAgICAgIC4uLm9wdGlvbnNcbiAgICAgICAgfSxcbiAgICAgICAgYXV0aG9yaXphdGlvbkVuZHBvaW50LFxuICAgICAgICBzY29wZXM6IF9zY29wZXMsXG4gICAgICAgIHN0YXRlLFxuICAgICAgICBjb2RlVmVyaWZpZXIsXG4gICAgICAgIHJlZGlyZWN0VVJJLFxuICAgICAgICBwcm9tcHQ6IG9wdGlvbnMucHJvbXB0XG4gICAgICB9KTtcbiAgICAgIHJldHVybiB1cmw7XG4gICAgfSxcbiAgICB2YWxpZGF0ZUF1dGhvcml6YXRpb25Db2RlOiBhc3luYyAoeyBjb2RlLCBjb2RlVmVyaWZpZXIsIHJlZGlyZWN0VVJJIH0pID0+IHtcbiAgICAgIHJldHVybiB2YWxpZGF0ZUF1dGhvcml6YXRpb25Db2RlKHtcbiAgICAgICAgY29kZSxcbiAgICAgICAgY29kZVZlcmlmaWVyLFxuICAgICAgICByZWRpcmVjdFVSSSxcbiAgICAgICAgb3B0aW9ucyxcbiAgICAgICAgdG9rZW5FbmRwb2ludFxuICAgICAgfSk7XG4gICAgfSxcbiAgICByZWZyZXNoQWNjZXNzVG9rZW46IG9wdGlvbnMucmVmcmVzaEFjY2Vzc1Rva2VuID8gb3B0aW9ucy5yZWZyZXNoQWNjZXNzVG9rZW4gOiBhc3luYyAocmVmcmVzaFRva2VuKSA9PiB7XG4gICAgICByZXR1cm4gcmVmcmVzaEFjY2Vzc1Rva2VuKHtcbiAgICAgICAgcmVmcmVzaFRva2VuLFxuICAgICAgICBvcHRpb25zOiB7XG4gICAgICAgICAgY2xpZW50SWQ6IG9wdGlvbnMuY2xpZW50SWQsXG4gICAgICAgICAgY2xpZW50S2V5OiBvcHRpb25zLmNsaWVudEtleSxcbiAgICAgICAgICBjbGllbnRTZWNyZXQ6IG9wdGlvbnMuY2xpZW50U2VjcmV0XG4gICAgICAgIH0sXG4gICAgICAgIHRva2VuRW5kcG9pbnRcbiAgICAgIH0pO1xuICAgIH0sXG4gICAgYXN5bmMgdmVyaWZ5SWRUb2tlbih0b2tlbiwgbm9uY2UpIHtcbiAgICAgIGlmIChvcHRpb25zLmRpc2FibGVJZFRva2VuU2lnbkluKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH1cbiAgICAgIGlmIChvcHRpb25zLnZlcmlmeUlkVG9rZW4pIHtcbiAgICAgICAgcmV0dXJuIG9wdGlvbnMudmVyaWZ5SWRUb2tlbih0b2tlbiwgbm9uY2UpO1xuICAgICAgfVxuICAgICAgdHJ5IHtcbiAgICAgICAgY29uc3QgZGVjb2RlZEhlYWRlciA9IGRlY29kZVByb3RlY3RlZEhlYWRlcih0b2tlbik7XG4gICAgICAgIGNvbnN0IHsga2lkLCBhbGc6IGp3dEFsZyB9ID0gZGVjb2RlZEhlYWRlcjtcbiAgICAgICAgaWYgKCFraWQgfHwgIWp3dEFsZykgcmV0dXJuIGZhbHNlO1xuICAgICAgICBjb25zdCBwdWJsaWNLZXkgPSBhd2FpdCBnZXRDb2duaXRvUHVibGljS2V5KFxuICAgICAgICAgIGtpZCxcbiAgICAgICAgICBvcHRpb25zLnJlZ2lvbixcbiAgICAgICAgICBvcHRpb25zLnVzZXJQb29sSWRcbiAgICAgICAgKTtcbiAgICAgICAgY29uc3QgZXhwZWN0ZWRJc3N1ZXIgPSBgaHR0cHM6Ly9jb2duaXRvLWlkcC4ke29wdGlvbnMucmVnaW9ufS5hbWF6b25hd3MuY29tLyR7b3B0aW9ucy51c2VyUG9vbElkfWA7XG4gICAgICAgIGNvbnN0IHsgcGF5bG9hZDogand0Q2xhaW1zIH0gPSBhd2FpdCBqd3RWZXJpZnkodG9rZW4sIHB1YmxpY0tleSwge1xuICAgICAgICAgIGFsZ29yaXRobXM6IFtqd3RBbGddLFxuICAgICAgICAgIGlzc3VlcjogZXhwZWN0ZWRJc3N1ZXIsXG4gICAgICAgICAgYXVkaWVuY2U6IG9wdGlvbnMuY2xpZW50SWQsXG4gICAgICAgICAgbWF4VG9rZW5BZ2U6IFwiMWhcIlxuICAgICAgICB9KTtcbiAgICAgICAgaWYgKG5vbmNlICYmIGp3dENsYWltcy5ub25jZSAhPT0gbm9uY2UpIHtcbiAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICBsb2dnZXIuZXJyb3IoXCJGYWlsZWQgdG8gdmVyaWZ5IElEIHRva2VuOlwiLCBlcnJvcik7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH1cbiAgICB9LFxuICAgIGFzeW5jIGdldFVzZXJJbmZvKHRva2VuKSB7XG4gICAgICBpZiAob3B0aW9ucy5nZXRVc2VySW5mbykge1xuICAgICAgICByZXR1cm4gb3B0aW9ucy5nZXRVc2VySW5mbyh0b2tlbik7XG4gICAgICB9XG4gICAgICBpZiAodG9rZW4uaWRUb2tlbikge1xuICAgICAgICB0cnkge1xuICAgICAgICAgIGNvbnN0IHByb2ZpbGUgPSBkZWNvZGVKd3QodG9rZW4uaWRUb2tlbik7XG4gICAgICAgICAgaWYgKCFwcm9maWxlKSB7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgICB9XG4gICAgICAgICAgY29uc3QgbmFtZSA9IHByb2ZpbGUubmFtZSB8fCBwcm9maWxlLmdpdmVuX25hbWUgfHwgcHJvZmlsZS51c2VybmFtZSB8fCBwcm9maWxlLmVtYWlsO1xuICAgICAgICAgIGNvbnN0IGVucmljaGVkUHJvZmlsZSA9IHtcbiAgICAgICAgICAgIC4uLnByb2ZpbGUsXG4gICAgICAgICAgICBuYW1lXG4gICAgICAgICAgfTtcbiAgICAgICAgICBjb25zdCB1c2VyTWFwID0gYXdhaXQgb3B0aW9ucy5tYXBQcm9maWxlVG9Vc2VyPy4oZW5yaWNoZWRQcm9maWxlKTtcbiAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgdXNlcjoge1xuICAgICAgICAgICAgICBpZDogcHJvZmlsZS5zdWIsXG4gICAgICAgICAgICAgIG5hbWU6IGVucmljaGVkUHJvZmlsZS5uYW1lLFxuICAgICAgICAgICAgICBlbWFpbDogcHJvZmlsZS5lbWFpbCxcbiAgICAgICAgICAgICAgaW1hZ2U6IHByb2ZpbGUucGljdHVyZSxcbiAgICAgICAgICAgICAgZW1haWxWZXJpZmllZDogcHJvZmlsZS5lbWFpbF92ZXJpZmllZCxcbiAgICAgICAgICAgICAgLi4udXNlck1hcFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGRhdGE6IGVucmljaGVkUHJvZmlsZVxuICAgICAgICAgIH07XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgbG9nZ2VyLmVycm9yKFwiRmFpbGVkIHRvIGRlY29kZSBJRCB0b2tlbjpcIiwgZXJyb3IpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBpZiAodG9rZW4uYWNjZXNzVG9rZW4pIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICBjb25zdCB7IGRhdGE6IHVzZXJJbmZvIH0gPSBhd2FpdCBiZXR0ZXJGZXRjaChcbiAgICAgICAgICAgIHVzZXJJbmZvRW5kcG9pbnQsXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAgICAgICBBdXRob3JpemF0aW9uOiBgQmVhcmVyICR7dG9rZW4uYWNjZXNzVG9rZW59YFxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgKTtcbiAgICAgICAgICBpZiAodXNlckluZm8pIHtcbiAgICAgICAgICAgIGNvbnN0IHVzZXJNYXAgPSBhd2FpdCBvcHRpb25zLm1hcFByb2ZpbGVUb1VzZXI/Lih1c2VySW5mbyk7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICB1c2VyOiB7XG4gICAgICAgICAgICAgICAgaWQ6IHVzZXJJbmZvLnN1YixcbiAgICAgICAgICAgICAgICBuYW1lOiB1c2VySW5mby5uYW1lIHx8IHVzZXJJbmZvLmdpdmVuX25hbWUgfHwgdXNlckluZm8udXNlcm5hbWUsXG4gICAgICAgICAgICAgICAgZW1haWw6IHVzZXJJbmZvLmVtYWlsLFxuICAgICAgICAgICAgICAgIGltYWdlOiB1c2VySW5mby5waWN0dXJlLFxuICAgICAgICAgICAgICAgIGVtYWlsVmVyaWZpZWQ6IHVzZXJJbmZvLmVtYWlsX3ZlcmlmaWVkLFxuICAgICAgICAgICAgICAgIC4uLnVzZXJNYXBcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgZGF0YTogdXNlckluZm9cbiAgICAgICAgICAgIH07XG4gICAgICAgICAgfVxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgIGxvZ2dlci5lcnJvcihcIkZhaWxlZCB0byBmZXRjaCB1c2VyIGluZm8gZnJvbSBDb2duaXRvOlwiLCBlcnJvcik7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHJldHVybiBudWxsO1xuICAgIH0sXG4gICAgb3B0aW9uc1xuICB9O1xufTtcbmNvbnN0IGdldENvZ25pdG9QdWJsaWNLZXkgPSBhc3luYyAoa2lkLCByZWdpb24sIHVzZXJQb29sSWQpID0+IHtcbiAgY29uc3QgQ09HTklUT19KV0tTX1VSSSA9IGBodHRwczovL2NvZ25pdG8taWRwLiR7cmVnaW9ufS5hbWF6b25hd3MuY29tLyR7dXNlclBvb2xJZH0vLndlbGwta25vd24vandrcy5qc29uYDtcbiAgdHJ5IHtcbiAgICBjb25zdCB7IGRhdGEgfSA9IGF3YWl0IGJldHRlckZldGNoKENPR05JVE9fSldLU19VUkkpO1xuICAgIGlmICghZGF0YT8ua2V5cykge1xuICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiQkFEX1JFUVVFU1RcIiwge1xuICAgICAgICBtZXNzYWdlOiBcIktleXMgbm90IGZvdW5kXCJcbiAgICAgIH0pO1xuICAgIH1cbiAgICBjb25zdCBqd2sgPSBkYXRhLmtleXMuZmluZCgoa2V5KSA9PiBrZXkua2lkID09PSBraWQpO1xuICAgIGlmICghandrKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYEpXSyB3aXRoIGtpZCAke2tpZH0gbm90IGZvdW5kYCk7XG4gICAgfVxuICAgIHJldHVybiBhd2FpdCBpbXBvcnRKV0soandrLCBqd2suYWxnKTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBsb2dnZXIuZXJyb3IoXCJGYWlsZWQgdG8gZmV0Y2ggQ29nbml0byBwdWJsaWMga2V5OlwiLCBlcnJvcik7XG4gICAgdGhyb3cgZXJyb3I7XG4gIH1cbn07XG5cbmNvbnN0IGRpc2NvcmQgPSAob3B0aW9ucykgPT4ge1xuICByZXR1cm4ge1xuICAgIGlkOiBcImRpc2NvcmRcIixcbiAgICBuYW1lOiBcIkRpc2NvcmRcIixcbiAgICBjcmVhdGVBdXRob3JpemF0aW9uVVJMKHsgc3RhdGUsIHNjb3BlcywgcmVkaXJlY3RVUkkgfSkge1xuICAgICAgY29uc3QgX3Njb3BlcyA9IG9wdGlvbnMuZGlzYWJsZURlZmF1bHRTY29wZSA/IFtdIDogW1wiaWRlbnRpZnlcIiwgXCJlbWFpbFwiXTtcbiAgICAgIHNjb3BlcyAmJiBfc2NvcGVzLnB1c2goLi4uc2NvcGVzKTtcbiAgICAgIG9wdGlvbnMuc2NvcGUgJiYgX3Njb3Blcy5wdXNoKC4uLm9wdGlvbnMuc2NvcGUpO1xuICAgICAgY29uc3QgaGFzQm90U2NvcGUgPSBfc2NvcGVzLmluY2x1ZGVzKFwiYm90XCIpO1xuICAgICAgY29uc3QgcGVybWlzc2lvbnNQYXJhbSA9IGhhc0JvdFNjb3BlICYmIG9wdGlvbnMucGVybWlzc2lvbnMgIT09IHZvaWQgMCA/IGAmcGVybWlzc2lvbnM9JHtvcHRpb25zLnBlcm1pc3Npb25zfWAgOiBcIlwiO1xuICAgICAgcmV0dXJuIG5ldyBVUkwoXG4gICAgICAgIGBodHRwczovL2Rpc2NvcmQuY29tL2FwaS9vYXV0aDIvYXV0aG9yaXplP3Njb3BlPSR7X3Njb3Blcy5qb2luKFxuICAgICAgICAgIFwiK1wiXG4gICAgICAgICl9JnJlc3BvbnNlX3R5cGU9Y29kZSZjbGllbnRfaWQ9JHtvcHRpb25zLmNsaWVudElkfSZyZWRpcmVjdF91cmk9JHtlbmNvZGVVUklDb21wb25lbnQoXG4gICAgICAgICAgb3B0aW9ucy5yZWRpcmVjdFVSSSB8fCByZWRpcmVjdFVSSVxuICAgICAgICApfSZzdGF0ZT0ke3N0YXRlfSZwcm9tcHQ9JHtvcHRpb25zLnByb21wdCB8fCBcIm5vbmVcIn0ke3Blcm1pc3Npb25zUGFyYW19YFxuICAgICAgKTtcbiAgICB9LFxuICAgIHZhbGlkYXRlQXV0aG9yaXphdGlvbkNvZGU6IGFzeW5jICh7IGNvZGUsIHJlZGlyZWN0VVJJIH0pID0+IHtcbiAgICAgIHJldHVybiB2YWxpZGF0ZUF1dGhvcml6YXRpb25Db2RlKHtcbiAgICAgICAgY29kZSxcbiAgICAgICAgcmVkaXJlY3RVUkksXG4gICAgICAgIG9wdGlvbnMsXG4gICAgICAgIHRva2VuRW5kcG9pbnQ6IFwiaHR0cHM6Ly9kaXNjb3JkLmNvbS9hcGkvb2F1dGgyL3Rva2VuXCJcbiAgICAgIH0pO1xuICAgIH0sXG4gICAgcmVmcmVzaEFjY2Vzc1Rva2VuOiBvcHRpb25zLnJlZnJlc2hBY2Nlc3NUb2tlbiA/IG9wdGlvbnMucmVmcmVzaEFjY2Vzc1Rva2VuIDogYXN5bmMgKHJlZnJlc2hUb2tlbikgPT4ge1xuICAgICAgcmV0dXJuIHJlZnJlc2hBY2Nlc3NUb2tlbih7XG4gICAgICAgIHJlZnJlc2hUb2tlbixcbiAgICAgICAgb3B0aW9uczoge1xuICAgICAgICAgIGNsaWVudElkOiBvcHRpb25zLmNsaWVudElkLFxuICAgICAgICAgIGNsaWVudEtleTogb3B0aW9ucy5jbGllbnRLZXksXG4gICAgICAgICAgY2xpZW50U2VjcmV0OiBvcHRpb25zLmNsaWVudFNlY3JldFxuICAgICAgICB9LFxuICAgICAgICB0b2tlbkVuZHBvaW50OiBcImh0dHBzOi8vZGlzY29yZC5jb20vYXBpL29hdXRoMi90b2tlblwiXG4gICAgICB9KTtcbiAgICB9LFxuICAgIGFzeW5jIGdldFVzZXJJbmZvKHRva2VuKSB7XG4gICAgICBpZiAob3B0aW9ucy5nZXRVc2VySW5mbykge1xuICAgICAgICByZXR1cm4gb3B0aW9ucy5nZXRVc2VySW5mbyh0b2tlbik7XG4gICAgICB9XG4gICAgICBjb25zdCB7IGRhdGE6IHByb2ZpbGUsIGVycm9yIH0gPSBhd2FpdCBiZXR0ZXJGZXRjaChcbiAgICAgICAgXCJodHRwczovL2Rpc2NvcmQuY29tL2FwaS91c2Vycy9AbWVcIixcbiAgICAgICAge1xuICAgICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAgIGF1dGhvcml6YXRpb246IGBCZWFyZXIgJHt0b2tlbi5hY2Nlc3NUb2tlbn1gXG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICApO1xuICAgICAgaWYgKGVycm9yKSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgICAgfVxuICAgICAgaWYgKHByb2ZpbGUuYXZhdGFyID09PSBudWxsKSB7XG4gICAgICAgIGNvbnN0IGRlZmF1bHRBdmF0YXJOdW1iZXIgPSBwcm9maWxlLmRpc2NyaW1pbmF0b3IgPT09IFwiMFwiID8gTnVtYmVyKEJpZ0ludChwcm9maWxlLmlkKSA+PiBCaWdJbnQoMjIpKSAlIDYgOiBwYXJzZUludChwcm9maWxlLmRpc2NyaW1pbmF0b3IpICUgNTtcbiAgICAgICAgcHJvZmlsZS5pbWFnZV91cmwgPSBgaHR0cHM6Ly9jZG4uZGlzY29yZGFwcC5jb20vZW1iZWQvYXZhdGFycy8ke2RlZmF1bHRBdmF0YXJOdW1iZXJ9LnBuZ2A7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBjb25zdCBmb3JtYXQgPSBwcm9maWxlLmF2YXRhci5zdGFydHNXaXRoKFwiYV9cIikgPyBcImdpZlwiIDogXCJwbmdcIjtcbiAgICAgICAgcHJvZmlsZS5pbWFnZV91cmwgPSBgaHR0cHM6Ly9jZG4uZGlzY29yZGFwcC5jb20vYXZhdGFycy8ke3Byb2ZpbGUuaWR9LyR7cHJvZmlsZS5hdmF0YXJ9LiR7Zm9ybWF0fWA7XG4gICAgICB9XG4gICAgICBjb25zdCB1c2VyTWFwID0gYXdhaXQgb3B0aW9ucy5tYXBQcm9maWxlVG9Vc2VyPy4ocHJvZmlsZSk7XG4gICAgICByZXR1cm4ge1xuICAgICAgICB1c2VyOiB7XG4gICAgICAgICAgaWQ6IHByb2ZpbGUuaWQsXG4gICAgICAgICAgbmFtZTogcHJvZmlsZS5nbG9iYWxfbmFtZSB8fCBwcm9maWxlLnVzZXJuYW1lIHx8IFwiXCIsXG4gICAgICAgICAgZW1haWw6IHByb2ZpbGUuZW1haWwsXG4gICAgICAgICAgZW1haWxWZXJpZmllZDogcHJvZmlsZS52ZXJpZmllZCxcbiAgICAgICAgICBpbWFnZTogcHJvZmlsZS5pbWFnZV91cmwsXG4gICAgICAgICAgLi4udXNlck1hcFxuICAgICAgICB9LFxuICAgICAgICBkYXRhOiBwcm9maWxlXG4gICAgICB9O1xuICAgIH0sXG4gICAgb3B0aW9uc1xuICB9O1xufTtcblxuY29uc3QgZmFjZWJvb2sgPSAob3B0aW9ucykgPT4ge1xuICByZXR1cm4ge1xuICAgIGlkOiBcImZhY2Vib29rXCIsXG4gICAgbmFtZTogXCJGYWNlYm9va1wiLFxuICAgIGFzeW5jIGNyZWF0ZUF1dGhvcml6YXRpb25VUkwoeyBzdGF0ZSwgc2NvcGVzLCByZWRpcmVjdFVSSSwgbG9naW5IaW50IH0pIHtcbiAgICAgIGNvbnN0IF9zY29wZXMgPSBvcHRpb25zLmRpc2FibGVEZWZhdWx0U2NvcGUgPyBbXSA6IFtcImVtYWlsXCIsIFwicHVibGljX3Byb2ZpbGVcIl07XG4gICAgICBvcHRpb25zLnNjb3BlICYmIF9zY29wZXMucHVzaCguLi5vcHRpb25zLnNjb3BlKTtcbiAgICAgIHNjb3BlcyAmJiBfc2NvcGVzLnB1c2goLi4uc2NvcGVzKTtcbiAgICAgIHJldHVybiBhd2FpdCBjcmVhdGVBdXRob3JpemF0aW9uVVJMKHtcbiAgICAgICAgaWQ6IFwiZmFjZWJvb2tcIixcbiAgICAgICAgb3B0aW9ucyxcbiAgICAgICAgYXV0aG9yaXphdGlvbkVuZHBvaW50OiBcImh0dHBzOi8vd3d3LmZhY2Vib29rLmNvbS92MjEuMC9kaWFsb2cvb2F1dGhcIixcbiAgICAgICAgc2NvcGVzOiBfc2NvcGVzLFxuICAgICAgICBzdGF0ZSxcbiAgICAgICAgcmVkaXJlY3RVUkksXG4gICAgICAgIGxvZ2luSGludCxcbiAgICAgICAgYWRkaXRpb25hbFBhcmFtczogb3B0aW9ucy5jb25maWdJZCA/IHtcbiAgICAgICAgICBjb25maWdfaWQ6IG9wdGlvbnMuY29uZmlnSWRcbiAgICAgICAgfSA6IHt9XG4gICAgICB9KTtcbiAgICB9LFxuICAgIHZhbGlkYXRlQXV0aG9yaXphdGlvbkNvZGU6IGFzeW5jICh7IGNvZGUsIHJlZGlyZWN0VVJJIH0pID0+IHtcbiAgICAgIHJldHVybiB2YWxpZGF0ZUF1dGhvcml6YXRpb25Db2RlKHtcbiAgICAgICAgY29kZSxcbiAgICAgICAgcmVkaXJlY3RVUkksXG4gICAgICAgIG9wdGlvbnMsXG4gICAgICAgIHRva2VuRW5kcG9pbnQ6IFwiaHR0cHM6Ly9ncmFwaC5mYWNlYm9vay5jb20vb2F1dGgvYWNjZXNzX3Rva2VuXCJcbiAgICAgIH0pO1xuICAgIH0sXG4gICAgYXN5bmMgdmVyaWZ5SWRUb2tlbih0b2tlbiwgbm9uY2UpIHtcbiAgICAgIGlmIChvcHRpb25zLmRpc2FibGVJZFRva2VuU2lnbkluKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH1cbiAgICAgIGlmIChvcHRpb25zLnZlcmlmeUlkVG9rZW4pIHtcbiAgICAgICAgcmV0dXJuIG9wdGlvbnMudmVyaWZ5SWRUb2tlbih0b2tlbiwgbm9uY2UpO1xuICAgICAgfVxuICAgICAgaWYgKHRva2VuLnNwbGl0KFwiLlwiKS5sZW5ndGggPT09IDMpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICBjb25zdCB7IHBheWxvYWQ6IGp3dENsYWltcyB9ID0gYXdhaXQgand0VmVyaWZ5KFxuICAgICAgICAgICAgdG9rZW4sXG4gICAgICAgICAgICBjcmVhdGVSZW1vdGVKV0tTZXQoXG4gICAgICAgICAgICAgIC8vIGh0dHBzOi8vZGV2ZWxvcGVycy5mYWNlYm9vay5jb20vZG9jcy9mYWNlYm9vay1sb2dpbi9saW1pdGVkLWxvZ2luL3Rva2VuLyNqd2tzXG4gICAgICAgICAgICAgIG5ldyBVUkwoXG4gICAgICAgICAgICAgICAgXCJodHRwczovL2xpbWl0ZWQuZmFjZWJvb2suY29tLy53ZWxsLWtub3duL29hdXRoL29wZW5pZC9qd2tzL1wiXG4gICAgICAgICAgICAgIClcbiAgICAgICAgICAgICksXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgIGFsZ29yaXRobXM6IFtcIlJTMjU2XCJdLFxuICAgICAgICAgICAgICBhdWRpZW5jZTogb3B0aW9ucy5jbGllbnRJZCxcbiAgICAgICAgICAgICAgaXNzdWVyOiBcImh0dHBzOi8vd3d3LmZhY2Vib29rLmNvbVwiXG4gICAgICAgICAgICB9XG4gICAgICAgICAgKTtcbiAgICAgICAgICBpZiAobm9uY2UgJiYgand0Q2xhaW1zLm5vbmNlICE9PSBub25jZSkge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgIH1cbiAgICAgICAgICByZXR1cm4gISFqd3RDbGFpbXM7XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9LFxuICAgIHJlZnJlc2hBY2Nlc3NUb2tlbjogb3B0aW9ucy5yZWZyZXNoQWNjZXNzVG9rZW4gPyBvcHRpb25zLnJlZnJlc2hBY2Nlc3NUb2tlbiA6IGFzeW5jIChyZWZyZXNoVG9rZW4pID0+IHtcbiAgICAgIHJldHVybiByZWZyZXNoQWNjZXNzVG9rZW4oe1xuICAgICAgICByZWZyZXNoVG9rZW4sXG4gICAgICAgIG9wdGlvbnM6IHtcbiAgICAgICAgICBjbGllbnRJZDogb3B0aW9ucy5jbGllbnRJZCxcbiAgICAgICAgICBjbGllbnRLZXk6IG9wdGlvbnMuY2xpZW50S2V5LFxuICAgICAgICAgIGNsaWVudFNlY3JldDogb3B0aW9ucy5jbGllbnRTZWNyZXRcbiAgICAgICAgfSxcbiAgICAgICAgdG9rZW5FbmRwb2ludDogXCJodHRwczovL2dyYXBoLmZhY2Vib29rLmNvbS92MTguMC9vYXV0aC9hY2Nlc3NfdG9rZW5cIlxuICAgICAgfSk7XG4gICAgfSxcbiAgICBhc3luYyBnZXRVc2VySW5mbyh0b2tlbikge1xuICAgICAgaWYgKG9wdGlvbnMuZ2V0VXNlckluZm8pIHtcbiAgICAgICAgcmV0dXJuIG9wdGlvbnMuZ2V0VXNlckluZm8odG9rZW4pO1xuICAgICAgfVxuICAgICAgaWYgKHRva2VuLmlkVG9rZW4gJiYgdG9rZW4uaWRUb2tlbi5zcGxpdChcIi5cIikubGVuZ3RoID09PSAzKSB7XG4gICAgICAgIGNvbnN0IHByb2ZpbGUyID0gZGVjb2RlSnd0KHRva2VuLmlkVG9rZW4pO1xuICAgICAgICBjb25zdCB1c2VyID0ge1xuICAgICAgICAgIGlkOiBwcm9maWxlMi5zdWIsXG4gICAgICAgICAgbmFtZTogcHJvZmlsZTIubmFtZSxcbiAgICAgICAgICBlbWFpbDogcHJvZmlsZTIuZW1haWwsXG4gICAgICAgICAgcGljdHVyZToge1xuICAgICAgICAgICAgZGF0YToge1xuICAgICAgICAgICAgICB1cmw6IHByb2ZpbGUyLnBpY3R1cmUsXG4gICAgICAgICAgICAgIGhlaWdodDogMTAwLFxuICAgICAgICAgICAgICB3aWR0aDogMTAwLFxuICAgICAgICAgICAgICBpc19zaWxob3VldHRlOiBmYWxzZVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgY29uc3QgdXNlck1hcDIgPSBhd2FpdCBvcHRpb25zLm1hcFByb2ZpbGVUb1VzZXI/Lih7XG4gICAgICAgICAgLi4udXNlcixcbiAgICAgICAgICBlbWFpbF92ZXJpZmllZDogdHJ1ZVxuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICB1c2VyOiB7XG4gICAgICAgICAgICAuLi51c2VyLFxuICAgICAgICAgICAgZW1haWxWZXJpZmllZDogdHJ1ZSxcbiAgICAgICAgICAgIC4uLnVzZXJNYXAyXG4gICAgICAgICAgfSxcbiAgICAgICAgICBkYXRhOiBwcm9maWxlMlxuICAgICAgICB9O1xuICAgICAgfVxuICAgICAgY29uc3QgZmllbGRzID0gW1xuICAgICAgICBcImlkXCIsXG4gICAgICAgIFwibmFtZVwiLFxuICAgICAgICBcImVtYWlsXCIsXG4gICAgICAgIFwicGljdHVyZVwiLFxuICAgICAgICAuLi5vcHRpb25zPy5maWVsZHMgfHwgW11cbiAgICAgIF07XG4gICAgICBjb25zdCB7IGRhdGE6IHByb2ZpbGUsIGVycm9yIH0gPSBhd2FpdCBiZXR0ZXJGZXRjaChcbiAgICAgICAgXCJodHRwczovL2dyYXBoLmZhY2Vib29rLmNvbS9tZT9maWVsZHM9XCIgKyBmaWVsZHMuam9pbihcIixcIiksXG4gICAgICAgIHtcbiAgICAgICAgICBhdXRoOiB7XG4gICAgICAgICAgICB0eXBlOiBcIkJlYXJlclwiLFxuICAgICAgICAgICAgdG9rZW46IHRva2VuLmFjY2Vzc1Rva2VuXG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICApO1xuICAgICAgaWYgKGVycm9yKSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgICAgfVxuICAgICAgY29uc3QgdXNlck1hcCA9IGF3YWl0IG9wdGlvbnMubWFwUHJvZmlsZVRvVXNlcj8uKHByb2ZpbGUpO1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgdXNlcjoge1xuICAgICAgICAgIGlkOiBwcm9maWxlLmlkLFxuICAgICAgICAgIG5hbWU6IHByb2ZpbGUubmFtZSxcbiAgICAgICAgICBlbWFpbDogcHJvZmlsZS5lbWFpbCxcbiAgICAgICAgICBpbWFnZTogcHJvZmlsZS5waWN0dXJlLmRhdGEudXJsLFxuICAgICAgICAgIGVtYWlsVmVyaWZpZWQ6IHByb2ZpbGUuZW1haWxfdmVyaWZpZWQsXG4gICAgICAgICAgLi4udXNlck1hcFxuICAgICAgICB9LFxuICAgICAgICBkYXRhOiBwcm9maWxlXG4gICAgICB9O1xuICAgIH0sXG4gICAgb3B0aW9uc1xuICB9O1xufTtcblxuY29uc3QgZmlnbWEgPSAob3B0aW9ucykgPT4ge1xuICByZXR1cm4ge1xuICAgIGlkOiBcImZpZ21hXCIsXG4gICAgbmFtZTogXCJGaWdtYVwiLFxuICAgIGFzeW5jIGNyZWF0ZUF1dGhvcml6YXRpb25VUkwoeyBzdGF0ZSwgc2NvcGVzLCBjb2RlVmVyaWZpZXIsIHJlZGlyZWN0VVJJIH0pIHtcbiAgICAgIGlmICghb3B0aW9ucy5jbGllbnRJZCB8fCAhb3B0aW9ucy5jbGllbnRTZWNyZXQpIHtcbiAgICAgICAgbG9nZ2VyLmVycm9yKFxuICAgICAgICAgIFwiQ2xpZW50IElkIGFuZCBDbGllbnQgU2VjcmV0IGFyZSByZXF1aXJlZCBmb3IgRmlnbWEuIE1ha2Ugc3VyZSB0byBwcm92aWRlIHRoZW0gaW4gdGhlIG9wdGlvbnMuXCJcbiAgICAgICAgKTtcbiAgICAgICAgdGhyb3cgbmV3IEJldHRlckF1dGhFcnJvcihcIkNMSUVOVF9JRF9BTkRfU0VDUkVUX1JFUVVJUkVEXCIpO1xuICAgICAgfVxuICAgICAgaWYgKCFjb2RlVmVyaWZpZXIpIHtcbiAgICAgICAgdGhyb3cgbmV3IEJldHRlckF1dGhFcnJvcihcImNvZGVWZXJpZmllciBpcyByZXF1aXJlZCBmb3IgRmlnbWFcIik7XG4gICAgICB9XG4gICAgICBjb25zdCBfc2NvcGVzID0gb3B0aW9ucy5kaXNhYmxlRGVmYXVsdFNjb3BlID8gW10gOiBbXCJmaWxlX3JlYWRcIl07XG4gICAgICBvcHRpb25zLnNjb3BlICYmIF9zY29wZXMucHVzaCguLi5vcHRpb25zLnNjb3BlKTtcbiAgICAgIHNjb3BlcyAmJiBfc2NvcGVzLnB1c2goLi4uc2NvcGVzKTtcbiAgICAgIGNvbnN0IHVybCA9IGF3YWl0IGNyZWF0ZUF1dGhvcml6YXRpb25VUkwoe1xuICAgICAgICBpZDogXCJmaWdtYVwiLFxuICAgICAgICBvcHRpb25zLFxuICAgICAgICBhdXRob3JpemF0aW9uRW5kcG9pbnQ6IFwiaHR0cHM6Ly93d3cuZmlnbWEuY29tL29hdXRoXCIsXG4gICAgICAgIHNjb3BlczogX3Njb3BlcyxcbiAgICAgICAgc3RhdGUsXG4gICAgICAgIGNvZGVWZXJpZmllcixcbiAgICAgICAgcmVkaXJlY3RVUklcbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIHVybDtcbiAgICB9LFxuICAgIHZhbGlkYXRlQXV0aG9yaXphdGlvbkNvZGU6IGFzeW5jICh7IGNvZGUsIGNvZGVWZXJpZmllciwgcmVkaXJlY3RVUkkgfSkgPT4ge1xuICAgICAgcmV0dXJuIHZhbGlkYXRlQXV0aG9yaXphdGlvbkNvZGUoe1xuICAgICAgICBjb2RlLFxuICAgICAgICBjb2RlVmVyaWZpZXIsXG4gICAgICAgIHJlZGlyZWN0VVJJLFxuICAgICAgICBvcHRpb25zLFxuICAgICAgICB0b2tlbkVuZHBvaW50OiBcImh0dHBzOi8vd3d3LmZpZ21hLmNvbS9hcGkvb2F1dGgvdG9rZW5cIlxuICAgICAgfSk7XG4gICAgfSxcbiAgICByZWZyZXNoQWNjZXNzVG9rZW46IG9wdGlvbnMucmVmcmVzaEFjY2Vzc1Rva2VuID8gb3B0aW9ucy5yZWZyZXNoQWNjZXNzVG9rZW4gOiBhc3luYyAocmVmcmVzaFRva2VuKSA9PiB7XG4gICAgICByZXR1cm4gcmVmcmVzaEFjY2Vzc1Rva2VuKHtcbiAgICAgICAgcmVmcmVzaFRva2VuLFxuICAgICAgICBvcHRpb25zOiB7XG4gICAgICAgICAgY2xpZW50SWQ6IG9wdGlvbnMuY2xpZW50SWQsXG4gICAgICAgICAgY2xpZW50S2V5OiBvcHRpb25zLmNsaWVudEtleSxcbiAgICAgICAgICBjbGllbnRTZWNyZXQ6IG9wdGlvbnMuY2xpZW50U2VjcmV0XG4gICAgICAgIH0sXG4gICAgICAgIHRva2VuRW5kcG9pbnQ6IFwiaHR0cHM6Ly93d3cuZmlnbWEuY29tL2FwaS9vYXV0aC90b2tlblwiXG4gICAgICB9KTtcbiAgICB9LFxuICAgIGFzeW5jIGdldFVzZXJJbmZvKHRva2VuKSB7XG4gICAgICBpZiAob3B0aW9ucy5nZXRVc2VySW5mbykge1xuICAgICAgICByZXR1cm4gb3B0aW9ucy5nZXRVc2VySW5mbyh0b2tlbik7XG4gICAgICB9XG4gICAgICB0cnkge1xuICAgICAgICBjb25zdCB7IGRhdGE6IHByb2ZpbGUgfSA9IGF3YWl0IGJldHRlckZldGNoKFxuICAgICAgICAgIFwiaHR0cHM6Ly9hcGkuZmlnbWEuY29tL3YxL21lXCIsXG4gICAgICAgICAge1xuICAgICAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICAgICBBdXRob3JpemF0aW9uOiBgQmVhcmVyICR7dG9rZW4uYWNjZXNzVG9rZW59YFxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgKTtcbiAgICAgICAgaWYgKCFwcm9maWxlKSB7XG4gICAgICAgICAgbG9nZ2VyLmVycm9yKFwiRmFpbGVkIHRvIGZldGNoIHVzZXIgZnJvbSBGaWdtYVwiKTtcbiAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCB1c2VyTWFwID0gYXdhaXQgb3B0aW9ucy5tYXBQcm9maWxlVG9Vc2VyPy4ocHJvZmlsZSk7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgdXNlcjoge1xuICAgICAgICAgICAgaWQ6IHByb2ZpbGUuaWQsXG4gICAgICAgICAgICBuYW1lOiBwcm9maWxlLmhhbmRsZSxcbiAgICAgICAgICAgIGVtYWlsOiBwcm9maWxlLmVtYWlsLFxuICAgICAgICAgICAgaW1hZ2U6IHByb2ZpbGUuaW1nX3VybCxcbiAgICAgICAgICAgIGVtYWlsVmVyaWZpZWQ6ICEhcHJvZmlsZS5lbWFpbCxcbiAgICAgICAgICAgIC4uLnVzZXJNYXBcbiAgICAgICAgICB9LFxuICAgICAgICAgIGRhdGE6IHByb2ZpbGVcbiAgICAgICAgfTtcbiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIGxvZ2dlci5lcnJvcihcIkZhaWxlZCB0byBmZXRjaCB1c2VyIGluZm8gZnJvbSBGaWdtYTpcIiwgZXJyb3IpO1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgIH1cbiAgICB9LFxuICAgIG9wdGlvbnNcbiAgfTtcbn07XG5cbmNvbnN0IGdpdGh1YiA9IChvcHRpb25zKSA9PiB7XG4gIGNvbnN0IHRva2VuRW5kcG9pbnQgPSBcImh0dHBzOi8vZ2l0aHViLmNvbS9sb2dpbi9vYXV0aC9hY2Nlc3NfdG9rZW5cIjtcbiAgcmV0dXJuIHtcbiAgICBpZDogXCJnaXRodWJcIixcbiAgICBuYW1lOiBcIkdpdEh1YlwiLFxuICAgIGNyZWF0ZUF1dGhvcml6YXRpb25VUkwoeyBzdGF0ZSwgc2NvcGVzLCBsb2dpbkhpbnQsIHJlZGlyZWN0VVJJIH0pIHtcbiAgICAgIGNvbnN0IF9zY29wZXMgPSBvcHRpb25zLmRpc2FibGVEZWZhdWx0U2NvcGUgPyBbXSA6IFtcInJlYWQ6dXNlclwiLCBcInVzZXI6ZW1haWxcIl07XG4gICAgICBvcHRpb25zLnNjb3BlICYmIF9zY29wZXMucHVzaCguLi5vcHRpb25zLnNjb3BlKTtcbiAgICAgIHNjb3BlcyAmJiBfc2NvcGVzLnB1c2goLi4uc2NvcGVzKTtcbiAgICAgIHJldHVybiBjcmVhdGVBdXRob3JpemF0aW9uVVJMKHtcbiAgICAgICAgaWQ6IFwiZ2l0aHViXCIsXG4gICAgICAgIG9wdGlvbnMsXG4gICAgICAgIGF1dGhvcml6YXRpb25FbmRwb2ludDogXCJodHRwczovL2dpdGh1Yi5jb20vbG9naW4vb2F1dGgvYXV0aG9yaXplXCIsXG4gICAgICAgIHNjb3BlczogX3Njb3BlcyxcbiAgICAgICAgc3RhdGUsXG4gICAgICAgIHJlZGlyZWN0VVJJLFxuICAgICAgICBsb2dpbkhpbnQsXG4gICAgICAgIHByb21wdDogb3B0aW9ucy5wcm9tcHRcbiAgICAgIH0pO1xuICAgIH0sXG4gICAgdmFsaWRhdGVBdXRob3JpemF0aW9uQ29kZTogYXN5bmMgKHsgY29kZSwgcmVkaXJlY3RVUkkgfSkgPT4ge1xuICAgICAgcmV0dXJuIHZhbGlkYXRlQXV0aG9yaXphdGlvbkNvZGUoe1xuICAgICAgICBjb2RlLFxuICAgICAgICByZWRpcmVjdFVSSSxcbiAgICAgICAgb3B0aW9ucyxcbiAgICAgICAgdG9rZW5FbmRwb2ludFxuICAgICAgfSk7XG4gICAgfSxcbiAgICByZWZyZXNoQWNjZXNzVG9rZW46IG9wdGlvbnMucmVmcmVzaEFjY2Vzc1Rva2VuID8gb3B0aW9ucy5yZWZyZXNoQWNjZXNzVG9rZW4gOiBhc3luYyAocmVmcmVzaFRva2VuKSA9PiB7XG4gICAgICByZXR1cm4gcmVmcmVzaEFjY2Vzc1Rva2VuKHtcbiAgICAgICAgcmVmcmVzaFRva2VuLFxuICAgICAgICBvcHRpb25zOiB7XG4gICAgICAgICAgY2xpZW50SWQ6IG9wdGlvbnMuY2xpZW50SWQsXG4gICAgICAgICAgY2xpZW50S2V5OiBvcHRpb25zLmNsaWVudEtleSxcbiAgICAgICAgICBjbGllbnRTZWNyZXQ6IG9wdGlvbnMuY2xpZW50U2VjcmV0XG4gICAgICAgIH0sXG4gICAgICAgIHRva2VuRW5kcG9pbnQ6IFwiaHR0cHM6Ly9naXRodWIuY29tL2xvZ2luL29hdXRoL2FjY2Vzc190b2tlblwiXG4gICAgICB9KTtcbiAgICB9LFxuICAgIGFzeW5jIGdldFVzZXJJbmZvKHRva2VuKSB7XG4gICAgICBpZiAob3B0aW9ucy5nZXRVc2VySW5mbykge1xuICAgICAgICByZXR1cm4gb3B0aW9ucy5nZXRVc2VySW5mbyh0b2tlbik7XG4gICAgICB9XG4gICAgICBjb25zdCB7IGRhdGE6IHByb2ZpbGUsIGVycm9yIH0gPSBhd2FpdCBiZXR0ZXJGZXRjaChcbiAgICAgICAgXCJodHRwczovL2FwaS5naXRodWIuY29tL3VzZXJcIixcbiAgICAgICAge1xuICAgICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAgIFwiVXNlci1BZ2VudFwiOiBcImJldHRlci1hdXRoXCIsXG4gICAgICAgICAgICBhdXRob3JpemF0aW9uOiBgQmVhcmVyICR7dG9rZW4uYWNjZXNzVG9rZW59YFxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgKTtcbiAgICAgIGlmIChlcnJvcikge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgIH1cbiAgICAgIGNvbnN0IHsgZGF0YTogZW1haWxzIH0gPSBhd2FpdCBiZXR0ZXJGZXRjaChcImh0dHBzOi8vYXBpLmdpdGh1Yi5jb20vdXNlci9lbWFpbHNcIiwge1xuICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgQXV0aG9yaXphdGlvbjogYEJlYXJlciAke3Rva2VuLmFjY2Vzc1Rva2VufWAsXG4gICAgICAgICAgXCJVc2VyLUFnZW50XCI6IFwiYmV0dGVyLWF1dGhcIlxuICAgICAgICB9XG4gICAgICB9KTtcbiAgICAgIGlmICghcHJvZmlsZS5lbWFpbCAmJiBlbWFpbHMpIHtcbiAgICAgICAgcHJvZmlsZS5lbWFpbCA9IChlbWFpbHMuZmluZCgoZSkgPT4gZS5wcmltYXJ5KSA/PyBlbWFpbHNbMF0pPy5lbWFpbDtcbiAgICAgIH1cbiAgICAgIGNvbnN0IGVtYWlsVmVyaWZpZWQgPSBlbWFpbHM/LmZpbmQoKGUpID0+IGUuZW1haWwgPT09IHByb2ZpbGUuZW1haWwpPy52ZXJpZmllZCA/PyBmYWxzZTtcbiAgICAgIGNvbnN0IHVzZXJNYXAgPSBhd2FpdCBvcHRpb25zLm1hcFByb2ZpbGVUb1VzZXI/Lihwcm9maWxlKTtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHVzZXI6IHtcbiAgICAgICAgICBpZDogcHJvZmlsZS5pZCxcbiAgICAgICAgICBuYW1lOiBwcm9maWxlLm5hbWUgfHwgcHJvZmlsZS5sb2dpbixcbiAgICAgICAgICBlbWFpbDogcHJvZmlsZS5lbWFpbCxcbiAgICAgICAgICBpbWFnZTogcHJvZmlsZS5hdmF0YXJfdXJsLFxuICAgICAgICAgIGVtYWlsVmVyaWZpZWQsXG4gICAgICAgICAgLi4udXNlck1hcFxuICAgICAgICB9LFxuICAgICAgICBkYXRhOiBwcm9maWxlXG4gICAgICB9O1xuICAgIH0sXG4gICAgb3B0aW9uc1xuICB9O1xufTtcblxuY29uc3QgZ29vZ2xlID0gKG9wdGlvbnMpID0+IHtcbiAgcmV0dXJuIHtcbiAgICBpZDogXCJnb29nbGVcIixcbiAgICBuYW1lOiBcIkdvb2dsZVwiLFxuICAgIGFzeW5jIGNyZWF0ZUF1dGhvcml6YXRpb25VUkwoe1xuICAgICAgc3RhdGUsXG4gICAgICBzY29wZXMsXG4gICAgICBjb2RlVmVyaWZpZXIsXG4gICAgICByZWRpcmVjdFVSSSxcbiAgICAgIGxvZ2luSGludCxcbiAgICAgIGRpc3BsYXlcbiAgICB9KSB7XG4gICAgICBpZiAoIW9wdGlvbnMuY2xpZW50SWQgfHwgIW9wdGlvbnMuY2xpZW50U2VjcmV0KSB7XG4gICAgICAgIGxvZ2dlci5lcnJvcihcbiAgICAgICAgICBcIkNsaWVudCBJZCBhbmQgQ2xpZW50IFNlY3JldCBpcyByZXF1aXJlZCBmb3IgR29vZ2xlLiBNYWtlIHN1cmUgdG8gcHJvdmlkZSB0aGVtIGluIHRoZSBvcHRpb25zLlwiXG4gICAgICAgICk7XG4gICAgICAgIHRocm93IG5ldyBCZXR0ZXJBdXRoRXJyb3IoXCJDTElFTlRfSURfQU5EX1NFQ1JFVF9SRVFVSVJFRFwiKTtcbiAgICAgIH1cbiAgICAgIGlmICghY29kZVZlcmlmaWVyKSB7XG4gICAgICAgIHRocm93IG5ldyBCZXR0ZXJBdXRoRXJyb3IoXCJjb2RlVmVyaWZpZXIgaXMgcmVxdWlyZWQgZm9yIEdvb2dsZVwiKTtcbiAgICAgIH1cbiAgICAgIGNvbnN0IF9zY29wZXMgPSBvcHRpb25zLmRpc2FibGVEZWZhdWx0U2NvcGUgPyBbXSA6IFtcImVtYWlsXCIsIFwicHJvZmlsZVwiLCBcIm9wZW5pZFwiXTtcbiAgICAgIG9wdGlvbnMuc2NvcGUgJiYgX3Njb3Blcy5wdXNoKC4uLm9wdGlvbnMuc2NvcGUpO1xuICAgICAgc2NvcGVzICYmIF9zY29wZXMucHVzaCguLi5zY29wZXMpO1xuICAgICAgY29uc3QgdXJsID0gYXdhaXQgY3JlYXRlQXV0aG9yaXphdGlvblVSTCh7XG4gICAgICAgIGlkOiBcImdvb2dsZVwiLFxuICAgICAgICBvcHRpb25zLFxuICAgICAgICBhdXRob3JpemF0aW9uRW5kcG9pbnQ6IFwiaHR0cHM6Ly9hY2NvdW50cy5nb29nbGUuY29tL28vb2F1dGgyL2F1dGhcIixcbiAgICAgICAgc2NvcGVzOiBfc2NvcGVzLFxuICAgICAgICBzdGF0ZSxcbiAgICAgICAgY29kZVZlcmlmaWVyLFxuICAgICAgICByZWRpcmVjdFVSSSxcbiAgICAgICAgcHJvbXB0OiBvcHRpb25zLnByb21wdCxcbiAgICAgICAgYWNjZXNzVHlwZTogb3B0aW9ucy5hY2Nlc3NUeXBlLFxuICAgICAgICBkaXNwbGF5OiBkaXNwbGF5IHx8IG9wdGlvbnMuZGlzcGxheSxcbiAgICAgICAgbG9naW5IaW50LFxuICAgICAgICBoZDogb3B0aW9ucy5oZCxcbiAgICAgICAgYWRkaXRpb25hbFBhcmFtczoge1xuICAgICAgICAgIGluY2x1ZGVfZ3JhbnRlZF9zY29wZXM6IFwidHJ1ZVwiXG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIHVybDtcbiAgICB9LFxuICAgIHZhbGlkYXRlQXV0aG9yaXphdGlvbkNvZGU6IGFzeW5jICh7IGNvZGUsIGNvZGVWZXJpZmllciwgcmVkaXJlY3RVUkkgfSkgPT4ge1xuICAgICAgcmV0dXJuIHZhbGlkYXRlQXV0aG9yaXphdGlvbkNvZGUoe1xuICAgICAgICBjb2RlLFxuICAgICAgICBjb2RlVmVyaWZpZXIsXG4gICAgICAgIHJlZGlyZWN0VVJJLFxuICAgICAgICBvcHRpb25zLFxuICAgICAgICB0b2tlbkVuZHBvaW50OiBcImh0dHBzOi8vb2F1dGgyLmdvb2dsZWFwaXMuY29tL3Rva2VuXCJcbiAgICAgIH0pO1xuICAgIH0sXG4gICAgcmVmcmVzaEFjY2Vzc1Rva2VuOiBvcHRpb25zLnJlZnJlc2hBY2Nlc3NUb2tlbiA/IG9wdGlvbnMucmVmcmVzaEFjY2Vzc1Rva2VuIDogYXN5bmMgKHJlZnJlc2hUb2tlbikgPT4ge1xuICAgICAgcmV0dXJuIHJlZnJlc2hBY2Nlc3NUb2tlbih7XG4gICAgICAgIHJlZnJlc2hUb2tlbixcbiAgICAgICAgb3B0aW9uczoge1xuICAgICAgICAgIGNsaWVudElkOiBvcHRpb25zLmNsaWVudElkLFxuICAgICAgICAgIGNsaWVudEtleTogb3B0aW9ucy5jbGllbnRLZXksXG4gICAgICAgICAgY2xpZW50U2VjcmV0OiBvcHRpb25zLmNsaWVudFNlY3JldFxuICAgICAgICB9LFxuICAgICAgICB0b2tlbkVuZHBvaW50OiBcImh0dHBzOi8vd3d3Lmdvb2dsZWFwaXMuY29tL29hdXRoMi92NC90b2tlblwiXG4gICAgICB9KTtcbiAgICB9LFxuICAgIGFzeW5jIHZlcmlmeUlkVG9rZW4odG9rZW4sIG5vbmNlKSB7XG4gICAgICBpZiAob3B0aW9ucy5kaXNhYmxlSWRUb2tlblNpZ25Jbikge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9XG4gICAgICBpZiAob3B0aW9ucy52ZXJpZnlJZFRva2VuKSB7XG4gICAgICAgIHJldHVybiBvcHRpb25zLnZlcmlmeUlkVG9rZW4odG9rZW4sIG5vbmNlKTtcbiAgICAgIH1cbiAgICAgIGNvbnN0IGdvb2dsZVB1YmxpY0tleVVybCA9IGBodHRwczovL3d3dy5nb29nbGVhcGlzLmNvbS9vYXV0aDIvdjMvdG9rZW5pbmZvP2lkX3Rva2VuPSR7dG9rZW59YDtcbiAgICAgIGNvbnN0IHsgZGF0YTogdG9rZW5JbmZvIH0gPSBhd2FpdCBiZXR0ZXJGZXRjaChnb29nbGVQdWJsaWNLZXlVcmwpO1xuICAgICAgaWYgKCF0b2tlbkluZm8pIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfVxuICAgICAgY29uc3QgaXNWYWxpZCA9IHRva2VuSW5mby5hdWQgPT09IG9wdGlvbnMuY2xpZW50SWQgJiYgKHRva2VuSW5mby5pc3MgPT09IFwiaHR0cHM6Ly9hY2NvdW50cy5nb29nbGUuY29tXCIgfHwgdG9rZW5JbmZvLmlzcyA9PT0gXCJhY2NvdW50cy5nb29nbGUuY29tXCIpO1xuICAgICAgcmV0dXJuIGlzVmFsaWQ7XG4gICAgfSxcbiAgICBhc3luYyBnZXRVc2VySW5mbyh0b2tlbikge1xuICAgICAgaWYgKG9wdGlvbnMuZ2V0VXNlckluZm8pIHtcbiAgICAgICAgcmV0dXJuIG9wdGlvbnMuZ2V0VXNlckluZm8odG9rZW4pO1xuICAgICAgfVxuICAgICAgaWYgKCF0b2tlbi5pZFRva2VuKSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgICAgfVxuICAgICAgY29uc3QgdXNlciA9IGRlY29kZUp3dCh0b2tlbi5pZFRva2VuKTtcbiAgICAgIGNvbnN0IHVzZXJNYXAgPSBhd2FpdCBvcHRpb25zLm1hcFByb2ZpbGVUb1VzZXI/Lih1c2VyKTtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHVzZXI6IHtcbiAgICAgICAgICBpZDogdXNlci5zdWIsXG4gICAgICAgICAgbmFtZTogdXNlci5uYW1lLFxuICAgICAgICAgIGVtYWlsOiB1c2VyLmVtYWlsLFxuICAgICAgICAgIGltYWdlOiB1c2VyLnBpY3R1cmUsXG4gICAgICAgICAgZW1haWxWZXJpZmllZDogdXNlci5lbWFpbF92ZXJpZmllZCxcbiAgICAgICAgICAuLi51c2VyTWFwXG4gICAgICAgIH0sXG4gICAgICAgIGRhdGE6IHVzZXJcbiAgICAgIH07XG4gICAgfSxcbiAgICBvcHRpb25zXG4gIH07XG59O1xuXG5jb25zdCBraWNrID0gKG9wdGlvbnMpID0+IHtcbiAgcmV0dXJuIHtcbiAgICBpZDogXCJraWNrXCIsXG4gICAgbmFtZTogXCJLaWNrXCIsXG4gICAgY3JlYXRlQXV0aG9yaXphdGlvblVSTCh7IHN0YXRlLCBzY29wZXMsIHJlZGlyZWN0VVJJLCBjb2RlVmVyaWZpZXIgfSkge1xuICAgICAgY29uc3QgX3Njb3BlcyA9IG9wdGlvbnMuZGlzYWJsZURlZmF1bHRTY29wZSA/IFtdIDogW1widXNlcjpyZWFkXCJdO1xuICAgICAgb3B0aW9ucy5zY29wZSAmJiBfc2NvcGVzLnB1c2goLi4ub3B0aW9ucy5zY29wZSk7XG4gICAgICBzY29wZXMgJiYgX3Njb3Blcy5wdXNoKC4uLnNjb3Blcyk7XG4gICAgICByZXR1cm4gY3JlYXRlQXV0aG9yaXphdGlvblVSTCh7XG4gICAgICAgIGlkOiBcImtpY2tcIixcbiAgICAgICAgcmVkaXJlY3RVUkksXG4gICAgICAgIG9wdGlvbnMsXG4gICAgICAgIGF1dGhvcml6YXRpb25FbmRwb2ludDogXCJodHRwczovL2lkLmtpY2suY29tL29hdXRoL2F1dGhvcml6ZVwiLFxuICAgICAgICBzY29wZXM6IF9zY29wZXMsXG4gICAgICAgIGNvZGVWZXJpZmllcixcbiAgICAgICAgc3RhdGVcbiAgICAgIH0pO1xuICAgIH0sXG4gICAgYXN5bmMgdmFsaWRhdGVBdXRob3JpemF0aW9uQ29kZSh7IGNvZGUsIHJlZGlyZWN0VVJJLCBjb2RlVmVyaWZpZXIgfSkge1xuICAgICAgcmV0dXJuIHZhbGlkYXRlQXV0aG9yaXphdGlvbkNvZGUoe1xuICAgICAgICBjb2RlLFxuICAgICAgICByZWRpcmVjdFVSSSxcbiAgICAgICAgb3B0aW9ucyxcbiAgICAgICAgdG9rZW5FbmRwb2ludDogXCJodHRwczovL2lkLmtpY2suY29tL29hdXRoL3Rva2VuXCIsXG4gICAgICAgIGNvZGVWZXJpZmllclxuICAgICAgfSk7XG4gICAgfSxcbiAgICBhc3luYyBnZXRVc2VySW5mbyh0b2tlbikge1xuICAgICAgaWYgKG9wdGlvbnMuZ2V0VXNlckluZm8pIHtcbiAgICAgICAgcmV0dXJuIG9wdGlvbnMuZ2V0VXNlckluZm8odG9rZW4pO1xuICAgICAgfVxuICAgICAgY29uc3QgeyBkYXRhLCBlcnJvciB9ID0gYXdhaXQgYmV0dGVyRmV0Y2goXCJodHRwczovL2FwaS5raWNrLmNvbS9wdWJsaWMvdjEvdXNlcnNcIiwge1xuICAgICAgICBtZXRob2Q6IFwiR0VUXCIsXG4gICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICBBdXRob3JpemF0aW9uOiBgQmVhcmVyICR7dG9rZW4uYWNjZXNzVG9rZW59YFxuICAgICAgICB9XG4gICAgICB9KTtcbiAgICAgIGlmIChlcnJvcikge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgIH1cbiAgICAgIGNvbnN0IHByb2ZpbGUgPSBkYXRhLmRhdGFbMF07XG4gICAgICBjb25zdCB1c2VyTWFwID0gYXdhaXQgb3B0aW9ucy5tYXBQcm9maWxlVG9Vc2VyPy4ocHJvZmlsZSk7XG4gICAgICByZXR1cm4ge1xuICAgICAgICB1c2VyOiB7XG4gICAgICAgICAgaWQ6IHByb2ZpbGUudXNlcl9pZCxcbiAgICAgICAgICBuYW1lOiBwcm9maWxlLm5hbWUsXG4gICAgICAgICAgZW1haWw6IHByb2ZpbGUuZW1haWwsXG4gICAgICAgICAgaW1hZ2U6IHByb2ZpbGUucHJvZmlsZV9waWN0dXJlLFxuICAgICAgICAgIGVtYWlsVmVyaWZpZWQ6IHRydWUsXG4gICAgICAgICAgLi4udXNlck1hcFxuICAgICAgICB9LFxuICAgICAgICBkYXRhOiBwcm9maWxlXG4gICAgICB9O1xuICAgIH0sXG4gICAgb3B0aW9uc1xuICB9O1xufTtcblxuY29uc3QgaHVnZ2luZ2ZhY2UgPSAob3B0aW9ucykgPT4ge1xuICByZXR1cm4ge1xuICAgIGlkOiBcImh1Z2dpbmdmYWNlXCIsXG4gICAgbmFtZTogXCJIdWdnaW5nIEZhY2VcIixcbiAgICBjcmVhdGVBdXRob3JpemF0aW9uVVJMKHsgc3RhdGUsIHNjb3BlcywgY29kZVZlcmlmaWVyLCByZWRpcmVjdFVSSSB9KSB7XG4gICAgICBjb25zdCBfc2NvcGVzID0gb3B0aW9ucy5kaXNhYmxlRGVmYXVsdFNjb3BlID8gW10gOiBbXCJvcGVuaWRcIiwgXCJwcm9maWxlXCIsIFwiZW1haWxcIl07XG4gICAgICBvcHRpb25zLnNjb3BlICYmIF9zY29wZXMucHVzaCguLi5vcHRpb25zLnNjb3BlKTtcbiAgICAgIHNjb3BlcyAmJiBfc2NvcGVzLnB1c2goLi4uc2NvcGVzKTtcbiAgICAgIHJldHVybiBjcmVhdGVBdXRob3JpemF0aW9uVVJMKHtcbiAgICAgICAgaWQ6IFwiaHVnZ2luZ2ZhY2VcIixcbiAgICAgICAgb3B0aW9ucyxcbiAgICAgICAgYXV0aG9yaXphdGlvbkVuZHBvaW50OiBcImh0dHBzOi8vaHVnZ2luZ2ZhY2UuY28vb2F1dGgvYXV0aG9yaXplXCIsXG4gICAgICAgIHNjb3BlczogX3Njb3BlcyxcbiAgICAgICAgc3RhdGUsXG4gICAgICAgIGNvZGVWZXJpZmllcixcbiAgICAgICAgcmVkaXJlY3RVUklcbiAgICAgIH0pO1xuICAgIH0sXG4gICAgdmFsaWRhdGVBdXRob3JpemF0aW9uQ29kZTogYXN5bmMgKHsgY29kZSwgY29kZVZlcmlmaWVyLCByZWRpcmVjdFVSSSB9KSA9PiB7XG4gICAgICByZXR1cm4gdmFsaWRhdGVBdXRob3JpemF0aW9uQ29kZSh7XG4gICAgICAgIGNvZGUsXG4gICAgICAgIGNvZGVWZXJpZmllcixcbiAgICAgICAgcmVkaXJlY3RVUkksXG4gICAgICAgIG9wdGlvbnMsXG4gICAgICAgIHRva2VuRW5kcG9pbnQ6IFwiaHR0cHM6Ly9odWdnaW5nZmFjZS5jby9vYXV0aC90b2tlblwiXG4gICAgICB9KTtcbiAgICB9LFxuICAgIHJlZnJlc2hBY2Nlc3NUb2tlbjogb3B0aW9ucy5yZWZyZXNoQWNjZXNzVG9rZW4gPyBvcHRpb25zLnJlZnJlc2hBY2Nlc3NUb2tlbiA6IGFzeW5jIChyZWZyZXNoVG9rZW4pID0+IHtcbiAgICAgIHJldHVybiByZWZyZXNoQWNjZXNzVG9rZW4oe1xuICAgICAgICByZWZyZXNoVG9rZW4sXG4gICAgICAgIG9wdGlvbnM6IHtcbiAgICAgICAgICBjbGllbnRJZDogb3B0aW9ucy5jbGllbnRJZCxcbiAgICAgICAgICBjbGllbnRLZXk6IG9wdGlvbnMuY2xpZW50S2V5LFxuICAgICAgICAgIGNsaWVudFNlY3JldDogb3B0aW9ucy5jbGllbnRTZWNyZXRcbiAgICAgICAgfSxcbiAgICAgICAgdG9rZW5FbmRwb2ludDogXCJodHRwczovL2h1Z2dpbmdmYWNlLmNvL29hdXRoL3Rva2VuXCJcbiAgICAgIH0pO1xuICAgIH0sXG4gICAgYXN5bmMgZ2V0VXNlckluZm8odG9rZW4pIHtcbiAgICAgIGlmIChvcHRpb25zLmdldFVzZXJJbmZvKSB7XG4gICAgICAgIHJldHVybiBvcHRpb25zLmdldFVzZXJJbmZvKHRva2VuKTtcbiAgICAgIH1cbiAgICAgIGNvbnN0IHsgZGF0YTogcHJvZmlsZSwgZXJyb3IgfSA9IGF3YWl0IGJldHRlckZldGNoKFxuICAgICAgICBcImh0dHBzOi8vaHVnZ2luZ2ZhY2UuY28vb2F1dGgvdXNlcmluZm9cIixcbiAgICAgICAge1xuICAgICAgICAgIG1ldGhvZDogXCJHRVRcIixcbiAgICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgICBBdXRob3JpemF0aW9uOiBgQmVhcmVyICR7dG9rZW4uYWNjZXNzVG9rZW59YFxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgKTtcbiAgICAgIGlmIChlcnJvcikge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgIH1cbiAgICAgIGNvbnN0IHVzZXJNYXAgPSBhd2FpdCBvcHRpb25zLm1hcFByb2ZpbGVUb1VzZXI/Lihwcm9maWxlKTtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHVzZXI6IHtcbiAgICAgICAgICBpZDogcHJvZmlsZS5zdWIsXG4gICAgICAgICAgbmFtZTogcHJvZmlsZS5uYW1lIHx8IHByb2ZpbGUucHJlZmVycmVkX3VzZXJuYW1lLFxuICAgICAgICAgIGVtYWlsOiBwcm9maWxlLmVtYWlsLFxuICAgICAgICAgIGltYWdlOiBwcm9maWxlLnBpY3R1cmUsXG4gICAgICAgICAgZW1haWxWZXJpZmllZDogcHJvZmlsZS5lbWFpbF92ZXJpZmllZCA/PyBmYWxzZSxcbiAgICAgICAgICAuLi51c2VyTWFwXG4gICAgICAgIH0sXG4gICAgICAgIGRhdGE6IHByb2ZpbGVcbiAgICAgIH07XG4gICAgfSxcbiAgICBvcHRpb25zXG4gIH07XG59O1xuXG5jb25zdCBtaWNyb3NvZnQgPSAob3B0aW9ucykgPT4ge1xuICBjb25zdCB0ZW5hbnQgPSBvcHRpb25zLnRlbmFudElkIHx8IFwiY29tbW9uXCI7XG4gIGNvbnN0IGF1dGhvcml0eSA9IG9wdGlvbnMuYXV0aG9yaXR5IHx8IFwiaHR0cHM6Ly9sb2dpbi5taWNyb3NvZnRvbmxpbmUuY29tXCI7XG4gIGNvbnN0IGF1dGhvcml6YXRpb25FbmRwb2ludCA9IGAke2F1dGhvcml0eX0vJHt0ZW5hbnR9L29hdXRoMi92Mi4wL2F1dGhvcml6ZWA7XG4gIGNvbnN0IHRva2VuRW5kcG9pbnQgPSBgJHthdXRob3JpdHl9LyR7dGVuYW50fS9vYXV0aDIvdjIuMC90b2tlbmA7XG4gIHJldHVybiB7XG4gICAgaWQ6IFwibWljcm9zb2Z0XCIsXG4gICAgbmFtZTogXCJNaWNyb3NvZnQgRW50cmFJRFwiLFxuICAgIGNyZWF0ZUF1dGhvcml6YXRpb25VUkwoZGF0YSkge1xuICAgICAgY29uc3Qgc2NvcGVzID0gb3B0aW9ucy5kaXNhYmxlRGVmYXVsdFNjb3BlID8gW10gOiBbXCJvcGVuaWRcIiwgXCJwcm9maWxlXCIsIFwiZW1haWxcIiwgXCJVc2VyLlJlYWRcIiwgXCJvZmZsaW5lX2FjY2Vzc1wiXTtcbiAgICAgIG9wdGlvbnMuc2NvcGUgJiYgc2NvcGVzLnB1c2goLi4ub3B0aW9ucy5zY29wZSk7XG4gICAgICBkYXRhLnNjb3BlcyAmJiBzY29wZXMucHVzaCguLi5kYXRhLnNjb3Blcyk7XG4gICAgICByZXR1cm4gY3JlYXRlQXV0aG9yaXphdGlvblVSTCh7XG4gICAgICAgIGlkOiBcIm1pY3Jvc29mdFwiLFxuICAgICAgICBvcHRpb25zLFxuICAgICAgICBhdXRob3JpemF0aW9uRW5kcG9pbnQsXG4gICAgICAgIHN0YXRlOiBkYXRhLnN0YXRlLFxuICAgICAgICBjb2RlVmVyaWZpZXI6IGRhdGEuY29kZVZlcmlmaWVyLFxuICAgICAgICBzY29wZXMsXG4gICAgICAgIHJlZGlyZWN0VVJJOiBkYXRhLnJlZGlyZWN0VVJJLFxuICAgICAgICBwcm9tcHQ6IG9wdGlvbnMucHJvbXB0LFxuICAgICAgICBsb2dpbkhpbnQ6IGRhdGEubG9naW5IaW50XG4gICAgICB9KTtcbiAgICB9LFxuICAgIHZhbGlkYXRlQXV0aG9yaXphdGlvbkNvZGUoeyBjb2RlLCBjb2RlVmVyaWZpZXIsIHJlZGlyZWN0VVJJIH0pIHtcbiAgICAgIHJldHVybiB2YWxpZGF0ZUF1dGhvcml6YXRpb25Db2RlKHtcbiAgICAgICAgY29kZSxcbiAgICAgICAgY29kZVZlcmlmaWVyLFxuICAgICAgICByZWRpcmVjdFVSSSxcbiAgICAgICAgb3B0aW9ucyxcbiAgICAgICAgdG9rZW5FbmRwb2ludFxuICAgICAgfSk7XG4gICAgfSxcbiAgICBhc3luYyBnZXRVc2VySW5mbyh0b2tlbikge1xuICAgICAgaWYgKG9wdGlvbnMuZ2V0VXNlckluZm8pIHtcbiAgICAgICAgcmV0dXJuIG9wdGlvbnMuZ2V0VXNlckluZm8odG9rZW4pO1xuICAgICAgfVxuICAgICAgaWYgKCF0b2tlbi5pZFRva2VuKSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgICAgfVxuICAgICAgY29uc3QgdXNlciA9IGRlY29kZUp3dCh0b2tlbi5pZFRva2VuKTtcbiAgICAgIGNvbnN0IHByb2ZpbGVQaG90b1NpemUgPSBvcHRpb25zLnByb2ZpbGVQaG90b1NpemUgfHwgNDg7XG4gICAgICBhd2FpdCBiZXR0ZXJGZXRjaChcbiAgICAgICAgYGh0dHBzOi8vZ3JhcGgubWljcm9zb2Z0LmNvbS92MS4wL21lL3Bob3Rvcy8ke3Byb2ZpbGVQaG90b1NpemV9eCR7cHJvZmlsZVBob3RvU2l6ZX0vJHZhbHVlYCxcbiAgICAgICAge1xuICAgICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAgIEF1dGhvcml6YXRpb246IGBCZWFyZXIgJHt0b2tlbi5hY2Nlc3NUb2tlbn1gXG4gICAgICAgICAgfSxcbiAgICAgICAgICBhc3luYyBvblJlc3BvbnNlKGNvbnRleHQpIHtcbiAgICAgICAgICAgIGlmIChvcHRpb25zLmRpc2FibGVQcm9maWxlUGhvdG8gfHwgIWNvbnRleHQucmVzcG9uc2Uub2spIHtcbiAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBjb250ZXh0LnJlc3BvbnNlLmNsb25lKCk7XG4gICAgICAgICAgICAgIGNvbnN0IHBpY3R1cmVCdWZmZXIgPSBhd2FpdCByZXNwb25zZS5hcnJheUJ1ZmZlcigpO1xuICAgICAgICAgICAgICBjb25zdCBwaWN0dXJlQmFzZTY0ID0gYmFzZTY0LmVuY29kZShwaWN0dXJlQnVmZmVyKTtcbiAgICAgICAgICAgICAgdXNlci5waWN0dXJlID0gYGRhdGE6aW1hZ2UvanBlZztiYXNlNjQsICR7cGljdHVyZUJhc2U2NH1gO1xuICAgICAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgICAgICBsb2dnZXIuZXJyb3IoXG4gICAgICAgICAgICAgICAgZSAmJiB0eXBlb2YgZSA9PT0gXCJvYmplY3RcIiAmJiBcIm5hbWVcIiBpbiBlID8gZS5uYW1lIDogXCJcIixcbiAgICAgICAgICAgICAgICBlXG4gICAgICAgICAgICAgICk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICApO1xuICAgICAgY29uc3QgdXNlck1hcCA9IGF3YWl0IG9wdGlvbnMubWFwUHJvZmlsZVRvVXNlcj8uKHVzZXIpO1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgdXNlcjoge1xuICAgICAgICAgIGlkOiB1c2VyLnN1YixcbiAgICAgICAgICBuYW1lOiB1c2VyLm5hbWUsXG4gICAgICAgICAgZW1haWw6IHVzZXIuZW1haWwsXG4gICAgICAgICAgaW1hZ2U6IHVzZXIucGljdHVyZSxcbiAgICAgICAgICBlbWFpbFZlcmlmaWVkOiB0cnVlLFxuICAgICAgICAgIC4uLnVzZXJNYXBcbiAgICAgICAgfSxcbiAgICAgICAgZGF0YTogdXNlclxuICAgICAgfTtcbiAgICB9LFxuICAgIHJlZnJlc2hBY2Nlc3NUb2tlbjogb3B0aW9ucy5yZWZyZXNoQWNjZXNzVG9rZW4gPyBvcHRpb25zLnJlZnJlc2hBY2Nlc3NUb2tlbiA6IGFzeW5jIChyZWZyZXNoVG9rZW4pID0+IHtcbiAgICAgIGNvbnN0IHNjb3BlcyA9IG9wdGlvbnMuZGlzYWJsZURlZmF1bHRTY29wZSA/IFtdIDogW1wib3BlbmlkXCIsIFwicHJvZmlsZVwiLCBcImVtYWlsXCIsIFwiVXNlci5SZWFkXCIsIFwib2ZmbGluZV9hY2Nlc3NcIl07XG4gICAgICBvcHRpb25zLnNjb3BlICYmIHNjb3Blcy5wdXNoKC4uLm9wdGlvbnMuc2NvcGUpO1xuICAgICAgcmV0dXJuIHJlZnJlc2hBY2Nlc3NUb2tlbih7XG4gICAgICAgIHJlZnJlc2hUb2tlbixcbiAgICAgICAgb3B0aW9uczoge1xuICAgICAgICAgIGNsaWVudElkOiBvcHRpb25zLmNsaWVudElkLFxuICAgICAgICAgIGNsaWVudFNlY3JldDogb3B0aW9ucy5jbGllbnRTZWNyZXRcbiAgICAgICAgfSxcbiAgICAgICAgZXh0cmFQYXJhbXM6IHtcbiAgICAgICAgICBzY29wZTogc2NvcGVzLmpvaW4oXCIgXCIpXG4gICAgICAgICAgLy8gSW5jbHVkZSB0aGUgc2NvcGVzIGluIHJlcXVlc3QgdG8gbWljcm9zb2Z0XG4gICAgICAgIH0sXG4gICAgICAgIHRva2VuRW5kcG9pbnRcbiAgICAgIH0pO1xuICAgIH0sXG4gICAgb3B0aW9uc1xuICB9O1xufTtcblxuY29uc3Qgc2xhY2sgPSAob3B0aW9ucykgPT4ge1xuICByZXR1cm4ge1xuICAgIGlkOiBcInNsYWNrXCIsXG4gICAgbmFtZTogXCJTbGFja1wiLFxuICAgIGNyZWF0ZUF1dGhvcml6YXRpb25VUkwoeyBzdGF0ZSwgc2NvcGVzLCByZWRpcmVjdFVSSSB9KSB7XG4gICAgICBjb25zdCBfc2NvcGVzID0gb3B0aW9ucy5kaXNhYmxlRGVmYXVsdFNjb3BlID8gW10gOiBbXCJvcGVuaWRcIiwgXCJwcm9maWxlXCIsIFwiZW1haWxcIl07XG4gICAgICBzY29wZXMgJiYgX3Njb3Blcy5wdXNoKC4uLnNjb3Blcyk7XG4gICAgICBvcHRpb25zLnNjb3BlICYmIF9zY29wZXMucHVzaCguLi5vcHRpb25zLnNjb3BlKTtcbiAgICAgIGNvbnN0IHVybCA9IG5ldyBVUkwoXCJodHRwczovL3NsYWNrLmNvbS9vcGVuaWQvY29ubmVjdC9hdXRob3JpemVcIik7XG4gICAgICB1cmwuc2VhcmNoUGFyYW1zLnNldChcInNjb3BlXCIsIF9zY29wZXMuam9pbihcIiBcIikpO1xuICAgICAgdXJsLnNlYXJjaFBhcmFtcy5zZXQoXCJyZXNwb25zZV90eXBlXCIsIFwiY29kZVwiKTtcbiAgICAgIHVybC5zZWFyY2hQYXJhbXMuc2V0KFwiY2xpZW50X2lkXCIsIG9wdGlvbnMuY2xpZW50SWQpO1xuICAgICAgdXJsLnNlYXJjaFBhcmFtcy5zZXQoXCJyZWRpcmVjdF91cmlcIiwgb3B0aW9ucy5yZWRpcmVjdFVSSSB8fCByZWRpcmVjdFVSSSk7XG4gICAgICB1cmwuc2VhcmNoUGFyYW1zLnNldChcInN0YXRlXCIsIHN0YXRlKTtcbiAgICAgIHJldHVybiB1cmw7XG4gICAgfSxcbiAgICB2YWxpZGF0ZUF1dGhvcml6YXRpb25Db2RlOiBhc3luYyAoeyBjb2RlLCByZWRpcmVjdFVSSSB9KSA9PiB7XG4gICAgICByZXR1cm4gdmFsaWRhdGVBdXRob3JpemF0aW9uQ29kZSh7XG4gICAgICAgIGNvZGUsXG4gICAgICAgIHJlZGlyZWN0VVJJLFxuICAgICAgICBvcHRpb25zLFxuICAgICAgICB0b2tlbkVuZHBvaW50OiBcImh0dHBzOi8vc2xhY2suY29tL2FwaS9vcGVuaWQuY29ubmVjdC50b2tlblwiXG4gICAgICB9KTtcbiAgICB9LFxuICAgIHJlZnJlc2hBY2Nlc3NUb2tlbjogb3B0aW9ucy5yZWZyZXNoQWNjZXNzVG9rZW4gPyBvcHRpb25zLnJlZnJlc2hBY2Nlc3NUb2tlbiA6IGFzeW5jIChyZWZyZXNoVG9rZW4pID0+IHtcbiAgICAgIHJldHVybiByZWZyZXNoQWNjZXNzVG9rZW4oe1xuICAgICAgICByZWZyZXNoVG9rZW4sXG4gICAgICAgIG9wdGlvbnM6IHtcbiAgICAgICAgICBjbGllbnRJZDogb3B0aW9ucy5jbGllbnRJZCxcbiAgICAgICAgICBjbGllbnRLZXk6IG9wdGlvbnMuY2xpZW50S2V5LFxuICAgICAgICAgIGNsaWVudFNlY3JldDogb3B0aW9ucy5jbGllbnRTZWNyZXRcbiAgICAgICAgfSxcbiAgICAgICAgdG9rZW5FbmRwb2ludDogXCJodHRwczovL3NsYWNrLmNvbS9hcGkvb3BlbmlkLmNvbm5lY3QudG9rZW5cIlxuICAgICAgfSk7XG4gICAgfSxcbiAgICBhc3luYyBnZXRVc2VySW5mbyh0b2tlbikge1xuICAgICAgaWYgKG9wdGlvbnMuZ2V0VXNlckluZm8pIHtcbiAgICAgICAgcmV0dXJuIG9wdGlvbnMuZ2V0VXNlckluZm8odG9rZW4pO1xuICAgICAgfVxuICAgICAgY29uc3QgeyBkYXRhOiBwcm9maWxlLCBlcnJvciB9ID0gYXdhaXQgYmV0dGVyRmV0Y2goXG4gICAgICAgIFwiaHR0cHM6Ly9zbGFjay5jb20vYXBpL29wZW5pZC5jb25uZWN0LnVzZXJJbmZvXCIsXG4gICAgICAgIHtcbiAgICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgICBhdXRob3JpemF0aW9uOiBgQmVhcmVyICR7dG9rZW4uYWNjZXNzVG9rZW59YFxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgKTtcbiAgICAgIGlmIChlcnJvcikge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgIH1cbiAgICAgIGNvbnN0IHVzZXJNYXAgPSBhd2FpdCBvcHRpb25zLm1hcFByb2ZpbGVUb1VzZXI/Lihwcm9maWxlKTtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHVzZXI6IHtcbiAgICAgICAgICBpZDogcHJvZmlsZVtcImh0dHBzOi8vc2xhY2suY29tL3VzZXJfaWRcIl0sXG4gICAgICAgICAgbmFtZTogcHJvZmlsZS5uYW1lIHx8IFwiXCIsXG4gICAgICAgICAgZW1haWw6IHByb2ZpbGUuZW1haWwsXG4gICAgICAgICAgZW1haWxWZXJpZmllZDogcHJvZmlsZS5lbWFpbF92ZXJpZmllZCxcbiAgICAgICAgICBpbWFnZTogcHJvZmlsZS5waWN0dXJlIHx8IHByb2ZpbGVbXCJodHRwczovL3NsYWNrLmNvbS91c2VyX2ltYWdlXzUxMlwiXSxcbiAgICAgICAgICAuLi51c2VyTWFwXG4gICAgICAgIH0sXG4gICAgICAgIGRhdGE6IHByb2ZpbGVcbiAgICAgIH07XG4gICAgfSxcbiAgICBvcHRpb25zXG4gIH07XG59O1xuXG5jb25zdCBub3Rpb24gPSAob3B0aW9ucykgPT4ge1xuICBjb25zdCB0b2tlbkVuZHBvaW50ID0gXCJodHRwczovL2FwaS5ub3Rpb24uY29tL3YxL29hdXRoL3Rva2VuXCI7XG4gIHJldHVybiB7XG4gICAgaWQ6IFwibm90aW9uXCIsXG4gICAgbmFtZTogXCJOb3Rpb25cIixcbiAgICBjcmVhdGVBdXRob3JpemF0aW9uVVJMKHsgc3RhdGUsIHNjb3BlcywgbG9naW5IaW50LCByZWRpcmVjdFVSSSB9KSB7XG4gICAgICBjb25zdCBfc2NvcGVzID0gb3B0aW9ucy5kaXNhYmxlRGVmYXVsdFNjb3BlID8gW10gOiBbXTtcbiAgICAgIG9wdGlvbnMuc2NvcGUgJiYgX3Njb3Blcy5wdXNoKC4uLm9wdGlvbnMuc2NvcGUpO1xuICAgICAgc2NvcGVzICYmIF9zY29wZXMucHVzaCguLi5zY29wZXMpO1xuICAgICAgcmV0dXJuIGNyZWF0ZUF1dGhvcml6YXRpb25VUkwoe1xuICAgICAgICBpZDogXCJub3Rpb25cIixcbiAgICAgICAgb3B0aW9ucyxcbiAgICAgICAgYXV0aG9yaXphdGlvbkVuZHBvaW50OiBcImh0dHBzOi8vYXBpLm5vdGlvbi5jb20vdjEvb2F1dGgvYXV0aG9yaXplXCIsXG4gICAgICAgIHNjb3BlczogX3Njb3BlcyxcbiAgICAgICAgc3RhdGUsXG4gICAgICAgIHJlZGlyZWN0VVJJLFxuICAgICAgICBsb2dpbkhpbnQsXG4gICAgICAgIGFkZGl0aW9uYWxQYXJhbXM6IHtcbiAgICAgICAgICBvd25lcjogXCJ1c2VyXCJcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfSxcbiAgICB2YWxpZGF0ZUF1dGhvcml6YXRpb25Db2RlOiBhc3luYyAoeyBjb2RlLCByZWRpcmVjdFVSSSB9KSA9PiB7XG4gICAgICByZXR1cm4gdmFsaWRhdGVBdXRob3JpemF0aW9uQ29kZSh7XG4gICAgICAgIGNvZGUsXG4gICAgICAgIHJlZGlyZWN0VVJJLFxuICAgICAgICBvcHRpb25zLFxuICAgICAgICB0b2tlbkVuZHBvaW50LFxuICAgICAgICBhdXRoZW50aWNhdGlvbjogXCJiYXNpY1wiXG4gICAgICB9KTtcbiAgICB9LFxuICAgIHJlZnJlc2hBY2Nlc3NUb2tlbjogb3B0aW9ucy5yZWZyZXNoQWNjZXNzVG9rZW4gPyBvcHRpb25zLnJlZnJlc2hBY2Nlc3NUb2tlbiA6IGFzeW5jIChyZWZyZXNoVG9rZW4pID0+IHtcbiAgICAgIHJldHVybiByZWZyZXNoQWNjZXNzVG9rZW4oe1xuICAgICAgICByZWZyZXNoVG9rZW4sXG4gICAgICAgIG9wdGlvbnM6IHtcbiAgICAgICAgICBjbGllbnRJZDogb3B0aW9ucy5jbGllbnRJZCxcbiAgICAgICAgICBjbGllbnRLZXk6IG9wdGlvbnMuY2xpZW50S2V5LFxuICAgICAgICAgIGNsaWVudFNlY3JldDogb3B0aW9ucy5jbGllbnRTZWNyZXRcbiAgICAgICAgfSxcbiAgICAgICAgdG9rZW5FbmRwb2ludFxuICAgICAgfSk7XG4gICAgfSxcbiAgICBhc3luYyBnZXRVc2VySW5mbyh0b2tlbikge1xuICAgICAgaWYgKG9wdGlvbnMuZ2V0VXNlckluZm8pIHtcbiAgICAgICAgcmV0dXJuIG9wdGlvbnMuZ2V0VXNlckluZm8odG9rZW4pO1xuICAgICAgfVxuICAgICAgY29uc3QgeyBkYXRhOiBwcm9maWxlLCBlcnJvciB9ID0gYXdhaXQgYmV0dGVyRmV0Y2goXCJodHRwczovL2FwaS5ub3Rpb24uY29tL3YxL3VzZXJzL21lXCIsIHtcbiAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgIEF1dGhvcml6YXRpb246IGBCZWFyZXIgJHt0b2tlbi5hY2Nlc3NUb2tlbn1gLFxuICAgICAgICAgIFwiTm90aW9uLVZlcnNpb25cIjogXCIyMDIyLTA2LTI4XCJcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgICBpZiAoZXJyb3IgfHwgIXByb2ZpbGUpIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICB9XG4gICAgICBjb25zdCB1c2VyUHJvZmlsZSA9IHByb2ZpbGUuYm90Py5vd25lcj8udXNlcjtcbiAgICAgIGlmICghdXNlclByb2ZpbGUpIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICB9XG4gICAgICBjb25zdCB1c2VyTWFwID0gYXdhaXQgb3B0aW9ucy5tYXBQcm9maWxlVG9Vc2VyPy4odXNlclByb2ZpbGUpO1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgdXNlcjoge1xuICAgICAgICAgIGlkOiB1c2VyUHJvZmlsZS5pZCxcbiAgICAgICAgICBuYW1lOiB1c2VyUHJvZmlsZS5uYW1lIHx8IFwiTm90aW9uIFVzZXJcIixcbiAgICAgICAgICBlbWFpbDogdXNlclByb2ZpbGUucGVyc29uPy5lbWFpbCB8fCBudWxsLFxuICAgICAgICAgIGltYWdlOiB1c2VyUHJvZmlsZS5hdmF0YXJfdXJsLFxuICAgICAgICAgIGVtYWlsVmVyaWZpZWQ6ICEhdXNlclByb2ZpbGUucGVyc29uPy5lbWFpbCxcbiAgICAgICAgICAuLi51c2VyTWFwXG4gICAgICAgIH0sXG4gICAgICAgIGRhdGE6IHVzZXJQcm9maWxlXG4gICAgICB9O1xuICAgIH0sXG4gICAgb3B0aW9uc1xuICB9O1xufTtcblxuY29uc3Qgc3BvdGlmeSA9IChvcHRpb25zKSA9PiB7XG4gIHJldHVybiB7XG4gICAgaWQ6IFwic3BvdGlmeVwiLFxuICAgIG5hbWU6IFwiU3BvdGlmeVwiLFxuICAgIGNyZWF0ZUF1dGhvcml6YXRpb25VUkwoeyBzdGF0ZSwgc2NvcGVzLCBjb2RlVmVyaWZpZXIsIHJlZGlyZWN0VVJJIH0pIHtcbiAgICAgIGNvbnN0IF9zY29wZXMgPSBvcHRpb25zLmRpc2FibGVEZWZhdWx0U2NvcGUgPyBbXSA6IFtcInVzZXItcmVhZC1lbWFpbFwiXTtcbiAgICAgIG9wdGlvbnMuc2NvcGUgJiYgX3Njb3Blcy5wdXNoKC4uLm9wdGlvbnMuc2NvcGUpO1xuICAgICAgc2NvcGVzICYmIF9zY29wZXMucHVzaCguLi5zY29wZXMpO1xuICAgICAgcmV0dXJuIGNyZWF0ZUF1dGhvcml6YXRpb25VUkwoe1xuICAgICAgICBpZDogXCJzcG90aWZ5XCIsXG4gICAgICAgIG9wdGlvbnMsXG4gICAgICAgIGF1dGhvcml6YXRpb25FbmRwb2ludDogXCJodHRwczovL2FjY291bnRzLnNwb3RpZnkuY29tL2F1dGhvcml6ZVwiLFxuICAgICAgICBzY29wZXM6IF9zY29wZXMsXG4gICAgICAgIHN0YXRlLFxuICAgICAgICBjb2RlVmVyaWZpZXIsXG4gICAgICAgIHJlZGlyZWN0VVJJXG4gICAgICB9KTtcbiAgICB9LFxuICAgIHZhbGlkYXRlQXV0aG9yaXphdGlvbkNvZGU6IGFzeW5jICh7IGNvZGUsIGNvZGVWZXJpZmllciwgcmVkaXJlY3RVUkkgfSkgPT4ge1xuICAgICAgcmV0dXJuIHZhbGlkYXRlQXV0aG9yaXphdGlvbkNvZGUoe1xuICAgICAgICBjb2RlLFxuICAgICAgICBjb2RlVmVyaWZpZXIsXG4gICAgICAgIHJlZGlyZWN0VVJJLFxuICAgICAgICBvcHRpb25zLFxuICAgICAgICB0b2tlbkVuZHBvaW50OiBcImh0dHBzOi8vYWNjb3VudHMuc3BvdGlmeS5jb20vYXBpL3Rva2VuXCJcbiAgICAgIH0pO1xuICAgIH0sXG4gICAgcmVmcmVzaEFjY2Vzc1Rva2VuOiBvcHRpb25zLnJlZnJlc2hBY2Nlc3NUb2tlbiA/IG9wdGlvbnMucmVmcmVzaEFjY2Vzc1Rva2VuIDogYXN5bmMgKHJlZnJlc2hUb2tlbikgPT4ge1xuICAgICAgcmV0dXJuIHJlZnJlc2hBY2Nlc3NUb2tlbih7XG4gICAgICAgIHJlZnJlc2hUb2tlbixcbiAgICAgICAgb3B0aW9uczoge1xuICAgICAgICAgIGNsaWVudElkOiBvcHRpb25zLmNsaWVudElkLFxuICAgICAgICAgIGNsaWVudEtleTogb3B0aW9ucy5jbGllbnRLZXksXG4gICAgICAgICAgY2xpZW50U2VjcmV0OiBvcHRpb25zLmNsaWVudFNlY3JldFxuICAgICAgICB9LFxuICAgICAgICB0b2tlbkVuZHBvaW50OiBcImh0dHBzOi8vYWNjb3VudHMuc3BvdGlmeS5jb20vYXBpL3Rva2VuXCJcbiAgICAgIH0pO1xuICAgIH0sXG4gICAgYXN5bmMgZ2V0VXNlckluZm8odG9rZW4pIHtcbiAgICAgIGlmIChvcHRpb25zLmdldFVzZXJJbmZvKSB7XG4gICAgICAgIHJldHVybiBvcHRpb25zLmdldFVzZXJJbmZvKHRva2VuKTtcbiAgICAgIH1cbiAgICAgIGNvbnN0IHsgZGF0YTogcHJvZmlsZSwgZXJyb3IgfSA9IGF3YWl0IGJldHRlckZldGNoKFxuICAgICAgICBcImh0dHBzOi8vYXBpLnNwb3RpZnkuY29tL3YxL21lXCIsXG4gICAgICAgIHtcbiAgICAgICAgICBtZXRob2Q6IFwiR0VUXCIsXG4gICAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICAgQXV0aG9yaXphdGlvbjogYEJlYXJlciAke3Rva2VuLmFjY2Vzc1Rva2VufWBcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICk7XG4gICAgICBpZiAoZXJyb3IpIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICB9XG4gICAgICBjb25zdCB1c2VyTWFwID0gYXdhaXQgb3B0aW9ucy5tYXBQcm9maWxlVG9Vc2VyPy4ocHJvZmlsZSk7XG4gICAgICByZXR1cm4ge1xuICAgICAgICB1c2VyOiB7XG4gICAgICAgICAgaWQ6IHByb2ZpbGUuaWQsXG4gICAgICAgICAgbmFtZTogcHJvZmlsZS5kaXNwbGF5X25hbWUsXG4gICAgICAgICAgZW1haWw6IHByb2ZpbGUuZW1haWwsXG4gICAgICAgICAgaW1hZ2U6IHByb2ZpbGUuaW1hZ2VzWzBdPy51cmwsXG4gICAgICAgICAgZW1haWxWZXJpZmllZDogZmFsc2UsXG4gICAgICAgICAgLi4udXNlck1hcFxuICAgICAgICB9LFxuICAgICAgICBkYXRhOiBwcm9maWxlXG4gICAgICB9O1xuICAgIH0sXG4gICAgb3B0aW9uc1xuICB9O1xufTtcblxuY29uc3QgdHdpdGNoID0gKG9wdGlvbnMpID0+IHtcbiAgcmV0dXJuIHtcbiAgICBpZDogXCJ0d2l0Y2hcIixcbiAgICBuYW1lOiBcIlR3aXRjaFwiLFxuICAgIGNyZWF0ZUF1dGhvcml6YXRpb25VUkwoeyBzdGF0ZSwgc2NvcGVzLCByZWRpcmVjdFVSSSB9KSB7XG4gICAgICBjb25zdCBfc2NvcGVzID0gb3B0aW9ucy5kaXNhYmxlRGVmYXVsdFNjb3BlID8gW10gOiBbXCJ1c2VyOnJlYWQ6ZW1haWxcIiwgXCJvcGVuaWRcIl07XG4gICAgICBvcHRpb25zLnNjb3BlICYmIF9zY29wZXMucHVzaCguLi5vcHRpb25zLnNjb3BlKTtcbiAgICAgIHNjb3BlcyAmJiBfc2NvcGVzLnB1c2goLi4uc2NvcGVzKTtcbiAgICAgIHJldHVybiBjcmVhdGVBdXRob3JpemF0aW9uVVJMKHtcbiAgICAgICAgaWQ6IFwidHdpdGNoXCIsXG4gICAgICAgIHJlZGlyZWN0VVJJLFxuICAgICAgICBvcHRpb25zLFxuICAgICAgICBhdXRob3JpemF0aW9uRW5kcG9pbnQ6IFwiaHR0cHM6Ly9pZC50d2l0Y2gudHYvb2F1dGgyL2F1dGhvcml6ZVwiLFxuICAgICAgICBzY29wZXM6IF9zY29wZXMsXG4gICAgICAgIHN0YXRlLFxuICAgICAgICBjbGFpbXM6IG9wdGlvbnMuY2xhaW1zIHx8IFtcbiAgICAgICAgICBcImVtYWlsXCIsXG4gICAgICAgICAgXCJlbWFpbF92ZXJpZmllZFwiLFxuICAgICAgICAgIFwicHJlZmVycmVkX3VzZXJuYW1lXCIsXG4gICAgICAgICAgXCJwaWN0dXJlXCJcbiAgICAgICAgXVxuICAgICAgfSk7XG4gICAgfSxcbiAgICB2YWxpZGF0ZUF1dGhvcml6YXRpb25Db2RlOiBhc3luYyAoeyBjb2RlLCByZWRpcmVjdFVSSSB9KSA9PiB7XG4gICAgICByZXR1cm4gdmFsaWRhdGVBdXRob3JpemF0aW9uQ29kZSh7XG4gICAgICAgIGNvZGUsXG4gICAgICAgIHJlZGlyZWN0VVJJLFxuICAgICAgICBvcHRpb25zLFxuICAgICAgICB0b2tlbkVuZHBvaW50OiBcImh0dHBzOi8vaWQudHdpdGNoLnR2L29hdXRoMi90b2tlblwiXG4gICAgICB9KTtcbiAgICB9LFxuICAgIHJlZnJlc2hBY2Nlc3NUb2tlbjogb3B0aW9ucy5yZWZyZXNoQWNjZXNzVG9rZW4gPyBvcHRpb25zLnJlZnJlc2hBY2Nlc3NUb2tlbiA6IGFzeW5jIChyZWZyZXNoVG9rZW4pID0+IHtcbiAgICAgIHJldHVybiByZWZyZXNoQWNjZXNzVG9rZW4oe1xuICAgICAgICByZWZyZXNoVG9rZW4sXG4gICAgICAgIG9wdGlvbnM6IHtcbiAgICAgICAgICBjbGllbnRJZDogb3B0aW9ucy5jbGllbnRJZCxcbiAgICAgICAgICBjbGllbnRLZXk6IG9wdGlvbnMuY2xpZW50S2V5LFxuICAgICAgICAgIGNsaWVudFNlY3JldDogb3B0aW9ucy5jbGllbnRTZWNyZXRcbiAgICAgICAgfSxcbiAgICAgICAgdG9rZW5FbmRwb2ludDogXCJodHRwczovL2lkLnR3aXRjaC50di9vYXV0aDIvdG9rZW5cIlxuICAgICAgfSk7XG4gICAgfSxcbiAgICBhc3luYyBnZXRVc2VySW5mbyh0b2tlbikge1xuICAgICAgaWYgKG9wdGlvbnMuZ2V0VXNlckluZm8pIHtcbiAgICAgICAgcmV0dXJuIG9wdGlvbnMuZ2V0VXNlckluZm8odG9rZW4pO1xuICAgICAgfVxuICAgICAgY29uc3QgaWRUb2tlbiA9IHRva2VuLmlkVG9rZW47XG4gICAgICBpZiAoIWlkVG9rZW4pIHtcbiAgICAgICAgbG9nZ2VyLmVycm9yKFwiTm8gaWRUb2tlbiBmb3VuZCBpbiB0b2tlblwiKTtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICB9XG4gICAgICBjb25zdCBwcm9maWxlID0gZGVjb2RlSnd0KGlkVG9rZW4pO1xuICAgICAgY29uc3QgdXNlck1hcCA9IGF3YWl0IG9wdGlvbnMubWFwUHJvZmlsZVRvVXNlcj8uKHByb2ZpbGUpO1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgdXNlcjoge1xuICAgICAgICAgIGlkOiBwcm9maWxlLnN1YixcbiAgICAgICAgICBuYW1lOiBwcm9maWxlLnByZWZlcnJlZF91c2VybmFtZSxcbiAgICAgICAgICBlbWFpbDogcHJvZmlsZS5lbWFpbCxcbiAgICAgICAgICBpbWFnZTogcHJvZmlsZS5waWN0dXJlLFxuICAgICAgICAgIGVtYWlsVmVyaWZpZWQ6IHByb2ZpbGUuZW1haWxfdmVyaWZpZWQsXG4gICAgICAgICAgLi4udXNlck1hcFxuICAgICAgICB9LFxuICAgICAgICBkYXRhOiBwcm9maWxlXG4gICAgICB9O1xuICAgIH0sXG4gICAgb3B0aW9uc1xuICB9O1xufTtcblxuY29uc3QgdHdpdHRlciA9IChvcHRpb25zKSA9PiB7XG4gIHJldHVybiB7XG4gICAgaWQ6IFwidHdpdHRlclwiLFxuICAgIG5hbWU6IFwiVHdpdHRlclwiLFxuICAgIGNyZWF0ZUF1dGhvcml6YXRpb25VUkwoZGF0YSkge1xuICAgICAgY29uc3QgX3Njb3BlcyA9IG9wdGlvbnMuZGlzYWJsZURlZmF1bHRTY29wZSA/IFtdIDogW1widXNlcnMucmVhZFwiLCBcInR3ZWV0LnJlYWRcIiwgXCJvZmZsaW5lLmFjY2Vzc1wiLCBcInVzZXJzLmVtYWlsXCJdO1xuICAgICAgb3B0aW9ucy5zY29wZSAmJiBfc2NvcGVzLnB1c2goLi4ub3B0aW9ucy5zY29wZSk7XG4gICAgICBkYXRhLnNjb3BlcyAmJiBfc2NvcGVzLnB1c2goLi4uZGF0YS5zY29wZXMpO1xuICAgICAgcmV0dXJuIGNyZWF0ZUF1dGhvcml6YXRpb25VUkwoe1xuICAgICAgICBpZDogXCJ0d2l0dGVyXCIsXG4gICAgICAgIG9wdGlvbnMsXG4gICAgICAgIGF1dGhvcml6YXRpb25FbmRwb2ludDogXCJodHRwczovL3guY29tL2kvb2F1dGgyL2F1dGhvcml6ZVwiLFxuICAgICAgICBzY29wZXM6IF9zY29wZXMsXG4gICAgICAgIHN0YXRlOiBkYXRhLnN0YXRlLFxuICAgICAgICBjb2RlVmVyaWZpZXI6IGRhdGEuY29kZVZlcmlmaWVyLFxuICAgICAgICByZWRpcmVjdFVSSTogZGF0YS5yZWRpcmVjdFVSSVxuICAgICAgfSk7XG4gICAgfSxcbiAgICB2YWxpZGF0ZUF1dGhvcml6YXRpb25Db2RlOiBhc3luYyAoeyBjb2RlLCBjb2RlVmVyaWZpZXIsIHJlZGlyZWN0VVJJIH0pID0+IHtcbiAgICAgIHJldHVybiB2YWxpZGF0ZUF1dGhvcml6YXRpb25Db2RlKHtcbiAgICAgICAgY29kZSxcbiAgICAgICAgY29kZVZlcmlmaWVyLFxuICAgICAgICBhdXRoZW50aWNhdGlvbjogXCJiYXNpY1wiLFxuICAgICAgICByZWRpcmVjdFVSSSxcbiAgICAgICAgb3B0aW9ucyxcbiAgICAgICAgdG9rZW5FbmRwb2ludDogXCJodHRwczovL2FwaS54LmNvbS8yL29hdXRoMi90b2tlblwiXG4gICAgICB9KTtcbiAgICB9LFxuICAgIHJlZnJlc2hBY2Nlc3NUb2tlbjogb3B0aW9ucy5yZWZyZXNoQWNjZXNzVG9rZW4gPyBvcHRpb25zLnJlZnJlc2hBY2Nlc3NUb2tlbiA6IGFzeW5jIChyZWZyZXNoVG9rZW4pID0+IHtcbiAgICAgIHJldHVybiByZWZyZXNoQWNjZXNzVG9rZW4oe1xuICAgICAgICByZWZyZXNoVG9rZW4sXG4gICAgICAgIG9wdGlvbnM6IHtcbiAgICAgICAgICBjbGllbnRJZDogb3B0aW9ucy5jbGllbnRJZCxcbiAgICAgICAgICBjbGllbnRLZXk6IG9wdGlvbnMuY2xpZW50S2V5LFxuICAgICAgICAgIGNsaWVudFNlY3JldDogb3B0aW9ucy5jbGllbnRTZWNyZXRcbiAgICAgICAgfSxcbiAgICAgICAgYXV0aGVudGljYXRpb246IFwiYmFzaWNcIixcbiAgICAgICAgdG9rZW5FbmRwb2ludDogXCJodHRwczovL2FwaS54LmNvbS8yL29hdXRoMi90b2tlblwiXG4gICAgICB9KTtcbiAgICB9LFxuICAgIGFzeW5jIGdldFVzZXJJbmZvKHRva2VuKSB7XG4gICAgICBpZiAob3B0aW9ucy5nZXRVc2VySW5mbykge1xuICAgICAgICByZXR1cm4gb3B0aW9ucy5nZXRVc2VySW5mbyh0b2tlbik7XG4gICAgICB9XG4gICAgICBjb25zdCB7IGRhdGE6IHByb2ZpbGUsIGVycm9yOiBwcm9maWxlRXJyb3IgfSA9IGF3YWl0IGJldHRlckZldGNoKFxuICAgICAgICBcImh0dHBzOi8vYXBpLnguY29tLzIvdXNlcnMvbWU/dXNlci5maWVsZHM9cHJvZmlsZV9pbWFnZV91cmxcIixcbiAgICAgICAge1xuICAgICAgICAgIG1ldGhvZDogXCJHRVRcIixcbiAgICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgICBBdXRob3JpemF0aW9uOiBgQmVhcmVyICR7dG9rZW4uYWNjZXNzVG9rZW59YFxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgKTtcbiAgICAgIGlmIChwcm9maWxlRXJyb3IpIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICB9XG4gICAgICBjb25zdCB7IGRhdGE6IGVtYWlsRGF0YSwgZXJyb3I6IGVtYWlsRXJyb3IgfSA9IGF3YWl0IGJldHRlckZldGNoKFwiaHR0cHM6Ly9hcGkueC5jb20vMi91c2Vycy9tZT91c2VyLmZpZWxkcz1jb25maXJtZWRfZW1haWxcIiwge1xuICAgICAgICBtZXRob2Q6IFwiR0VUXCIsXG4gICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICBBdXRob3JpemF0aW9uOiBgQmVhcmVyICR7dG9rZW4uYWNjZXNzVG9rZW59YFxuICAgICAgICB9XG4gICAgICB9KTtcbiAgICAgIGxldCBlbWFpbFZlcmlmaWVkID0gZmFsc2U7XG4gICAgICBpZiAoIWVtYWlsRXJyb3IgJiYgZW1haWxEYXRhPy5kYXRhPy5jb25maXJtZWRfZW1haWwpIHtcbiAgICAgICAgcHJvZmlsZS5kYXRhLmVtYWlsID0gZW1haWxEYXRhLmRhdGEuY29uZmlybWVkX2VtYWlsO1xuICAgICAgICBlbWFpbFZlcmlmaWVkID0gdHJ1ZTtcbiAgICAgIH1cbiAgICAgIGNvbnN0IHVzZXJNYXAgPSBhd2FpdCBvcHRpb25zLm1hcFByb2ZpbGVUb1VzZXI/Lihwcm9maWxlKTtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHVzZXI6IHtcbiAgICAgICAgICBpZDogcHJvZmlsZS5kYXRhLmlkLFxuICAgICAgICAgIG5hbWU6IHByb2ZpbGUuZGF0YS5uYW1lLFxuICAgICAgICAgIGVtYWlsOiBwcm9maWxlLmRhdGEuZW1haWwgfHwgcHJvZmlsZS5kYXRhLnVzZXJuYW1lIHx8IG51bGwsXG4gICAgICAgICAgaW1hZ2U6IHByb2ZpbGUuZGF0YS5wcm9maWxlX2ltYWdlX3VybCxcbiAgICAgICAgICBlbWFpbFZlcmlmaWVkLFxuICAgICAgICAgIC4uLnVzZXJNYXBcbiAgICAgICAgfSxcbiAgICAgICAgZGF0YTogcHJvZmlsZVxuICAgICAgfTtcbiAgICB9LFxuICAgIG9wdGlvbnNcbiAgfTtcbn07XG5cbmNvbnN0IGRyb3Bib3ggPSAob3B0aW9ucykgPT4ge1xuICBjb25zdCB0b2tlbkVuZHBvaW50ID0gXCJodHRwczovL2FwaS5kcm9wYm94YXBpLmNvbS9vYXV0aDIvdG9rZW5cIjtcbiAgcmV0dXJuIHtcbiAgICBpZDogXCJkcm9wYm94XCIsXG4gICAgbmFtZTogXCJEcm9wYm94XCIsXG4gICAgY3JlYXRlQXV0aG9yaXphdGlvblVSTDogYXN5bmMgKHtcbiAgICAgIHN0YXRlLFxuICAgICAgc2NvcGVzLFxuICAgICAgY29kZVZlcmlmaWVyLFxuICAgICAgcmVkaXJlY3RVUklcbiAgICB9KSA9PiB7XG4gICAgICBjb25zdCBfc2NvcGVzID0gb3B0aW9ucy5kaXNhYmxlRGVmYXVsdFNjb3BlID8gW10gOiBbXCJhY2NvdW50X2luZm8ucmVhZFwiXTtcbiAgICAgIG9wdGlvbnMuc2NvcGUgJiYgX3Njb3Blcy5wdXNoKC4uLm9wdGlvbnMuc2NvcGUpO1xuICAgICAgc2NvcGVzICYmIF9zY29wZXMucHVzaCguLi5zY29wZXMpO1xuICAgICAgY29uc3QgYWRkaXRpb25hbFBhcmFtcyA9IHt9O1xuICAgICAgaWYgKG9wdGlvbnMuYWNjZXNzVHlwZSkge1xuICAgICAgICBhZGRpdGlvbmFsUGFyYW1zLnRva2VuX2FjY2Vzc190eXBlID0gb3B0aW9ucy5hY2Nlc3NUeXBlO1xuICAgICAgfVxuICAgICAgcmV0dXJuIGF3YWl0IGNyZWF0ZUF1dGhvcml6YXRpb25VUkwoe1xuICAgICAgICBpZDogXCJkcm9wYm94XCIsXG4gICAgICAgIG9wdGlvbnMsXG4gICAgICAgIGF1dGhvcml6YXRpb25FbmRwb2ludDogXCJodHRwczovL3d3dy5kcm9wYm94LmNvbS9vYXV0aDIvYXV0aG9yaXplXCIsXG4gICAgICAgIHNjb3BlczogX3Njb3BlcyxcbiAgICAgICAgc3RhdGUsXG4gICAgICAgIHJlZGlyZWN0VVJJLFxuICAgICAgICBjb2RlVmVyaWZpZXIsXG4gICAgICAgIGFkZGl0aW9uYWxQYXJhbXNcbiAgICAgIH0pO1xuICAgIH0sXG4gICAgdmFsaWRhdGVBdXRob3JpemF0aW9uQ29kZTogYXN5bmMgKHsgY29kZSwgY29kZVZlcmlmaWVyLCByZWRpcmVjdFVSSSB9KSA9PiB7XG4gICAgICByZXR1cm4gYXdhaXQgdmFsaWRhdGVBdXRob3JpemF0aW9uQ29kZSh7XG4gICAgICAgIGNvZGUsXG4gICAgICAgIGNvZGVWZXJpZmllcixcbiAgICAgICAgcmVkaXJlY3RVUkksXG4gICAgICAgIG9wdGlvbnMsXG4gICAgICAgIHRva2VuRW5kcG9pbnRcbiAgICAgIH0pO1xuICAgIH0sXG4gICAgcmVmcmVzaEFjY2Vzc1Rva2VuOiBvcHRpb25zLnJlZnJlc2hBY2Nlc3NUb2tlbiA/IG9wdGlvbnMucmVmcmVzaEFjY2Vzc1Rva2VuIDogYXN5bmMgKHJlZnJlc2hUb2tlbikgPT4ge1xuICAgICAgcmV0dXJuIHJlZnJlc2hBY2Nlc3NUb2tlbih7XG4gICAgICAgIHJlZnJlc2hUb2tlbixcbiAgICAgICAgb3B0aW9uczoge1xuICAgICAgICAgIGNsaWVudElkOiBvcHRpb25zLmNsaWVudElkLFxuICAgICAgICAgIGNsaWVudEtleTogb3B0aW9ucy5jbGllbnRLZXksXG4gICAgICAgICAgY2xpZW50U2VjcmV0OiBvcHRpb25zLmNsaWVudFNlY3JldFxuICAgICAgICB9LFxuICAgICAgICB0b2tlbkVuZHBvaW50OiBcImh0dHBzOi8vYXBpLmRyb3Bib3guY29tL29hdXRoMi90b2tlblwiXG4gICAgICB9KTtcbiAgICB9LFxuICAgIGFzeW5jIGdldFVzZXJJbmZvKHRva2VuKSB7XG4gICAgICBpZiAob3B0aW9ucy5nZXRVc2VySW5mbykge1xuICAgICAgICByZXR1cm4gb3B0aW9ucy5nZXRVc2VySW5mbyh0b2tlbik7XG4gICAgICB9XG4gICAgICBjb25zdCB7IGRhdGE6IHByb2ZpbGUsIGVycm9yIH0gPSBhd2FpdCBiZXR0ZXJGZXRjaChcbiAgICAgICAgXCJodHRwczovL2FwaS5kcm9wYm94YXBpLmNvbS8yL3VzZXJzL2dldF9jdXJyZW50X2FjY291bnRcIixcbiAgICAgICAge1xuICAgICAgICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICAgQXV0aG9yaXphdGlvbjogYEJlYXJlciAke3Rva2VuLmFjY2Vzc1Rva2VufWBcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICk7XG4gICAgICBpZiAoZXJyb3IpIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICB9XG4gICAgICBjb25zdCB1c2VyTWFwID0gYXdhaXQgb3B0aW9ucy5tYXBQcm9maWxlVG9Vc2VyPy4ocHJvZmlsZSk7XG4gICAgICByZXR1cm4ge1xuICAgICAgICB1c2VyOiB7XG4gICAgICAgICAgaWQ6IHByb2ZpbGUuYWNjb3VudF9pZCxcbiAgICAgICAgICBuYW1lOiBwcm9maWxlLm5hbWU/LmRpc3BsYXlfbmFtZSxcbiAgICAgICAgICBlbWFpbDogcHJvZmlsZS5lbWFpbCxcbiAgICAgICAgICBlbWFpbFZlcmlmaWVkOiBwcm9maWxlLmVtYWlsX3ZlcmlmaWVkIHx8IGZhbHNlLFxuICAgICAgICAgIGltYWdlOiBwcm9maWxlLnByb2ZpbGVfcGhvdG9fdXJsLFxuICAgICAgICAgIC4uLnVzZXJNYXBcbiAgICAgICAgfSxcbiAgICAgICAgZGF0YTogcHJvZmlsZVxuICAgICAgfTtcbiAgICB9LFxuICAgIG9wdGlvbnNcbiAgfTtcbn07XG5cbmNvbnN0IGxpbmVhciA9IChvcHRpb25zKSA9PiB7XG4gIGNvbnN0IHRva2VuRW5kcG9pbnQgPSBcImh0dHBzOi8vYXBpLmxpbmVhci5hcHAvb2F1dGgvdG9rZW5cIjtcbiAgcmV0dXJuIHtcbiAgICBpZDogXCJsaW5lYXJcIixcbiAgICBuYW1lOiBcIkxpbmVhclwiLFxuICAgIGNyZWF0ZUF1dGhvcml6YXRpb25VUkwoeyBzdGF0ZSwgc2NvcGVzLCBsb2dpbkhpbnQsIHJlZGlyZWN0VVJJIH0pIHtcbiAgICAgIGNvbnN0IF9zY29wZXMgPSBvcHRpb25zLmRpc2FibGVEZWZhdWx0U2NvcGUgPyBbXSA6IFtcInJlYWRcIl07XG4gICAgICBvcHRpb25zLnNjb3BlICYmIF9zY29wZXMucHVzaCguLi5vcHRpb25zLnNjb3BlKTtcbiAgICAgIHNjb3BlcyAmJiBfc2NvcGVzLnB1c2goLi4uc2NvcGVzKTtcbiAgICAgIHJldHVybiBjcmVhdGVBdXRob3JpemF0aW9uVVJMKHtcbiAgICAgICAgaWQ6IFwibGluZWFyXCIsXG4gICAgICAgIG9wdGlvbnMsXG4gICAgICAgIGF1dGhvcml6YXRpb25FbmRwb2ludDogXCJodHRwczovL2xpbmVhci5hcHAvb2F1dGgvYXV0aG9yaXplXCIsXG4gICAgICAgIHNjb3BlczogX3Njb3BlcyxcbiAgICAgICAgc3RhdGUsXG4gICAgICAgIHJlZGlyZWN0VVJJLFxuICAgICAgICBsb2dpbkhpbnRcbiAgICAgIH0pO1xuICAgIH0sXG4gICAgdmFsaWRhdGVBdXRob3JpemF0aW9uQ29kZTogYXN5bmMgKHsgY29kZSwgcmVkaXJlY3RVUkkgfSkgPT4ge1xuICAgICAgcmV0dXJuIHZhbGlkYXRlQXV0aG9yaXphdGlvbkNvZGUoe1xuICAgICAgICBjb2RlLFxuICAgICAgICByZWRpcmVjdFVSSSxcbiAgICAgICAgb3B0aW9ucyxcbiAgICAgICAgdG9rZW5FbmRwb2ludFxuICAgICAgfSk7XG4gICAgfSxcbiAgICByZWZyZXNoQWNjZXNzVG9rZW46IG9wdGlvbnMucmVmcmVzaEFjY2Vzc1Rva2VuID8gb3B0aW9ucy5yZWZyZXNoQWNjZXNzVG9rZW4gOiBhc3luYyAocmVmcmVzaFRva2VuKSA9PiB7XG4gICAgICByZXR1cm4gcmVmcmVzaEFjY2Vzc1Rva2VuKHtcbiAgICAgICAgcmVmcmVzaFRva2VuLFxuICAgICAgICBvcHRpb25zOiB7XG4gICAgICAgICAgY2xpZW50SWQ6IG9wdGlvbnMuY2xpZW50SWQsXG4gICAgICAgICAgY2xpZW50S2V5OiBvcHRpb25zLmNsaWVudEtleSxcbiAgICAgICAgICBjbGllbnRTZWNyZXQ6IG9wdGlvbnMuY2xpZW50U2VjcmV0XG4gICAgICAgIH0sXG4gICAgICAgIHRva2VuRW5kcG9pbnRcbiAgICAgIH0pO1xuICAgIH0sXG4gICAgYXN5bmMgZ2V0VXNlckluZm8odG9rZW4pIHtcbiAgICAgIGlmIChvcHRpb25zLmdldFVzZXJJbmZvKSB7XG4gICAgICAgIHJldHVybiBvcHRpb25zLmdldFVzZXJJbmZvKHRva2VuKTtcbiAgICAgIH1cbiAgICAgIGNvbnN0IHsgZGF0YTogcHJvZmlsZSwgZXJyb3IgfSA9IGF3YWl0IGJldHRlckZldGNoKFxuICAgICAgICBcImh0dHBzOi8vYXBpLmxpbmVhci5hcHAvZ3JhcGhxbFwiLFxuICAgICAgICB7XG4gICAgICAgICAgbWV0aG9kOiBcIlBPU1RcIixcbiAgICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcbiAgICAgICAgICAgIEF1dGhvcml6YXRpb246IGBCZWFyZXIgJHt0b2tlbi5hY2Nlc3NUb2tlbn1gXG4gICAgICAgICAgfSxcbiAgICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgICAgICBxdWVyeTogYFxuXHRcdFx0XHRcdFx0XHRxdWVyeSB7XG5cdFx0XHRcdFx0XHRcdFx0dmlld2VyIHtcblx0XHRcdFx0XHRcdFx0XHRcdGlkXG5cdFx0XHRcdFx0XHRcdFx0XHRuYW1lXG5cdFx0XHRcdFx0XHRcdFx0XHRlbWFpbFxuXHRcdFx0XHRcdFx0XHRcdFx0YXZhdGFyVXJsXG5cdFx0XHRcdFx0XHRcdFx0XHRhY3RpdmVcblx0XHRcdFx0XHRcdFx0XHRcdGNyZWF0ZWRBdFxuXHRcdFx0XHRcdFx0XHRcdFx0dXBkYXRlZEF0XG5cdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRgXG4gICAgICAgICAgfSlcbiAgICAgICAgfVxuICAgICAgKTtcbiAgICAgIGlmIChlcnJvciB8fCAhcHJvZmlsZT8uZGF0YT8udmlld2VyKSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgICAgfVxuICAgICAgY29uc3QgdXNlckRhdGEgPSBwcm9maWxlLmRhdGEudmlld2VyO1xuICAgICAgY29uc3QgdXNlck1hcCA9IGF3YWl0IG9wdGlvbnMubWFwUHJvZmlsZVRvVXNlcj8uKHVzZXJEYXRhKTtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHVzZXI6IHtcbiAgICAgICAgICBpZDogcHJvZmlsZS5kYXRhLnZpZXdlci5pZCxcbiAgICAgICAgICBuYW1lOiBwcm9maWxlLmRhdGEudmlld2VyLm5hbWUsXG4gICAgICAgICAgZW1haWw6IHByb2ZpbGUuZGF0YS52aWV3ZXIuZW1haWwsXG4gICAgICAgICAgaW1hZ2U6IHByb2ZpbGUuZGF0YS52aWV3ZXIuYXZhdGFyVXJsLFxuICAgICAgICAgIGVtYWlsVmVyaWZpZWQ6IHRydWUsXG4gICAgICAgICAgLi4udXNlck1hcFxuICAgICAgICB9LFxuICAgICAgICBkYXRhOiB1c2VyRGF0YVxuICAgICAgfTtcbiAgICB9LFxuICAgIG9wdGlvbnNcbiAgfTtcbn07XG5cbmNvbnN0IGxpbmtlZGluID0gKG9wdGlvbnMpID0+IHtcbiAgY29uc3QgYXV0aG9yaXphdGlvbkVuZHBvaW50ID0gXCJodHRwczovL3d3dy5saW5rZWRpbi5jb20vb2F1dGgvdjIvYXV0aG9yaXphdGlvblwiO1xuICBjb25zdCB0b2tlbkVuZHBvaW50ID0gXCJodHRwczovL3d3dy5saW5rZWRpbi5jb20vb2F1dGgvdjIvYWNjZXNzVG9rZW5cIjtcbiAgcmV0dXJuIHtcbiAgICBpZDogXCJsaW5rZWRpblwiLFxuICAgIG5hbWU6IFwiTGlua2VkaW5cIixcbiAgICBjcmVhdGVBdXRob3JpemF0aW9uVVJMOiBhc3luYyAoe1xuICAgICAgc3RhdGUsXG4gICAgICBzY29wZXMsXG4gICAgICByZWRpcmVjdFVSSSxcbiAgICAgIGxvZ2luSGludFxuICAgIH0pID0+IHtcbiAgICAgIGNvbnN0IF9zY29wZXMgPSBvcHRpb25zLmRpc2FibGVEZWZhdWx0U2NvcGUgPyBbXSA6IFtcInByb2ZpbGVcIiwgXCJlbWFpbFwiLCBcIm9wZW5pZFwiXTtcbiAgICAgIG9wdGlvbnMuc2NvcGUgJiYgX3Njb3Blcy5wdXNoKC4uLm9wdGlvbnMuc2NvcGUpO1xuICAgICAgc2NvcGVzICYmIF9zY29wZXMucHVzaCguLi5zY29wZXMpO1xuICAgICAgcmV0dXJuIGF3YWl0IGNyZWF0ZUF1dGhvcml6YXRpb25VUkwoe1xuICAgICAgICBpZDogXCJsaW5rZWRpblwiLFxuICAgICAgICBvcHRpb25zLFxuICAgICAgICBhdXRob3JpemF0aW9uRW5kcG9pbnQsXG4gICAgICAgIHNjb3BlczogX3Njb3BlcyxcbiAgICAgICAgc3RhdGUsXG4gICAgICAgIGxvZ2luSGludCxcbiAgICAgICAgcmVkaXJlY3RVUklcbiAgICAgIH0pO1xuICAgIH0sXG4gICAgdmFsaWRhdGVBdXRob3JpemF0aW9uQ29kZTogYXN5bmMgKHsgY29kZSwgcmVkaXJlY3RVUkkgfSkgPT4ge1xuICAgICAgcmV0dXJuIGF3YWl0IHZhbGlkYXRlQXV0aG9yaXphdGlvbkNvZGUoe1xuICAgICAgICBjb2RlLFxuICAgICAgICByZWRpcmVjdFVSSSxcbiAgICAgICAgb3B0aW9ucyxcbiAgICAgICAgdG9rZW5FbmRwb2ludFxuICAgICAgfSk7XG4gICAgfSxcbiAgICByZWZyZXNoQWNjZXNzVG9rZW46IG9wdGlvbnMucmVmcmVzaEFjY2Vzc1Rva2VuID8gb3B0aW9ucy5yZWZyZXNoQWNjZXNzVG9rZW4gOiBhc3luYyAocmVmcmVzaFRva2VuKSA9PiB7XG4gICAgICByZXR1cm4gcmVmcmVzaEFjY2Vzc1Rva2VuKHtcbiAgICAgICAgcmVmcmVzaFRva2VuLFxuICAgICAgICBvcHRpb25zOiB7XG4gICAgICAgICAgY2xpZW50SWQ6IG9wdGlvbnMuY2xpZW50SWQsXG4gICAgICAgICAgY2xpZW50S2V5OiBvcHRpb25zLmNsaWVudEtleSxcbiAgICAgICAgICBjbGllbnRTZWNyZXQ6IG9wdGlvbnMuY2xpZW50U2VjcmV0XG4gICAgICAgIH0sXG4gICAgICAgIHRva2VuRW5kcG9pbnRcbiAgICAgIH0pO1xuICAgIH0sXG4gICAgYXN5bmMgZ2V0VXNlckluZm8odG9rZW4pIHtcbiAgICAgIGlmIChvcHRpb25zLmdldFVzZXJJbmZvKSB7XG4gICAgICAgIHJldHVybiBvcHRpb25zLmdldFVzZXJJbmZvKHRva2VuKTtcbiAgICAgIH1cbiAgICAgIGNvbnN0IHsgZGF0YTogcHJvZmlsZSwgZXJyb3IgfSA9IGF3YWl0IGJldHRlckZldGNoKFxuICAgICAgICBcImh0dHBzOi8vYXBpLmxpbmtlZGluLmNvbS92Mi91c2VyaW5mb1wiLFxuICAgICAgICB7XG4gICAgICAgICAgbWV0aG9kOiBcIkdFVFwiLFxuICAgICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAgIEF1dGhvcml6YXRpb246IGBCZWFyZXIgJHt0b2tlbi5hY2Nlc3NUb2tlbn1gXG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICApO1xuICAgICAgaWYgKGVycm9yKSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgICAgfVxuICAgICAgY29uc3QgdXNlck1hcCA9IGF3YWl0IG9wdGlvbnMubWFwUHJvZmlsZVRvVXNlcj8uKHByb2ZpbGUpO1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgdXNlcjoge1xuICAgICAgICAgIGlkOiBwcm9maWxlLnN1YixcbiAgICAgICAgICBuYW1lOiBwcm9maWxlLm5hbWUsXG4gICAgICAgICAgZW1haWw6IHByb2ZpbGUuZW1haWwsXG4gICAgICAgICAgZW1haWxWZXJpZmllZDogcHJvZmlsZS5lbWFpbF92ZXJpZmllZCB8fCBmYWxzZSxcbiAgICAgICAgICBpbWFnZTogcHJvZmlsZS5waWN0dXJlLFxuICAgICAgICAgIC4uLnVzZXJNYXBcbiAgICAgICAgfSxcbiAgICAgICAgZGF0YTogcHJvZmlsZVxuICAgICAgfTtcbiAgICB9LFxuICAgIG9wdGlvbnNcbiAgfTtcbn07XG5cbmNvbnN0IGNsZWFuRG91YmxlU2xhc2hlcyA9IChpbnB1dCA9IFwiXCIpID0+IHtcbiAgcmV0dXJuIGlucHV0LnNwbGl0KFwiOi8vXCIpLm1hcCgoc3RyKSA9PiBzdHIucmVwbGFjZSgvXFwvezIsfS9nLCBcIi9cIikpLmpvaW4oXCI6Ly9cIik7XG59O1xuY29uc3QgaXNzdWVyVG9FbmRwb2ludHMgPSAoaXNzdWVyKSA9PiB7XG4gIGxldCBiYXNlVXJsID0gaXNzdWVyIHx8IFwiaHR0cHM6Ly9naXRsYWIuY29tXCI7XG4gIHJldHVybiB7XG4gICAgYXV0aG9yaXphdGlvbkVuZHBvaW50OiBjbGVhbkRvdWJsZVNsYXNoZXMoYCR7YmFzZVVybH0vb2F1dGgvYXV0aG9yaXplYCksXG4gICAgdG9rZW5FbmRwb2ludDogY2xlYW5Eb3VibGVTbGFzaGVzKGAke2Jhc2VVcmx9L29hdXRoL3Rva2VuYCksXG4gICAgdXNlcmluZm9FbmRwb2ludDogY2xlYW5Eb3VibGVTbGFzaGVzKGAke2Jhc2VVcmx9L2FwaS92NC91c2VyYClcbiAgfTtcbn07XG5jb25zdCBnaXRsYWIgPSAob3B0aW9ucykgPT4ge1xuICBjb25zdCB7IGF1dGhvcml6YXRpb25FbmRwb2ludCwgdG9rZW5FbmRwb2ludCwgdXNlcmluZm9FbmRwb2ludCB9ID0gaXNzdWVyVG9FbmRwb2ludHMob3B0aW9ucy5pc3N1ZXIpO1xuICBjb25zdCBpc3N1ZXJJZCA9IFwiZ2l0bGFiXCI7XG4gIGNvbnN0IGlzc3Vlck5hbWUgPSBcIkdpdGxhYlwiO1xuICByZXR1cm4ge1xuICAgIGlkOiBpc3N1ZXJJZCxcbiAgICBuYW1lOiBpc3N1ZXJOYW1lLFxuICAgIGNyZWF0ZUF1dGhvcml6YXRpb25VUkw6IGFzeW5jICh7XG4gICAgICBzdGF0ZSxcbiAgICAgIHNjb3BlcyxcbiAgICAgIGNvZGVWZXJpZmllcixcbiAgICAgIGxvZ2luSGludCxcbiAgICAgIHJlZGlyZWN0VVJJXG4gICAgfSkgPT4ge1xuICAgICAgY29uc3QgX3Njb3BlcyA9IG9wdGlvbnMuZGlzYWJsZURlZmF1bHRTY29wZSA/IFtdIDogW1wicmVhZF91c2VyXCJdO1xuICAgICAgb3B0aW9ucy5zY29wZSAmJiBfc2NvcGVzLnB1c2goLi4ub3B0aW9ucy5zY29wZSk7XG4gICAgICBzY29wZXMgJiYgX3Njb3Blcy5wdXNoKC4uLnNjb3Blcyk7XG4gICAgICByZXR1cm4gYXdhaXQgY3JlYXRlQXV0aG9yaXphdGlvblVSTCh7XG4gICAgICAgIGlkOiBpc3N1ZXJJZCxcbiAgICAgICAgb3B0aW9ucyxcbiAgICAgICAgYXV0aG9yaXphdGlvbkVuZHBvaW50LFxuICAgICAgICBzY29wZXM6IF9zY29wZXMsXG4gICAgICAgIHN0YXRlLFxuICAgICAgICByZWRpcmVjdFVSSSxcbiAgICAgICAgY29kZVZlcmlmaWVyLFxuICAgICAgICBsb2dpbkhpbnRcbiAgICAgIH0pO1xuICAgIH0sXG4gICAgdmFsaWRhdGVBdXRob3JpemF0aW9uQ29kZTogYXN5bmMgKHsgY29kZSwgcmVkaXJlY3RVUkksIGNvZGVWZXJpZmllciB9KSA9PiB7XG4gICAgICByZXR1cm4gdmFsaWRhdGVBdXRob3JpemF0aW9uQ29kZSh7XG4gICAgICAgIGNvZGUsXG4gICAgICAgIHJlZGlyZWN0VVJJLFxuICAgICAgICBvcHRpb25zLFxuICAgICAgICBjb2RlVmVyaWZpZXIsXG4gICAgICAgIHRva2VuRW5kcG9pbnRcbiAgICAgIH0pO1xuICAgIH0sXG4gICAgcmVmcmVzaEFjY2Vzc1Rva2VuOiBvcHRpb25zLnJlZnJlc2hBY2Nlc3NUb2tlbiA/IG9wdGlvbnMucmVmcmVzaEFjY2Vzc1Rva2VuIDogYXN5bmMgKHJlZnJlc2hUb2tlbikgPT4ge1xuICAgICAgcmV0dXJuIHJlZnJlc2hBY2Nlc3NUb2tlbih7XG4gICAgICAgIHJlZnJlc2hUb2tlbixcbiAgICAgICAgb3B0aW9uczoge1xuICAgICAgICAgIGNsaWVudElkOiBvcHRpb25zLmNsaWVudElkLFxuICAgICAgICAgIGNsaWVudEtleTogb3B0aW9ucy5jbGllbnRLZXksXG4gICAgICAgICAgY2xpZW50U2VjcmV0OiBvcHRpb25zLmNsaWVudFNlY3JldFxuICAgICAgICB9LFxuICAgICAgICB0b2tlbkVuZHBvaW50XG4gICAgICB9KTtcbiAgICB9LFxuICAgIGFzeW5jIGdldFVzZXJJbmZvKHRva2VuKSB7XG4gICAgICBpZiAob3B0aW9ucy5nZXRVc2VySW5mbykge1xuICAgICAgICByZXR1cm4gb3B0aW9ucy5nZXRVc2VySW5mbyh0b2tlbik7XG4gICAgICB9XG4gICAgICBjb25zdCB7IGRhdGE6IHByb2ZpbGUsIGVycm9yIH0gPSBhd2FpdCBiZXR0ZXJGZXRjaChcbiAgICAgICAgdXNlcmluZm9FbmRwb2ludCxcbiAgICAgICAgeyBoZWFkZXJzOiB7IGF1dGhvcml6YXRpb246IGBCZWFyZXIgJHt0b2tlbi5hY2Nlc3NUb2tlbn1gIH0gfVxuICAgICAgKTtcbiAgICAgIGlmIChlcnJvciB8fCBwcm9maWxlLnN0YXRlICE9PSBcImFjdGl2ZVwiIHx8IHByb2ZpbGUubG9ja2VkKSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgICAgfVxuICAgICAgY29uc3QgdXNlck1hcCA9IGF3YWl0IG9wdGlvbnMubWFwUHJvZmlsZVRvVXNlcj8uKHByb2ZpbGUpO1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgdXNlcjoge1xuICAgICAgICAgIGlkOiBwcm9maWxlLmlkLFxuICAgICAgICAgIG5hbWU6IHByb2ZpbGUubmFtZSA/PyBwcm9maWxlLnVzZXJuYW1lLFxuICAgICAgICAgIGVtYWlsOiBwcm9maWxlLmVtYWlsLFxuICAgICAgICAgIGltYWdlOiBwcm9maWxlLmF2YXRhcl91cmwsXG4gICAgICAgICAgZW1haWxWZXJpZmllZDogdHJ1ZSxcbiAgICAgICAgICAuLi51c2VyTWFwXG4gICAgICAgIH0sXG4gICAgICAgIGRhdGE6IHByb2ZpbGVcbiAgICAgIH07XG4gICAgfSxcbiAgICBvcHRpb25zXG4gIH07XG59O1xuXG5jb25zdCB0aWt0b2sgPSAob3B0aW9ucykgPT4ge1xuICByZXR1cm4ge1xuICAgIGlkOiBcInRpa3Rva1wiLFxuICAgIG5hbWU6IFwiVGlrVG9rXCIsXG4gICAgY3JlYXRlQXV0aG9yaXphdGlvblVSTCh7IHN0YXRlLCBzY29wZXMsIHJlZGlyZWN0VVJJIH0pIHtcbiAgICAgIGNvbnN0IF9zY29wZXMgPSBvcHRpb25zLmRpc2FibGVEZWZhdWx0U2NvcGUgPyBbXSA6IFtcInVzZXIuaW5mby5wcm9maWxlXCJdO1xuICAgICAgb3B0aW9ucy5zY29wZSAmJiBfc2NvcGVzLnB1c2goLi4ub3B0aW9ucy5zY29wZSk7XG4gICAgICBzY29wZXMgJiYgX3Njb3Blcy5wdXNoKC4uLnNjb3Blcyk7XG4gICAgICByZXR1cm4gbmV3IFVSTChcbiAgICAgICAgYGh0dHBzOi8vd3d3LnRpa3Rvay5jb20vdjIvYXV0aC9hdXRob3JpemU/c2NvcGU9JHtfc2NvcGVzLmpvaW4oXG4gICAgICAgICAgXCIsXCJcbiAgICAgICAgKX0mcmVzcG9uc2VfdHlwZT1jb2RlJmNsaWVudF9rZXk9JHtvcHRpb25zLmNsaWVudEtleX0mcmVkaXJlY3RfdXJpPSR7ZW5jb2RlVVJJQ29tcG9uZW50KFxuICAgICAgICAgIG9wdGlvbnMucmVkaXJlY3RVUkkgfHwgcmVkaXJlY3RVUklcbiAgICAgICAgKX0mc3RhdGU9JHtzdGF0ZX1gXG4gICAgICApO1xuICAgIH0sXG4gICAgdmFsaWRhdGVBdXRob3JpemF0aW9uQ29kZTogYXN5bmMgKHsgY29kZSwgcmVkaXJlY3RVUkkgfSkgPT4ge1xuICAgICAgcmV0dXJuIHZhbGlkYXRlQXV0aG9yaXphdGlvbkNvZGUoe1xuICAgICAgICBjb2RlLFxuICAgICAgICByZWRpcmVjdFVSSTogb3B0aW9ucy5yZWRpcmVjdFVSSSB8fCByZWRpcmVjdFVSSSxcbiAgICAgICAgb3B0aW9uczoge1xuICAgICAgICAgIGNsaWVudEtleTogb3B0aW9ucy5jbGllbnRLZXksXG4gICAgICAgICAgY2xpZW50U2VjcmV0OiBvcHRpb25zLmNsaWVudFNlY3JldFxuICAgICAgICB9LFxuICAgICAgICB0b2tlbkVuZHBvaW50OiBcImh0dHBzOi8vb3Blbi50aWt0b2thcGlzLmNvbS92Mi9vYXV0aC90b2tlbi9cIlxuICAgICAgfSk7XG4gICAgfSxcbiAgICByZWZyZXNoQWNjZXNzVG9rZW46IG9wdGlvbnMucmVmcmVzaEFjY2Vzc1Rva2VuID8gb3B0aW9ucy5yZWZyZXNoQWNjZXNzVG9rZW4gOiBhc3luYyAocmVmcmVzaFRva2VuKSA9PiB7XG4gICAgICByZXR1cm4gcmVmcmVzaEFjY2Vzc1Rva2VuKHtcbiAgICAgICAgcmVmcmVzaFRva2VuLFxuICAgICAgICBvcHRpb25zOiB7XG4gICAgICAgICAgY2xpZW50U2VjcmV0OiBvcHRpb25zLmNsaWVudFNlY3JldFxuICAgICAgICB9LFxuICAgICAgICB0b2tlbkVuZHBvaW50OiBcImh0dHBzOi8vb3Blbi50aWt0b2thcGlzLmNvbS92Mi9vYXV0aC90b2tlbi9cIixcbiAgICAgICAgYXV0aGVudGljYXRpb246IFwicG9zdFwiLFxuICAgICAgICBleHRyYVBhcmFtczoge1xuICAgICAgICAgIGNsaWVudF9rZXk6IG9wdGlvbnMuY2xpZW50S2V5XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH0sXG4gICAgYXN5bmMgZ2V0VXNlckluZm8odG9rZW4pIHtcbiAgICAgIGlmIChvcHRpb25zLmdldFVzZXJJbmZvKSB7XG4gICAgICAgIHJldHVybiBvcHRpb25zLmdldFVzZXJJbmZvKHRva2VuKTtcbiAgICAgIH1cbiAgICAgIGNvbnN0IGZpZWxkcyA9IFtcbiAgICAgICAgXCJvcGVuX2lkXCIsXG4gICAgICAgIFwiYXZhdGFyX2xhcmdlX3VybFwiLFxuICAgICAgICBcImRpc3BsYXlfbmFtZVwiLFxuICAgICAgICBcInVzZXJuYW1lXCJcbiAgICAgIF07XG4gICAgICBjb25zdCB7IGRhdGE6IHByb2ZpbGUsIGVycm9yIH0gPSBhd2FpdCBiZXR0ZXJGZXRjaChcbiAgICAgICAgYGh0dHBzOi8vb3Blbi50aWt0b2thcGlzLmNvbS92Mi91c2VyL2luZm8vP2ZpZWxkcz0ke2ZpZWxkcy5qb2luKFwiLFwiKX1gLFxuICAgICAgICB7XG4gICAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICAgYXV0aG9yaXphdGlvbjogYEJlYXJlciAke3Rva2VuLmFjY2Vzc1Rva2VufWBcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICk7XG4gICAgICBpZiAoZXJyb3IpIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICB9XG4gICAgICByZXR1cm4ge1xuICAgICAgICB1c2VyOiB7XG4gICAgICAgICAgZW1haWw6IHByb2ZpbGUuZGF0YS51c2VyLmVtYWlsIHx8IHByb2ZpbGUuZGF0YS51c2VyLnVzZXJuYW1lLFxuICAgICAgICAgIGlkOiBwcm9maWxlLmRhdGEudXNlci5vcGVuX2lkLFxuICAgICAgICAgIG5hbWU6IHByb2ZpbGUuZGF0YS51c2VyLmRpc3BsYXlfbmFtZSB8fCBwcm9maWxlLmRhdGEudXNlci51c2VybmFtZSxcbiAgICAgICAgICBpbWFnZTogcHJvZmlsZS5kYXRhLnVzZXIuYXZhdGFyX2xhcmdlX3VybCxcbiAgICAgICAgICAvKiogQG5vdGUgVGlrdG9rIGRvZXMgbm90IHByb3ZpZGUgZW1haWxWZXJpZmllZCBvciBldmVuIGVtYWlsKi9cbiAgICAgICAgICBlbWFpbFZlcmlmaWVkOiBwcm9maWxlLmRhdGEudXNlci5lbWFpbCA/IHRydWUgOiBmYWxzZVxuICAgICAgICB9LFxuICAgICAgICBkYXRhOiBwcm9maWxlXG4gICAgICB9O1xuICAgIH0sXG4gICAgb3B0aW9uc1xuICB9O1xufTtcblxuY29uc3QgcmVkZGl0ID0gKG9wdGlvbnMpID0+IHtcbiAgcmV0dXJuIHtcbiAgICBpZDogXCJyZWRkaXRcIixcbiAgICBuYW1lOiBcIlJlZGRpdFwiLFxuICAgIGNyZWF0ZUF1dGhvcml6YXRpb25VUkwoeyBzdGF0ZSwgc2NvcGVzLCByZWRpcmVjdFVSSSB9KSB7XG4gICAgICBjb25zdCBfc2NvcGVzID0gb3B0aW9ucy5kaXNhYmxlRGVmYXVsdFNjb3BlID8gW10gOiBbXCJpZGVudGl0eVwiXTtcbiAgICAgIG9wdGlvbnMuc2NvcGUgJiYgX3Njb3Blcy5wdXNoKC4uLm9wdGlvbnMuc2NvcGUpO1xuICAgICAgc2NvcGVzICYmIF9zY29wZXMucHVzaCguLi5zY29wZXMpO1xuICAgICAgcmV0dXJuIGNyZWF0ZUF1dGhvcml6YXRpb25VUkwoe1xuICAgICAgICBpZDogXCJyZWRkaXRcIixcbiAgICAgICAgb3B0aW9ucyxcbiAgICAgICAgYXV0aG9yaXphdGlvbkVuZHBvaW50OiBcImh0dHBzOi8vd3d3LnJlZGRpdC5jb20vYXBpL3YxL2F1dGhvcml6ZVwiLFxuICAgICAgICBzY29wZXM6IF9zY29wZXMsXG4gICAgICAgIHN0YXRlLFxuICAgICAgICByZWRpcmVjdFVSSSxcbiAgICAgICAgZHVyYXRpb246IG9wdGlvbnMuZHVyYXRpb25cbiAgICAgIH0pO1xuICAgIH0sXG4gICAgdmFsaWRhdGVBdXRob3JpemF0aW9uQ29kZTogYXN5bmMgKHsgY29kZSwgcmVkaXJlY3RVUkkgfSkgPT4ge1xuICAgICAgY29uc3QgYm9keSA9IG5ldyBVUkxTZWFyY2hQYXJhbXMoe1xuICAgICAgICBncmFudF90eXBlOiBcImF1dGhvcml6YXRpb25fY29kZVwiLFxuICAgICAgICBjb2RlLFxuICAgICAgICByZWRpcmVjdF91cmk6IG9wdGlvbnMucmVkaXJlY3RVUkkgfHwgcmVkaXJlY3RVUklcbiAgICAgIH0pO1xuICAgICAgY29uc3QgaGVhZGVycyA9IHtcbiAgICAgICAgXCJjb250ZW50LXR5cGVcIjogXCJhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWRcIixcbiAgICAgICAgYWNjZXB0OiBcInRleHQvcGxhaW5cIixcbiAgICAgICAgXCJ1c2VyLWFnZW50XCI6IFwiYmV0dGVyLWF1dGhcIixcbiAgICAgICAgQXV0aG9yaXphdGlvbjogYEJhc2ljICR7YmFzZTY0LmVuY29kZShcbiAgICAgICAgICBgJHtvcHRpb25zLmNsaWVudElkfToke29wdGlvbnMuY2xpZW50U2VjcmV0fWBcbiAgICAgICAgKX1gXG4gICAgICB9O1xuICAgICAgY29uc3QgeyBkYXRhLCBlcnJvciB9ID0gYXdhaXQgYmV0dGVyRmV0Y2goXG4gICAgICAgIFwiaHR0cHM6Ly93d3cucmVkZGl0LmNvbS9hcGkvdjEvYWNjZXNzX3Rva2VuXCIsXG4gICAgICAgIHtcbiAgICAgICAgICBtZXRob2Q6IFwiUE9TVFwiLFxuICAgICAgICAgIGhlYWRlcnMsXG4gICAgICAgICAgYm9keTogYm9keS50b1N0cmluZygpXG4gICAgICAgIH1cbiAgICAgICk7XG4gICAgICBpZiAoZXJyb3IpIHtcbiAgICAgICAgdGhyb3cgZXJyb3I7XG4gICAgICB9XG4gICAgICByZXR1cm4gZ2V0T0F1dGgyVG9rZW5zKGRhdGEpO1xuICAgIH0sXG4gICAgcmVmcmVzaEFjY2Vzc1Rva2VuOiBvcHRpb25zLnJlZnJlc2hBY2Nlc3NUb2tlbiA/IG9wdGlvbnMucmVmcmVzaEFjY2Vzc1Rva2VuIDogYXN5bmMgKHJlZnJlc2hUb2tlbikgPT4ge1xuICAgICAgcmV0dXJuIHJlZnJlc2hBY2Nlc3NUb2tlbih7XG4gICAgICAgIHJlZnJlc2hUb2tlbixcbiAgICAgICAgb3B0aW9uczoge1xuICAgICAgICAgIGNsaWVudElkOiBvcHRpb25zLmNsaWVudElkLFxuICAgICAgICAgIGNsaWVudEtleTogb3B0aW9ucy5jbGllbnRLZXksXG4gICAgICAgICAgY2xpZW50U2VjcmV0OiBvcHRpb25zLmNsaWVudFNlY3JldFxuICAgICAgICB9LFxuICAgICAgICBhdXRoZW50aWNhdGlvbjogXCJiYXNpY1wiLFxuICAgICAgICB0b2tlbkVuZHBvaW50OiBcImh0dHBzOi8vd3d3LnJlZGRpdC5jb20vYXBpL3YxL2FjY2Vzc190b2tlblwiXG4gICAgICB9KTtcbiAgICB9LFxuICAgIGFzeW5jIGdldFVzZXJJbmZvKHRva2VuKSB7XG4gICAgICBpZiAob3B0aW9ucy5nZXRVc2VySW5mbykge1xuICAgICAgICByZXR1cm4gb3B0aW9ucy5nZXRVc2VySW5mbyh0b2tlbik7XG4gICAgICB9XG4gICAgICBjb25zdCB7IGRhdGE6IHByb2ZpbGUsIGVycm9yIH0gPSBhd2FpdCBiZXR0ZXJGZXRjaChcbiAgICAgICAgXCJodHRwczovL29hdXRoLnJlZGRpdC5jb20vYXBpL3YxL21lXCIsXG4gICAgICAgIHtcbiAgICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgICBBdXRob3JpemF0aW9uOiBgQmVhcmVyICR7dG9rZW4uYWNjZXNzVG9rZW59YCxcbiAgICAgICAgICAgIFwiVXNlci1BZ2VudFwiOiBcImJldHRlci1hdXRoXCJcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICk7XG4gICAgICBpZiAoZXJyb3IpIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICB9XG4gICAgICBjb25zdCB1c2VyTWFwID0gYXdhaXQgb3B0aW9ucy5tYXBQcm9maWxlVG9Vc2VyPy4ocHJvZmlsZSk7XG4gICAgICByZXR1cm4ge1xuICAgICAgICB1c2VyOiB7XG4gICAgICAgICAgaWQ6IHByb2ZpbGUuaWQsXG4gICAgICAgICAgbmFtZTogcHJvZmlsZS5uYW1lLFxuICAgICAgICAgIGVtYWlsOiBwcm9maWxlLm9hdXRoX2NsaWVudF9pZCxcbiAgICAgICAgICBlbWFpbFZlcmlmaWVkOiBwcm9maWxlLmhhc192ZXJpZmllZF9lbWFpbCxcbiAgICAgICAgICBpbWFnZTogcHJvZmlsZS5pY29uX2ltZz8uc3BsaXQoXCI/XCIpWzBdLFxuICAgICAgICAgIC4uLnVzZXJNYXBcbiAgICAgICAgfSxcbiAgICAgICAgZGF0YTogcHJvZmlsZVxuICAgICAgfTtcbiAgICB9LFxuICAgIG9wdGlvbnNcbiAgfTtcbn07XG5cbmNvbnN0IHJvYmxveCA9IChvcHRpb25zKSA9PiB7XG4gIHJldHVybiB7XG4gICAgaWQ6IFwicm9ibG94XCIsXG4gICAgbmFtZTogXCJSb2Jsb3hcIixcbiAgICBjcmVhdGVBdXRob3JpemF0aW9uVVJMKHsgc3RhdGUsIHNjb3BlcywgcmVkaXJlY3RVUkkgfSkge1xuICAgICAgY29uc3QgX3Njb3BlcyA9IG9wdGlvbnMuZGlzYWJsZURlZmF1bHRTY29wZSA/IFtdIDogW1wib3BlbmlkXCIsIFwicHJvZmlsZVwiXTtcbiAgICAgIG9wdGlvbnMuc2NvcGUgJiYgX3Njb3Blcy5wdXNoKC4uLm9wdGlvbnMuc2NvcGUpO1xuICAgICAgc2NvcGVzICYmIF9zY29wZXMucHVzaCguLi5zY29wZXMpO1xuICAgICAgcmV0dXJuIG5ldyBVUkwoXG4gICAgICAgIGBodHRwczovL2FwaXMucm9ibG94LmNvbS9vYXV0aC92MS9hdXRob3JpemU/c2NvcGU9JHtfc2NvcGVzLmpvaW4oXG4gICAgICAgICAgXCIrXCJcbiAgICAgICAgKX0mcmVzcG9uc2VfdHlwZT1jb2RlJmNsaWVudF9pZD0ke29wdGlvbnMuY2xpZW50SWR9JnJlZGlyZWN0X3VyaT0ke2VuY29kZVVSSUNvbXBvbmVudChcbiAgICAgICAgICBvcHRpb25zLnJlZGlyZWN0VVJJIHx8IHJlZGlyZWN0VVJJXG4gICAgICAgICl9JnN0YXRlPSR7c3RhdGV9JnByb21wdD0ke29wdGlvbnMucHJvbXB0IHx8IFwic2VsZWN0X2FjY291bnQgY29uc2VudFwifWBcbiAgICAgICk7XG4gICAgfSxcbiAgICB2YWxpZGF0ZUF1dGhvcml6YXRpb25Db2RlOiBhc3luYyAoeyBjb2RlLCByZWRpcmVjdFVSSSB9KSA9PiB7XG4gICAgICByZXR1cm4gdmFsaWRhdGVBdXRob3JpemF0aW9uQ29kZSh7XG4gICAgICAgIGNvZGUsXG4gICAgICAgIHJlZGlyZWN0VVJJOiBvcHRpb25zLnJlZGlyZWN0VVJJIHx8IHJlZGlyZWN0VVJJLFxuICAgICAgICBvcHRpb25zLFxuICAgICAgICB0b2tlbkVuZHBvaW50OiBcImh0dHBzOi8vYXBpcy5yb2Jsb3guY29tL29hdXRoL3YxL3Rva2VuXCIsXG4gICAgICAgIGF1dGhlbnRpY2F0aW9uOiBcInBvc3RcIlxuICAgICAgfSk7XG4gICAgfSxcbiAgICByZWZyZXNoQWNjZXNzVG9rZW46IG9wdGlvbnMucmVmcmVzaEFjY2Vzc1Rva2VuID8gb3B0aW9ucy5yZWZyZXNoQWNjZXNzVG9rZW4gOiBhc3luYyAocmVmcmVzaFRva2VuKSA9PiB7XG4gICAgICByZXR1cm4gcmVmcmVzaEFjY2Vzc1Rva2VuKHtcbiAgICAgICAgcmVmcmVzaFRva2VuLFxuICAgICAgICBvcHRpb25zOiB7XG4gICAgICAgICAgY2xpZW50SWQ6IG9wdGlvbnMuY2xpZW50SWQsXG4gICAgICAgICAgY2xpZW50S2V5OiBvcHRpb25zLmNsaWVudEtleSxcbiAgICAgICAgICBjbGllbnRTZWNyZXQ6IG9wdGlvbnMuY2xpZW50U2VjcmV0XG4gICAgICAgIH0sXG4gICAgICAgIHRva2VuRW5kcG9pbnQ6IFwiaHR0cHM6Ly9hcGlzLnJvYmxveC5jb20vb2F1dGgvdjEvdG9rZW5cIlxuICAgICAgfSk7XG4gICAgfSxcbiAgICBhc3luYyBnZXRVc2VySW5mbyh0b2tlbikge1xuICAgICAgaWYgKG9wdGlvbnMuZ2V0VXNlckluZm8pIHtcbiAgICAgICAgcmV0dXJuIG9wdGlvbnMuZ2V0VXNlckluZm8odG9rZW4pO1xuICAgICAgfVxuICAgICAgY29uc3QgeyBkYXRhOiBwcm9maWxlLCBlcnJvciB9ID0gYXdhaXQgYmV0dGVyRmV0Y2goXG4gICAgICAgIFwiaHR0cHM6Ly9hcGlzLnJvYmxveC5jb20vb2F1dGgvdjEvdXNlcmluZm9cIixcbiAgICAgICAge1xuICAgICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAgIGF1dGhvcml6YXRpb246IGBCZWFyZXIgJHt0b2tlbi5hY2Nlc3NUb2tlbn1gXG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICApO1xuICAgICAgaWYgKGVycm9yKSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgICAgfVxuICAgICAgY29uc3QgdXNlck1hcCA9IGF3YWl0IG9wdGlvbnMubWFwUHJvZmlsZVRvVXNlcj8uKHByb2ZpbGUpO1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgdXNlcjoge1xuICAgICAgICAgIGlkOiBwcm9maWxlLnN1YixcbiAgICAgICAgICBuYW1lOiBwcm9maWxlLm5pY2tuYW1lIHx8IHByb2ZpbGUucHJlZmVycmVkX3VzZXJuYW1lIHx8IFwiXCIsXG4gICAgICAgICAgaW1hZ2U6IHByb2ZpbGUucGljdHVyZSxcbiAgICAgICAgICBlbWFpbDogcHJvZmlsZS5wcmVmZXJyZWRfdXNlcm5hbWUgfHwgbnVsbCxcbiAgICAgICAgICAvLyBSb2Jsb3ggZG9lcyBub3QgcHJvdmlkZSBlbWFpbFxuICAgICAgICAgIGVtYWlsVmVyaWZpZWQ6IHRydWUsXG4gICAgICAgICAgLi4udXNlck1hcFxuICAgICAgICB9LFxuICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgLi4ucHJvZmlsZVxuICAgICAgICB9XG4gICAgICB9O1xuICAgIH0sXG4gICAgb3B0aW9uc1xuICB9O1xufTtcblxuY29uc3Qgc2FsZXNmb3JjZSA9IChvcHRpb25zKSA9PiB7XG4gIGNvbnN0IGVudmlyb25tZW50ID0gb3B0aW9ucy5lbnZpcm9ubWVudCA/PyBcInByb2R1Y3Rpb25cIjtcbiAgY29uc3QgaXNTYW5kYm94ID0gZW52aXJvbm1lbnQgPT09IFwic2FuZGJveFwiO1xuICBjb25zdCBhdXRob3JpemF0aW9uRW5kcG9pbnQgPSBvcHRpb25zLmxvZ2luVXJsID8gYGh0dHBzOi8vJHtvcHRpb25zLmxvZ2luVXJsfS9zZXJ2aWNlcy9vYXV0aDIvYXV0aG9yaXplYCA6IGlzU2FuZGJveCA/IFwiaHR0cHM6Ly90ZXN0LnNhbGVzZm9yY2UuY29tL3NlcnZpY2VzL29hdXRoMi9hdXRob3JpemVcIiA6IFwiaHR0cHM6Ly9sb2dpbi5zYWxlc2ZvcmNlLmNvbS9zZXJ2aWNlcy9vYXV0aDIvYXV0aG9yaXplXCI7XG4gIGNvbnN0IHRva2VuRW5kcG9pbnQgPSBvcHRpb25zLmxvZ2luVXJsID8gYGh0dHBzOi8vJHtvcHRpb25zLmxvZ2luVXJsfS9zZXJ2aWNlcy9vYXV0aDIvdG9rZW5gIDogaXNTYW5kYm94ID8gXCJodHRwczovL3Rlc3Quc2FsZXNmb3JjZS5jb20vc2VydmljZXMvb2F1dGgyL3Rva2VuXCIgOiBcImh0dHBzOi8vbG9naW4uc2FsZXNmb3JjZS5jb20vc2VydmljZXMvb2F1dGgyL3Rva2VuXCI7XG4gIGNvbnN0IHVzZXJJbmZvRW5kcG9pbnQgPSBvcHRpb25zLmxvZ2luVXJsID8gYGh0dHBzOi8vJHtvcHRpb25zLmxvZ2luVXJsfS9zZXJ2aWNlcy9vYXV0aDIvdXNlcmluZm9gIDogaXNTYW5kYm94ID8gXCJodHRwczovL3Rlc3Quc2FsZXNmb3JjZS5jb20vc2VydmljZXMvb2F1dGgyL3VzZXJpbmZvXCIgOiBcImh0dHBzOi8vbG9naW4uc2FsZXNmb3JjZS5jb20vc2VydmljZXMvb2F1dGgyL3VzZXJpbmZvXCI7XG4gIHJldHVybiB7XG4gICAgaWQ6IFwic2FsZXNmb3JjZVwiLFxuICAgIG5hbWU6IFwiU2FsZXNmb3JjZVwiLFxuICAgIGFzeW5jIGNyZWF0ZUF1dGhvcml6YXRpb25VUkwoeyBzdGF0ZSwgc2NvcGVzLCBjb2RlVmVyaWZpZXIsIHJlZGlyZWN0VVJJIH0pIHtcbiAgICAgIGlmICghb3B0aW9ucy5jbGllbnRJZCB8fCAhb3B0aW9ucy5jbGllbnRTZWNyZXQpIHtcbiAgICAgICAgbG9nZ2VyLmVycm9yKFxuICAgICAgICAgIFwiQ2xpZW50IElkIGFuZCBDbGllbnQgU2VjcmV0IGFyZSByZXF1aXJlZCBmb3IgU2FsZXNmb3JjZS4gTWFrZSBzdXJlIHRvIHByb3ZpZGUgdGhlbSBpbiB0aGUgb3B0aW9ucy5cIlxuICAgICAgICApO1xuICAgICAgICB0aHJvdyBuZXcgQmV0dGVyQXV0aEVycm9yKFwiQ0xJRU5UX0lEX0FORF9TRUNSRVRfUkVRVUlSRURcIik7XG4gICAgICB9XG4gICAgICBpZiAoIWNvZGVWZXJpZmllcikge1xuICAgICAgICB0aHJvdyBuZXcgQmV0dGVyQXV0aEVycm9yKFwiY29kZVZlcmlmaWVyIGlzIHJlcXVpcmVkIGZvciBTYWxlc2ZvcmNlXCIpO1xuICAgICAgfVxuICAgICAgY29uc3QgX3Njb3BlcyA9IG9wdGlvbnMuZGlzYWJsZURlZmF1bHRTY29wZSA/IFtdIDogW1wib3BlbmlkXCIsIFwiZW1haWxcIiwgXCJwcm9maWxlXCJdO1xuICAgICAgb3B0aW9ucy5zY29wZSAmJiBfc2NvcGVzLnB1c2goLi4ub3B0aW9ucy5zY29wZSk7XG4gICAgICBzY29wZXMgJiYgX3Njb3Blcy5wdXNoKC4uLnNjb3Blcyk7XG4gICAgICByZXR1cm4gY3JlYXRlQXV0aG9yaXphdGlvblVSTCh7XG4gICAgICAgIGlkOiBcInNhbGVzZm9yY2VcIixcbiAgICAgICAgb3B0aW9ucyxcbiAgICAgICAgYXV0aG9yaXphdGlvbkVuZHBvaW50LFxuICAgICAgICBzY29wZXM6IF9zY29wZXMsXG4gICAgICAgIHN0YXRlLFxuICAgICAgICBjb2RlVmVyaWZpZXIsXG4gICAgICAgIHJlZGlyZWN0VVJJOiBvcHRpb25zLnJlZGlyZWN0VVJJIHx8IHJlZGlyZWN0VVJJXG4gICAgICB9KTtcbiAgICB9LFxuICAgIHZhbGlkYXRlQXV0aG9yaXphdGlvbkNvZGU6IGFzeW5jICh7IGNvZGUsIGNvZGVWZXJpZmllciwgcmVkaXJlY3RVUkkgfSkgPT4ge1xuICAgICAgcmV0dXJuIHZhbGlkYXRlQXV0aG9yaXphdGlvbkNvZGUoe1xuICAgICAgICBjb2RlLFxuICAgICAgICBjb2RlVmVyaWZpZXIsXG4gICAgICAgIHJlZGlyZWN0VVJJOiBvcHRpb25zLnJlZGlyZWN0VVJJIHx8IHJlZGlyZWN0VVJJLFxuICAgICAgICBvcHRpb25zLFxuICAgICAgICB0b2tlbkVuZHBvaW50XG4gICAgICB9KTtcbiAgICB9LFxuICAgIHJlZnJlc2hBY2Nlc3NUb2tlbjogb3B0aW9ucy5yZWZyZXNoQWNjZXNzVG9rZW4gPyBvcHRpb25zLnJlZnJlc2hBY2Nlc3NUb2tlbiA6IGFzeW5jIChyZWZyZXNoVG9rZW4pID0+IHtcbiAgICAgIHJldHVybiByZWZyZXNoQWNjZXNzVG9rZW4oe1xuICAgICAgICByZWZyZXNoVG9rZW4sXG4gICAgICAgIG9wdGlvbnM6IHtcbiAgICAgICAgICBjbGllbnRJZDogb3B0aW9ucy5jbGllbnRJZCxcbiAgICAgICAgICBjbGllbnRTZWNyZXQ6IG9wdGlvbnMuY2xpZW50U2VjcmV0XG4gICAgICAgIH0sXG4gICAgICAgIHRva2VuRW5kcG9pbnRcbiAgICAgIH0pO1xuICAgIH0sXG4gICAgYXN5bmMgZ2V0VXNlckluZm8odG9rZW4pIHtcbiAgICAgIGlmIChvcHRpb25zLmdldFVzZXJJbmZvKSB7XG4gICAgICAgIHJldHVybiBvcHRpb25zLmdldFVzZXJJbmZvKHRva2VuKTtcbiAgICAgIH1cbiAgICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IHsgZGF0YTogdXNlciB9ID0gYXdhaXQgYmV0dGVyRmV0Y2goXG4gICAgICAgICAgdXNlckluZm9FbmRwb2ludCxcbiAgICAgICAgICB7XG4gICAgICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgICAgIEF1dGhvcml6YXRpb246IGBCZWFyZXIgJHt0b2tlbi5hY2Nlc3NUb2tlbn1gXG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICApO1xuICAgICAgICBpZiAoIXVzZXIpIHtcbiAgICAgICAgICBsb2dnZXIuZXJyb3IoXCJGYWlsZWQgdG8gZmV0Y2ggdXNlciBpbmZvIGZyb20gU2FsZXNmb3JjZVwiKTtcbiAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCB1c2VyTWFwID0gYXdhaXQgb3B0aW9ucy5tYXBQcm9maWxlVG9Vc2VyPy4odXNlcik7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgdXNlcjoge1xuICAgICAgICAgICAgaWQ6IHVzZXIudXNlcl9pZCxcbiAgICAgICAgICAgIG5hbWU6IHVzZXIubmFtZSxcbiAgICAgICAgICAgIGVtYWlsOiB1c2VyLmVtYWlsLFxuICAgICAgICAgICAgaW1hZ2U6IHVzZXIucGhvdG9zPy5waWN0dXJlIHx8IHVzZXIucGhvdG9zPy50aHVtYm5haWwsXG4gICAgICAgICAgICBlbWFpbFZlcmlmaWVkOiB1c2VyLmVtYWlsX3ZlcmlmaWVkID8/IGZhbHNlLFxuICAgICAgICAgICAgLi4udXNlck1hcFxuICAgICAgICAgIH0sXG4gICAgICAgICAgZGF0YTogdXNlclxuICAgICAgICB9O1xuICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgbG9nZ2VyLmVycm9yKFwiRmFpbGVkIHRvIGZldGNoIHVzZXIgaW5mbyBmcm9tIFNhbGVzZm9yY2U6XCIsIGVycm9yKTtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICB9XG4gICAgfSxcbiAgICBvcHRpb25zXG4gIH07XG59O1xuXG5jb25zdCB2ayA9IChvcHRpb25zKSA9PiB7XG4gIHJldHVybiB7XG4gICAgaWQ6IFwidmtcIixcbiAgICBuYW1lOiBcIlZLXCIsXG4gICAgYXN5bmMgY3JlYXRlQXV0aG9yaXphdGlvblVSTCh7IHN0YXRlLCBzY29wZXMsIGNvZGVWZXJpZmllciwgcmVkaXJlY3RVUkkgfSkge1xuICAgICAgY29uc3QgX3Njb3BlcyA9IG9wdGlvbnMuZGlzYWJsZURlZmF1bHRTY29wZSA/IFtdIDogW1wiZW1haWxcIiwgXCJwaG9uZVwiXTtcbiAgICAgIG9wdGlvbnMuc2NvcGUgJiYgX3Njb3Blcy5wdXNoKC4uLm9wdGlvbnMuc2NvcGUpO1xuICAgICAgc2NvcGVzICYmIF9zY29wZXMucHVzaCguLi5zY29wZXMpO1xuICAgICAgY29uc3QgYXV0aG9yaXphdGlvbkVuZHBvaW50ID0gXCJodHRwczovL2lkLnZrLmNvbS9hdXRob3JpemVcIjtcbiAgICAgIHJldHVybiBjcmVhdGVBdXRob3JpemF0aW9uVVJMKHtcbiAgICAgICAgaWQ6IFwidmtcIixcbiAgICAgICAgb3B0aW9ucyxcbiAgICAgICAgYXV0aG9yaXphdGlvbkVuZHBvaW50LFxuICAgICAgICBzY29wZXM6IF9zY29wZXMsXG4gICAgICAgIHN0YXRlLFxuICAgICAgICByZWRpcmVjdFVSSSxcbiAgICAgICAgY29kZVZlcmlmaWVyXG4gICAgICB9KTtcbiAgICB9LFxuICAgIHZhbGlkYXRlQXV0aG9yaXphdGlvbkNvZGU6IGFzeW5jICh7XG4gICAgICBjb2RlLFxuICAgICAgY29kZVZlcmlmaWVyLFxuICAgICAgcmVkaXJlY3RVUkksXG4gICAgICBkZXZpY2VJZFxuICAgIH0pID0+IHtcbiAgICAgIHJldHVybiB2YWxpZGF0ZUF1dGhvcml6YXRpb25Db2RlKHtcbiAgICAgICAgY29kZSxcbiAgICAgICAgY29kZVZlcmlmaWVyLFxuICAgICAgICByZWRpcmVjdFVSSTogb3B0aW9ucy5yZWRpcmVjdFVSSSB8fCByZWRpcmVjdFVSSSxcbiAgICAgICAgb3B0aW9ucyxcbiAgICAgICAgZGV2aWNlSWQsXG4gICAgICAgIHRva2VuRW5kcG9pbnQ6IFwiaHR0cHM6Ly9pZC52ay5jb20vb2F1dGgyL2F1dGhcIlxuICAgICAgfSk7XG4gICAgfSxcbiAgICByZWZyZXNoQWNjZXNzVG9rZW46IG9wdGlvbnMucmVmcmVzaEFjY2Vzc1Rva2VuID8gb3B0aW9ucy5yZWZyZXNoQWNjZXNzVG9rZW4gOiBhc3luYyAocmVmcmVzaFRva2VuKSA9PiB7XG4gICAgICByZXR1cm4gcmVmcmVzaEFjY2Vzc1Rva2VuKHtcbiAgICAgICAgcmVmcmVzaFRva2VuLFxuICAgICAgICBvcHRpb25zOiB7XG4gICAgICAgICAgY2xpZW50SWQ6IG9wdGlvbnMuY2xpZW50SWQsXG4gICAgICAgICAgY2xpZW50S2V5OiBvcHRpb25zLmNsaWVudEtleSxcbiAgICAgICAgICBjbGllbnRTZWNyZXQ6IG9wdGlvbnMuY2xpZW50U2VjcmV0XG4gICAgICAgIH0sXG4gICAgICAgIHRva2VuRW5kcG9pbnQ6IFwiaHR0cHM6Ly9pZC52ay5jb20vb2F1dGgyL2F1dGhcIlxuICAgICAgfSk7XG4gICAgfSxcbiAgICBhc3luYyBnZXRVc2VySW5mbyhkYXRhKSB7XG4gICAgICBpZiAob3B0aW9ucy5nZXRVc2VySW5mbykge1xuICAgICAgICByZXR1cm4gb3B0aW9ucy5nZXRVc2VySW5mbyhkYXRhKTtcbiAgICAgIH1cbiAgICAgIGlmICghZGF0YS5hY2Nlc3NUb2tlbikge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgIH1cbiAgICAgIGNvbnN0IGZvcm1Cb2R5ID0gbmV3IFVSTFNlYXJjaFBhcmFtcyh7XG4gICAgICAgIGFjY2Vzc190b2tlbjogZGF0YS5hY2Nlc3NUb2tlbixcbiAgICAgICAgY2xpZW50X2lkOiBvcHRpb25zLmNsaWVudElkXG4gICAgICB9KS50b1N0cmluZygpO1xuICAgICAgY29uc3QgeyBkYXRhOiBwcm9maWxlLCBlcnJvciB9ID0gYXdhaXQgYmV0dGVyRmV0Y2goXG4gICAgICAgIFwiaHR0cHM6Ly9pZC52ay5jb20vb2F1dGgyL3VzZXJfaW5mb1wiLFxuICAgICAgICB7XG4gICAgICAgICAgbWV0aG9kOiBcIlBPU1RcIixcbiAgICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZFwiXG4gICAgICAgICAgfSxcbiAgICAgICAgICBib2R5OiBmb3JtQm9keVxuICAgICAgICB9XG4gICAgICApO1xuICAgICAgaWYgKGVycm9yKSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgICAgfVxuICAgICAgaWYgKCFwcm9maWxlLnVzZXIuZW1haWwpIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICB9XG4gICAgICBjb25zdCB1c2VyTWFwID0gYXdhaXQgb3B0aW9ucy5tYXBQcm9maWxlVG9Vc2VyPy4ocHJvZmlsZSk7XG4gICAgICByZXR1cm4ge1xuICAgICAgICB1c2VyOiB7XG4gICAgICAgICAgaWQ6IHByb2ZpbGUudXNlci51c2VyX2lkLFxuICAgICAgICAgIGZpcnN0X25hbWU6IHByb2ZpbGUudXNlci5maXJzdF9uYW1lLFxuICAgICAgICAgIGxhc3RfbmFtZTogcHJvZmlsZS51c2VyLmxhc3RfbmFtZSxcbiAgICAgICAgICBlbWFpbDogcHJvZmlsZS51c2VyLmVtYWlsLFxuICAgICAgICAgIGltYWdlOiBwcm9maWxlLnVzZXIuYXZhdGFyLFxuICAgICAgICAgIC8qKiBAbm90ZSBWSyBkb2VzIG5vdCBwcm92aWRlIGVtYWlsVmVyaWZpZWQqL1xuICAgICAgICAgIGVtYWlsVmVyaWZpZWQ6ICEhcHJvZmlsZS51c2VyLmVtYWlsLFxuICAgICAgICAgIGJpcnRoZGF5OiBwcm9maWxlLnVzZXIuYmlydGhkYXksXG4gICAgICAgICAgc2V4OiBwcm9maWxlLnVzZXIuc2V4LFxuICAgICAgICAgIG5hbWU6IGAke3Byb2ZpbGUudXNlci5maXJzdF9uYW1lfSAke3Byb2ZpbGUudXNlci5sYXN0X25hbWV9YCxcbiAgICAgICAgICAuLi51c2VyTWFwXG4gICAgICAgIH0sXG4gICAgICAgIGRhdGE6IHByb2ZpbGVcbiAgICAgIH07XG4gICAgfSxcbiAgICBvcHRpb25zXG4gIH07XG59O1xuXG5jb25zdCB6b29tID0gKHVzZXJPcHRpb25zKSA9PiB7XG4gIGNvbnN0IG9wdGlvbnMgPSB7XG4gICAgcGtjZTogdHJ1ZSxcbiAgICAuLi51c2VyT3B0aW9uc1xuICB9O1xuICByZXR1cm4ge1xuICAgIGlkOiBcInpvb21cIixcbiAgICBuYW1lOiBcIlpvb21cIixcbiAgICBjcmVhdGVBdXRob3JpemF0aW9uVVJMOiBhc3luYyAoeyBzdGF0ZSwgcmVkaXJlY3RVUkksIGNvZGVWZXJpZmllciB9KSA9PiB7XG4gICAgICBjb25zdCBwYXJhbXMgPSBuZXcgVVJMU2VhcmNoUGFyYW1zKHtcbiAgICAgICAgcmVzcG9uc2VfdHlwZTogXCJjb2RlXCIsXG4gICAgICAgIHJlZGlyZWN0X3VyaTogb3B0aW9ucy5yZWRpcmVjdFVSSSA/IG9wdGlvbnMucmVkaXJlY3RVUkkgOiByZWRpcmVjdFVSSSxcbiAgICAgICAgY2xpZW50X2lkOiBvcHRpb25zLmNsaWVudElkLFxuICAgICAgICBzdGF0ZVxuICAgICAgfSk7XG4gICAgICBpZiAob3B0aW9ucy5wa2NlKSB7XG4gICAgICAgIGNvbnN0IGNvZGVDaGFsbGVuZ2UgPSBhd2FpdCBnZW5lcmF0ZUNvZGVDaGFsbGVuZ2UoY29kZVZlcmlmaWVyKTtcbiAgICAgICAgcGFyYW1zLnNldChcImNvZGVfY2hhbGxlbmdlX21ldGhvZFwiLCBcIlMyNTZcIik7XG4gICAgICAgIHBhcmFtcy5zZXQoXCJjb2RlX2NoYWxsZW5nZVwiLCBjb2RlQ2hhbGxlbmdlKTtcbiAgICAgIH1cbiAgICAgIGNvbnN0IHVybCA9IG5ldyBVUkwoXCJodHRwczovL3pvb20udXMvb2F1dGgvYXV0aG9yaXplXCIpO1xuICAgICAgdXJsLnNlYXJjaCA9IHBhcmFtcy50b1N0cmluZygpO1xuICAgICAgcmV0dXJuIHVybDtcbiAgICB9LFxuICAgIHZhbGlkYXRlQXV0aG9yaXphdGlvbkNvZGU6IGFzeW5jICh7IGNvZGUsIHJlZGlyZWN0VVJJLCBjb2RlVmVyaWZpZXIgfSkgPT4ge1xuICAgICAgcmV0dXJuIHZhbGlkYXRlQXV0aG9yaXphdGlvbkNvZGUoe1xuICAgICAgICBjb2RlLFxuICAgICAgICByZWRpcmVjdFVSSTogb3B0aW9ucy5yZWRpcmVjdFVSSSB8fCByZWRpcmVjdFVSSSxcbiAgICAgICAgY29kZVZlcmlmaWVyLFxuICAgICAgICBvcHRpb25zLFxuICAgICAgICB0b2tlbkVuZHBvaW50OiBcImh0dHBzOi8vem9vbS51cy9vYXV0aC90b2tlblwiLFxuICAgICAgICBhdXRoZW50aWNhdGlvbjogXCJwb3N0XCJcbiAgICAgIH0pO1xuICAgIH0sXG4gICAgYXN5bmMgZ2V0VXNlckluZm8odG9rZW4pIHtcbiAgICAgIGlmIChvcHRpb25zLmdldFVzZXJJbmZvKSB7XG4gICAgICAgIHJldHVybiBvcHRpb25zLmdldFVzZXJJbmZvKHRva2VuKTtcbiAgICAgIH1cbiAgICAgIGNvbnN0IHsgZGF0YTogcHJvZmlsZSwgZXJyb3IgfSA9IGF3YWl0IGJldHRlckZldGNoKFxuICAgICAgICBcImh0dHBzOi8vYXBpLnpvb20udXMvdjIvdXNlcnMvbWVcIixcbiAgICAgICAge1xuICAgICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAgIGF1dGhvcml6YXRpb246IGBCZWFyZXIgJHt0b2tlbi5hY2Nlc3NUb2tlbn1gXG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICApO1xuICAgICAgaWYgKGVycm9yKSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgICAgfVxuICAgICAgY29uc3QgdXNlck1hcCA9IGF3YWl0IG9wdGlvbnMubWFwUHJvZmlsZVRvVXNlcj8uKHByb2ZpbGUpO1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgdXNlcjoge1xuICAgICAgICAgIGlkOiBwcm9maWxlLmlkLFxuICAgICAgICAgIG5hbWU6IHByb2ZpbGUuZGlzcGxheV9uYW1lLFxuICAgICAgICAgIGltYWdlOiBwcm9maWxlLnBpY191cmwsXG4gICAgICAgICAgZW1haWw6IHByb2ZpbGUuZW1haWwsXG4gICAgICAgICAgZW1haWxWZXJpZmllZDogQm9vbGVhbihwcm9maWxlLnZlcmlmaWVkKSxcbiAgICAgICAgICAuLi51c2VyTWFwXG4gICAgICAgIH0sXG4gICAgICAgIGRhdGE6IHtcbiAgICAgICAgICAuLi5wcm9maWxlXG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgfVxuICB9O1xufTtcblxuY29uc3Qga2FrYW8gPSAob3B0aW9ucykgPT4ge1xuICByZXR1cm4ge1xuICAgIGlkOiBcImtha2FvXCIsXG4gICAgbmFtZTogXCJLYWthb1wiLFxuICAgIGNyZWF0ZUF1dGhvcml6YXRpb25VUkwoeyBzdGF0ZSwgc2NvcGVzLCByZWRpcmVjdFVSSSB9KSB7XG4gICAgICBjb25zdCBfc2NvcGVzID0gb3B0aW9ucy5kaXNhYmxlRGVmYXVsdFNjb3BlID8gW10gOiBbXCJhY2NvdW50X2VtYWlsXCIsIFwicHJvZmlsZV9pbWFnZVwiLCBcInByb2ZpbGVfbmlja25hbWVcIl07XG4gICAgICBvcHRpb25zLnNjb3BlICYmIF9zY29wZXMucHVzaCguLi5vcHRpb25zLnNjb3BlKTtcbiAgICAgIHNjb3BlcyAmJiBfc2NvcGVzLnB1c2goLi4uc2NvcGVzKTtcbiAgICAgIHJldHVybiBjcmVhdGVBdXRob3JpemF0aW9uVVJMKHtcbiAgICAgICAgaWQ6IFwia2FrYW9cIixcbiAgICAgICAgb3B0aW9ucyxcbiAgICAgICAgYXV0aG9yaXphdGlvbkVuZHBvaW50OiBcImh0dHBzOi8va2F1dGgua2FrYW8uY29tL29hdXRoL2F1dGhvcml6ZVwiLFxuICAgICAgICBzY29wZXM6IF9zY29wZXMsXG4gICAgICAgIHN0YXRlLFxuICAgICAgICByZWRpcmVjdFVSSVxuICAgICAgfSk7XG4gICAgfSxcbiAgICB2YWxpZGF0ZUF1dGhvcml6YXRpb25Db2RlOiBhc3luYyAoeyBjb2RlLCByZWRpcmVjdFVSSSB9KSA9PiB7XG4gICAgICByZXR1cm4gdmFsaWRhdGVBdXRob3JpemF0aW9uQ29kZSh7XG4gICAgICAgIGNvZGUsXG4gICAgICAgIHJlZGlyZWN0VVJJLFxuICAgICAgICBvcHRpb25zLFxuICAgICAgICB0b2tlbkVuZHBvaW50OiBcImh0dHBzOi8va2F1dGgua2FrYW8uY29tL29hdXRoL3Rva2VuXCJcbiAgICAgIH0pO1xuICAgIH0sXG4gICAgcmVmcmVzaEFjY2Vzc1Rva2VuOiBvcHRpb25zLnJlZnJlc2hBY2Nlc3NUb2tlbiA/IG9wdGlvbnMucmVmcmVzaEFjY2Vzc1Rva2VuIDogYXN5bmMgKHJlZnJlc2hUb2tlbikgPT4ge1xuICAgICAgcmV0dXJuIHJlZnJlc2hBY2Nlc3NUb2tlbih7XG4gICAgICAgIHJlZnJlc2hUb2tlbixcbiAgICAgICAgb3B0aW9uczoge1xuICAgICAgICAgIGNsaWVudElkOiBvcHRpb25zLmNsaWVudElkLFxuICAgICAgICAgIGNsaWVudEtleTogb3B0aW9ucy5jbGllbnRLZXksXG4gICAgICAgICAgY2xpZW50U2VjcmV0OiBvcHRpb25zLmNsaWVudFNlY3JldFxuICAgICAgICB9LFxuICAgICAgICB0b2tlbkVuZHBvaW50OiBcImh0dHBzOi8va2F1dGgua2FrYW8uY29tL29hdXRoL3Rva2VuXCJcbiAgICAgIH0pO1xuICAgIH0sXG4gICAgYXN5bmMgZ2V0VXNlckluZm8odG9rZW4pIHtcbiAgICAgIGlmIChvcHRpb25zLmdldFVzZXJJbmZvKSB7XG4gICAgICAgIHJldHVybiBvcHRpb25zLmdldFVzZXJJbmZvKHRva2VuKTtcbiAgICAgIH1cbiAgICAgIGNvbnN0IHsgZGF0YTogcHJvZmlsZSwgZXJyb3IgfSA9IGF3YWl0IGJldHRlckZldGNoKFxuICAgICAgICBcImh0dHBzOi8va2FwaS5rYWthby5jb20vdjIvdXNlci9tZVwiLFxuICAgICAgICB7XG4gICAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICAgQXV0aG9yaXphdGlvbjogYEJlYXJlciAke3Rva2VuLmFjY2Vzc1Rva2VufWBcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICk7XG4gICAgICBpZiAoZXJyb3IgfHwgIXByb2ZpbGUpIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICB9XG4gICAgICBjb25zdCB1c2VyTWFwID0gYXdhaXQgb3B0aW9ucy5tYXBQcm9maWxlVG9Vc2VyPy4ocHJvZmlsZSk7XG4gICAgICBjb25zdCBhY2NvdW50ID0gcHJvZmlsZS5rYWthb19hY2NvdW50IHx8IHt9O1xuICAgICAgY29uc3Qga2FrYW9Qcm9maWxlID0gYWNjb3VudC5wcm9maWxlIHx8IHt9O1xuICAgICAgY29uc3QgdXNlciA9IHtcbiAgICAgICAgaWQ6IFN0cmluZyhwcm9maWxlLmlkKSxcbiAgICAgICAgbmFtZToga2FrYW9Qcm9maWxlLm5pY2tuYW1lIHx8IGFjY291bnQubmFtZSB8fCB2b2lkIDAsXG4gICAgICAgIGVtYWlsOiBhY2NvdW50LmVtYWlsLFxuICAgICAgICBpbWFnZToga2FrYW9Qcm9maWxlLnByb2ZpbGVfaW1hZ2VfdXJsIHx8IGtha2FvUHJvZmlsZS50aHVtYm5haWxfaW1hZ2VfdXJsLFxuICAgICAgICBlbWFpbFZlcmlmaWVkOiAhIWFjY291bnQuaXNfZW1haWxfdmFsaWQgJiYgISFhY2NvdW50LmlzX2VtYWlsX3ZlcmlmaWVkLFxuICAgICAgICAuLi51c2VyTWFwXG4gICAgICB9O1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgdXNlcixcbiAgICAgICAgZGF0YTogcHJvZmlsZVxuICAgICAgfTtcbiAgICB9LFxuICAgIG9wdGlvbnNcbiAgfTtcbn07XG5cbmNvbnN0IG5hdmVyID0gKG9wdGlvbnMpID0+IHtcbiAgcmV0dXJuIHtcbiAgICBpZDogXCJuYXZlclwiLFxuICAgIG5hbWU6IFwiTmF2ZXJcIixcbiAgICBjcmVhdGVBdXRob3JpemF0aW9uVVJMKHsgc3RhdGUsIHNjb3BlcywgcmVkaXJlY3RVUkkgfSkge1xuICAgICAgY29uc3QgX3Njb3BlcyA9IG9wdGlvbnMuZGlzYWJsZURlZmF1bHRTY29wZSA/IFtdIDogW1wicHJvZmlsZVwiLCBcImVtYWlsXCJdO1xuICAgICAgb3B0aW9ucy5zY29wZSAmJiBfc2NvcGVzLnB1c2goLi4ub3B0aW9ucy5zY29wZSk7XG4gICAgICBzY29wZXMgJiYgX3Njb3Blcy5wdXNoKC4uLnNjb3Blcyk7XG4gICAgICByZXR1cm4gY3JlYXRlQXV0aG9yaXphdGlvblVSTCh7XG4gICAgICAgIGlkOiBcIm5hdmVyXCIsXG4gICAgICAgIG9wdGlvbnMsXG4gICAgICAgIGF1dGhvcml6YXRpb25FbmRwb2ludDogXCJodHRwczovL25pZC5uYXZlci5jb20vb2F1dGgyLjAvYXV0aG9yaXplXCIsXG4gICAgICAgIHNjb3BlczogX3Njb3BlcyxcbiAgICAgICAgc3RhdGUsXG4gICAgICAgIHJlZGlyZWN0VVJJXG4gICAgICB9KTtcbiAgICB9LFxuICAgIHZhbGlkYXRlQXV0aG9yaXphdGlvbkNvZGU6IGFzeW5jICh7IGNvZGUsIHJlZGlyZWN0VVJJIH0pID0+IHtcbiAgICAgIHJldHVybiB2YWxpZGF0ZUF1dGhvcml6YXRpb25Db2RlKHtcbiAgICAgICAgY29kZSxcbiAgICAgICAgcmVkaXJlY3RVUkksXG4gICAgICAgIG9wdGlvbnMsXG4gICAgICAgIHRva2VuRW5kcG9pbnQ6IFwiaHR0cHM6Ly9uaWQubmF2ZXIuY29tL29hdXRoMi4wL3Rva2VuXCJcbiAgICAgIH0pO1xuICAgIH0sXG4gICAgcmVmcmVzaEFjY2Vzc1Rva2VuOiBvcHRpb25zLnJlZnJlc2hBY2Nlc3NUb2tlbiA/IG9wdGlvbnMucmVmcmVzaEFjY2Vzc1Rva2VuIDogYXN5bmMgKHJlZnJlc2hUb2tlbikgPT4ge1xuICAgICAgcmV0dXJuIHJlZnJlc2hBY2Nlc3NUb2tlbih7XG4gICAgICAgIHJlZnJlc2hUb2tlbixcbiAgICAgICAgb3B0aW9uczoge1xuICAgICAgICAgIGNsaWVudElkOiBvcHRpb25zLmNsaWVudElkLFxuICAgICAgICAgIGNsaWVudEtleTogb3B0aW9ucy5jbGllbnRLZXksXG4gICAgICAgICAgY2xpZW50U2VjcmV0OiBvcHRpb25zLmNsaWVudFNlY3JldFxuICAgICAgICB9LFxuICAgICAgICB0b2tlbkVuZHBvaW50OiBcImh0dHBzOi8vbmlkLm5hdmVyLmNvbS9vYXV0aDIuMC90b2tlblwiXG4gICAgICB9KTtcbiAgICB9LFxuICAgIGFzeW5jIGdldFVzZXJJbmZvKHRva2VuKSB7XG4gICAgICBpZiAob3B0aW9ucy5nZXRVc2VySW5mbykge1xuICAgICAgICByZXR1cm4gb3B0aW9ucy5nZXRVc2VySW5mbyh0b2tlbik7XG4gICAgICB9XG4gICAgICBjb25zdCB7IGRhdGE6IHByb2ZpbGUsIGVycm9yIH0gPSBhd2FpdCBiZXR0ZXJGZXRjaChcbiAgICAgICAgXCJodHRwczovL29wZW5hcGkubmF2ZXIuY29tL3YxL25pZC9tZVwiLFxuICAgICAgICB7XG4gICAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICAgQXV0aG9yaXphdGlvbjogYEJlYXJlciAke3Rva2VuLmFjY2Vzc1Rva2VufWBcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICk7XG4gICAgICBpZiAoZXJyb3IgfHwgIXByb2ZpbGUgfHwgcHJvZmlsZS5yZXN1bHRjb2RlICE9PSBcIjAwXCIpIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICB9XG4gICAgICBjb25zdCB1c2VyTWFwID0gYXdhaXQgb3B0aW9ucy5tYXBQcm9maWxlVG9Vc2VyPy4ocHJvZmlsZSk7XG4gICAgICBjb25zdCByZXMgPSBwcm9maWxlLnJlc3BvbnNlIHx8IHt9O1xuICAgICAgY29uc3QgdXNlciA9IHtcbiAgICAgICAgaWQ6IHJlcy5pZCxcbiAgICAgICAgbmFtZTogcmVzLm5hbWUgfHwgcmVzLm5pY2tuYW1lLFxuICAgICAgICBlbWFpbDogcmVzLmVtYWlsLFxuICAgICAgICBpbWFnZTogcmVzLnByb2ZpbGVfaW1hZ2UsXG4gICAgICAgIGVtYWlsVmVyaWZpZWQ6IGZhbHNlLFxuICAgICAgICAuLi51c2VyTWFwXG4gICAgICB9O1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgdXNlcixcbiAgICAgICAgZGF0YTogcHJvZmlsZVxuICAgICAgfTtcbiAgICB9LFxuICAgIG9wdGlvbnNcbiAgfTtcbn07XG5cbmNvbnN0IGxpbmUgPSAob3B0aW9ucykgPT4ge1xuICBjb25zdCBhdXRob3JpemF0aW9uRW5kcG9pbnQgPSBcImh0dHBzOi8vYWNjZXNzLmxpbmUubWUvb2F1dGgyL3YyLjEvYXV0aG9yaXplXCI7XG4gIGNvbnN0IHRva2VuRW5kcG9pbnQgPSBcImh0dHBzOi8vYXBpLmxpbmUubWUvb2F1dGgyL3YyLjEvdG9rZW5cIjtcbiAgY29uc3QgdXNlckluZm9FbmRwb2ludCA9IFwiaHR0cHM6Ly9hcGkubGluZS5tZS9vYXV0aDIvdjIuMS91c2VyaW5mb1wiO1xuICBjb25zdCB2ZXJpZnlJZFRva2VuRW5kcG9pbnQgPSBcImh0dHBzOi8vYXBpLmxpbmUubWUvb2F1dGgyL3YyLjEvdmVyaWZ5XCI7XG4gIHJldHVybiB7XG4gICAgaWQ6IFwibGluZVwiLFxuICAgIG5hbWU6IFwiTElORVwiLFxuICAgIGFzeW5jIGNyZWF0ZUF1dGhvcml6YXRpb25VUkwoe1xuICAgICAgc3RhdGUsXG4gICAgICBzY29wZXMsXG4gICAgICBjb2RlVmVyaWZpZXIsXG4gICAgICByZWRpcmVjdFVSSSxcbiAgICAgIGxvZ2luSGludFxuICAgIH0pIHtcbiAgICAgIGNvbnN0IF9zY29wZXMgPSBvcHRpb25zLmRpc2FibGVEZWZhdWx0U2NvcGUgPyBbXSA6IFtcIm9wZW5pZFwiLCBcInByb2ZpbGVcIiwgXCJlbWFpbFwiXTtcbiAgICAgIG9wdGlvbnMuc2NvcGUgJiYgX3Njb3Blcy5wdXNoKC4uLm9wdGlvbnMuc2NvcGUpO1xuICAgICAgc2NvcGVzICYmIF9zY29wZXMucHVzaCguLi5zY29wZXMpO1xuICAgICAgcmV0dXJuIGF3YWl0IGNyZWF0ZUF1dGhvcml6YXRpb25VUkwoe1xuICAgICAgICBpZDogXCJsaW5lXCIsXG4gICAgICAgIG9wdGlvbnMsXG4gICAgICAgIGF1dGhvcml6YXRpb25FbmRwb2ludCxcbiAgICAgICAgc2NvcGVzOiBfc2NvcGVzLFxuICAgICAgICBzdGF0ZSxcbiAgICAgICAgY29kZVZlcmlmaWVyLFxuICAgICAgICByZWRpcmVjdFVSSSxcbiAgICAgICAgbG9naW5IaW50XG4gICAgICB9KTtcbiAgICB9LFxuICAgIHZhbGlkYXRlQXV0aG9yaXphdGlvbkNvZGU6IGFzeW5jICh7IGNvZGUsIGNvZGVWZXJpZmllciwgcmVkaXJlY3RVUkkgfSkgPT4ge1xuICAgICAgcmV0dXJuIHZhbGlkYXRlQXV0aG9yaXphdGlvbkNvZGUoe1xuICAgICAgICBjb2RlLFxuICAgICAgICBjb2RlVmVyaWZpZXIsXG4gICAgICAgIHJlZGlyZWN0VVJJLFxuICAgICAgICBvcHRpb25zLFxuICAgICAgICB0b2tlbkVuZHBvaW50XG4gICAgICB9KTtcbiAgICB9LFxuICAgIHJlZnJlc2hBY2Nlc3NUb2tlbjogb3B0aW9ucy5yZWZyZXNoQWNjZXNzVG9rZW4gPyBvcHRpb25zLnJlZnJlc2hBY2Nlc3NUb2tlbiA6IGFzeW5jIChyZWZyZXNoVG9rZW4pID0+IHtcbiAgICAgIHJldHVybiByZWZyZXNoQWNjZXNzVG9rZW4oe1xuICAgICAgICByZWZyZXNoVG9rZW4sXG4gICAgICAgIG9wdGlvbnM6IHtcbiAgICAgICAgICBjbGllbnRJZDogb3B0aW9ucy5jbGllbnRJZCxcbiAgICAgICAgICBjbGllbnRTZWNyZXQ6IG9wdGlvbnMuY2xpZW50U2VjcmV0XG4gICAgICAgIH0sXG4gICAgICAgIHRva2VuRW5kcG9pbnRcbiAgICAgIH0pO1xuICAgIH0sXG4gICAgYXN5bmMgdmVyaWZ5SWRUb2tlbih0b2tlbiwgbm9uY2UpIHtcbiAgICAgIGlmIChvcHRpb25zLmRpc2FibGVJZFRva2VuU2lnbkluKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH1cbiAgICAgIGlmIChvcHRpb25zLnZlcmlmeUlkVG9rZW4pIHtcbiAgICAgICAgcmV0dXJuIG9wdGlvbnMudmVyaWZ5SWRUb2tlbih0b2tlbiwgbm9uY2UpO1xuICAgICAgfVxuICAgICAgY29uc3QgYm9keSA9IG5ldyBVUkxTZWFyY2hQYXJhbXMoKTtcbiAgICAgIGJvZHkuc2V0KFwiaWRfdG9rZW5cIiwgdG9rZW4pO1xuICAgICAgYm9keS5zZXQoXCJjbGllbnRfaWRcIiwgb3B0aW9ucy5jbGllbnRJZCk7XG4gICAgICBpZiAobm9uY2UpIGJvZHkuc2V0KFwibm9uY2VcIiwgbm9uY2UpO1xuICAgICAgY29uc3QgeyBkYXRhLCBlcnJvciB9ID0gYXdhaXQgYmV0dGVyRmV0Y2goXG4gICAgICAgIHZlcmlmeUlkVG9rZW5FbmRwb2ludCxcbiAgICAgICAge1xuICAgICAgICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICAgXCJjb250ZW50LXR5cGVcIjogXCJhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWRcIlxuICAgICAgICAgIH0sXG4gICAgICAgICAgYm9keVxuICAgICAgICB9XG4gICAgICApO1xuICAgICAgaWYgKGVycm9yIHx8ICFkYXRhKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH1cbiAgICAgIGlmIChkYXRhLmF1ZCAhPT0gb3B0aW9ucy5jbGllbnRJZCkgcmV0dXJuIGZhbHNlO1xuICAgICAgaWYgKG5vbmNlICYmIGRhdGEubm9uY2UgJiYgZGF0YS5ub25jZSAhPT0gbm9uY2UpIHJldHVybiBmYWxzZTtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH0sXG4gICAgYXN5bmMgZ2V0VXNlckluZm8odG9rZW4pIHtcbiAgICAgIGlmIChvcHRpb25zLmdldFVzZXJJbmZvKSB7XG4gICAgICAgIHJldHVybiBvcHRpb25zLmdldFVzZXJJbmZvKHRva2VuKTtcbiAgICAgIH1cbiAgICAgIGxldCBwcm9maWxlID0gbnVsbDtcbiAgICAgIGlmICh0b2tlbi5pZFRva2VuKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgcHJvZmlsZSA9IGRlY29kZUp3dCh0b2tlbi5pZFRva2VuKTtcbiAgICAgICAgfSBjYXRjaCB7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGlmICghcHJvZmlsZSkge1xuICAgICAgICBjb25zdCB7IGRhdGEgfSA9IGF3YWl0IGJldHRlckZldGNoKHVzZXJJbmZvRW5kcG9pbnQsIHtcbiAgICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgICBhdXRob3JpemF0aW9uOiBgQmVhcmVyICR7dG9rZW4uYWNjZXNzVG9rZW59YFxuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIHByb2ZpbGUgPSBkYXRhIHx8IG51bGw7XG4gICAgICB9XG4gICAgICBpZiAoIXByb2ZpbGUpIHJldHVybiBudWxsO1xuICAgICAgY29uc3QgdXNlck1hcCA9IGF3YWl0IG9wdGlvbnMubWFwUHJvZmlsZVRvVXNlcj8uKHByb2ZpbGUpO1xuICAgICAgY29uc3QgaWQgPSBwcm9maWxlLnN1YiB8fCBwcm9maWxlLnVzZXJJZDtcbiAgICAgIGNvbnN0IG5hbWUgPSBwcm9maWxlLm5hbWUgfHwgcHJvZmlsZS5kaXNwbGF5TmFtZTtcbiAgICAgIGNvbnN0IGltYWdlID0gcHJvZmlsZS5waWN0dXJlIHx8IHByb2ZpbGUucGljdHVyZVVybCB8fCB2b2lkIDA7XG4gICAgICBjb25zdCBlbWFpbCA9IHByb2ZpbGUuZW1haWw7XG4gICAgICByZXR1cm4ge1xuICAgICAgICB1c2VyOiB7XG4gICAgICAgICAgaWQsXG4gICAgICAgICAgbmFtZSxcbiAgICAgICAgICBlbWFpbCxcbiAgICAgICAgICBpbWFnZSxcbiAgICAgICAgICAvLyBMSU5FIGRvZXMgbm90IGV4cG9zZSBlbWFpbCB2ZXJpZmljYXRpb24gc3RhdHVzIGluIElEIHRva2VuL3VzZXJpbmZvXG4gICAgICAgICAgZW1haWxWZXJpZmllZDogZmFsc2UsXG4gICAgICAgICAgLi4udXNlck1hcFxuICAgICAgICB9LFxuICAgICAgICBkYXRhOiBwcm9maWxlXG4gICAgICB9O1xuICAgIH0sXG4gICAgb3B0aW9uc1xuICB9O1xufTtcblxuY29uc3QgcGF5cGFsID0gKG9wdGlvbnMpID0+IHtcbiAgY29uc3QgZW52aXJvbm1lbnQgPSBvcHRpb25zLmVudmlyb25tZW50IHx8IFwic2FuZGJveFwiO1xuICBjb25zdCBpc1NhbmRib3ggPSBlbnZpcm9ubWVudCA9PT0gXCJzYW5kYm94XCI7XG4gIGNvbnN0IGF1dGhvcml6YXRpb25FbmRwb2ludCA9IGlzU2FuZGJveCA/IFwiaHR0cHM6Ly93d3cuc2FuZGJveC5wYXlwYWwuY29tL3NpZ25pbi9hdXRob3JpemVcIiA6IFwiaHR0cHM6Ly93d3cucGF5cGFsLmNvbS9zaWduaW4vYXV0aG9yaXplXCI7XG4gIGNvbnN0IHRva2VuRW5kcG9pbnQgPSBpc1NhbmRib3ggPyBcImh0dHBzOi8vYXBpLW0uc2FuZGJveC5wYXlwYWwuY29tL3YxL29hdXRoMi90b2tlblwiIDogXCJodHRwczovL2FwaS1tLnBheXBhbC5jb20vdjEvb2F1dGgyL3Rva2VuXCI7XG4gIGNvbnN0IHVzZXJJbmZvRW5kcG9pbnQgPSBpc1NhbmRib3ggPyBcImh0dHBzOi8vYXBpLW0uc2FuZGJveC5wYXlwYWwuY29tL3YxL2lkZW50aXR5L29hdXRoMi91c2VyaW5mb1wiIDogXCJodHRwczovL2FwaS1tLnBheXBhbC5jb20vdjEvaWRlbnRpdHkvb2F1dGgyL3VzZXJpbmZvXCI7XG4gIHJldHVybiB7XG4gICAgaWQ6IFwicGF5cGFsXCIsXG4gICAgbmFtZTogXCJQYXlQYWxcIixcbiAgICBhc3luYyBjcmVhdGVBdXRob3JpemF0aW9uVVJMKHsgc3RhdGUsIGNvZGVWZXJpZmllciwgcmVkaXJlY3RVUkkgfSkge1xuICAgICAgaWYgKCFvcHRpb25zLmNsaWVudElkIHx8ICFvcHRpb25zLmNsaWVudFNlY3JldCkge1xuICAgICAgICBsb2dnZXIuZXJyb3IoXG4gICAgICAgICAgXCJDbGllbnQgSWQgYW5kIENsaWVudCBTZWNyZXQgaXMgcmVxdWlyZWQgZm9yIFBheVBhbC4gTWFrZSBzdXJlIHRvIHByb3ZpZGUgdGhlbSBpbiB0aGUgb3B0aW9ucy5cIlxuICAgICAgICApO1xuICAgICAgICB0aHJvdyBuZXcgQmV0dGVyQXV0aEVycm9yKFwiQ0xJRU5UX0lEX0FORF9TRUNSRVRfUkVRVUlSRURcIik7XG4gICAgICB9XG4gICAgICBjb25zdCBfc2NvcGVzID0gW107XG4gICAgICBjb25zdCB1cmwgPSBhd2FpdCBjcmVhdGVBdXRob3JpemF0aW9uVVJMKHtcbiAgICAgICAgaWQ6IFwicGF5cGFsXCIsXG4gICAgICAgIG9wdGlvbnMsXG4gICAgICAgIGF1dGhvcml6YXRpb25FbmRwb2ludCxcbiAgICAgICAgc2NvcGVzOiBfc2NvcGVzLFxuICAgICAgICBzdGF0ZSxcbiAgICAgICAgY29kZVZlcmlmaWVyLFxuICAgICAgICByZWRpcmVjdFVSSSxcbiAgICAgICAgcHJvbXB0OiBvcHRpb25zLnByb21wdFxuICAgICAgfSk7XG4gICAgICByZXR1cm4gdXJsO1xuICAgIH0sXG4gICAgdmFsaWRhdGVBdXRob3JpemF0aW9uQ29kZTogYXN5bmMgKHsgY29kZSwgcmVkaXJlY3RVUkkgfSkgPT4ge1xuICAgICAgY29uc3QgY3JlZGVudGlhbHMgPSBiYXNlNjQuZW5jb2RlKFxuICAgICAgICBgJHtvcHRpb25zLmNsaWVudElkfToke29wdGlvbnMuY2xpZW50U2VjcmV0fWBcbiAgICAgICk7XG4gICAgICB0cnkge1xuICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGJldHRlckZldGNoKHRva2VuRW5kcG9pbnQsIHtcbiAgICAgICAgICBtZXRob2Q6IFwiUE9TVFwiLFxuICAgICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAgIEF1dGhvcml6YXRpb246IGBCYXNpYyAke2NyZWRlbnRpYWxzfWAsXG4gICAgICAgICAgICBBY2NlcHQ6IFwiYXBwbGljYXRpb24vanNvblwiLFxuICAgICAgICAgICAgXCJBY2NlcHQtTGFuZ3VhZ2VcIjogXCJlbl9VU1wiLFxuICAgICAgICAgICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWRcIlxuICAgICAgICAgIH0sXG4gICAgICAgICAgYm9keTogbmV3IFVSTFNlYXJjaFBhcmFtcyh7XG4gICAgICAgICAgICBncmFudF90eXBlOiBcImF1dGhvcml6YXRpb25fY29kZVwiLFxuICAgICAgICAgICAgY29kZSxcbiAgICAgICAgICAgIHJlZGlyZWN0X3VyaTogcmVkaXJlY3RVUklcbiAgICAgICAgICB9KS50b1N0cmluZygpXG4gICAgICAgIH0pO1xuICAgICAgICBpZiAoIXJlc3BvbnNlLmRhdGEpIHtcbiAgICAgICAgICB0aHJvdyBuZXcgQmV0dGVyQXV0aEVycm9yKFwiRkFJTEVEX1RPX0dFVF9BQ0NFU1NfVE9LRU5cIik7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgZGF0YSA9IHJlc3BvbnNlLmRhdGE7XG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IHtcbiAgICAgICAgICBhY2Nlc3NUb2tlbjogZGF0YS5hY2Nlc3NfdG9rZW4sXG4gICAgICAgICAgcmVmcmVzaFRva2VuOiBkYXRhLnJlZnJlc2hfdG9rZW4sXG4gICAgICAgICAgYWNjZXNzVG9rZW5FeHBpcmVzQXQ6IGRhdGEuZXhwaXJlc19pbiA/IG5ldyBEYXRlKERhdGUubm93KCkgKyBkYXRhLmV4cGlyZXNfaW4gKiAxZTMpIDogdm9pZCAwLFxuICAgICAgICAgIGlkVG9rZW46IGRhdGEuaWRfdG9rZW5cbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIGxvZ2dlci5lcnJvcihcIlBheVBhbCB0b2tlbiBleGNoYW5nZSBmYWlsZWQ6XCIsIGVycm9yKTtcbiAgICAgICAgdGhyb3cgbmV3IEJldHRlckF1dGhFcnJvcihcIkZBSUxFRF9UT19HRVRfQUNDRVNTX1RPS0VOXCIpO1xuICAgICAgfVxuICAgIH0sXG4gICAgcmVmcmVzaEFjY2Vzc1Rva2VuOiBvcHRpb25zLnJlZnJlc2hBY2Nlc3NUb2tlbiA/IG9wdGlvbnMucmVmcmVzaEFjY2Vzc1Rva2VuIDogYXN5bmMgKHJlZnJlc2hUb2tlbikgPT4ge1xuICAgICAgY29uc3QgY3JlZGVudGlhbHMgPSBiYXNlNjQuZW5jb2RlKFxuICAgICAgICBgJHtvcHRpb25zLmNsaWVudElkfToke29wdGlvbnMuY2xpZW50U2VjcmV0fWBcbiAgICAgICk7XG4gICAgICB0cnkge1xuICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGJldHRlckZldGNoKHRva2VuRW5kcG9pbnQsIHtcbiAgICAgICAgICBtZXRob2Q6IFwiUE9TVFwiLFxuICAgICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAgIEF1dGhvcml6YXRpb246IGBCYXNpYyAke2NyZWRlbnRpYWxzfWAsXG4gICAgICAgICAgICBBY2NlcHQ6IFwiYXBwbGljYXRpb24vanNvblwiLFxuICAgICAgICAgICAgXCJBY2NlcHQtTGFuZ3VhZ2VcIjogXCJlbl9VU1wiLFxuICAgICAgICAgICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWRcIlxuICAgICAgICAgIH0sXG4gICAgICAgICAgYm9keTogbmV3IFVSTFNlYXJjaFBhcmFtcyh7XG4gICAgICAgICAgICBncmFudF90eXBlOiBcInJlZnJlc2hfdG9rZW5cIixcbiAgICAgICAgICAgIHJlZnJlc2hfdG9rZW46IHJlZnJlc2hUb2tlblxuICAgICAgICAgIH0pLnRvU3RyaW5nKClcbiAgICAgICAgfSk7XG4gICAgICAgIGlmICghcmVzcG9uc2UuZGF0YSkge1xuICAgICAgICAgIHRocm93IG5ldyBCZXR0ZXJBdXRoRXJyb3IoXCJGQUlMRURfVE9fUkVGUkVTSF9BQ0NFU1NfVE9LRU5cIik7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgZGF0YSA9IHJlc3BvbnNlLmRhdGE7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgYWNjZXNzVG9rZW46IGRhdGEuYWNjZXNzX3Rva2VuLFxuICAgICAgICAgIHJlZnJlc2hUb2tlbjogZGF0YS5yZWZyZXNoX3Rva2VuLFxuICAgICAgICAgIGFjY2Vzc1Rva2VuRXhwaXJlc0F0OiBkYXRhLmV4cGlyZXNfaW4gPyBuZXcgRGF0ZShEYXRlLm5vdygpICsgZGF0YS5leHBpcmVzX2luICogMWUzKSA6IHZvaWQgMFxuICAgICAgICB9O1xuICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgbG9nZ2VyLmVycm9yKFwiUGF5UGFsIHRva2VuIHJlZnJlc2ggZmFpbGVkOlwiLCBlcnJvcik7XG4gICAgICAgIHRocm93IG5ldyBCZXR0ZXJBdXRoRXJyb3IoXCJGQUlMRURfVE9fUkVGUkVTSF9BQ0NFU1NfVE9LRU5cIik7XG4gICAgICB9XG4gICAgfSxcbiAgICBhc3luYyB2ZXJpZnlJZFRva2VuKHRva2VuLCBub25jZSkge1xuICAgICAgaWYgKG9wdGlvbnMuZGlzYWJsZUlkVG9rZW5TaWduSW4pIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfVxuICAgICAgaWYgKG9wdGlvbnMudmVyaWZ5SWRUb2tlbikge1xuICAgICAgICByZXR1cm4gb3B0aW9ucy52ZXJpZnlJZFRva2VuKHRva2VuLCBub25jZSk7XG4gICAgICB9XG4gICAgICB0cnkge1xuICAgICAgICBjb25zdCBwYXlsb2FkID0gZGVjb2RlSnd0KHRva2VuKTtcbiAgICAgICAgcmV0dXJuICEhcGF5bG9hZC5zdWI7XG4gICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICBsb2dnZXIuZXJyb3IoXCJGYWlsZWQgdG8gdmVyaWZ5IFBheVBhbCBJRCB0b2tlbjpcIiwgZXJyb3IpO1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9XG4gICAgfSxcbiAgICBhc3luYyBnZXRVc2VySW5mbyh0b2tlbikge1xuICAgICAgaWYgKG9wdGlvbnMuZ2V0VXNlckluZm8pIHtcbiAgICAgICAgcmV0dXJuIG9wdGlvbnMuZ2V0VXNlckluZm8odG9rZW4pO1xuICAgICAgfVxuICAgICAgaWYgKCF0b2tlbi5hY2Nlc3NUb2tlbikge1xuICAgICAgICBsb2dnZXIuZXJyb3IoXCJBY2Nlc3MgdG9rZW4gaXMgcmVxdWlyZWQgdG8gZmV0Y2ggUGF5UGFsIHVzZXIgaW5mb1wiKTtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICB9XG4gICAgICB0cnkge1xuICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGJldHRlckZldGNoKFxuICAgICAgICAgIGAke3VzZXJJbmZvRW5kcG9pbnR9P3NjaGVtYT1wYXlwYWx2MS4xYCxcbiAgICAgICAgICB7XG4gICAgICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgICAgIEF1dGhvcml6YXRpb246IGBCZWFyZXIgJHt0b2tlbi5hY2Nlc3NUb2tlbn1gLFxuICAgICAgICAgICAgICBBY2NlcHQ6IFwiYXBwbGljYXRpb24vanNvblwiXG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICApO1xuICAgICAgICBpZiAoIXJlc3BvbnNlLmRhdGEpIHtcbiAgICAgICAgICBsb2dnZXIuZXJyb3IoXCJGYWlsZWQgdG8gZmV0Y2ggdXNlciBpbmZvIGZyb20gUGF5UGFsXCIpO1xuICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IHVzZXJJbmZvID0gcmVzcG9uc2UuZGF0YTtcbiAgICAgICAgY29uc3QgdXNlck1hcCA9IGF3YWl0IG9wdGlvbnMubWFwUHJvZmlsZVRvVXNlcj8uKHVzZXJJbmZvKTtcbiAgICAgICAgY29uc3QgcmVzdWx0ID0ge1xuICAgICAgICAgIHVzZXI6IHtcbiAgICAgICAgICAgIGlkOiB1c2VySW5mby51c2VyX2lkLFxuICAgICAgICAgICAgbmFtZTogdXNlckluZm8ubmFtZSxcbiAgICAgICAgICAgIGVtYWlsOiB1c2VySW5mby5lbWFpbCxcbiAgICAgICAgICAgIGltYWdlOiB1c2VySW5mby5waWN0dXJlLFxuICAgICAgICAgICAgZW1haWxWZXJpZmllZDogdXNlckluZm8uZW1haWxfdmVyaWZpZWQsXG4gICAgICAgICAgICAuLi51c2VyTWFwXG4gICAgICAgICAgfSxcbiAgICAgICAgICBkYXRhOiB1c2VySW5mb1xuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgbG9nZ2VyLmVycm9yKFwiRmFpbGVkIHRvIGZldGNoIHVzZXIgaW5mbyBmcm9tIFBheVBhbDpcIiwgZXJyb3IpO1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgIH1cbiAgICB9LFxuICAgIG9wdGlvbnNcbiAgfTtcbn07XG5cbmNvbnN0IHNvY2lhbFByb3ZpZGVycyA9IHtcbiAgYXBwbGUsXG4gIGF0bGFzc2lhbixcbiAgY29nbml0byxcbiAgZGlzY29yZCxcbiAgZmFjZWJvb2ssXG4gIGZpZ21hLFxuICBnaXRodWIsXG4gIG1pY3Jvc29mdCxcbiAgZ29vZ2xlLFxuICBodWdnaW5nZmFjZSxcbiAgc2xhY2ssXG4gIHNwb3RpZnksXG4gIHR3aXRjaCxcbiAgdHdpdHRlcixcbiAgZHJvcGJveCxcbiAga2ljayxcbiAgbGluZWFyLFxuICBsaW5rZWRpbixcbiAgZ2l0bGFiLFxuICB0aWt0b2ssXG4gIHJlZGRpdCxcbiAgcm9ibG94LFxuICBzYWxlc2ZvcmNlLFxuICB2ayxcbiAgem9vbSxcbiAgbm90aW9uLFxuICBrYWthbyxcbiAgbmF2ZXIsXG4gIGxpbmUsXG4gIHBheXBhbFxufTtcbmNvbnN0IHNvY2lhbFByb3ZpZGVyTGlzdCA9IE9iamVjdC5rZXlzKHNvY2lhbFByb3ZpZGVycyk7XG5jb25zdCBTb2NpYWxQcm92aWRlckxpc3RFbnVtID0gei5lbnVtKHNvY2lhbFByb3ZpZGVyTGlzdCkub3Ioei5zdHJpbmcoKSk7XG5cbmV4cG9ydCB7IFNvY2lhbFByb3ZpZGVyTGlzdEVudW0sIGFwcGxlLCBhdGxhc3NpYW4sIGNvZ25pdG8sIGRpc2NvcmQsIGRyb3Bib3gsIGZhY2Vib29rLCBmaWdtYSwgZ2V0QXBwbGVQdWJsaWNLZXksIGdldENvZ25pdG9QdWJsaWNLZXksIGdpdGh1YiwgZ2l0bGFiLCBnb29nbGUsIGh1Z2dpbmdmYWNlLCBrYWthbywga2ljaywgbGluZSwgbGluZWFyLCBsaW5rZWRpbiwgbWljcm9zb2Z0LCBuYXZlciwgbm90aW9uLCBwYXlwYWwsIHJlZGRpdCwgcm9ibG94LCBzYWxlc2ZvcmNlLCBzbGFjaywgc29jaWFsUHJvdmlkZXJMaXN0LCBzb2NpYWxQcm92aWRlcnMsIHNwb3RpZnksIHRpa3RvaywgdHdpdGNoLCB0d2l0dGVyLCB2aywgem9vbSB9O1xuIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6WzBdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(action-browser)/./node_modules/@better-auth/core/dist/social-providers/index.mjs\n");

/***/ }),

/***/ "(action-browser)/./node_modules/@better-auth/core/dist/utils/index.mjs":
/*!*************************************************************!*\
  !*** ./node_modules/@better-auth/core/dist/utils/index.mjs ***!
  \*************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   defineErrorCodes: () => (/* binding */ defineErrorCodes)\n/* harmony export */ });\nfunction defineErrorCodes(codes) {\n  return codes;\n}\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFjdGlvbi1icm93c2VyKS8uL25vZGVfbW9kdWxlcy9AYmV0dGVyLWF1dGgvY29yZS9kaXN0L3V0aWxzL2luZGV4Lm1qcyIsIm1hcHBpbmdzIjoiOzs7O0FBQUE7QUFDQTtBQUNBOztBQUU0QiIsInNvdXJjZXMiOlsiQzpcXFVzZXJzXFxzaWQwMVxcT25lRHJpdmVcXERlc2t0b3BcXGFtZC10ZWxlcGhvbnktc3lzdGVtXFxmcm9udGVuZFxcbm9kZV9tb2R1bGVzXFxAYmV0dGVyLWF1dGhcXGNvcmVcXGRpc3RcXHV0aWxzXFxpbmRleC5tanMiXSwic291cmNlc0NvbnRlbnQiOlsiZnVuY3Rpb24gZGVmaW5lRXJyb3JDb2Rlcyhjb2Rlcykge1xuICByZXR1cm4gY29kZXM7XG59XG5cbmV4cG9ydCB7IGRlZmluZUVycm9yQ29kZXMgfTtcbiJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOlswXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(action-browser)/./node_modules/@better-auth/core/dist/utils/index.mjs\n");

/***/ }),

/***/ "(action-browser)/./node_modules/@better-auth/telemetry/dist/index.mjs":
/*!************************************************************!*\
  !*** ./node_modules/@better-auth/telemetry/dist/index.mjs ***!
  \************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createTelemetry: () => (/* binding */ createTelemetry),\n/* harmony export */   getTelemetryAuthConfig: () => (/* binding */ getTelemetryAuthConfig)\n/* harmony export */ });\n/* harmony import */ var _better_auth_core_env__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @better-auth/core/env */ \"(action-browser)/./node_modules/@better-auth/core/dist/env/index.mjs\");\n/* harmony import */ var _better_auth_utils_random__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @better-auth/utils/random */ \"(action-browser)/./node_modules/@better-auth/utils/dist/random.mjs\");\n/* harmony import */ var _better_auth_utils_hash__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @better-auth/utils/hash */ \"(action-browser)/./node_modules/@better-auth/utils/dist/hash.mjs\");\n/* harmony import */ var _better_auth_utils_base64__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @better-auth/utils/base64 */ \"(action-browser)/./node_modules/@better-auth/utils/dist/base64.mjs\");\n/* harmony import */ var _better_fetch_fetch__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @better-fetch/fetch */ \"(action-browser)/./node_modules/@better-fetch/fetch/dist/index.js\");\n\n\n\n\n\n\nconst generateId = (size) => {\n  return (0,_better_auth_utils_random__WEBPACK_IMPORTED_MODULE_1__.createRandomStringGenerator)(\"a-z\", \"A-Z\", \"0-9\")(size);\n};\n\nasync function hashToBase64(data) {\n  const buffer = await (0,_better_auth_utils_hash__WEBPACK_IMPORTED_MODULE_2__.createHash)(\"SHA-256\").digest(data);\n  return _better_auth_utils_base64__WEBPACK_IMPORTED_MODULE_3__.base64.encode(buffer);\n}\n\nlet packageJSONCache;\nasync function readRootPackageJson() {\n  if (packageJSONCache) return packageJSONCache;\n  try {\n    const cwd = typeof process !== \"undefined\" && typeof process.cwd === \"function\" ? process.cwd() : \"\";\n    if (!cwd) return void 0;\n    const importRuntime = (m) => Function(\"mm\", \"return import(mm)\")(m);\n    const [{ default: fs }, { default: path }] = await Promise.all([\n      importRuntime(\"fs/promises\"),\n      importRuntime(\"path\")\n    ]);\n    const raw = await fs.readFile(path.join(cwd, \"package.json\"), \"utf-8\");\n    packageJSONCache = JSON.parse(raw);\n    return packageJSONCache;\n  } catch {\n  }\n  return void 0;\n}\nasync function getPackageVersion(pkg) {\n  if (packageJSONCache) {\n    return packageJSONCache.dependencies?.[pkg] || packageJSONCache.devDependencies?.[pkg] || packageJSONCache.peerDependencies?.[pkg];\n  }\n  try {\n    const cwd = typeof process !== \"undefined\" && typeof process.cwd === \"function\" ? process.cwd() : \"\";\n    if (!cwd) throw new Error(\"no-cwd\");\n    const importRuntime = (m) => Function(\"mm\", \"return import(mm)\")(m);\n    const [{ default: fs }, { default: path }] = await Promise.all([\n      importRuntime(\"fs/promises\"),\n      importRuntime(\"path\")\n    ]);\n    const pkgJsonPath = path.join(cwd, \"node_modules\", pkg, \"package.json\");\n    const raw = await fs.readFile(pkgJsonPath, \"utf-8\");\n    const json = JSON.parse(raw);\n    const resolved = json.version || await getVersionFromLocalPackageJson(pkg) || void 0;\n    return resolved;\n  } catch {\n  }\n  const fromRoot = await getVersionFromLocalPackageJson(pkg);\n  return fromRoot;\n}\nasync function getVersionFromLocalPackageJson(pkg) {\n  const json = await readRootPackageJson();\n  if (!json) return void 0;\n  const allDeps = {\n    ...json.dependencies,\n    ...json.devDependencies,\n    ...json.peerDependencies\n  };\n  return allDeps[pkg];\n}\nasync function getNameFromLocalPackageJson() {\n  const json = await readRootPackageJson();\n  return json?.name;\n}\n\nlet projectIdCached = null;\nasync function getProjectId(baseUrl) {\n  if (projectIdCached) return projectIdCached;\n  const projectName = await getNameFromLocalPackageJson();\n  if (projectName) {\n    projectIdCached = await hashToBase64(\n      baseUrl ? baseUrl + projectName : projectName\n    );\n    return projectIdCached;\n  }\n  if (baseUrl) {\n    projectIdCached = await hashToBase64(baseUrl);\n    return projectIdCached;\n  }\n  projectIdCached = generateId(32);\n  return projectIdCached;\n}\n\nconst importRuntime = (m) => {\n  return Function(\"mm\", \"return import(mm)\")(m);\n};\n\nfunction getVendor() {\n  const hasAny = (...keys) => keys.some((k) => Boolean(_better_auth_core_env__WEBPACK_IMPORTED_MODULE_0__.env[k]));\n  if (hasAny(\"CF_PAGES\", \"CF_PAGES_URL\", \"CF_ACCOUNT_ID\") || typeof navigator !== \"undefined\" && navigator.userAgent === \"Cloudflare-Workers\") {\n    return \"cloudflare\";\n  }\n  if (hasAny(\"VERCEL\", \"VERCEL_URL\", \"VERCEL_ENV\")) return \"vercel\";\n  if (hasAny(\"NETLIFY\", \"NETLIFY_URL\")) return \"netlify\";\n  if (hasAny(\n    \"RENDER\",\n    \"RENDER_URL\",\n    \"RENDER_INTERNAL_HOSTNAME\",\n    \"RENDER_SERVICE_ID\"\n  )) {\n    return \"render\";\n  }\n  if (hasAny(\"AWS_LAMBDA_FUNCTION_NAME\", \"AWS_EXECUTION_ENV\", \"LAMBDA_TASK_ROOT\")) {\n    return \"aws\";\n  }\n  if (hasAny(\n    \"GOOGLE_CLOUD_FUNCTION_NAME\",\n    \"GOOGLE_CLOUD_PROJECT\",\n    \"GCP_PROJECT\",\n    \"K_SERVICE\"\n  )) {\n    return \"gcp\";\n  }\n  if (hasAny(\n    \"AZURE_FUNCTION_NAME\",\n    \"FUNCTIONS_WORKER_RUNTIME\",\n    \"WEBSITE_INSTANCE_ID\",\n    \"WEBSITE_SITE_NAME\"\n  )) {\n    return \"azure\";\n  }\n  if (hasAny(\"DENO_DEPLOYMENT_ID\", \"DENO_REGION\")) return \"deno-deploy\";\n  if (hasAny(\"FLY_APP_NAME\", \"FLY_REGION\", \"FLY_ALLOC_ID\")) return \"fly-io\";\n  if (hasAny(\"RAILWAY_STATIC_URL\", \"RAILWAY_ENVIRONMENT_NAME\"))\n    return \"railway\";\n  if (hasAny(\"DYNO\", \"HEROKU_APP_NAME\")) return \"heroku\";\n  if (hasAny(\"DO_DEPLOYMENT_ID\", \"DO_APP_NAME\", \"DIGITALOCEAN\"))\n    return \"digitalocean\";\n  if (hasAny(\"KOYEB\", \"KOYEB_DEPLOYMENT_ID\", \"KOYEB_APP_NAME\")) return \"koyeb\";\n  return null;\n}\nasync function detectSystemInfo() {\n  try {\n    if (getVendor() === \"cloudflare\") return \"cloudflare\";\n    const os = await importRuntime(\"os\");\n    const cpus = os.cpus();\n    return {\n      deploymentVendor: getVendor(),\n      systemPlatform: os.platform(),\n      systemRelease: os.release(),\n      systemArchitecture: os.arch(),\n      cpuCount: cpus.length,\n      cpuModel: cpus.length ? cpus[0].model : null,\n      cpuSpeed: cpus.length ? cpus[0].speed : null,\n      memory: os.totalmem(),\n      isWSL: await isWsl(),\n      isDocker: await isDocker(),\n      isTTY: typeof process !== \"undefined\" && process.stdout ? process.stdout.isTTY : null\n    };\n  } catch (e) {\n    return {\n      systemPlatform: null,\n      systemRelease: null,\n      systemArchitecture: null,\n      cpuCount: null,\n      cpuModel: null,\n      cpuSpeed: null,\n      memory: null,\n      isWSL: null,\n      isDocker: null,\n      isTTY: null\n    };\n  }\n}\nlet isDockerCached;\nasync function hasDockerEnv() {\n  if (getVendor() === \"cloudflare\") return false;\n  try {\n    const fs = await importRuntime(\"fs\");\n    fs.statSync(\"/.dockerenv\");\n    return true;\n  } catch {\n    return false;\n  }\n}\nasync function hasDockerCGroup() {\n  if (getVendor() === \"cloudflare\") return false;\n  try {\n    const fs = await importRuntime(\"fs\");\n    return fs.readFileSync(\"/proc/self/cgroup\", \"utf8\").includes(\"docker\");\n  } catch {\n    return false;\n  }\n}\nasync function isDocker() {\n  if (getVendor() === \"cloudflare\") return false;\n  if (isDockerCached === void 0) {\n    isDockerCached = await hasDockerEnv() || await hasDockerCGroup();\n  }\n  return isDockerCached;\n}\nasync function isWsl() {\n  try {\n    if (getVendor() === \"cloudflare\") return false;\n    if (typeof process === \"undefined\" || process?.platform !== \"linux\") {\n      return false;\n    }\n    const fs = await importRuntime(\"fs\");\n    const os = await importRuntime(\"os\");\n    if (os.release().toLowerCase().includes(\"microsoft\")) {\n      if (await isInsideContainer()) {\n        return false;\n      }\n      return true;\n    }\n    return fs.readFileSync(\"/proc/version\", \"utf8\").toLowerCase().includes(\"microsoft\") ? !await isInsideContainer() : false;\n  } catch {\n    return false;\n  }\n}\nlet isInsideContainerCached;\nconst hasContainerEnv = async () => {\n  if (getVendor() === \"cloudflare\") return false;\n  try {\n    const fs = await importRuntime(\"fs\");\n    fs.statSync(\"/run/.containerenv\");\n    return true;\n  } catch {\n    return false;\n  }\n};\nasync function isInsideContainer() {\n  if (isInsideContainerCached === void 0) {\n    isInsideContainerCached = await hasContainerEnv() || await isDocker();\n  }\n  return isInsideContainerCached;\n}\nfunction isCI() {\n  return _better_auth_core_env__WEBPACK_IMPORTED_MODULE_0__.env.CI !== \"false\" && (\"BUILD_ID\" in _better_auth_core_env__WEBPACK_IMPORTED_MODULE_0__.env || // Jenkins, Cloudbees\n  \"BUILD_NUMBER\" in _better_auth_core_env__WEBPACK_IMPORTED_MODULE_0__.env || // Jenkins, TeamCity (fixed typo: extra space removed)\n  \"CI\" in _better_auth_core_env__WEBPACK_IMPORTED_MODULE_0__.env || // Travis CI, CircleCI, Cirrus CI, Gitlab CI, Appveyor, CodeShip, dsari, Cloudflare\n  \"CI_APP_ID\" in _better_auth_core_env__WEBPACK_IMPORTED_MODULE_0__.env || // Appflow\n  \"CI_BUILD_ID\" in _better_auth_core_env__WEBPACK_IMPORTED_MODULE_0__.env || // Appflow\n  \"CI_BUILD_NUMBER\" in _better_auth_core_env__WEBPACK_IMPORTED_MODULE_0__.env || // Appflow\n  \"CI_NAME\" in _better_auth_core_env__WEBPACK_IMPORTED_MODULE_0__.env || // Codeship and others\n  \"CONTINUOUS_INTEGRATION\" in _better_auth_core_env__WEBPACK_IMPORTED_MODULE_0__.env || // Travis CI, Cirrus CI\n  \"RUN_ID\" in _better_auth_core_env__WEBPACK_IMPORTED_MODULE_0__.env);\n}\n\nfunction detectRuntime() {\n  if (typeof Deno !== \"undefined\") {\n    const denoVersion = Deno?.version?.deno ?? null;\n    return { name: \"deno\", version: denoVersion };\n  }\n  if (typeof Bun !== \"undefined\") {\n    const bunVersion = Bun?.version ?? null;\n    return { name: \"bun\", version: bunVersion };\n  }\n  if (typeof process !== \"undefined\" && process?.versions?.node) {\n    return { name: \"node\", version: process.versions.node ?? null };\n  }\n  return { name: \"edge\", version: null };\n}\nfunction detectEnvironment() {\n  return (0,_better_auth_core_env__WEBPACK_IMPORTED_MODULE_0__.getEnvVar)(\"NODE_ENV\") === \"production\" ? \"production\" : isCI() ? \"ci\" : (0,_better_auth_core_env__WEBPACK_IMPORTED_MODULE_0__.isTest)() ? \"test\" : \"development\";\n}\n\nconst DATABASES = {\n  pg: \"postgresql\",\n  mysql: \"mysql\",\n  mariadb: \"mariadb\",\n  sqlite3: \"sqlite\",\n  \"better-sqlite3\": \"sqlite\",\n  \"@prisma/client\": \"prisma\",\n  mongoose: \"mongodb\",\n  mongodb: \"mongodb\",\n  \"drizzle-orm\": \"drizzle\"\n};\nasync function detectDatabase() {\n  for (const [pkg, name] of Object.entries(DATABASES)) {\n    const version = await getPackageVersion(pkg);\n    if (version) return { name, version };\n  }\n  return void 0;\n}\n\nconst FRAMEWORKS = {\n  next: \"next\",\n  nuxt: \"nuxt\",\n  \"@remix-run/server-runtime\": \"remix\",\n  astro: \"astro\",\n  \"@sveltejs/kit\": \"sveltekit\",\n  \"solid-start\": \"solid-start\",\n  \"tanstack-start\": \"tanstack-start\",\n  hono: \"hono\",\n  express: \"express\",\n  elysia: \"elysia\",\n  expo: \"expo\"\n};\nasync function detectFramework() {\n  for (const [pkg, name] of Object.entries(FRAMEWORKS)) {\n    const version = await getPackageVersion(pkg);\n    if (version) return { name, version };\n  }\n  return void 0;\n}\n\nfunction detectPackageManager() {\n  const userAgent = _better_auth_core_env__WEBPACK_IMPORTED_MODULE_0__.env.npm_config_user_agent;\n  if (!userAgent) {\n    return void 0;\n  }\n  const pmSpec = userAgent.split(\" \")[0];\n  const separatorPos = pmSpec.lastIndexOf(\"/\");\n  const name = pmSpec.substring(0, separatorPos);\n  return {\n    name: name === \"npminstall\" ? \"cnpm\" : name,\n    version: pmSpec.substring(separatorPos + 1)\n  };\n}\n\nfunction getTelemetryAuthConfig(options, context) {\n  return {\n    database: context?.database,\n    adapter: context?.adapter,\n    emailVerification: {\n      sendVerificationEmail: !!options.emailVerification?.sendVerificationEmail,\n      sendOnSignUp: !!options.emailVerification?.sendOnSignUp,\n      sendOnSignIn: !!options.emailVerification?.sendOnSignIn,\n      autoSignInAfterVerification: !!options.emailVerification?.autoSignInAfterVerification,\n      expiresIn: options.emailVerification?.expiresIn,\n      onEmailVerification: !!options.emailVerification?.onEmailVerification,\n      afterEmailVerification: !!options.emailVerification?.afterEmailVerification\n    },\n    emailAndPassword: {\n      enabled: !!options.emailAndPassword?.enabled,\n      disableSignUp: !!options.emailAndPassword?.disableSignUp,\n      requireEmailVerification: !!options.emailAndPassword?.requireEmailVerification,\n      maxPasswordLength: options.emailAndPassword?.maxPasswordLength,\n      minPasswordLength: options.emailAndPassword?.minPasswordLength,\n      sendResetPassword: !!options.emailAndPassword?.sendResetPassword,\n      resetPasswordTokenExpiresIn: options.emailAndPassword?.resetPasswordTokenExpiresIn,\n      onPasswordReset: !!options.emailAndPassword?.onPasswordReset,\n      password: {\n        hash: !!options.emailAndPassword?.password?.hash,\n        verify: !!options.emailAndPassword?.password?.verify\n      },\n      autoSignIn: !!options.emailAndPassword?.autoSignIn,\n      revokeSessionsOnPasswordReset: !!options.emailAndPassword?.revokeSessionsOnPasswordReset\n    },\n    socialProviders: Object.keys(options.socialProviders || {}).map((p) => {\n      const provider = options.socialProviders?.[p];\n      if (!provider) return {};\n      return {\n        id: p,\n        mapProfileToUser: !!provider.mapProfileToUser,\n        disableDefaultScope: !!provider.disableDefaultScope,\n        disableIdTokenSignIn: !!provider.disableIdTokenSignIn,\n        disableImplicitSignUp: provider.disableImplicitSignUp,\n        disableSignUp: provider.disableSignUp,\n        getUserInfo: !!provider.getUserInfo,\n        overrideUserInfoOnSignIn: !!provider.overrideUserInfoOnSignIn,\n        prompt: provider.prompt,\n        verifyIdToken: !!provider.verifyIdToken,\n        scope: provider.scope,\n        refreshAccessToken: !!provider.refreshAccessToken\n      };\n    }),\n    plugins: options.plugins?.map((p) => p.id.toString()),\n    user: {\n      modelName: options.user?.modelName,\n      fields: options.user?.fields,\n      additionalFields: options.user?.additionalFields,\n      changeEmail: {\n        enabled: options.user?.changeEmail?.enabled,\n        sendChangeEmailVerification: !!options.user?.changeEmail?.sendChangeEmailVerification\n      }\n    },\n    verification: {\n      modelName: options.verification?.modelName,\n      disableCleanup: options.verification?.disableCleanup,\n      fields: options.verification?.fields\n    },\n    session: {\n      modelName: options.session?.modelName,\n      additionalFields: options.session?.additionalFields,\n      cookieCache: {\n        enabled: options.session?.cookieCache?.enabled,\n        maxAge: options.session?.cookieCache?.maxAge\n      },\n      disableSessionRefresh: options.session?.disableSessionRefresh,\n      expiresIn: options.session?.expiresIn,\n      fields: options.session?.fields,\n      freshAge: options.session?.freshAge,\n      preserveSessionInDatabase: options.session?.preserveSessionInDatabase,\n      storeSessionInDatabase: options.session?.storeSessionInDatabase,\n      updateAge: options.session?.updateAge\n    },\n    account: {\n      modelName: options.account?.modelName,\n      fields: options.account?.fields,\n      encryptOAuthTokens: options.account?.encryptOAuthTokens,\n      updateAccountOnSignIn: options.account?.updateAccountOnSignIn,\n      accountLinking: {\n        enabled: options.account?.accountLinking?.enabled,\n        trustedProviders: options.account?.accountLinking?.trustedProviders,\n        updateUserInfoOnLink: options.account?.accountLinking?.updateUserInfoOnLink,\n        allowUnlinkingAll: options.account?.accountLinking?.allowUnlinkingAll\n      }\n    },\n    hooks: {\n      after: !!options.hooks?.after,\n      before: !!options.hooks?.before\n    },\n    secondaryStorage: !!options.secondaryStorage,\n    advanced: {\n      cookiePrefix: !!options.advanced?.cookiePrefix,\n      //this shouldn't be tracked\n      cookies: !!options.advanced?.cookies,\n      crossSubDomainCookies: {\n        domain: !!options.advanced?.crossSubDomainCookies?.domain,\n        enabled: options.advanced?.crossSubDomainCookies?.enabled,\n        additionalCookies: options.advanced?.crossSubDomainCookies?.additionalCookies\n      },\n      database: {\n        useNumberId: !!options.advanced?.database?.useNumberId,\n        generateId: options.advanced?.database?.generateId,\n        defaultFindManyLimit: options.advanced?.database?.defaultFindManyLimit\n      },\n      useSecureCookies: options.advanced?.useSecureCookies,\n      ipAddress: {\n        disableIpTracking: options.advanced?.ipAddress?.disableIpTracking,\n        ipAddressHeaders: options.advanced?.ipAddress?.ipAddressHeaders\n      },\n      disableCSRFCheck: options.advanced?.disableCSRFCheck,\n      cookieAttributes: {\n        expires: options.advanced?.defaultCookieAttributes?.expires,\n        secure: options.advanced?.defaultCookieAttributes?.secure,\n        sameSite: options.advanced?.defaultCookieAttributes?.sameSite,\n        domain: !!options.advanced?.defaultCookieAttributes?.domain,\n        path: options.advanced?.defaultCookieAttributes?.path,\n        httpOnly: options.advanced?.defaultCookieAttributes?.httpOnly\n      }\n    },\n    trustedOrigins: options.trustedOrigins?.length,\n    rateLimit: {\n      storage: options.rateLimit?.storage,\n      modelName: options.rateLimit?.modelName,\n      window: options.rateLimit?.window,\n      customStorage: !!options.rateLimit?.customStorage,\n      enabled: options.rateLimit?.enabled,\n      max: options.rateLimit?.max\n    },\n    onAPIError: {\n      errorURL: options.onAPIError?.errorURL,\n      onError: !!options.onAPIError?.onError,\n      throw: options.onAPIError?.throw\n    },\n    logger: {\n      disabled: options.logger?.disabled,\n      level: options.logger?.level,\n      log: !!options.logger?.log\n    },\n    databaseHooks: {\n      user: {\n        create: {\n          after: !!options.databaseHooks?.user?.create?.after,\n          before: !!options.databaseHooks?.user?.create?.before\n        },\n        update: {\n          after: !!options.databaseHooks?.user?.update?.after,\n          before: !!options.databaseHooks?.user?.update?.before\n        }\n      },\n      session: {\n        create: {\n          after: !!options.databaseHooks?.session?.create?.after,\n          before: !!options.databaseHooks?.session?.create?.before\n        },\n        update: {\n          after: !!options.databaseHooks?.session?.update?.after,\n          before: !!options.databaseHooks?.session?.update?.before\n        }\n      },\n      account: {\n        create: {\n          after: !!options.databaseHooks?.account?.create?.after,\n          before: !!options.databaseHooks?.account?.create?.before\n        },\n        update: {\n          after: !!options.databaseHooks?.account?.update?.after,\n          before: !!options.databaseHooks?.account?.update?.before\n        }\n      },\n      verification: {\n        create: {\n          after: !!options.databaseHooks?.verification?.create?.after,\n          before: !!options.databaseHooks?.verification?.create?.before\n        },\n        update: {\n          after: !!options.databaseHooks?.verification?.update?.after,\n          before: !!options.databaseHooks?.verification?.update?.before\n        }\n      }\n    }\n  };\n}\n\nasync function createTelemetry(options, context) {\n  const debugEnabled = options.telemetry?.debug || (0,_better_auth_core_env__WEBPACK_IMPORTED_MODULE_0__.getBooleanEnvVar)(\"BETTER_AUTH_TELEMETRY_DEBUG\", false);\n  const TELEMETRY_ENDPOINT = _better_auth_core_env__WEBPACK_IMPORTED_MODULE_0__.ENV.BETTER_AUTH_TELEMETRY_ENDPOINT;\n  const track = async (event) => {\n    try {\n      if (context?.customTrack) {\n        await context.customTrack(event);\n      } else {\n        if (debugEnabled) {\n          await Promise.resolve(\n            _better_auth_core_env__WEBPACK_IMPORTED_MODULE_0__.logger.info(\"telemetry event\", JSON.stringify(event, null, 2))\n          );\n        } else {\n          await (0,_better_fetch_fetch__WEBPACK_IMPORTED_MODULE_4__.betterFetch)(TELEMETRY_ENDPOINT, {\n            method: \"POST\",\n            body: event\n          });\n        }\n      }\n    } catch {\n    }\n  };\n  const isEnabled = async () => {\n    const telemetryEnabled = options.telemetry?.enabled !== void 0 ? options.telemetry.enabled : false;\n    const envEnabled = (0,_better_auth_core_env__WEBPACK_IMPORTED_MODULE_0__.getBooleanEnvVar)(\"BETTER_AUTH_TELEMETRY\", false);\n    return (envEnabled || telemetryEnabled) && (context?.skipTestCheck || !(0,_better_auth_core_env__WEBPACK_IMPORTED_MODULE_0__.isTest)());\n  };\n  const enabled = await isEnabled();\n  let anonymousId;\n  if (enabled) {\n    anonymousId = await getProjectId(options.baseURL);\n    const payload = {\n      config: getTelemetryAuthConfig(options),\n      runtime: detectRuntime(),\n      database: await detectDatabase(),\n      framework: await detectFramework(),\n      environment: detectEnvironment(),\n      systemInfo: await detectSystemInfo(),\n      packageManager: detectPackageManager()\n    };\n    void track({ type: \"init\", payload, anonymousId });\n  }\n  return {\n    publish: async (event) => {\n      if (!enabled) return;\n      if (!anonymousId) {\n        anonymousId = await getProjectId(options.baseURL);\n      }\n      await track({\n        type: event.type,\n        payload: event.payload,\n        anonymousId\n      });\n    }\n  };\n}\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFjdGlvbi1icm93c2VyKS8uL25vZGVfbW9kdWxlcy9AYmV0dGVyLWF1dGgvdGVsZW1ldHJ5L2Rpc3QvaW5kZXgubWpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7QUFBOEY7QUFDdEI7QUFDbkI7QUFDRjtBQUNEOztBQUVsRDtBQUNBLFNBQVMsc0ZBQTJCO0FBQ3BDOztBQUVBO0FBQ0EsdUJBQXVCLG1FQUFVO0FBQ2pDLFNBQVMsNkRBQU07QUFDZjs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWEsYUFBYSxJQUFJLGVBQWU7QUFDN0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhLGFBQWEsSUFBSSxlQUFlO0FBQzdDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0EsdURBQXVELHNEQUFHO0FBQzFEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVMsc0RBQUcsb0JBQW9CLG9FQUFpQjtBQUNqRCxFQUFFLHdFQUFxQjtBQUN2QixFQUFFLDhEQUFXO0FBQ2IsRUFBRSxxRUFBa0I7QUFDcEIsRUFBRSx1RUFBb0I7QUFDdEIsRUFBRSwyRUFBd0I7QUFDMUIsRUFBRSxtRUFBZ0I7QUFDbEIsRUFBRSxrRkFBK0I7QUFDakMsRUFBRSxrRUFBZTtBQUNqQjs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBLFNBQVMsZ0VBQVMsK0RBQStELDZEQUFNO0FBQ3ZGOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwQkFBMEI7QUFDMUI7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMEJBQTBCO0FBQzFCO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLG9CQUFvQixzREFBRztBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBLEtBQUs7QUFDTCw4REFBOEQ7QUFDOUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0EsbURBQW1ELHVFQUFnQjtBQUNuRSw2QkFBNkIsc0RBQUc7QUFDaEM7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFRO0FBQ1I7QUFDQTtBQUNBLFlBQVkseURBQU07QUFDbEI7QUFDQSxVQUFVO0FBQ1YsZ0JBQWdCLGdFQUFXO0FBQzNCO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7QUFDQTtBQUNBLHVCQUF1Qix1RUFBZ0I7QUFDdkMsMkVBQTJFLDZEQUFNO0FBQ2pGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUIsb0NBQW9DO0FBQ3JEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBOztBQUVtRCIsInNvdXJjZXMiOlsiQzpcXFVzZXJzXFxzaWQwMVxcT25lRHJpdmVcXERlc2t0b3BcXGFtZC10ZWxlcGhvbnktc3lzdGVtXFxmcm9udGVuZFxcbm9kZV9tb2R1bGVzXFxAYmV0dGVyLWF1dGhcXHRlbGVtZXRyeVxcZGlzdFxcaW5kZXgubWpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGVudiwgZ2V0RW52VmFyLCBpc1Rlc3QsIGdldEJvb2xlYW5FbnZWYXIsIEVOViwgbG9nZ2VyIH0gZnJvbSAnQGJldHRlci1hdXRoL2NvcmUvZW52JztcbmltcG9ydCB7IGNyZWF0ZVJhbmRvbVN0cmluZ0dlbmVyYXRvciB9IGZyb20gJ0BiZXR0ZXItYXV0aC91dGlscy9yYW5kb20nO1xuaW1wb3J0IHsgY3JlYXRlSGFzaCB9IGZyb20gJ0BiZXR0ZXItYXV0aC91dGlscy9oYXNoJztcbmltcG9ydCB7IGJhc2U2NCB9IGZyb20gJ0BiZXR0ZXItYXV0aC91dGlscy9iYXNlNjQnO1xuaW1wb3J0IHsgYmV0dGVyRmV0Y2ggfSBmcm9tICdAYmV0dGVyLWZldGNoL2ZldGNoJztcblxuY29uc3QgZ2VuZXJhdGVJZCA9IChzaXplKSA9PiB7XG4gIHJldHVybiBjcmVhdGVSYW5kb21TdHJpbmdHZW5lcmF0b3IoXCJhLXpcIiwgXCJBLVpcIiwgXCIwLTlcIikoc2l6ZSk7XG59O1xuXG5hc3luYyBmdW5jdGlvbiBoYXNoVG9CYXNlNjQoZGF0YSkge1xuICBjb25zdCBidWZmZXIgPSBhd2FpdCBjcmVhdGVIYXNoKFwiU0hBLTI1NlwiKS5kaWdlc3QoZGF0YSk7XG4gIHJldHVybiBiYXNlNjQuZW5jb2RlKGJ1ZmZlcik7XG59XG5cbmxldCBwYWNrYWdlSlNPTkNhY2hlO1xuYXN5bmMgZnVuY3Rpb24gcmVhZFJvb3RQYWNrYWdlSnNvbigpIHtcbiAgaWYgKHBhY2thZ2VKU09OQ2FjaGUpIHJldHVybiBwYWNrYWdlSlNPTkNhY2hlO1xuICB0cnkge1xuICAgIGNvbnN0IGN3ZCA9IHR5cGVvZiBwcm9jZXNzICE9PSBcInVuZGVmaW5lZFwiICYmIHR5cGVvZiBwcm9jZXNzLmN3ZCA9PT0gXCJmdW5jdGlvblwiID8gcHJvY2Vzcy5jd2QoKSA6IFwiXCI7XG4gICAgaWYgKCFjd2QpIHJldHVybiB2b2lkIDA7XG4gICAgY29uc3QgaW1wb3J0UnVudGltZSA9IChtKSA9PiBGdW5jdGlvbihcIm1tXCIsIFwicmV0dXJuIGltcG9ydChtbSlcIikobSk7XG4gICAgY29uc3QgW3sgZGVmYXVsdDogZnMgfSwgeyBkZWZhdWx0OiBwYXRoIH1dID0gYXdhaXQgUHJvbWlzZS5hbGwoW1xuICAgICAgaW1wb3J0UnVudGltZShcImZzL3Byb21pc2VzXCIpLFxuICAgICAgaW1wb3J0UnVudGltZShcInBhdGhcIilcbiAgICBdKTtcbiAgICBjb25zdCByYXcgPSBhd2FpdCBmcy5yZWFkRmlsZShwYXRoLmpvaW4oY3dkLCBcInBhY2thZ2UuanNvblwiKSwgXCJ1dGYtOFwiKTtcbiAgICBwYWNrYWdlSlNPTkNhY2hlID0gSlNPTi5wYXJzZShyYXcpO1xuICAgIHJldHVybiBwYWNrYWdlSlNPTkNhY2hlO1xuICB9IGNhdGNoIHtcbiAgfVxuICByZXR1cm4gdm9pZCAwO1xufVxuYXN5bmMgZnVuY3Rpb24gZ2V0UGFja2FnZVZlcnNpb24ocGtnKSB7XG4gIGlmIChwYWNrYWdlSlNPTkNhY2hlKSB7XG4gICAgcmV0dXJuIHBhY2thZ2VKU09OQ2FjaGUuZGVwZW5kZW5jaWVzPy5bcGtnXSB8fCBwYWNrYWdlSlNPTkNhY2hlLmRldkRlcGVuZGVuY2llcz8uW3BrZ10gfHwgcGFja2FnZUpTT05DYWNoZS5wZWVyRGVwZW5kZW5jaWVzPy5bcGtnXTtcbiAgfVxuICB0cnkge1xuICAgIGNvbnN0IGN3ZCA9IHR5cGVvZiBwcm9jZXNzICE9PSBcInVuZGVmaW5lZFwiICYmIHR5cGVvZiBwcm9jZXNzLmN3ZCA9PT0gXCJmdW5jdGlvblwiID8gcHJvY2Vzcy5jd2QoKSA6IFwiXCI7XG4gICAgaWYgKCFjd2QpIHRocm93IG5ldyBFcnJvcihcIm5vLWN3ZFwiKTtcbiAgICBjb25zdCBpbXBvcnRSdW50aW1lID0gKG0pID0+IEZ1bmN0aW9uKFwibW1cIiwgXCJyZXR1cm4gaW1wb3J0KG1tKVwiKShtKTtcbiAgICBjb25zdCBbeyBkZWZhdWx0OiBmcyB9LCB7IGRlZmF1bHQ6IHBhdGggfV0gPSBhd2FpdCBQcm9taXNlLmFsbChbXG4gICAgICBpbXBvcnRSdW50aW1lKFwiZnMvcHJvbWlzZXNcIiksXG4gICAgICBpbXBvcnRSdW50aW1lKFwicGF0aFwiKVxuICAgIF0pO1xuICAgIGNvbnN0IHBrZ0pzb25QYXRoID0gcGF0aC5qb2luKGN3ZCwgXCJub2RlX21vZHVsZXNcIiwgcGtnLCBcInBhY2thZ2UuanNvblwiKTtcbiAgICBjb25zdCByYXcgPSBhd2FpdCBmcy5yZWFkRmlsZShwa2dKc29uUGF0aCwgXCJ1dGYtOFwiKTtcbiAgICBjb25zdCBqc29uID0gSlNPTi5wYXJzZShyYXcpO1xuICAgIGNvbnN0IHJlc29sdmVkID0ganNvbi52ZXJzaW9uIHx8IGF3YWl0IGdldFZlcnNpb25Gcm9tTG9jYWxQYWNrYWdlSnNvbihwa2cpIHx8IHZvaWQgMDtcbiAgICByZXR1cm4gcmVzb2x2ZWQ7XG4gIH0gY2F0Y2gge1xuICB9XG4gIGNvbnN0IGZyb21Sb290ID0gYXdhaXQgZ2V0VmVyc2lvbkZyb21Mb2NhbFBhY2thZ2VKc29uKHBrZyk7XG4gIHJldHVybiBmcm9tUm9vdDtcbn1cbmFzeW5jIGZ1bmN0aW9uIGdldFZlcnNpb25Gcm9tTG9jYWxQYWNrYWdlSnNvbihwa2cpIHtcbiAgY29uc3QganNvbiA9IGF3YWl0IHJlYWRSb290UGFja2FnZUpzb24oKTtcbiAgaWYgKCFqc29uKSByZXR1cm4gdm9pZCAwO1xuICBjb25zdCBhbGxEZXBzID0ge1xuICAgIC4uLmpzb24uZGVwZW5kZW5jaWVzLFxuICAgIC4uLmpzb24uZGV2RGVwZW5kZW5jaWVzLFxuICAgIC4uLmpzb24ucGVlckRlcGVuZGVuY2llc1xuICB9O1xuICByZXR1cm4gYWxsRGVwc1twa2ddO1xufVxuYXN5bmMgZnVuY3Rpb24gZ2V0TmFtZUZyb21Mb2NhbFBhY2thZ2VKc29uKCkge1xuICBjb25zdCBqc29uID0gYXdhaXQgcmVhZFJvb3RQYWNrYWdlSnNvbigpO1xuICByZXR1cm4ganNvbj8ubmFtZTtcbn1cblxubGV0IHByb2plY3RJZENhY2hlZCA9IG51bGw7XG5hc3luYyBmdW5jdGlvbiBnZXRQcm9qZWN0SWQoYmFzZVVybCkge1xuICBpZiAocHJvamVjdElkQ2FjaGVkKSByZXR1cm4gcHJvamVjdElkQ2FjaGVkO1xuICBjb25zdCBwcm9qZWN0TmFtZSA9IGF3YWl0IGdldE5hbWVGcm9tTG9jYWxQYWNrYWdlSnNvbigpO1xuICBpZiAocHJvamVjdE5hbWUpIHtcbiAgICBwcm9qZWN0SWRDYWNoZWQgPSBhd2FpdCBoYXNoVG9CYXNlNjQoXG4gICAgICBiYXNlVXJsID8gYmFzZVVybCArIHByb2plY3ROYW1lIDogcHJvamVjdE5hbWVcbiAgICApO1xuICAgIHJldHVybiBwcm9qZWN0SWRDYWNoZWQ7XG4gIH1cbiAgaWYgKGJhc2VVcmwpIHtcbiAgICBwcm9qZWN0SWRDYWNoZWQgPSBhd2FpdCBoYXNoVG9CYXNlNjQoYmFzZVVybCk7XG4gICAgcmV0dXJuIHByb2plY3RJZENhY2hlZDtcbiAgfVxuICBwcm9qZWN0SWRDYWNoZWQgPSBnZW5lcmF0ZUlkKDMyKTtcbiAgcmV0dXJuIHByb2plY3RJZENhY2hlZDtcbn1cblxuY29uc3QgaW1wb3J0UnVudGltZSA9IChtKSA9PiB7XG4gIHJldHVybiBGdW5jdGlvbihcIm1tXCIsIFwicmV0dXJuIGltcG9ydChtbSlcIikobSk7XG59O1xuXG5mdW5jdGlvbiBnZXRWZW5kb3IoKSB7XG4gIGNvbnN0IGhhc0FueSA9ICguLi5rZXlzKSA9PiBrZXlzLnNvbWUoKGspID0+IEJvb2xlYW4oZW52W2tdKSk7XG4gIGlmIChoYXNBbnkoXCJDRl9QQUdFU1wiLCBcIkNGX1BBR0VTX1VSTFwiLCBcIkNGX0FDQ09VTlRfSURcIikgfHwgdHlwZW9mIG5hdmlnYXRvciAhPT0gXCJ1bmRlZmluZWRcIiAmJiBuYXZpZ2F0b3IudXNlckFnZW50ID09PSBcIkNsb3VkZmxhcmUtV29ya2Vyc1wiKSB7XG4gICAgcmV0dXJuIFwiY2xvdWRmbGFyZVwiO1xuICB9XG4gIGlmIChoYXNBbnkoXCJWRVJDRUxcIiwgXCJWRVJDRUxfVVJMXCIsIFwiVkVSQ0VMX0VOVlwiKSkgcmV0dXJuIFwidmVyY2VsXCI7XG4gIGlmIChoYXNBbnkoXCJORVRMSUZZXCIsIFwiTkVUTElGWV9VUkxcIikpIHJldHVybiBcIm5ldGxpZnlcIjtcbiAgaWYgKGhhc0FueShcbiAgICBcIlJFTkRFUlwiLFxuICAgIFwiUkVOREVSX1VSTFwiLFxuICAgIFwiUkVOREVSX0lOVEVSTkFMX0hPU1ROQU1FXCIsXG4gICAgXCJSRU5ERVJfU0VSVklDRV9JRFwiXG4gICkpIHtcbiAgICByZXR1cm4gXCJyZW5kZXJcIjtcbiAgfVxuICBpZiAoaGFzQW55KFwiQVdTX0xBTUJEQV9GVU5DVElPTl9OQU1FXCIsIFwiQVdTX0VYRUNVVElPTl9FTlZcIiwgXCJMQU1CREFfVEFTS19ST09UXCIpKSB7XG4gICAgcmV0dXJuIFwiYXdzXCI7XG4gIH1cbiAgaWYgKGhhc0FueShcbiAgICBcIkdPT0dMRV9DTE9VRF9GVU5DVElPTl9OQU1FXCIsXG4gICAgXCJHT09HTEVfQ0xPVURfUFJPSkVDVFwiLFxuICAgIFwiR0NQX1BST0pFQ1RcIixcbiAgICBcIktfU0VSVklDRVwiXG4gICkpIHtcbiAgICByZXR1cm4gXCJnY3BcIjtcbiAgfVxuICBpZiAoaGFzQW55KFxuICAgIFwiQVpVUkVfRlVOQ1RJT05fTkFNRVwiLFxuICAgIFwiRlVOQ1RJT05TX1dPUktFUl9SVU5USU1FXCIsXG4gICAgXCJXRUJTSVRFX0lOU1RBTkNFX0lEXCIsXG4gICAgXCJXRUJTSVRFX1NJVEVfTkFNRVwiXG4gICkpIHtcbiAgICByZXR1cm4gXCJhenVyZVwiO1xuICB9XG4gIGlmIChoYXNBbnkoXCJERU5PX0RFUExPWU1FTlRfSURcIiwgXCJERU5PX1JFR0lPTlwiKSkgcmV0dXJuIFwiZGVuby1kZXBsb3lcIjtcbiAgaWYgKGhhc0FueShcIkZMWV9BUFBfTkFNRVwiLCBcIkZMWV9SRUdJT05cIiwgXCJGTFlfQUxMT0NfSURcIikpIHJldHVybiBcImZseS1pb1wiO1xuICBpZiAoaGFzQW55KFwiUkFJTFdBWV9TVEFUSUNfVVJMXCIsIFwiUkFJTFdBWV9FTlZJUk9OTUVOVF9OQU1FXCIpKVxuICAgIHJldHVybiBcInJhaWx3YXlcIjtcbiAgaWYgKGhhc0FueShcIkRZTk9cIiwgXCJIRVJPS1VfQVBQX05BTUVcIikpIHJldHVybiBcImhlcm9rdVwiO1xuICBpZiAoaGFzQW55KFwiRE9fREVQTE9ZTUVOVF9JRFwiLCBcIkRPX0FQUF9OQU1FXCIsIFwiRElHSVRBTE9DRUFOXCIpKVxuICAgIHJldHVybiBcImRpZ2l0YWxvY2VhblwiO1xuICBpZiAoaGFzQW55KFwiS09ZRUJcIiwgXCJLT1lFQl9ERVBMT1lNRU5UX0lEXCIsIFwiS09ZRUJfQVBQX05BTUVcIikpIHJldHVybiBcImtveWViXCI7XG4gIHJldHVybiBudWxsO1xufVxuYXN5bmMgZnVuY3Rpb24gZGV0ZWN0U3lzdGVtSW5mbygpIHtcbiAgdHJ5IHtcbiAgICBpZiAoZ2V0VmVuZG9yKCkgPT09IFwiY2xvdWRmbGFyZVwiKSByZXR1cm4gXCJjbG91ZGZsYXJlXCI7XG4gICAgY29uc3Qgb3MgPSBhd2FpdCBpbXBvcnRSdW50aW1lKFwib3NcIik7XG4gICAgY29uc3QgY3B1cyA9IG9zLmNwdXMoKTtcbiAgICByZXR1cm4ge1xuICAgICAgZGVwbG95bWVudFZlbmRvcjogZ2V0VmVuZG9yKCksXG4gICAgICBzeXN0ZW1QbGF0Zm9ybTogb3MucGxhdGZvcm0oKSxcbiAgICAgIHN5c3RlbVJlbGVhc2U6IG9zLnJlbGVhc2UoKSxcbiAgICAgIHN5c3RlbUFyY2hpdGVjdHVyZTogb3MuYXJjaCgpLFxuICAgICAgY3B1Q291bnQ6IGNwdXMubGVuZ3RoLFxuICAgICAgY3B1TW9kZWw6IGNwdXMubGVuZ3RoID8gY3B1c1swXS5tb2RlbCA6IG51bGwsXG4gICAgICBjcHVTcGVlZDogY3B1cy5sZW5ndGggPyBjcHVzWzBdLnNwZWVkIDogbnVsbCxcbiAgICAgIG1lbW9yeTogb3MudG90YWxtZW0oKSxcbiAgICAgIGlzV1NMOiBhd2FpdCBpc1dzbCgpLFxuICAgICAgaXNEb2NrZXI6IGF3YWl0IGlzRG9ja2VyKCksXG4gICAgICBpc1RUWTogdHlwZW9mIHByb2Nlc3MgIT09IFwidW5kZWZpbmVkXCIgJiYgcHJvY2Vzcy5zdGRvdXQgPyBwcm9jZXNzLnN0ZG91dC5pc1RUWSA6IG51bGxcbiAgICB9O1xuICB9IGNhdGNoIChlKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHN5c3RlbVBsYXRmb3JtOiBudWxsLFxuICAgICAgc3lzdGVtUmVsZWFzZTogbnVsbCxcbiAgICAgIHN5c3RlbUFyY2hpdGVjdHVyZTogbnVsbCxcbiAgICAgIGNwdUNvdW50OiBudWxsLFxuICAgICAgY3B1TW9kZWw6IG51bGwsXG4gICAgICBjcHVTcGVlZDogbnVsbCxcbiAgICAgIG1lbW9yeTogbnVsbCxcbiAgICAgIGlzV1NMOiBudWxsLFxuICAgICAgaXNEb2NrZXI6IG51bGwsXG4gICAgICBpc1RUWTogbnVsbFxuICAgIH07XG4gIH1cbn1cbmxldCBpc0RvY2tlckNhY2hlZDtcbmFzeW5jIGZ1bmN0aW9uIGhhc0RvY2tlckVudigpIHtcbiAgaWYgKGdldFZlbmRvcigpID09PSBcImNsb3VkZmxhcmVcIikgcmV0dXJuIGZhbHNlO1xuICB0cnkge1xuICAgIGNvbnN0IGZzID0gYXdhaXQgaW1wb3J0UnVudGltZShcImZzXCIpO1xuICAgIGZzLnN0YXRTeW5jKFwiLy5kb2NrZXJlbnZcIik7XG4gICAgcmV0dXJuIHRydWU7XG4gIH0gY2F0Y2gge1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxufVxuYXN5bmMgZnVuY3Rpb24gaGFzRG9ja2VyQ0dyb3VwKCkge1xuICBpZiAoZ2V0VmVuZG9yKCkgPT09IFwiY2xvdWRmbGFyZVwiKSByZXR1cm4gZmFsc2U7XG4gIHRyeSB7XG4gICAgY29uc3QgZnMgPSBhd2FpdCBpbXBvcnRSdW50aW1lKFwiZnNcIik7XG4gICAgcmV0dXJuIGZzLnJlYWRGaWxlU3luYyhcIi9wcm9jL3NlbGYvY2dyb3VwXCIsIFwidXRmOFwiKS5pbmNsdWRlcyhcImRvY2tlclwiKTtcbiAgfSBjYXRjaCB7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG59XG5hc3luYyBmdW5jdGlvbiBpc0RvY2tlcigpIHtcbiAgaWYgKGdldFZlbmRvcigpID09PSBcImNsb3VkZmxhcmVcIikgcmV0dXJuIGZhbHNlO1xuICBpZiAoaXNEb2NrZXJDYWNoZWQgPT09IHZvaWQgMCkge1xuICAgIGlzRG9ja2VyQ2FjaGVkID0gYXdhaXQgaGFzRG9ja2VyRW52KCkgfHwgYXdhaXQgaGFzRG9ja2VyQ0dyb3VwKCk7XG4gIH1cbiAgcmV0dXJuIGlzRG9ja2VyQ2FjaGVkO1xufVxuYXN5bmMgZnVuY3Rpb24gaXNXc2woKSB7XG4gIHRyeSB7XG4gICAgaWYgKGdldFZlbmRvcigpID09PSBcImNsb3VkZmxhcmVcIikgcmV0dXJuIGZhbHNlO1xuICAgIGlmICh0eXBlb2YgcHJvY2VzcyA9PT0gXCJ1bmRlZmluZWRcIiB8fCBwcm9jZXNzPy5wbGF0Zm9ybSAhPT0gXCJsaW51eFwiKSB7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIGNvbnN0IGZzID0gYXdhaXQgaW1wb3J0UnVudGltZShcImZzXCIpO1xuICAgIGNvbnN0IG9zID0gYXdhaXQgaW1wb3J0UnVudGltZShcIm9zXCIpO1xuICAgIGlmIChvcy5yZWxlYXNlKCkudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhcIm1pY3Jvc29mdFwiKSkge1xuICAgICAgaWYgKGF3YWl0IGlzSW5zaWRlQ29udGFpbmVyKCkpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICAgIHJldHVybiBmcy5yZWFkRmlsZVN5bmMoXCIvcHJvYy92ZXJzaW9uXCIsIFwidXRmOFwiKS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKFwibWljcm9zb2Z0XCIpID8gIWF3YWl0IGlzSW5zaWRlQ29udGFpbmVyKCkgOiBmYWxzZTtcbiAgfSBjYXRjaCB7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG59XG5sZXQgaXNJbnNpZGVDb250YWluZXJDYWNoZWQ7XG5jb25zdCBoYXNDb250YWluZXJFbnYgPSBhc3luYyAoKSA9PiB7XG4gIGlmIChnZXRWZW5kb3IoKSA9PT0gXCJjbG91ZGZsYXJlXCIpIHJldHVybiBmYWxzZTtcbiAgdHJ5IHtcbiAgICBjb25zdCBmcyA9IGF3YWl0IGltcG9ydFJ1bnRpbWUoXCJmc1wiKTtcbiAgICBmcy5zdGF0U3luYyhcIi9ydW4vLmNvbnRhaW5lcmVudlwiKTtcbiAgICByZXR1cm4gdHJ1ZTtcbiAgfSBjYXRjaCB7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG59O1xuYXN5bmMgZnVuY3Rpb24gaXNJbnNpZGVDb250YWluZXIoKSB7XG4gIGlmIChpc0luc2lkZUNvbnRhaW5lckNhY2hlZCA9PT0gdm9pZCAwKSB7XG4gICAgaXNJbnNpZGVDb250YWluZXJDYWNoZWQgPSBhd2FpdCBoYXNDb250YWluZXJFbnYoKSB8fCBhd2FpdCBpc0RvY2tlcigpO1xuICB9XG4gIHJldHVybiBpc0luc2lkZUNvbnRhaW5lckNhY2hlZDtcbn1cbmZ1bmN0aW9uIGlzQ0koKSB7XG4gIHJldHVybiBlbnYuQ0kgIT09IFwiZmFsc2VcIiAmJiAoXCJCVUlMRF9JRFwiIGluIGVudiB8fCAvLyBKZW5raW5zLCBDbG91ZGJlZXNcbiAgXCJCVUlMRF9OVU1CRVJcIiBpbiBlbnYgfHwgLy8gSmVua2lucywgVGVhbUNpdHkgKGZpeGVkIHR5cG86IGV4dHJhIHNwYWNlIHJlbW92ZWQpXG4gIFwiQ0lcIiBpbiBlbnYgfHwgLy8gVHJhdmlzIENJLCBDaXJjbGVDSSwgQ2lycnVzIENJLCBHaXRsYWIgQ0ksIEFwcHZleW9yLCBDb2RlU2hpcCwgZHNhcmksIENsb3VkZmxhcmVcbiAgXCJDSV9BUFBfSURcIiBpbiBlbnYgfHwgLy8gQXBwZmxvd1xuICBcIkNJX0JVSUxEX0lEXCIgaW4gZW52IHx8IC8vIEFwcGZsb3dcbiAgXCJDSV9CVUlMRF9OVU1CRVJcIiBpbiBlbnYgfHwgLy8gQXBwZmxvd1xuICBcIkNJX05BTUVcIiBpbiBlbnYgfHwgLy8gQ29kZXNoaXAgYW5kIG90aGVyc1xuICBcIkNPTlRJTlVPVVNfSU5URUdSQVRJT05cIiBpbiBlbnYgfHwgLy8gVHJhdmlzIENJLCBDaXJydXMgQ0lcbiAgXCJSVU5fSURcIiBpbiBlbnYpO1xufVxuXG5mdW5jdGlvbiBkZXRlY3RSdW50aW1lKCkge1xuICBpZiAodHlwZW9mIERlbm8gIT09IFwidW5kZWZpbmVkXCIpIHtcbiAgICBjb25zdCBkZW5vVmVyc2lvbiA9IERlbm8/LnZlcnNpb24/LmRlbm8gPz8gbnVsbDtcbiAgICByZXR1cm4geyBuYW1lOiBcImRlbm9cIiwgdmVyc2lvbjogZGVub1ZlcnNpb24gfTtcbiAgfVxuICBpZiAodHlwZW9mIEJ1biAhPT0gXCJ1bmRlZmluZWRcIikge1xuICAgIGNvbnN0IGJ1blZlcnNpb24gPSBCdW4/LnZlcnNpb24gPz8gbnVsbDtcbiAgICByZXR1cm4geyBuYW1lOiBcImJ1blwiLCB2ZXJzaW9uOiBidW5WZXJzaW9uIH07XG4gIH1cbiAgaWYgKHR5cGVvZiBwcm9jZXNzICE9PSBcInVuZGVmaW5lZFwiICYmIHByb2Nlc3M/LnZlcnNpb25zPy5ub2RlKSB7XG4gICAgcmV0dXJuIHsgbmFtZTogXCJub2RlXCIsIHZlcnNpb246IHByb2Nlc3MudmVyc2lvbnMubm9kZSA/PyBudWxsIH07XG4gIH1cbiAgcmV0dXJuIHsgbmFtZTogXCJlZGdlXCIsIHZlcnNpb246IG51bGwgfTtcbn1cbmZ1bmN0aW9uIGRldGVjdEVudmlyb25tZW50KCkge1xuICByZXR1cm4gZ2V0RW52VmFyKFwiTk9ERV9FTlZcIikgPT09IFwicHJvZHVjdGlvblwiID8gXCJwcm9kdWN0aW9uXCIgOiBpc0NJKCkgPyBcImNpXCIgOiBpc1Rlc3QoKSA/IFwidGVzdFwiIDogXCJkZXZlbG9wbWVudFwiO1xufVxuXG5jb25zdCBEQVRBQkFTRVMgPSB7XG4gIHBnOiBcInBvc3RncmVzcWxcIixcbiAgbXlzcWw6IFwibXlzcWxcIixcbiAgbWFyaWFkYjogXCJtYXJpYWRiXCIsXG4gIHNxbGl0ZTM6IFwic3FsaXRlXCIsXG4gIFwiYmV0dGVyLXNxbGl0ZTNcIjogXCJzcWxpdGVcIixcbiAgXCJAcHJpc21hL2NsaWVudFwiOiBcInByaXNtYVwiLFxuICBtb25nb29zZTogXCJtb25nb2RiXCIsXG4gIG1vbmdvZGI6IFwibW9uZ29kYlwiLFxuICBcImRyaXp6bGUtb3JtXCI6IFwiZHJpenpsZVwiXG59O1xuYXN5bmMgZnVuY3Rpb24gZGV0ZWN0RGF0YWJhc2UoKSB7XG4gIGZvciAoY29uc3QgW3BrZywgbmFtZV0gb2YgT2JqZWN0LmVudHJpZXMoREFUQUJBU0VTKSkge1xuICAgIGNvbnN0IHZlcnNpb24gPSBhd2FpdCBnZXRQYWNrYWdlVmVyc2lvbihwa2cpO1xuICAgIGlmICh2ZXJzaW9uKSByZXR1cm4geyBuYW1lLCB2ZXJzaW9uIH07XG4gIH1cbiAgcmV0dXJuIHZvaWQgMDtcbn1cblxuY29uc3QgRlJBTUVXT1JLUyA9IHtcbiAgbmV4dDogXCJuZXh0XCIsXG4gIG51eHQ6IFwibnV4dFwiLFxuICBcIkByZW1peC1ydW4vc2VydmVyLXJ1bnRpbWVcIjogXCJyZW1peFwiLFxuICBhc3RybzogXCJhc3Ryb1wiLFxuICBcIkBzdmVsdGVqcy9raXRcIjogXCJzdmVsdGVraXRcIixcbiAgXCJzb2xpZC1zdGFydFwiOiBcInNvbGlkLXN0YXJ0XCIsXG4gIFwidGFuc3RhY2stc3RhcnRcIjogXCJ0YW5zdGFjay1zdGFydFwiLFxuICBob25vOiBcImhvbm9cIixcbiAgZXhwcmVzczogXCJleHByZXNzXCIsXG4gIGVseXNpYTogXCJlbHlzaWFcIixcbiAgZXhwbzogXCJleHBvXCJcbn07XG5hc3luYyBmdW5jdGlvbiBkZXRlY3RGcmFtZXdvcmsoKSB7XG4gIGZvciAoY29uc3QgW3BrZywgbmFtZV0gb2YgT2JqZWN0LmVudHJpZXMoRlJBTUVXT1JLUykpIHtcbiAgICBjb25zdCB2ZXJzaW9uID0gYXdhaXQgZ2V0UGFja2FnZVZlcnNpb24ocGtnKTtcbiAgICBpZiAodmVyc2lvbikgcmV0dXJuIHsgbmFtZSwgdmVyc2lvbiB9O1xuICB9XG4gIHJldHVybiB2b2lkIDA7XG59XG5cbmZ1bmN0aW9uIGRldGVjdFBhY2thZ2VNYW5hZ2VyKCkge1xuICBjb25zdCB1c2VyQWdlbnQgPSBlbnYubnBtX2NvbmZpZ191c2VyX2FnZW50O1xuICBpZiAoIXVzZXJBZ2VudCkge1xuICAgIHJldHVybiB2b2lkIDA7XG4gIH1cbiAgY29uc3QgcG1TcGVjID0gdXNlckFnZW50LnNwbGl0KFwiIFwiKVswXTtcbiAgY29uc3Qgc2VwYXJhdG9yUG9zID0gcG1TcGVjLmxhc3RJbmRleE9mKFwiL1wiKTtcbiAgY29uc3QgbmFtZSA9IHBtU3BlYy5zdWJzdHJpbmcoMCwgc2VwYXJhdG9yUG9zKTtcbiAgcmV0dXJuIHtcbiAgICBuYW1lOiBuYW1lID09PSBcIm5wbWluc3RhbGxcIiA/IFwiY25wbVwiIDogbmFtZSxcbiAgICB2ZXJzaW9uOiBwbVNwZWMuc3Vic3RyaW5nKHNlcGFyYXRvclBvcyArIDEpXG4gIH07XG59XG5cbmZ1bmN0aW9uIGdldFRlbGVtZXRyeUF1dGhDb25maWcob3B0aW9ucywgY29udGV4dCkge1xuICByZXR1cm4ge1xuICAgIGRhdGFiYXNlOiBjb250ZXh0Py5kYXRhYmFzZSxcbiAgICBhZGFwdGVyOiBjb250ZXh0Py5hZGFwdGVyLFxuICAgIGVtYWlsVmVyaWZpY2F0aW9uOiB7XG4gICAgICBzZW5kVmVyaWZpY2F0aW9uRW1haWw6ICEhb3B0aW9ucy5lbWFpbFZlcmlmaWNhdGlvbj8uc2VuZFZlcmlmaWNhdGlvbkVtYWlsLFxuICAgICAgc2VuZE9uU2lnblVwOiAhIW9wdGlvbnMuZW1haWxWZXJpZmljYXRpb24/LnNlbmRPblNpZ25VcCxcbiAgICAgIHNlbmRPblNpZ25JbjogISFvcHRpb25zLmVtYWlsVmVyaWZpY2F0aW9uPy5zZW5kT25TaWduSW4sXG4gICAgICBhdXRvU2lnbkluQWZ0ZXJWZXJpZmljYXRpb246ICEhb3B0aW9ucy5lbWFpbFZlcmlmaWNhdGlvbj8uYXV0b1NpZ25JbkFmdGVyVmVyaWZpY2F0aW9uLFxuICAgICAgZXhwaXJlc0luOiBvcHRpb25zLmVtYWlsVmVyaWZpY2F0aW9uPy5leHBpcmVzSW4sXG4gICAgICBvbkVtYWlsVmVyaWZpY2F0aW9uOiAhIW9wdGlvbnMuZW1haWxWZXJpZmljYXRpb24/Lm9uRW1haWxWZXJpZmljYXRpb24sXG4gICAgICBhZnRlckVtYWlsVmVyaWZpY2F0aW9uOiAhIW9wdGlvbnMuZW1haWxWZXJpZmljYXRpb24/LmFmdGVyRW1haWxWZXJpZmljYXRpb25cbiAgICB9LFxuICAgIGVtYWlsQW5kUGFzc3dvcmQ6IHtcbiAgICAgIGVuYWJsZWQ6ICEhb3B0aW9ucy5lbWFpbEFuZFBhc3N3b3JkPy5lbmFibGVkLFxuICAgICAgZGlzYWJsZVNpZ25VcDogISFvcHRpb25zLmVtYWlsQW5kUGFzc3dvcmQ/LmRpc2FibGVTaWduVXAsXG4gICAgICByZXF1aXJlRW1haWxWZXJpZmljYXRpb246ICEhb3B0aW9ucy5lbWFpbEFuZFBhc3N3b3JkPy5yZXF1aXJlRW1haWxWZXJpZmljYXRpb24sXG4gICAgICBtYXhQYXNzd29yZExlbmd0aDogb3B0aW9ucy5lbWFpbEFuZFBhc3N3b3JkPy5tYXhQYXNzd29yZExlbmd0aCxcbiAgICAgIG1pblBhc3N3b3JkTGVuZ3RoOiBvcHRpb25zLmVtYWlsQW5kUGFzc3dvcmQ/Lm1pblBhc3N3b3JkTGVuZ3RoLFxuICAgICAgc2VuZFJlc2V0UGFzc3dvcmQ6ICEhb3B0aW9ucy5lbWFpbEFuZFBhc3N3b3JkPy5zZW5kUmVzZXRQYXNzd29yZCxcbiAgICAgIHJlc2V0UGFzc3dvcmRUb2tlbkV4cGlyZXNJbjogb3B0aW9ucy5lbWFpbEFuZFBhc3N3b3JkPy5yZXNldFBhc3N3b3JkVG9rZW5FeHBpcmVzSW4sXG4gICAgICBvblBhc3N3b3JkUmVzZXQ6ICEhb3B0aW9ucy5lbWFpbEFuZFBhc3N3b3JkPy5vblBhc3N3b3JkUmVzZXQsXG4gICAgICBwYXNzd29yZDoge1xuICAgICAgICBoYXNoOiAhIW9wdGlvbnMuZW1haWxBbmRQYXNzd29yZD8ucGFzc3dvcmQ/Lmhhc2gsXG4gICAgICAgIHZlcmlmeTogISFvcHRpb25zLmVtYWlsQW5kUGFzc3dvcmQ/LnBhc3N3b3JkPy52ZXJpZnlcbiAgICAgIH0sXG4gICAgICBhdXRvU2lnbkluOiAhIW9wdGlvbnMuZW1haWxBbmRQYXNzd29yZD8uYXV0b1NpZ25JbixcbiAgICAgIHJldm9rZVNlc3Npb25zT25QYXNzd29yZFJlc2V0OiAhIW9wdGlvbnMuZW1haWxBbmRQYXNzd29yZD8ucmV2b2tlU2Vzc2lvbnNPblBhc3N3b3JkUmVzZXRcbiAgICB9LFxuICAgIHNvY2lhbFByb3ZpZGVyczogT2JqZWN0LmtleXMob3B0aW9ucy5zb2NpYWxQcm92aWRlcnMgfHwge30pLm1hcCgocCkgPT4ge1xuICAgICAgY29uc3QgcHJvdmlkZXIgPSBvcHRpb25zLnNvY2lhbFByb3ZpZGVycz8uW3BdO1xuICAgICAgaWYgKCFwcm92aWRlcikgcmV0dXJuIHt9O1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgaWQ6IHAsXG4gICAgICAgIG1hcFByb2ZpbGVUb1VzZXI6ICEhcHJvdmlkZXIubWFwUHJvZmlsZVRvVXNlcixcbiAgICAgICAgZGlzYWJsZURlZmF1bHRTY29wZTogISFwcm92aWRlci5kaXNhYmxlRGVmYXVsdFNjb3BlLFxuICAgICAgICBkaXNhYmxlSWRUb2tlblNpZ25JbjogISFwcm92aWRlci5kaXNhYmxlSWRUb2tlblNpZ25JbixcbiAgICAgICAgZGlzYWJsZUltcGxpY2l0U2lnblVwOiBwcm92aWRlci5kaXNhYmxlSW1wbGljaXRTaWduVXAsXG4gICAgICAgIGRpc2FibGVTaWduVXA6IHByb3ZpZGVyLmRpc2FibGVTaWduVXAsXG4gICAgICAgIGdldFVzZXJJbmZvOiAhIXByb3ZpZGVyLmdldFVzZXJJbmZvLFxuICAgICAgICBvdmVycmlkZVVzZXJJbmZvT25TaWduSW46ICEhcHJvdmlkZXIub3ZlcnJpZGVVc2VySW5mb09uU2lnbkluLFxuICAgICAgICBwcm9tcHQ6IHByb3ZpZGVyLnByb21wdCxcbiAgICAgICAgdmVyaWZ5SWRUb2tlbjogISFwcm92aWRlci52ZXJpZnlJZFRva2VuLFxuICAgICAgICBzY29wZTogcHJvdmlkZXIuc2NvcGUsXG4gICAgICAgIHJlZnJlc2hBY2Nlc3NUb2tlbjogISFwcm92aWRlci5yZWZyZXNoQWNjZXNzVG9rZW5cbiAgICAgIH07XG4gICAgfSksXG4gICAgcGx1Z2luczogb3B0aW9ucy5wbHVnaW5zPy5tYXAoKHApID0+IHAuaWQudG9TdHJpbmcoKSksXG4gICAgdXNlcjoge1xuICAgICAgbW9kZWxOYW1lOiBvcHRpb25zLnVzZXI/Lm1vZGVsTmFtZSxcbiAgICAgIGZpZWxkczogb3B0aW9ucy51c2VyPy5maWVsZHMsXG4gICAgICBhZGRpdGlvbmFsRmllbGRzOiBvcHRpb25zLnVzZXI/LmFkZGl0aW9uYWxGaWVsZHMsXG4gICAgICBjaGFuZ2VFbWFpbDoge1xuICAgICAgICBlbmFibGVkOiBvcHRpb25zLnVzZXI/LmNoYW5nZUVtYWlsPy5lbmFibGVkLFxuICAgICAgICBzZW5kQ2hhbmdlRW1haWxWZXJpZmljYXRpb246ICEhb3B0aW9ucy51c2VyPy5jaGFuZ2VFbWFpbD8uc2VuZENoYW5nZUVtYWlsVmVyaWZpY2F0aW9uXG4gICAgICB9XG4gICAgfSxcbiAgICB2ZXJpZmljYXRpb246IHtcbiAgICAgIG1vZGVsTmFtZTogb3B0aW9ucy52ZXJpZmljYXRpb24/Lm1vZGVsTmFtZSxcbiAgICAgIGRpc2FibGVDbGVhbnVwOiBvcHRpb25zLnZlcmlmaWNhdGlvbj8uZGlzYWJsZUNsZWFudXAsXG4gICAgICBmaWVsZHM6IG9wdGlvbnMudmVyaWZpY2F0aW9uPy5maWVsZHNcbiAgICB9LFxuICAgIHNlc3Npb246IHtcbiAgICAgIG1vZGVsTmFtZTogb3B0aW9ucy5zZXNzaW9uPy5tb2RlbE5hbWUsXG4gICAgICBhZGRpdGlvbmFsRmllbGRzOiBvcHRpb25zLnNlc3Npb24/LmFkZGl0aW9uYWxGaWVsZHMsXG4gICAgICBjb29raWVDYWNoZToge1xuICAgICAgICBlbmFibGVkOiBvcHRpb25zLnNlc3Npb24/LmNvb2tpZUNhY2hlPy5lbmFibGVkLFxuICAgICAgICBtYXhBZ2U6IG9wdGlvbnMuc2Vzc2lvbj8uY29va2llQ2FjaGU/Lm1heEFnZVxuICAgICAgfSxcbiAgICAgIGRpc2FibGVTZXNzaW9uUmVmcmVzaDogb3B0aW9ucy5zZXNzaW9uPy5kaXNhYmxlU2Vzc2lvblJlZnJlc2gsXG4gICAgICBleHBpcmVzSW46IG9wdGlvbnMuc2Vzc2lvbj8uZXhwaXJlc0luLFxuICAgICAgZmllbGRzOiBvcHRpb25zLnNlc3Npb24/LmZpZWxkcyxcbiAgICAgIGZyZXNoQWdlOiBvcHRpb25zLnNlc3Npb24/LmZyZXNoQWdlLFxuICAgICAgcHJlc2VydmVTZXNzaW9uSW5EYXRhYmFzZTogb3B0aW9ucy5zZXNzaW9uPy5wcmVzZXJ2ZVNlc3Npb25JbkRhdGFiYXNlLFxuICAgICAgc3RvcmVTZXNzaW9uSW5EYXRhYmFzZTogb3B0aW9ucy5zZXNzaW9uPy5zdG9yZVNlc3Npb25JbkRhdGFiYXNlLFxuICAgICAgdXBkYXRlQWdlOiBvcHRpb25zLnNlc3Npb24/LnVwZGF0ZUFnZVxuICAgIH0sXG4gICAgYWNjb3VudDoge1xuICAgICAgbW9kZWxOYW1lOiBvcHRpb25zLmFjY291bnQ/Lm1vZGVsTmFtZSxcbiAgICAgIGZpZWxkczogb3B0aW9ucy5hY2NvdW50Py5maWVsZHMsXG4gICAgICBlbmNyeXB0T0F1dGhUb2tlbnM6IG9wdGlvbnMuYWNjb3VudD8uZW5jcnlwdE9BdXRoVG9rZW5zLFxuICAgICAgdXBkYXRlQWNjb3VudE9uU2lnbkluOiBvcHRpb25zLmFjY291bnQ/LnVwZGF0ZUFjY291bnRPblNpZ25JbixcbiAgICAgIGFjY291bnRMaW5raW5nOiB7XG4gICAgICAgIGVuYWJsZWQ6IG9wdGlvbnMuYWNjb3VudD8uYWNjb3VudExpbmtpbmc/LmVuYWJsZWQsXG4gICAgICAgIHRydXN0ZWRQcm92aWRlcnM6IG9wdGlvbnMuYWNjb3VudD8uYWNjb3VudExpbmtpbmc/LnRydXN0ZWRQcm92aWRlcnMsXG4gICAgICAgIHVwZGF0ZVVzZXJJbmZvT25MaW5rOiBvcHRpb25zLmFjY291bnQ/LmFjY291bnRMaW5raW5nPy51cGRhdGVVc2VySW5mb09uTGluayxcbiAgICAgICAgYWxsb3dVbmxpbmtpbmdBbGw6IG9wdGlvbnMuYWNjb3VudD8uYWNjb3VudExpbmtpbmc/LmFsbG93VW5saW5raW5nQWxsXG4gICAgICB9XG4gICAgfSxcbiAgICBob29rczoge1xuICAgICAgYWZ0ZXI6ICEhb3B0aW9ucy5ob29rcz8uYWZ0ZXIsXG4gICAgICBiZWZvcmU6ICEhb3B0aW9ucy5ob29rcz8uYmVmb3JlXG4gICAgfSxcbiAgICBzZWNvbmRhcnlTdG9yYWdlOiAhIW9wdGlvbnMuc2Vjb25kYXJ5U3RvcmFnZSxcbiAgICBhZHZhbmNlZDoge1xuICAgICAgY29va2llUHJlZml4OiAhIW9wdGlvbnMuYWR2YW5jZWQ/LmNvb2tpZVByZWZpeCxcbiAgICAgIC8vdGhpcyBzaG91bGRuJ3QgYmUgdHJhY2tlZFxuICAgICAgY29va2llczogISFvcHRpb25zLmFkdmFuY2VkPy5jb29raWVzLFxuICAgICAgY3Jvc3NTdWJEb21haW5Db29raWVzOiB7XG4gICAgICAgIGRvbWFpbjogISFvcHRpb25zLmFkdmFuY2VkPy5jcm9zc1N1YkRvbWFpbkNvb2tpZXM/LmRvbWFpbixcbiAgICAgICAgZW5hYmxlZDogb3B0aW9ucy5hZHZhbmNlZD8uY3Jvc3NTdWJEb21haW5Db29raWVzPy5lbmFibGVkLFxuICAgICAgICBhZGRpdGlvbmFsQ29va2llczogb3B0aW9ucy5hZHZhbmNlZD8uY3Jvc3NTdWJEb21haW5Db29raWVzPy5hZGRpdGlvbmFsQ29va2llc1xuICAgICAgfSxcbiAgICAgIGRhdGFiYXNlOiB7XG4gICAgICAgIHVzZU51bWJlcklkOiAhIW9wdGlvbnMuYWR2YW5jZWQ/LmRhdGFiYXNlPy51c2VOdW1iZXJJZCxcbiAgICAgICAgZ2VuZXJhdGVJZDogb3B0aW9ucy5hZHZhbmNlZD8uZGF0YWJhc2U/LmdlbmVyYXRlSWQsXG4gICAgICAgIGRlZmF1bHRGaW5kTWFueUxpbWl0OiBvcHRpb25zLmFkdmFuY2VkPy5kYXRhYmFzZT8uZGVmYXVsdEZpbmRNYW55TGltaXRcbiAgICAgIH0sXG4gICAgICB1c2VTZWN1cmVDb29raWVzOiBvcHRpb25zLmFkdmFuY2VkPy51c2VTZWN1cmVDb29raWVzLFxuICAgICAgaXBBZGRyZXNzOiB7XG4gICAgICAgIGRpc2FibGVJcFRyYWNraW5nOiBvcHRpb25zLmFkdmFuY2VkPy5pcEFkZHJlc3M/LmRpc2FibGVJcFRyYWNraW5nLFxuICAgICAgICBpcEFkZHJlc3NIZWFkZXJzOiBvcHRpb25zLmFkdmFuY2VkPy5pcEFkZHJlc3M/LmlwQWRkcmVzc0hlYWRlcnNcbiAgICAgIH0sXG4gICAgICBkaXNhYmxlQ1NSRkNoZWNrOiBvcHRpb25zLmFkdmFuY2VkPy5kaXNhYmxlQ1NSRkNoZWNrLFxuICAgICAgY29va2llQXR0cmlidXRlczoge1xuICAgICAgICBleHBpcmVzOiBvcHRpb25zLmFkdmFuY2VkPy5kZWZhdWx0Q29va2llQXR0cmlidXRlcz8uZXhwaXJlcyxcbiAgICAgICAgc2VjdXJlOiBvcHRpb25zLmFkdmFuY2VkPy5kZWZhdWx0Q29va2llQXR0cmlidXRlcz8uc2VjdXJlLFxuICAgICAgICBzYW1lU2l0ZTogb3B0aW9ucy5hZHZhbmNlZD8uZGVmYXVsdENvb2tpZUF0dHJpYnV0ZXM/LnNhbWVTaXRlLFxuICAgICAgICBkb21haW46ICEhb3B0aW9ucy5hZHZhbmNlZD8uZGVmYXVsdENvb2tpZUF0dHJpYnV0ZXM/LmRvbWFpbixcbiAgICAgICAgcGF0aDogb3B0aW9ucy5hZHZhbmNlZD8uZGVmYXVsdENvb2tpZUF0dHJpYnV0ZXM/LnBhdGgsXG4gICAgICAgIGh0dHBPbmx5OiBvcHRpb25zLmFkdmFuY2VkPy5kZWZhdWx0Q29va2llQXR0cmlidXRlcz8uaHR0cE9ubHlcbiAgICAgIH1cbiAgICB9LFxuICAgIHRydXN0ZWRPcmlnaW5zOiBvcHRpb25zLnRydXN0ZWRPcmlnaW5zPy5sZW5ndGgsXG4gICAgcmF0ZUxpbWl0OiB7XG4gICAgICBzdG9yYWdlOiBvcHRpb25zLnJhdGVMaW1pdD8uc3RvcmFnZSxcbiAgICAgIG1vZGVsTmFtZTogb3B0aW9ucy5yYXRlTGltaXQ/Lm1vZGVsTmFtZSxcbiAgICAgIHdpbmRvdzogb3B0aW9ucy5yYXRlTGltaXQ/LndpbmRvdyxcbiAgICAgIGN1c3RvbVN0b3JhZ2U6ICEhb3B0aW9ucy5yYXRlTGltaXQ/LmN1c3RvbVN0b3JhZ2UsXG4gICAgICBlbmFibGVkOiBvcHRpb25zLnJhdGVMaW1pdD8uZW5hYmxlZCxcbiAgICAgIG1heDogb3B0aW9ucy5yYXRlTGltaXQ/Lm1heFxuICAgIH0sXG4gICAgb25BUElFcnJvcjoge1xuICAgICAgZXJyb3JVUkw6IG9wdGlvbnMub25BUElFcnJvcj8uZXJyb3JVUkwsXG4gICAgICBvbkVycm9yOiAhIW9wdGlvbnMub25BUElFcnJvcj8ub25FcnJvcixcbiAgICAgIHRocm93OiBvcHRpb25zLm9uQVBJRXJyb3I/LnRocm93XG4gICAgfSxcbiAgICBsb2dnZXI6IHtcbiAgICAgIGRpc2FibGVkOiBvcHRpb25zLmxvZ2dlcj8uZGlzYWJsZWQsXG4gICAgICBsZXZlbDogb3B0aW9ucy5sb2dnZXI/LmxldmVsLFxuICAgICAgbG9nOiAhIW9wdGlvbnMubG9nZ2VyPy5sb2dcbiAgICB9LFxuICAgIGRhdGFiYXNlSG9va3M6IHtcbiAgICAgIHVzZXI6IHtcbiAgICAgICAgY3JlYXRlOiB7XG4gICAgICAgICAgYWZ0ZXI6ICEhb3B0aW9ucy5kYXRhYmFzZUhvb2tzPy51c2VyPy5jcmVhdGU/LmFmdGVyLFxuICAgICAgICAgIGJlZm9yZTogISFvcHRpb25zLmRhdGFiYXNlSG9va3M/LnVzZXI/LmNyZWF0ZT8uYmVmb3JlXG4gICAgICAgIH0sXG4gICAgICAgIHVwZGF0ZToge1xuICAgICAgICAgIGFmdGVyOiAhIW9wdGlvbnMuZGF0YWJhc2VIb29rcz8udXNlcj8udXBkYXRlPy5hZnRlcixcbiAgICAgICAgICBiZWZvcmU6ICEhb3B0aW9ucy5kYXRhYmFzZUhvb2tzPy51c2VyPy51cGRhdGU/LmJlZm9yZVxuICAgICAgICB9XG4gICAgICB9LFxuICAgICAgc2Vzc2lvbjoge1xuICAgICAgICBjcmVhdGU6IHtcbiAgICAgICAgICBhZnRlcjogISFvcHRpb25zLmRhdGFiYXNlSG9va3M/LnNlc3Npb24/LmNyZWF0ZT8uYWZ0ZXIsXG4gICAgICAgICAgYmVmb3JlOiAhIW9wdGlvbnMuZGF0YWJhc2VIb29rcz8uc2Vzc2lvbj8uY3JlYXRlPy5iZWZvcmVcbiAgICAgICAgfSxcbiAgICAgICAgdXBkYXRlOiB7XG4gICAgICAgICAgYWZ0ZXI6ICEhb3B0aW9ucy5kYXRhYmFzZUhvb2tzPy5zZXNzaW9uPy51cGRhdGU/LmFmdGVyLFxuICAgICAgICAgIGJlZm9yZTogISFvcHRpb25zLmRhdGFiYXNlSG9va3M/LnNlc3Npb24/LnVwZGF0ZT8uYmVmb3JlXG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgICBhY2NvdW50OiB7XG4gICAgICAgIGNyZWF0ZToge1xuICAgICAgICAgIGFmdGVyOiAhIW9wdGlvbnMuZGF0YWJhc2VIb29rcz8uYWNjb3VudD8uY3JlYXRlPy5hZnRlcixcbiAgICAgICAgICBiZWZvcmU6ICEhb3B0aW9ucy5kYXRhYmFzZUhvb2tzPy5hY2NvdW50Py5jcmVhdGU/LmJlZm9yZVxuICAgICAgICB9LFxuICAgICAgICB1cGRhdGU6IHtcbiAgICAgICAgICBhZnRlcjogISFvcHRpb25zLmRhdGFiYXNlSG9va3M/LmFjY291bnQ/LnVwZGF0ZT8uYWZ0ZXIsXG4gICAgICAgICAgYmVmb3JlOiAhIW9wdGlvbnMuZGF0YWJhc2VIb29rcz8uYWNjb3VudD8udXBkYXRlPy5iZWZvcmVcbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIHZlcmlmaWNhdGlvbjoge1xuICAgICAgICBjcmVhdGU6IHtcbiAgICAgICAgICBhZnRlcjogISFvcHRpb25zLmRhdGFiYXNlSG9va3M/LnZlcmlmaWNhdGlvbj8uY3JlYXRlPy5hZnRlcixcbiAgICAgICAgICBiZWZvcmU6ICEhb3B0aW9ucy5kYXRhYmFzZUhvb2tzPy52ZXJpZmljYXRpb24/LmNyZWF0ZT8uYmVmb3JlXG4gICAgICAgIH0sXG4gICAgICAgIHVwZGF0ZToge1xuICAgICAgICAgIGFmdGVyOiAhIW9wdGlvbnMuZGF0YWJhc2VIb29rcz8udmVyaWZpY2F0aW9uPy51cGRhdGU/LmFmdGVyLFxuICAgICAgICAgIGJlZm9yZTogISFvcHRpb25zLmRhdGFiYXNlSG9va3M/LnZlcmlmaWNhdGlvbj8udXBkYXRlPy5iZWZvcmVcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfTtcbn1cblxuYXN5bmMgZnVuY3Rpb24gY3JlYXRlVGVsZW1ldHJ5KG9wdGlvbnMsIGNvbnRleHQpIHtcbiAgY29uc3QgZGVidWdFbmFibGVkID0gb3B0aW9ucy50ZWxlbWV0cnk/LmRlYnVnIHx8IGdldEJvb2xlYW5FbnZWYXIoXCJCRVRURVJfQVVUSF9URUxFTUVUUllfREVCVUdcIiwgZmFsc2UpO1xuICBjb25zdCBURUxFTUVUUllfRU5EUE9JTlQgPSBFTlYuQkVUVEVSX0FVVEhfVEVMRU1FVFJZX0VORFBPSU5UO1xuICBjb25zdCB0cmFjayA9IGFzeW5jIChldmVudCkgPT4ge1xuICAgIHRyeSB7XG4gICAgICBpZiAoY29udGV4dD8uY3VzdG9tVHJhY2spIHtcbiAgICAgICAgYXdhaXQgY29udGV4dC5jdXN0b21UcmFjayhldmVudCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBpZiAoZGVidWdFbmFibGVkKSB7XG4gICAgICAgICAgYXdhaXQgUHJvbWlzZS5yZXNvbHZlKFxuICAgICAgICAgICAgbG9nZ2VyLmluZm8oXCJ0ZWxlbWV0cnkgZXZlbnRcIiwgSlNPTi5zdHJpbmdpZnkoZXZlbnQsIG51bGwsIDIpKVxuICAgICAgICAgICk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgYXdhaXQgYmV0dGVyRmV0Y2goVEVMRU1FVFJZX0VORFBPSU5ULCB7XG4gICAgICAgICAgICBtZXRob2Q6IFwiUE9TVFwiLFxuICAgICAgICAgICAgYm9keTogZXZlbnRcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0gY2F0Y2gge1xuICAgIH1cbiAgfTtcbiAgY29uc3QgaXNFbmFibGVkID0gYXN5bmMgKCkgPT4ge1xuICAgIGNvbnN0IHRlbGVtZXRyeUVuYWJsZWQgPSBvcHRpb25zLnRlbGVtZXRyeT8uZW5hYmxlZCAhPT0gdm9pZCAwID8gb3B0aW9ucy50ZWxlbWV0cnkuZW5hYmxlZCA6IGZhbHNlO1xuICAgIGNvbnN0IGVudkVuYWJsZWQgPSBnZXRCb29sZWFuRW52VmFyKFwiQkVUVEVSX0FVVEhfVEVMRU1FVFJZXCIsIGZhbHNlKTtcbiAgICByZXR1cm4gKGVudkVuYWJsZWQgfHwgdGVsZW1ldHJ5RW5hYmxlZCkgJiYgKGNvbnRleHQ/LnNraXBUZXN0Q2hlY2sgfHwgIWlzVGVzdCgpKTtcbiAgfTtcbiAgY29uc3QgZW5hYmxlZCA9IGF3YWl0IGlzRW5hYmxlZCgpO1xuICBsZXQgYW5vbnltb3VzSWQ7XG4gIGlmIChlbmFibGVkKSB7XG4gICAgYW5vbnltb3VzSWQgPSBhd2FpdCBnZXRQcm9qZWN0SWQob3B0aW9ucy5iYXNlVVJMKTtcbiAgICBjb25zdCBwYXlsb2FkID0ge1xuICAgICAgY29uZmlnOiBnZXRUZWxlbWV0cnlBdXRoQ29uZmlnKG9wdGlvbnMpLFxuICAgICAgcnVudGltZTogZGV0ZWN0UnVudGltZSgpLFxuICAgICAgZGF0YWJhc2U6IGF3YWl0IGRldGVjdERhdGFiYXNlKCksXG4gICAgICBmcmFtZXdvcms6IGF3YWl0IGRldGVjdEZyYW1ld29yaygpLFxuICAgICAgZW52aXJvbm1lbnQ6IGRldGVjdEVudmlyb25tZW50KCksXG4gICAgICBzeXN0ZW1JbmZvOiBhd2FpdCBkZXRlY3RTeXN0ZW1JbmZvKCksXG4gICAgICBwYWNrYWdlTWFuYWdlcjogZGV0ZWN0UGFja2FnZU1hbmFnZXIoKVxuICAgIH07XG4gICAgdm9pZCB0cmFjayh7IHR5cGU6IFwiaW5pdFwiLCBwYXlsb2FkLCBhbm9ueW1vdXNJZCB9KTtcbiAgfVxuICByZXR1cm4ge1xuICAgIHB1Ymxpc2g6IGFzeW5jIChldmVudCkgPT4ge1xuICAgICAgaWYgKCFlbmFibGVkKSByZXR1cm47XG4gICAgICBpZiAoIWFub255bW91c0lkKSB7XG4gICAgICAgIGFub255bW91c0lkID0gYXdhaXQgZ2V0UHJvamVjdElkKG9wdGlvbnMuYmFzZVVSTCk7XG4gICAgICB9XG4gICAgICBhd2FpdCB0cmFjayh7XG4gICAgICAgIHR5cGU6IGV2ZW50LnR5cGUsXG4gICAgICAgIHBheWxvYWQ6IGV2ZW50LnBheWxvYWQsXG4gICAgICAgIGFub255bW91c0lkXG4gICAgICB9KTtcbiAgICB9XG4gIH07XG59XG5cbmV4cG9ydCB7IGNyZWF0ZVRlbGVtZXRyeSwgZ2V0VGVsZW1ldHJ5QXV0aENvbmZpZyB9O1xuIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6WzBdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(action-browser)/./node_modules/@better-auth/telemetry/dist/index.mjs\n");

/***/ }),

/***/ "(action-browser)/./node_modules/@better-auth/utils/dist/base64.mjs":
/*!*********************************************************!*\
  !*** ./node_modules/@better-auth/utils/dist/base64.mjs ***!
  \*********************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   base64: () => (/* binding */ base64),\n/* harmony export */   base64Url: () => (/* binding */ base64Url)\n/* harmony export */ });\nfunction getAlphabet(urlSafe) {\n  return urlSafe ? \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_\" : \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\";\n}\nfunction base64Encode(data, alphabet, padding) {\n  let result = \"\";\n  let buffer = 0;\n  let shift = 0;\n  for (const byte of data) {\n    buffer = buffer << 8 | byte;\n    shift += 8;\n    while (shift >= 6) {\n      shift -= 6;\n      result += alphabet[buffer >> shift & 63];\n    }\n  }\n  if (shift > 0) {\n    result += alphabet[buffer << 6 - shift & 63];\n  }\n  if (padding) {\n    const padCount = (4 - result.length % 4) % 4;\n    result += \"=\".repeat(padCount);\n  }\n  return result;\n}\nfunction base64Decode(data, alphabet) {\n  const decodeMap = /* @__PURE__ */ new Map();\n  for (let i = 0; i < alphabet.length; i++) {\n    decodeMap.set(alphabet[i], i);\n  }\n  const result = [];\n  let buffer = 0;\n  let bitsCollected = 0;\n  for (const char of data) {\n    if (char === \"=\")\n      break;\n    const value = decodeMap.get(char);\n    if (value === void 0) {\n      throw new Error(`Invalid Base64 character: ${char}`);\n    }\n    buffer = buffer << 6 | value;\n    bitsCollected += 6;\n    if (bitsCollected >= 8) {\n      bitsCollected -= 8;\n      result.push(buffer >> bitsCollected & 255);\n    }\n  }\n  return Uint8Array.from(result);\n}\nconst base64 = {\n  encode(data, options = {}) {\n    const alphabet = getAlphabet(false);\n    const buffer = typeof data === \"string\" ? new TextEncoder().encode(data) : new Uint8Array(data);\n    return base64Encode(buffer, alphabet, options.padding ?? true);\n  },\n  decode(data) {\n    if (typeof data !== \"string\") {\n      data = new TextDecoder().decode(data);\n    }\n    const urlSafe = data.includes(\"-\") || data.includes(\"_\");\n    const alphabet = getAlphabet(urlSafe);\n    return base64Decode(data, alphabet);\n  }\n};\nconst base64Url = {\n  encode(data, options = {}) {\n    const alphabet = getAlphabet(true);\n    const buffer = typeof data === \"string\" ? new TextEncoder().encode(data) : new Uint8Array(data);\n    return base64Encode(buffer, alphabet, options.padding ?? true);\n  },\n  decode(data) {\n    const urlSafe = data.includes(\"-\") || data.includes(\"_\");\n    const alphabet = getAlphabet(urlSafe);\n    return base64Decode(data, alphabet);\n  }\n};\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFjdGlvbi1icm93c2VyKS8uL25vZGVfbW9kdWxlcy9AYmV0dGVyLWF1dGgvdXRpbHMvZGlzdC9iYXNlNjQubWpzIiwibWFwcGluZ3MiOiI7Ozs7O0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQixxQkFBcUI7QUFDdkM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtREFBbUQsS0FBSztBQUN4RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkJBQTJCO0FBQzNCO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJCQUEyQjtBQUMzQjtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUU2QiIsInNvdXJjZXMiOlsiQzpcXFVzZXJzXFxzaWQwMVxcT25lRHJpdmVcXERlc2t0b3BcXGFtZC10ZWxlcGhvbnktc3lzdGVtXFxmcm9udGVuZFxcbm9kZV9tb2R1bGVzXFxAYmV0dGVyLWF1dGhcXHV0aWxzXFxkaXN0XFxiYXNlNjQubWpzIl0sInNvdXJjZXNDb250ZW50IjpbImZ1bmN0aW9uIGdldEFscGhhYmV0KHVybFNhZmUpIHtcbiAgcmV0dXJuIHVybFNhZmUgPyBcIkFCQ0RFRkdISUpLTE1OT1BRUlNUVVZXWFlaYWJjZGVmZ2hpamtsbW5vcHFyc3R1dnd4eXowMTIzNDU2Nzg5LV9cIiA6IFwiQUJDREVGR0hJSktMTU5PUFFSU1RVVldYWVphYmNkZWZnaGlqa2xtbm9wcXJzdHV2d3h5ejAxMjM0NTY3ODkrL1wiO1xufVxuZnVuY3Rpb24gYmFzZTY0RW5jb2RlKGRhdGEsIGFscGhhYmV0LCBwYWRkaW5nKSB7XG4gIGxldCByZXN1bHQgPSBcIlwiO1xuICBsZXQgYnVmZmVyID0gMDtcbiAgbGV0IHNoaWZ0ID0gMDtcbiAgZm9yIChjb25zdCBieXRlIG9mIGRhdGEpIHtcbiAgICBidWZmZXIgPSBidWZmZXIgPDwgOCB8IGJ5dGU7XG4gICAgc2hpZnQgKz0gODtcbiAgICB3aGlsZSAoc2hpZnQgPj0gNikge1xuICAgICAgc2hpZnQgLT0gNjtcbiAgICAgIHJlc3VsdCArPSBhbHBoYWJldFtidWZmZXIgPj4gc2hpZnQgJiA2M107XG4gICAgfVxuICB9XG4gIGlmIChzaGlmdCA+IDApIHtcbiAgICByZXN1bHQgKz0gYWxwaGFiZXRbYnVmZmVyIDw8IDYgLSBzaGlmdCAmIDYzXTtcbiAgfVxuICBpZiAocGFkZGluZykge1xuICAgIGNvbnN0IHBhZENvdW50ID0gKDQgLSByZXN1bHQubGVuZ3RoICUgNCkgJSA0O1xuICAgIHJlc3VsdCArPSBcIj1cIi5yZXBlYXQocGFkQ291bnQpO1xuICB9XG4gIHJldHVybiByZXN1bHQ7XG59XG5mdW5jdGlvbiBiYXNlNjREZWNvZGUoZGF0YSwgYWxwaGFiZXQpIHtcbiAgY29uc3QgZGVjb2RlTWFwID0gLyogQF9fUFVSRV9fICovIG5ldyBNYXAoKTtcbiAgZm9yIChsZXQgaSA9IDA7IGkgPCBhbHBoYWJldC5sZW5ndGg7IGkrKykge1xuICAgIGRlY29kZU1hcC5zZXQoYWxwaGFiZXRbaV0sIGkpO1xuICB9XG4gIGNvbnN0IHJlc3VsdCA9IFtdO1xuICBsZXQgYnVmZmVyID0gMDtcbiAgbGV0IGJpdHNDb2xsZWN0ZWQgPSAwO1xuICBmb3IgKGNvbnN0IGNoYXIgb2YgZGF0YSkge1xuICAgIGlmIChjaGFyID09PSBcIj1cIilcbiAgICAgIGJyZWFrO1xuICAgIGNvbnN0IHZhbHVlID0gZGVjb2RlTWFwLmdldChjaGFyKTtcbiAgICBpZiAodmFsdWUgPT09IHZvaWQgMCkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGBJbnZhbGlkIEJhc2U2NCBjaGFyYWN0ZXI6ICR7Y2hhcn1gKTtcbiAgICB9XG4gICAgYnVmZmVyID0gYnVmZmVyIDw8IDYgfCB2YWx1ZTtcbiAgICBiaXRzQ29sbGVjdGVkICs9IDY7XG4gICAgaWYgKGJpdHNDb2xsZWN0ZWQgPj0gOCkge1xuICAgICAgYml0c0NvbGxlY3RlZCAtPSA4O1xuICAgICAgcmVzdWx0LnB1c2goYnVmZmVyID4+IGJpdHNDb2xsZWN0ZWQgJiAyNTUpO1xuICAgIH1cbiAgfVxuICByZXR1cm4gVWludDhBcnJheS5mcm9tKHJlc3VsdCk7XG59XG5jb25zdCBiYXNlNjQgPSB7XG4gIGVuY29kZShkYXRhLCBvcHRpb25zID0ge30pIHtcbiAgICBjb25zdCBhbHBoYWJldCA9IGdldEFscGhhYmV0KGZhbHNlKTtcbiAgICBjb25zdCBidWZmZXIgPSB0eXBlb2YgZGF0YSA9PT0gXCJzdHJpbmdcIiA/IG5ldyBUZXh0RW5jb2RlcigpLmVuY29kZShkYXRhKSA6IG5ldyBVaW50OEFycmF5KGRhdGEpO1xuICAgIHJldHVybiBiYXNlNjRFbmNvZGUoYnVmZmVyLCBhbHBoYWJldCwgb3B0aW9ucy5wYWRkaW5nID8/IHRydWUpO1xuICB9LFxuICBkZWNvZGUoZGF0YSkge1xuICAgIGlmICh0eXBlb2YgZGF0YSAhPT0gXCJzdHJpbmdcIikge1xuICAgICAgZGF0YSA9IG5ldyBUZXh0RGVjb2RlcigpLmRlY29kZShkYXRhKTtcbiAgICB9XG4gICAgY29uc3QgdXJsU2FmZSA9IGRhdGEuaW5jbHVkZXMoXCItXCIpIHx8IGRhdGEuaW5jbHVkZXMoXCJfXCIpO1xuICAgIGNvbnN0IGFscGhhYmV0ID0gZ2V0QWxwaGFiZXQodXJsU2FmZSk7XG4gICAgcmV0dXJuIGJhc2U2NERlY29kZShkYXRhLCBhbHBoYWJldCk7XG4gIH1cbn07XG5jb25zdCBiYXNlNjRVcmwgPSB7XG4gIGVuY29kZShkYXRhLCBvcHRpb25zID0ge30pIHtcbiAgICBjb25zdCBhbHBoYWJldCA9IGdldEFscGhhYmV0KHRydWUpO1xuICAgIGNvbnN0IGJ1ZmZlciA9IHR5cGVvZiBkYXRhID09PSBcInN0cmluZ1wiID8gbmV3IFRleHRFbmNvZGVyKCkuZW5jb2RlKGRhdGEpIDogbmV3IFVpbnQ4QXJyYXkoZGF0YSk7XG4gICAgcmV0dXJuIGJhc2U2NEVuY29kZShidWZmZXIsIGFscGhhYmV0LCBvcHRpb25zLnBhZGRpbmcgPz8gdHJ1ZSk7XG4gIH0sXG4gIGRlY29kZShkYXRhKSB7XG4gICAgY29uc3QgdXJsU2FmZSA9IGRhdGEuaW5jbHVkZXMoXCItXCIpIHx8IGRhdGEuaW5jbHVkZXMoXCJfXCIpO1xuICAgIGNvbnN0IGFscGhhYmV0ID0gZ2V0QWxwaGFiZXQodXJsU2FmZSk7XG4gICAgcmV0dXJuIGJhc2U2NERlY29kZShkYXRhLCBhbHBoYWJldCk7XG4gIH1cbn07XG5cbmV4cG9ydCB7IGJhc2U2NCwgYmFzZTY0VXJsIH07XG4iXSwibmFtZXMiOltdLCJpZ25vcmVMaXN0IjpbMF0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(action-browser)/./node_modules/@better-auth/utils/dist/base64.mjs\n");

/***/ }),

/***/ "(action-browser)/./node_modules/@better-auth/utils/dist/binary.mjs":
/*!*********************************************************!*\
  !*** ./node_modules/@better-auth/utils/dist/binary.mjs ***!
  \*********************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   binary: () => (/* binding */ binary)\n/* harmony export */ });\nconst decoders = /* @__PURE__ */ new Map();\nconst encoder = new TextEncoder();\nconst binary = {\n  decode: (data, encoding = \"utf-8\") => {\n    if (!decoders.has(encoding)) {\n      decoders.set(encoding, new TextDecoder(encoding));\n    }\n    const decoder = decoders.get(encoding);\n    return decoder.decode(data);\n  },\n  encode: encoder.encode\n};\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFjdGlvbi1icm93c2VyKS8uL25vZGVfbW9kdWxlcy9AYmV0dGVyLWF1dGgvdXRpbHMvZGlzdC9iaW5hcnkubWpzIiwibWFwcGluZ3MiOiI7Ozs7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTs7QUFFa0IiLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcc2lkMDFcXE9uZURyaXZlXFxEZXNrdG9wXFxhbWQtdGVsZXBob255LXN5c3RlbVxcZnJvbnRlbmRcXG5vZGVfbW9kdWxlc1xcQGJldHRlci1hdXRoXFx1dGlsc1xcZGlzdFxcYmluYXJ5Lm1qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBkZWNvZGVycyA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgTWFwKCk7XG5jb25zdCBlbmNvZGVyID0gbmV3IFRleHRFbmNvZGVyKCk7XG5jb25zdCBiaW5hcnkgPSB7XG4gIGRlY29kZTogKGRhdGEsIGVuY29kaW5nID0gXCJ1dGYtOFwiKSA9PiB7XG4gICAgaWYgKCFkZWNvZGVycy5oYXMoZW5jb2RpbmcpKSB7XG4gICAgICBkZWNvZGVycy5zZXQoZW5jb2RpbmcsIG5ldyBUZXh0RGVjb2RlcihlbmNvZGluZykpO1xuICAgIH1cbiAgICBjb25zdCBkZWNvZGVyID0gZGVjb2RlcnMuZ2V0KGVuY29kaW5nKTtcbiAgICByZXR1cm4gZGVjb2Rlci5kZWNvZGUoZGF0YSk7XG4gIH0sXG4gIGVuY29kZTogZW5jb2Rlci5lbmNvZGVcbn07XG5cbmV4cG9ydCB7IGJpbmFyeSB9O1xuIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6WzBdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(action-browser)/./node_modules/@better-auth/utils/dist/binary.mjs\n");

/***/ }),

/***/ "(action-browser)/./node_modules/@better-auth/utils/dist/hash.mjs":
/*!*******************************************************!*\
  !*** ./node_modules/@better-auth/utils/dist/hash.mjs ***!
  \*******************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createHash: () => (/* binding */ createHash)\n/* harmony export */ });\n/* harmony import */ var _base64_mjs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./base64.mjs */ \"(action-browser)/./node_modules/@better-auth/utils/dist/base64.mjs\");\n/* harmony import */ var _index_mjs__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./index.mjs */ \"(action-browser)/./node_modules/@better-auth/utils/dist/index.mjs\");\n\n\n\nfunction createHash(algorithm, encoding) {\n  return {\n    digest: async (input) => {\n      const encoder = new TextEncoder();\n      const data = typeof input === \"string\" ? encoder.encode(input) : input;\n      const hashBuffer = await (0,_index_mjs__WEBPACK_IMPORTED_MODULE_1__.getWebcryptoSubtle)().digest(algorithm, data);\n      if (encoding === \"hex\") {\n        const hashArray = Array.from(new Uint8Array(hashBuffer));\n        const hashHex = hashArray.map((b) => b.toString(16).padStart(2, \"0\")).join(\"\");\n        return hashHex;\n      }\n      if (encoding === \"base64\" || encoding === \"base64url\" || encoding === \"base64urlnopad\") {\n        if (encoding.includes(\"url\")) {\n          return _base64_mjs__WEBPACK_IMPORTED_MODULE_0__.base64Url.encode(hashBuffer, {\n            padding: encoding !== \"base64urlnopad\"\n          });\n        }\n        const hashBase64 = _base64_mjs__WEBPACK_IMPORTED_MODULE_0__.base64.encode(hashBuffer);\n        return hashBase64;\n      }\n      return hashBuffer;\n    }\n  };\n}\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFjdGlvbi1icm93c2VyKS8uL25vZGVfbW9kdWxlcy9AYmV0dGVyLWF1dGgvdXRpbHMvZGlzdC9oYXNoLm1qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7QUFBaUQ7QUFDQTs7QUFFakQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLCtCQUErQiw4REFBa0I7QUFDakQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUIsa0RBQVM7QUFDMUI7QUFDQSxXQUFXO0FBQ1g7QUFDQSwyQkFBMkIsK0NBQU07QUFDakM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVzQiIsInNvdXJjZXMiOlsiQzpcXFVzZXJzXFxzaWQwMVxcT25lRHJpdmVcXERlc2t0b3BcXGFtZC10ZWxlcGhvbnktc3lzdGVtXFxmcm9udGVuZFxcbm9kZV9tb2R1bGVzXFxAYmV0dGVyLWF1dGhcXHV0aWxzXFxkaXN0XFxoYXNoLm1qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBiYXNlNjRVcmwsIGJhc2U2NCB9IGZyb20gJy4vYmFzZTY0Lm1qcyc7XG5pbXBvcnQgeyBnZXRXZWJjcnlwdG9TdWJ0bGUgfSBmcm9tICcuL2luZGV4Lm1qcyc7XG5cbmZ1bmN0aW9uIGNyZWF0ZUhhc2goYWxnb3JpdGhtLCBlbmNvZGluZykge1xuICByZXR1cm4ge1xuICAgIGRpZ2VzdDogYXN5bmMgKGlucHV0KSA9PiB7XG4gICAgICBjb25zdCBlbmNvZGVyID0gbmV3IFRleHRFbmNvZGVyKCk7XG4gICAgICBjb25zdCBkYXRhID0gdHlwZW9mIGlucHV0ID09PSBcInN0cmluZ1wiID8gZW5jb2Rlci5lbmNvZGUoaW5wdXQpIDogaW5wdXQ7XG4gICAgICBjb25zdCBoYXNoQnVmZmVyID0gYXdhaXQgZ2V0V2ViY3J5cHRvU3VidGxlKCkuZGlnZXN0KGFsZ29yaXRobSwgZGF0YSk7XG4gICAgICBpZiAoZW5jb2RpbmcgPT09IFwiaGV4XCIpIHtcbiAgICAgICAgY29uc3QgaGFzaEFycmF5ID0gQXJyYXkuZnJvbShuZXcgVWludDhBcnJheShoYXNoQnVmZmVyKSk7XG4gICAgICAgIGNvbnN0IGhhc2hIZXggPSBoYXNoQXJyYXkubWFwKChiKSA9PiBiLnRvU3RyaW5nKDE2KS5wYWRTdGFydCgyLCBcIjBcIikpLmpvaW4oXCJcIik7XG4gICAgICAgIHJldHVybiBoYXNoSGV4O1xuICAgICAgfVxuICAgICAgaWYgKGVuY29kaW5nID09PSBcImJhc2U2NFwiIHx8IGVuY29kaW5nID09PSBcImJhc2U2NHVybFwiIHx8IGVuY29kaW5nID09PSBcImJhc2U2NHVybG5vcGFkXCIpIHtcbiAgICAgICAgaWYgKGVuY29kaW5nLmluY2x1ZGVzKFwidXJsXCIpKSB7XG4gICAgICAgICAgcmV0dXJuIGJhc2U2NFVybC5lbmNvZGUoaGFzaEJ1ZmZlciwge1xuICAgICAgICAgICAgcGFkZGluZzogZW5jb2RpbmcgIT09IFwiYmFzZTY0dXJsbm9wYWRcIlxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGhhc2hCYXNlNjQgPSBiYXNlNjQuZW5jb2RlKGhhc2hCdWZmZXIpO1xuICAgICAgICByZXR1cm4gaGFzaEJhc2U2NDtcbiAgICAgIH1cbiAgICAgIHJldHVybiBoYXNoQnVmZmVyO1xuICAgIH1cbiAgfTtcbn1cblxuZXhwb3J0IHsgY3JlYXRlSGFzaCB9O1xuIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6WzBdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(action-browser)/./node_modules/@better-auth/utils/dist/hash.mjs\n");

/***/ }),

/***/ "(action-browser)/./node_modules/@better-auth/utils/dist/hex.mjs":
/*!******************************************************!*\
  !*** ./node_modules/@better-auth/utils/dist/hex.mjs ***!
  \******************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   hex: () => (/* binding */ hex)\n/* harmony export */ });\nconst hexadecimal = \"0123456789abcdef\";\nconst hex = {\n  encode: (data) => {\n    if (typeof data === \"string\") {\n      data = new TextEncoder().encode(data);\n    }\n    if (data.byteLength === 0) {\n      return \"\";\n    }\n    const buffer = new Uint8Array(data);\n    let result = \"\";\n    for (const byte of buffer) {\n      result += byte.toString(16).padStart(2, \"0\");\n    }\n    return result;\n  },\n  decode: (data) => {\n    if (!data) {\n      return \"\";\n    }\n    if (typeof data === \"string\") {\n      if (data.length % 2 !== 0) {\n        throw new Error(\"Invalid hexadecimal string\");\n      }\n      if (!new RegExp(`^[${hexadecimal}]+$`).test(data)) {\n        throw new Error(\"Invalid hexadecimal string\");\n      }\n      const result = new Uint8Array(data.length / 2);\n      for (let i = 0; i < data.length; i += 2) {\n        result[i / 2] = parseInt(data.slice(i, i + 2), 16);\n      }\n      return new TextDecoder().decode(result);\n    }\n    return new TextDecoder().decode(data);\n  }\n};\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFjdGlvbi1icm93c2VyKS8uL25vZGVfbW9kdWxlcy9AYmV0dGVyLWF1dGgvdXRpbHMvZGlzdC9oZXgubWpzIiwibWFwcGluZ3MiOiI7Ozs7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJCQUEyQixZQUFZO0FBQ3ZDO0FBQ0E7QUFDQTtBQUNBLHNCQUFzQixpQkFBaUI7QUFDdkM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRWUiLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcc2lkMDFcXE9uZURyaXZlXFxEZXNrdG9wXFxhbWQtdGVsZXBob255LXN5c3RlbVxcZnJvbnRlbmRcXG5vZGVfbW9kdWxlc1xcQGJldHRlci1hdXRoXFx1dGlsc1xcZGlzdFxcaGV4Lm1qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBoZXhhZGVjaW1hbCA9IFwiMDEyMzQ1Njc4OWFiY2RlZlwiO1xuY29uc3QgaGV4ID0ge1xuICBlbmNvZGU6IChkYXRhKSA9PiB7XG4gICAgaWYgKHR5cGVvZiBkYXRhID09PSBcInN0cmluZ1wiKSB7XG4gICAgICBkYXRhID0gbmV3IFRleHRFbmNvZGVyKCkuZW5jb2RlKGRhdGEpO1xuICAgIH1cbiAgICBpZiAoZGF0YS5ieXRlTGVuZ3RoID09PSAwKSB7XG4gICAgICByZXR1cm4gXCJcIjtcbiAgICB9XG4gICAgY29uc3QgYnVmZmVyID0gbmV3IFVpbnQ4QXJyYXkoZGF0YSk7XG4gICAgbGV0IHJlc3VsdCA9IFwiXCI7XG4gICAgZm9yIChjb25zdCBieXRlIG9mIGJ1ZmZlcikge1xuICAgICAgcmVzdWx0ICs9IGJ5dGUudG9TdHJpbmcoMTYpLnBhZFN0YXJ0KDIsIFwiMFwiKTtcbiAgICB9XG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgfSxcbiAgZGVjb2RlOiAoZGF0YSkgPT4ge1xuICAgIGlmICghZGF0YSkge1xuICAgICAgcmV0dXJuIFwiXCI7XG4gICAgfVxuICAgIGlmICh0eXBlb2YgZGF0YSA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgaWYgKGRhdGEubGVuZ3RoICUgMiAhPT0gMCkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJJbnZhbGlkIGhleGFkZWNpbWFsIHN0cmluZ1wiKTtcbiAgICAgIH1cbiAgICAgIGlmICghbmV3IFJlZ0V4cChgXlske2hleGFkZWNpbWFsfV0rJGApLnRlc3QoZGF0YSkpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiSW52YWxpZCBoZXhhZGVjaW1hbCBzdHJpbmdcIik7XG4gICAgICB9XG4gICAgICBjb25zdCByZXN1bHQgPSBuZXcgVWludDhBcnJheShkYXRhLmxlbmd0aCAvIDIpO1xuICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBkYXRhLmxlbmd0aDsgaSArPSAyKSB7XG4gICAgICAgIHJlc3VsdFtpIC8gMl0gPSBwYXJzZUludChkYXRhLnNsaWNlKGksIGkgKyAyKSwgMTYpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIG5ldyBUZXh0RGVjb2RlcigpLmRlY29kZShyZXN1bHQpO1xuICAgIH1cbiAgICByZXR1cm4gbmV3IFRleHREZWNvZGVyKCkuZGVjb2RlKGRhdGEpO1xuICB9XG59O1xuXG5leHBvcnQgeyBoZXggfTtcbiJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOlswXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(action-browser)/./node_modules/@better-auth/utils/dist/hex.mjs\n");

/***/ }),

/***/ "(action-browser)/./node_modules/@better-auth/utils/dist/hmac.mjs":
/*!*******************************************************!*\
  !*** ./node_modules/@better-auth/utils/dist/hmac.mjs ***!
  \*******************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createHMAC: () => (/* binding */ createHMAC)\n/* harmony export */ });\n/* harmony import */ var _hex_mjs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./hex.mjs */ \"(action-browser)/./node_modules/@better-auth/utils/dist/hex.mjs\");\n/* harmony import */ var _base64_mjs__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./base64.mjs */ \"(action-browser)/./node_modules/@better-auth/utils/dist/base64.mjs\");\n/* harmony import */ var _index_mjs__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./index.mjs */ \"(action-browser)/./node_modules/@better-auth/utils/dist/index.mjs\");\n\n\n\n\nconst createHMAC = (algorithm = \"SHA-256\", encoding = \"none\") => {\n  const hmac = {\n    importKey: async (key, keyUsage) => {\n      return (0,_index_mjs__WEBPACK_IMPORTED_MODULE_2__.getWebcryptoSubtle)().importKey(\n        \"raw\",\n        typeof key === \"string\" ? new TextEncoder().encode(key) : key,\n        { name: \"HMAC\", hash: { name: algorithm } },\n        false,\n        [keyUsage]\n      );\n    },\n    sign: async (hmacKey, data) => {\n      if (typeof hmacKey === \"string\") {\n        hmacKey = await hmac.importKey(hmacKey, \"sign\");\n      }\n      const signature = await (0,_index_mjs__WEBPACK_IMPORTED_MODULE_2__.getWebcryptoSubtle)().sign(\n        \"HMAC\",\n        hmacKey,\n        typeof data === \"string\" ? new TextEncoder().encode(data) : data\n      );\n      if (encoding === \"hex\") {\n        return _hex_mjs__WEBPACK_IMPORTED_MODULE_0__.hex.encode(signature);\n      }\n      if (encoding === \"base64\" || encoding === \"base64url\" || encoding === \"base64urlnopad\") {\n        return _base64_mjs__WEBPACK_IMPORTED_MODULE_1__.base64Url.encode(signature, {\n          padding: encoding !== \"base64urlnopad\"\n        });\n      }\n      return signature;\n    },\n    verify: async (hmacKey, data, signature) => {\n      if (typeof hmacKey === \"string\") {\n        hmacKey = await hmac.importKey(hmacKey, \"verify\");\n      }\n      if (encoding === \"hex\") {\n        signature = _hex_mjs__WEBPACK_IMPORTED_MODULE_0__.hex.decode(signature);\n      }\n      if (encoding === \"base64\" || encoding === \"base64url\" || encoding === \"base64urlnopad\") {\n        signature = await _base64_mjs__WEBPACK_IMPORTED_MODULE_1__.base64.decode(signature);\n      }\n      return (0,_index_mjs__WEBPACK_IMPORTED_MODULE_2__.getWebcryptoSubtle)().verify(\n        \"HMAC\",\n        hmacKey,\n        typeof signature === \"string\" ? new TextEncoder().encode(signature) : signature,\n        typeof data === \"string\" ? new TextEncoder().encode(data) : data\n      );\n    }\n  };\n  return hmac;\n};\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFjdGlvbi1icm93c2VyKS8uL25vZGVfbW9kdWxlcy9AYmV0dGVyLWF1dGgvdXRpbHMvZGlzdC9obWFjLm1qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7O0FBQWdDO0FBQ2lCO0FBQ0E7O0FBRWpEO0FBQ0E7QUFDQTtBQUNBLGFBQWEsOERBQWtCO0FBQy9CO0FBQ0E7QUFDQSxVQUFVLHNCQUFzQixtQkFBbUI7QUFDbkQ7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsOEJBQThCLDhEQUFrQjtBQUNoRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZSx5Q0FBRztBQUNsQjtBQUNBO0FBQ0EsZUFBZSxrREFBUztBQUN4QjtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQkFBb0IseUNBQUc7QUFDdkI7QUFDQTtBQUNBLDBCQUEwQiwrQ0FBTTtBQUNoQztBQUNBLGFBQWEsOERBQWtCO0FBQy9CO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFc0IiLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcc2lkMDFcXE9uZURyaXZlXFxEZXNrdG9wXFxhbWQtdGVsZXBob255LXN5c3RlbVxcZnJvbnRlbmRcXG5vZGVfbW9kdWxlc1xcQGJldHRlci1hdXRoXFx1dGlsc1xcZGlzdFxcaG1hYy5tanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgaGV4IH0gZnJvbSAnLi9oZXgubWpzJztcbmltcG9ydCB7IGJhc2U2NFVybCwgYmFzZTY0IH0gZnJvbSAnLi9iYXNlNjQubWpzJztcbmltcG9ydCB7IGdldFdlYmNyeXB0b1N1YnRsZSB9IGZyb20gJy4vaW5kZXgubWpzJztcblxuY29uc3QgY3JlYXRlSE1BQyA9IChhbGdvcml0aG0gPSBcIlNIQS0yNTZcIiwgZW5jb2RpbmcgPSBcIm5vbmVcIikgPT4ge1xuICBjb25zdCBobWFjID0ge1xuICAgIGltcG9ydEtleTogYXN5bmMgKGtleSwga2V5VXNhZ2UpID0+IHtcbiAgICAgIHJldHVybiBnZXRXZWJjcnlwdG9TdWJ0bGUoKS5pbXBvcnRLZXkoXG4gICAgICAgIFwicmF3XCIsXG4gICAgICAgIHR5cGVvZiBrZXkgPT09IFwic3RyaW5nXCIgPyBuZXcgVGV4dEVuY29kZXIoKS5lbmNvZGUoa2V5KSA6IGtleSxcbiAgICAgICAgeyBuYW1lOiBcIkhNQUNcIiwgaGFzaDogeyBuYW1lOiBhbGdvcml0aG0gfSB9LFxuICAgICAgICBmYWxzZSxcbiAgICAgICAgW2tleVVzYWdlXVxuICAgICAgKTtcbiAgICB9LFxuICAgIHNpZ246IGFzeW5jIChobWFjS2V5LCBkYXRhKSA9PiB7XG4gICAgICBpZiAodHlwZW9mIGhtYWNLZXkgPT09IFwic3RyaW5nXCIpIHtcbiAgICAgICAgaG1hY0tleSA9IGF3YWl0IGhtYWMuaW1wb3J0S2V5KGhtYWNLZXksIFwic2lnblwiKTtcbiAgICAgIH1cbiAgICAgIGNvbnN0IHNpZ25hdHVyZSA9IGF3YWl0IGdldFdlYmNyeXB0b1N1YnRsZSgpLnNpZ24oXG4gICAgICAgIFwiSE1BQ1wiLFxuICAgICAgICBobWFjS2V5LFxuICAgICAgICB0eXBlb2YgZGF0YSA9PT0gXCJzdHJpbmdcIiA/IG5ldyBUZXh0RW5jb2RlcigpLmVuY29kZShkYXRhKSA6IGRhdGFcbiAgICAgICk7XG4gICAgICBpZiAoZW5jb2RpbmcgPT09IFwiaGV4XCIpIHtcbiAgICAgICAgcmV0dXJuIGhleC5lbmNvZGUoc2lnbmF0dXJlKTtcbiAgICAgIH1cbiAgICAgIGlmIChlbmNvZGluZyA9PT0gXCJiYXNlNjRcIiB8fCBlbmNvZGluZyA9PT0gXCJiYXNlNjR1cmxcIiB8fCBlbmNvZGluZyA9PT0gXCJiYXNlNjR1cmxub3BhZFwiKSB7XG4gICAgICAgIHJldHVybiBiYXNlNjRVcmwuZW5jb2RlKHNpZ25hdHVyZSwge1xuICAgICAgICAgIHBhZGRpbmc6IGVuY29kaW5nICE9PSBcImJhc2U2NHVybG5vcGFkXCJcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgICByZXR1cm4gc2lnbmF0dXJlO1xuICAgIH0sXG4gICAgdmVyaWZ5OiBhc3luYyAoaG1hY0tleSwgZGF0YSwgc2lnbmF0dXJlKSA9PiB7XG4gICAgICBpZiAodHlwZW9mIGhtYWNLZXkgPT09IFwic3RyaW5nXCIpIHtcbiAgICAgICAgaG1hY0tleSA9IGF3YWl0IGhtYWMuaW1wb3J0S2V5KGhtYWNLZXksIFwidmVyaWZ5XCIpO1xuICAgICAgfVxuICAgICAgaWYgKGVuY29kaW5nID09PSBcImhleFwiKSB7XG4gICAgICAgIHNpZ25hdHVyZSA9IGhleC5kZWNvZGUoc2lnbmF0dXJlKTtcbiAgICAgIH1cbiAgICAgIGlmIChlbmNvZGluZyA9PT0gXCJiYXNlNjRcIiB8fCBlbmNvZGluZyA9PT0gXCJiYXNlNjR1cmxcIiB8fCBlbmNvZGluZyA9PT0gXCJiYXNlNjR1cmxub3BhZFwiKSB7XG4gICAgICAgIHNpZ25hdHVyZSA9IGF3YWl0IGJhc2U2NC5kZWNvZGUoc2lnbmF0dXJlKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBnZXRXZWJjcnlwdG9TdWJ0bGUoKS52ZXJpZnkoXG4gICAgICAgIFwiSE1BQ1wiLFxuICAgICAgICBobWFjS2V5LFxuICAgICAgICB0eXBlb2Ygc2lnbmF0dXJlID09PSBcInN0cmluZ1wiID8gbmV3IFRleHRFbmNvZGVyKCkuZW5jb2RlKHNpZ25hdHVyZSkgOiBzaWduYXR1cmUsXG4gICAgICAgIHR5cGVvZiBkYXRhID09PSBcInN0cmluZ1wiID8gbmV3IFRleHRFbmNvZGVyKCkuZW5jb2RlKGRhdGEpIDogZGF0YVxuICAgICAgKTtcbiAgICB9XG4gIH07XG4gIHJldHVybiBobWFjO1xufTtcblxuZXhwb3J0IHsgY3JlYXRlSE1BQyB9O1xuIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6WzBdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(action-browser)/./node_modules/@better-auth/utils/dist/hmac.mjs\n");

/***/ }),

/***/ "(action-browser)/./node_modules/@better-auth/utils/dist/index.mjs":
/*!********************************************************!*\
  !*** ./node_modules/@better-auth/utils/dist/index.mjs ***!
  \********************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   getWebcryptoSubtle: () => (/* binding */ getWebcryptoSubtle)\n/* harmony export */ });\nfunction getWebcryptoSubtle() {\n  const cr = typeof globalThis !== \"undefined\" && globalThis.crypto;\n  if (cr && typeof cr.subtle === \"object\" && cr.subtle != null)\n    return cr.subtle;\n  throw new Error(\"crypto.subtle must be defined\");\n}\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFjdGlvbi1icm93c2VyKS8uL25vZGVfbW9kdWxlcy9AYmV0dGVyLWF1dGgvdXRpbHMvZGlzdC9pbmRleC5tanMiLCJtYXBwaW5ncyI6Ijs7OztBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFOEIiLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcc2lkMDFcXE9uZURyaXZlXFxEZXNrdG9wXFxhbWQtdGVsZXBob255LXN5c3RlbVxcZnJvbnRlbmRcXG5vZGVfbW9kdWxlc1xcQGJldHRlci1hdXRoXFx1dGlsc1xcZGlzdFxcaW5kZXgubWpzIl0sInNvdXJjZXNDb250ZW50IjpbImZ1bmN0aW9uIGdldFdlYmNyeXB0b1N1YnRsZSgpIHtcbiAgY29uc3QgY3IgPSB0eXBlb2YgZ2xvYmFsVGhpcyAhPT0gXCJ1bmRlZmluZWRcIiAmJiBnbG9iYWxUaGlzLmNyeXB0bztcbiAgaWYgKGNyICYmIHR5cGVvZiBjci5zdWJ0bGUgPT09IFwib2JqZWN0XCIgJiYgY3Iuc3VidGxlICE9IG51bGwpXG4gICAgcmV0dXJuIGNyLnN1YnRsZTtcbiAgdGhyb3cgbmV3IEVycm9yKFwiY3J5cHRvLnN1YnRsZSBtdXN0IGJlIGRlZmluZWRcIik7XG59XG5cbmV4cG9ydCB7IGdldFdlYmNyeXB0b1N1YnRsZSB9O1xuIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6WzBdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(action-browser)/./node_modules/@better-auth/utils/dist/index.mjs\n");

/***/ }),

/***/ "(action-browser)/./node_modules/@better-auth/utils/dist/random.mjs":
/*!*********************************************************!*\
  !*** ./node_modules/@better-auth/utils/dist/random.mjs ***!
  \*********************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createRandomStringGenerator: () => (/* binding */ createRandomStringGenerator)\n/* harmony export */ });\nfunction expandAlphabet(alphabet) {\n  switch (alphabet) {\n    case \"a-z\":\n      return \"abcdefghijklmnopqrstuvwxyz\";\n    case \"A-Z\":\n      return \"ABCDEFGHIJKLMNOPQRSTUVWXYZ\";\n    case \"0-9\":\n      return \"0123456789\";\n    case \"-_\":\n      return \"-_\";\n    default:\n      throw new Error(`Unsupported alphabet: ${alphabet}`);\n  }\n}\nfunction createRandomStringGenerator(...baseAlphabets) {\n  const baseCharSet = baseAlphabets.map(expandAlphabet).join(\"\");\n  if (baseCharSet.length === 0) {\n    throw new Error(\n      \"No valid characters provided for random string generation.\"\n    );\n  }\n  const baseCharSetLength = baseCharSet.length;\n  return (length, ...alphabets) => {\n    if (length <= 0) {\n      throw new Error(\"Length must be a positive integer.\");\n    }\n    let charSet = baseCharSet;\n    let charSetLength = baseCharSetLength;\n    if (alphabets.length > 0) {\n      charSet = alphabets.map(expandAlphabet).join(\"\");\n      charSetLength = charSet.length;\n    }\n    const maxValid = Math.floor(256 / charSetLength) * charSetLength;\n    const buf = new Uint8Array(length * 2);\n    const bufLength = buf.length;\n    let result = \"\";\n    let bufIndex = bufLength;\n    let rand;\n    while (result.length < length) {\n      if (bufIndex >= bufLength) {\n        crypto.getRandomValues(buf);\n        bufIndex = 0;\n      }\n      rand = buf[bufIndex++];\n      if (rand < maxValid) {\n        result += charSet[rand % charSetLength];\n      }\n    }\n    return result;\n  };\n}\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFjdGlvbi1icm93c2VyKS8uL25vZGVfbW9kdWxlcy9AYmV0dGVyLWF1dGgvdXRpbHMvZGlzdC9yYW5kb20ubWpzIiwibWFwcGluZ3MiOiI7Ozs7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsK0NBQStDLFNBQVM7QUFDeEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUV1QyIsInNvdXJjZXMiOlsiQzpcXFVzZXJzXFxzaWQwMVxcT25lRHJpdmVcXERlc2t0b3BcXGFtZC10ZWxlcGhvbnktc3lzdGVtXFxmcm9udGVuZFxcbm9kZV9tb2R1bGVzXFxAYmV0dGVyLWF1dGhcXHV0aWxzXFxkaXN0XFxyYW5kb20ubWpzIl0sInNvdXJjZXNDb250ZW50IjpbImZ1bmN0aW9uIGV4cGFuZEFscGhhYmV0KGFscGhhYmV0KSB7XG4gIHN3aXRjaCAoYWxwaGFiZXQpIHtcbiAgICBjYXNlIFwiYS16XCI6XG4gICAgICByZXR1cm4gXCJhYmNkZWZnaGlqa2xtbm9wcXJzdHV2d3h5elwiO1xuICAgIGNhc2UgXCJBLVpcIjpcbiAgICAgIHJldHVybiBcIkFCQ0RFRkdISUpLTE1OT1BRUlNUVVZXWFlaXCI7XG4gICAgY2FzZSBcIjAtOVwiOlxuICAgICAgcmV0dXJuIFwiMDEyMzQ1Njc4OVwiO1xuICAgIGNhc2UgXCItX1wiOlxuICAgICAgcmV0dXJuIFwiLV9cIjtcbiAgICBkZWZhdWx0OlxuICAgICAgdGhyb3cgbmV3IEVycm9yKGBVbnN1cHBvcnRlZCBhbHBoYWJldDogJHthbHBoYWJldH1gKTtcbiAgfVxufVxuZnVuY3Rpb24gY3JlYXRlUmFuZG9tU3RyaW5nR2VuZXJhdG9yKC4uLmJhc2VBbHBoYWJldHMpIHtcbiAgY29uc3QgYmFzZUNoYXJTZXQgPSBiYXNlQWxwaGFiZXRzLm1hcChleHBhbmRBbHBoYWJldCkuam9pbihcIlwiKTtcbiAgaWYgKGJhc2VDaGFyU2V0Lmxlbmd0aCA9PT0gMCkge1xuICAgIHRocm93IG5ldyBFcnJvcihcbiAgICAgIFwiTm8gdmFsaWQgY2hhcmFjdGVycyBwcm92aWRlZCBmb3IgcmFuZG9tIHN0cmluZyBnZW5lcmF0aW9uLlwiXG4gICAgKTtcbiAgfVxuICBjb25zdCBiYXNlQ2hhclNldExlbmd0aCA9IGJhc2VDaGFyU2V0Lmxlbmd0aDtcbiAgcmV0dXJuIChsZW5ndGgsIC4uLmFscGhhYmV0cykgPT4ge1xuICAgIGlmIChsZW5ndGggPD0gMCkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKFwiTGVuZ3RoIG11c3QgYmUgYSBwb3NpdGl2ZSBpbnRlZ2VyLlwiKTtcbiAgICB9XG4gICAgbGV0IGNoYXJTZXQgPSBiYXNlQ2hhclNldDtcbiAgICBsZXQgY2hhclNldExlbmd0aCA9IGJhc2VDaGFyU2V0TGVuZ3RoO1xuICAgIGlmIChhbHBoYWJldHMubGVuZ3RoID4gMCkge1xuICAgICAgY2hhclNldCA9IGFscGhhYmV0cy5tYXAoZXhwYW5kQWxwaGFiZXQpLmpvaW4oXCJcIik7XG4gICAgICBjaGFyU2V0TGVuZ3RoID0gY2hhclNldC5sZW5ndGg7XG4gICAgfVxuICAgIGNvbnN0IG1heFZhbGlkID0gTWF0aC5mbG9vcigyNTYgLyBjaGFyU2V0TGVuZ3RoKSAqIGNoYXJTZXRMZW5ndGg7XG4gICAgY29uc3QgYnVmID0gbmV3IFVpbnQ4QXJyYXkobGVuZ3RoICogMik7XG4gICAgY29uc3QgYnVmTGVuZ3RoID0gYnVmLmxlbmd0aDtcbiAgICBsZXQgcmVzdWx0ID0gXCJcIjtcbiAgICBsZXQgYnVmSW5kZXggPSBidWZMZW5ndGg7XG4gICAgbGV0IHJhbmQ7XG4gICAgd2hpbGUgKHJlc3VsdC5sZW5ndGggPCBsZW5ndGgpIHtcbiAgICAgIGlmIChidWZJbmRleCA+PSBidWZMZW5ndGgpIHtcbiAgICAgICAgY3J5cHRvLmdldFJhbmRvbVZhbHVlcyhidWYpO1xuICAgICAgICBidWZJbmRleCA9IDA7XG4gICAgICB9XG4gICAgICByYW5kID0gYnVmW2J1ZkluZGV4KytdO1xuICAgICAgaWYgKHJhbmQgPCBtYXhWYWxpZCkge1xuICAgICAgICByZXN1bHQgKz0gY2hhclNldFtyYW5kICUgY2hhclNldExlbmd0aF07XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiByZXN1bHQ7XG4gIH07XG59XG5cbmV4cG9ydCB7IGNyZWF0ZVJhbmRvbVN0cmluZ0dlbmVyYXRvciB9O1xuIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6WzBdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(action-browser)/./node_modules/@better-auth/utils/dist/random.mjs\n");

/***/ }),

/***/ "(rsc)/./node_modules/@better-auth/core/dist/db/adapter/index.mjs":
/*!******************************************************************!*\
  !*** ./node_modules/@better-auth/core/dist/db/adapter/index.mjs ***!
  \******************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);



/***/ }),

/***/ "(rsc)/./node_modules/@better-auth/core/dist/db/index.mjs":
/*!**********************************************************!*\
  !*** ./node_modules/@better-auth/core/dist/db/index.mjs ***!
  \**********************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   accountSchema: () => (/* binding */ accountSchema),\n/* harmony export */   coreSchema: () => (/* binding */ coreSchema),\n/* harmony export */   rateLimitSchema: () => (/* binding */ rateLimitSchema),\n/* harmony export */   sessionSchema: () => (/* binding */ sessionSchema),\n/* harmony export */   userSchema: () => (/* binding */ userSchema),\n/* harmony export */   verificationSchema: () => (/* binding */ verificationSchema)\n/* harmony export */ });\n/* harmony import */ var zod__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! zod */ \"(rsc)/./node_modules/zod/v4/classic/external.js\");\n\n\nconst coreSchema = zod__WEBPACK_IMPORTED_MODULE_0__.object({\n  id: zod__WEBPACK_IMPORTED_MODULE_0__.string(),\n  createdAt: zod__WEBPACK_IMPORTED_MODULE_0__.date().default(() => /* @__PURE__ */ new Date()),\n  updatedAt: zod__WEBPACK_IMPORTED_MODULE_0__.date().default(() => /* @__PURE__ */ new Date())\n});\n\nconst userSchema = coreSchema.extend({\n  email: zod__WEBPACK_IMPORTED_MODULE_0__.string().transform((val) => val.toLowerCase()),\n  emailVerified: zod__WEBPACK_IMPORTED_MODULE_0__.boolean().default(false),\n  name: zod__WEBPACK_IMPORTED_MODULE_0__.string(),\n  image: zod__WEBPACK_IMPORTED_MODULE_0__.string().nullish()\n});\n\nconst accountSchema = coreSchema.extend({\n  providerId: zod__WEBPACK_IMPORTED_MODULE_0__.string(),\n  accountId: zod__WEBPACK_IMPORTED_MODULE_0__.string(),\n  userId: zod__WEBPACK_IMPORTED_MODULE_0__.coerce.string(),\n  accessToken: zod__WEBPACK_IMPORTED_MODULE_0__.string().nullish(),\n  refreshToken: zod__WEBPACK_IMPORTED_MODULE_0__.string().nullish(),\n  idToken: zod__WEBPACK_IMPORTED_MODULE_0__.string().nullish(),\n  /**\n   * Access token expires at\n   */\n  accessTokenExpiresAt: zod__WEBPACK_IMPORTED_MODULE_0__.date().nullish(),\n  /**\n   * Refresh token expires at\n   */\n  refreshTokenExpiresAt: zod__WEBPACK_IMPORTED_MODULE_0__.date().nullish(),\n  /**\n   * The scopes that the user has authorized\n   */\n  scope: zod__WEBPACK_IMPORTED_MODULE_0__.string().nullish(),\n  /**\n   * Password is only stored in the credential provider\n   */\n  password: zod__WEBPACK_IMPORTED_MODULE_0__.string().nullish()\n});\n\nconst sessionSchema = coreSchema.extend({\n  userId: zod__WEBPACK_IMPORTED_MODULE_0__.coerce.string(),\n  expiresAt: zod__WEBPACK_IMPORTED_MODULE_0__.date(),\n  token: zod__WEBPACK_IMPORTED_MODULE_0__.string(),\n  ipAddress: zod__WEBPACK_IMPORTED_MODULE_0__.string().nullish(),\n  userAgent: zod__WEBPACK_IMPORTED_MODULE_0__.string().nullish()\n});\n\nconst verificationSchema = coreSchema.extend({\n  value: zod__WEBPACK_IMPORTED_MODULE_0__.string(),\n  expiresAt: zod__WEBPACK_IMPORTED_MODULE_0__.date(),\n  identifier: zod__WEBPACK_IMPORTED_MODULE_0__.string()\n});\n\nconst rateLimitSchema = zod__WEBPACK_IMPORTED_MODULE_0__.object({\n  /**\n   * The key to use for rate limiting\n   */\n  key: zod__WEBPACK_IMPORTED_MODULE_0__.string(),\n  /**\n   * The number of requests made\n   */\n  count: zod__WEBPACK_IMPORTED_MODULE_0__.number(),\n  /**\n   * The last request time in milliseconds\n   */\n  lastRequest: zod__WEBPACK_IMPORTED_MODULE_0__.number()\n});\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvQGJldHRlci1hdXRoL2NvcmUvZGlzdC9kYi9pbmRleC5tanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7OztBQUF5Qjs7QUFFekIsbUJBQW1CLHVDQUFRO0FBQzNCLE1BQU0sdUNBQVE7QUFDZCxhQUFhLHFDQUFNO0FBQ25CLGFBQWEscUNBQU07QUFDbkIsQ0FBQzs7QUFFRDtBQUNBLFNBQVMsdUNBQVE7QUFDakIsaUJBQWlCLHdDQUFTO0FBQzFCLFFBQVEsdUNBQVE7QUFDaEIsU0FBUyx1Q0FBUTtBQUNqQixDQUFDOztBQUVEO0FBQ0EsY0FBYyx1Q0FBUTtBQUN0QixhQUFhLHVDQUFRO0FBQ3JCLFVBQVUsOENBQWU7QUFDekIsZUFBZSx1Q0FBUTtBQUN2QixnQkFBZ0IsdUNBQVE7QUFDeEIsV0FBVyx1Q0FBUTtBQUNuQjtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IscUNBQU07QUFDOUI7QUFDQTtBQUNBO0FBQ0EseUJBQXlCLHFDQUFNO0FBQy9CO0FBQ0E7QUFDQTtBQUNBLFNBQVMsdUNBQVE7QUFDakI7QUFDQTtBQUNBO0FBQ0EsWUFBWSx1Q0FBUTtBQUNwQixDQUFDOztBQUVEO0FBQ0EsVUFBVSw4Q0FBZTtBQUN6QixhQUFhLHFDQUFNO0FBQ25CLFNBQVMsdUNBQVE7QUFDakIsYUFBYSx1Q0FBUTtBQUNyQixhQUFhLHVDQUFRO0FBQ3JCLENBQUM7O0FBRUQ7QUFDQSxTQUFTLHVDQUFRO0FBQ2pCLGFBQWEscUNBQU07QUFDbkIsY0FBYyx1Q0FBUTtBQUN0QixDQUFDOztBQUVELHdCQUF3Qix1Q0FBUTtBQUNoQztBQUNBO0FBQ0E7QUFDQSxPQUFPLHVDQUFRO0FBQ2Y7QUFDQTtBQUNBO0FBQ0EsU0FBUyx1Q0FBUTtBQUNqQjtBQUNBO0FBQ0E7QUFDQSxlQUFlLHVDQUFRO0FBQ3ZCLENBQUM7O0FBRW9HIiwic291cmNlcyI6WyJDOlxcVXNlcnNcXHNpZDAxXFxPbmVEcml2ZVxcRGVza3RvcFxcYW1kLXRlbGVwaG9ueS1zeXN0ZW1cXGZyb250ZW5kXFxub2RlX21vZHVsZXNcXEBiZXR0ZXItYXV0aFxcY29yZVxcZGlzdFxcZGJcXGluZGV4Lm1qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgKiBhcyB6IGZyb20gJ3pvZCc7XG5cbmNvbnN0IGNvcmVTY2hlbWEgPSB6Lm9iamVjdCh7XG4gIGlkOiB6LnN0cmluZygpLFxuICBjcmVhdGVkQXQ6IHouZGF0ZSgpLmRlZmF1bHQoKCkgPT4gLyogQF9fUFVSRV9fICovIG5ldyBEYXRlKCkpLFxuICB1cGRhdGVkQXQ6IHouZGF0ZSgpLmRlZmF1bHQoKCkgPT4gLyogQF9fUFVSRV9fICovIG5ldyBEYXRlKCkpXG59KTtcblxuY29uc3QgdXNlclNjaGVtYSA9IGNvcmVTY2hlbWEuZXh0ZW5kKHtcbiAgZW1haWw6IHouc3RyaW5nKCkudHJhbnNmb3JtKCh2YWwpID0+IHZhbC50b0xvd2VyQ2FzZSgpKSxcbiAgZW1haWxWZXJpZmllZDogei5ib29sZWFuKCkuZGVmYXVsdChmYWxzZSksXG4gIG5hbWU6IHouc3RyaW5nKCksXG4gIGltYWdlOiB6LnN0cmluZygpLm51bGxpc2goKVxufSk7XG5cbmNvbnN0IGFjY291bnRTY2hlbWEgPSBjb3JlU2NoZW1hLmV4dGVuZCh7XG4gIHByb3ZpZGVySWQ6IHouc3RyaW5nKCksXG4gIGFjY291bnRJZDogei5zdHJpbmcoKSxcbiAgdXNlcklkOiB6LmNvZXJjZS5zdHJpbmcoKSxcbiAgYWNjZXNzVG9rZW46IHouc3RyaW5nKCkubnVsbGlzaCgpLFxuICByZWZyZXNoVG9rZW46IHouc3RyaW5nKCkubnVsbGlzaCgpLFxuICBpZFRva2VuOiB6LnN0cmluZygpLm51bGxpc2goKSxcbiAgLyoqXG4gICAqIEFjY2VzcyB0b2tlbiBleHBpcmVzIGF0XG4gICAqL1xuICBhY2Nlc3NUb2tlbkV4cGlyZXNBdDogei5kYXRlKCkubnVsbGlzaCgpLFxuICAvKipcbiAgICogUmVmcmVzaCB0b2tlbiBleHBpcmVzIGF0XG4gICAqL1xuICByZWZyZXNoVG9rZW5FeHBpcmVzQXQ6IHouZGF0ZSgpLm51bGxpc2goKSxcbiAgLyoqXG4gICAqIFRoZSBzY29wZXMgdGhhdCB0aGUgdXNlciBoYXMgYXV0aG9yaXplZFxuICAgKi9cbiAgc2NvcGU6IHouc3RyaW5nKCkubnVsbGlzaCgpLFxuICAvKipcbiAgICogUGFzc3dvcmQgaXMgb25seSBzdG9yZWQgaW4gdGhlIGNyZWRlbnRpYWwgcHJvdmlkZXJcbiAgICovXG4gIHBhc3N3b3JkOiB6LnN0cmluZygpLm51bGxpc2goKVxufSk7XG5cbmNvbnN0IHNlc3Npb25TY2hlbWEgPSBjb3JlU2NoZW1hLmV4dGVuZCh7XG4gIHVzZXJJZDogei5jb2VyY2Uuc3RyaW5nKCksXG4gIGV4cGlyZXNBdDogei5kYXRlKCksXG4gIHRva2VuOiB6LnN0cmluZygpLFxuICBpcEFkZHJlc3M6IHouc3RyaW5nKCkubnVsbGlzaCgpLFxuICB1c2VyQWdlbnQ6IHouc3RyaW5nKCkubnVsbGlzaCgpXG59KTtcblxuY29uc3QgdmVyaWZpY2F0aW9uU2NoZW1hID0gY29yZVNjaGVtYS5leHRlbmQoe1xuICB2YWx1ZTogei5zdHJpbmcoKSxcbiAgZXhwaXJlc0F0OiB6LmRhdGUoKSxcbiAgaWRlbnRpZmllcjogei5zdHJpbmcoKVxufSk7XG5cbmNvbnN0IHJhdGVMaW1pdFNjaGVtYSA9IHoub2JqZWN0KHtcbiAgLyoqXG4gICAqIFRoZSBrZXkgdG8gdXNlIGZvciByYXRlIGxpbWl0aW5nXG4gICAqL1xuICBrZXk6IHouc3RyaW5nKCksXG4gIC8qKlxuICAgKiBUaGUgbnVtYmVyIG9mIHJlcXVlc3RzIG1hZGVcbiAgICovXG4gIGNvdW50OiB6Lm51bWJlcigpLFxuICAvKipcbiAgICogVGhlIGxhc3QgcmVxdWVzdCB0aW1lIGluIG1pbGxpc2Vjb25kc1xuICAgKi9cbiAgbGFzdFJlcXVlc3Q6IHoubnVtYmVyKClcbn0pO1xuXG5leHBvcnQgeyBhY2NvdW50U2NoZW1hLCBjb3JlU2NoZW1hLCByYXRlTGltaXRTY2hlbWEsIHNlc3Npb25TY2hlbWEsIHVzZXJTY2hlbWEsIHZlcmlmaWNhdGlvblNjaGVtYSB9O1xuIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6WzBdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/@better-auth/core/dist/db/index.mjs\n");

/***/ }),

/***/ "(rsc)/./node_modules/@better-auth/core/dist/env/index.mjs":
/*!***********************************************************!*\
  !*** ./node_modules/@better-auth/core/dist/env/index.mjs ***!
  \***********************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   ENV: () => (/* binding */ ENV),\n/* harmony export */   TTY_COLORS: () => (/* binding */ TTY_COLORS),\n/* harmony export */   createLogger: () => (/* binding */ createLogger),\n/* harmony export */   env: () => (/* binding */ env),\n/* harmony export */   getBooleanEnvVar: () => (/* binding */ getBooleanEnvVar),\n/* harmony export */   getColorDepth: () => (/* binding */ getColorDepth),\n/* harmony export */   getEnvVar: () => (/* binding */ getEnvVar),\n/* harmony export */   isDevelopment: () => (/* binding */ isDevelopment),\n/* harmony export */   isProduction: () => (/* binding */ isProduction),\n/* harmony export */   isTest: () => (/* binding */ isTest),\n/* harmony export */   levels: () => (/* binding */ levels),\n/* harmony export */   logger: () => (/* binding */ logger),\n/* harmony export */   nodeENV: () => (/* binding */ nodeENV),\n/* harmony export */   shouldPublishLog: () => (/* binding */ shouldPublishLog)\n/* harmony export */ });\nconst _envShim = /* @__PURE__ */ Object.create(null);\nconst _getEnv = (useShim) => globalThis.process?.env || //@ts-expect-error\nglobalThis.Deno?.env.toObject() || //@ts-expect-error\nglobalThis.__env__ || (useShim ? _envShim : globalThis);\nconst env = new Proxy(_envShim, {\n  get(_, prop) {\n    const env2 = _getEnv();\n    return env2[prop] ?? _envShim[prop];\n  },\n  has(_, prop) {\n    const env2 = _getEnv();\n    return prop in env2 || prop in _envShim;\n  },\n  set(_, prop, value) {\n    const env2 = _getEnv(true);\n    env2[prop] = value;\n    return true;\n  },\n  deleteProperty(_, prop) {\n    if (!prop) {\n      return false;\n    }\n    const env2 = _getEnv(true);\n    delete env2[prop];\n    return true;\n  },\n  ownKeys() {\n    const env2 = _getEnv(true);\n    return Object.keys(env2);\n  }\n});\nfunction toBoolean(val) {\n  return val ? val !== \"false\" : false;\n}\nconst nodeENV = typeof process !== \"undefined\" && process.env && \"development\" || \"\";\nconst isProduction = nodeENV === \"production\";\nconst isDevelopment = () => nodeENV === \"dev\" || nodeENV === \"development\";\nconst isTest = () => nodeENV === \"test\" || toBoolean(env.TEST);\nfunction getEnvVar(key, fallback) {\n  if (typeof process !== \"undefined\" && process.env) {\n    return process.env[key] ?? fallback;\n  }\n  if (typeof Deno !== \"undefined\") {\n    return Deno.env.get(key) ?? fallback;\n  }\n  if (typeof Bun !== \"undefined\") {\n    return Bun.env[key] ?? fallback;\n  }\n  return fallback;\n}\nfunction getBooleanEnvVar(key, fallback = true) {\n  const value = getEnvVar(key);\n  if (!value) return fallback;\n  return value !== \"0\" && value.toLowerCase() !== \"false\" && value !== \"\";\n}\nconst ENV = Object.freeze({\n  get BETTER_AUTH_SECRET() {\n    return getEnvVar(\"BETTER_AUTH_SECRET\");\n  },\n  get AUTH_SECRET() {\n    return getEnvVar(\"AUTH_SECRET\");\n  },\n  get BETTER_AUTH_TELEMETRY() {\n    return getEnvVar(\"BETTER_AUTH_TELEMETRY\");\n  },\n  get BETTER_AUTH_TELEMETRY_ID() {\n    return getEnvVar(\"BETTER_AUTH_TELEMETRY_ID\");\n  },\n  get NODE_ENV() {\n    return getEnvVar(\"NODE_ENV\", \"development\");\n  },\n  get PACKAGE_VERSION() {\n    return getEnvVar(\"PACKAGE_VERSION\", \"0.0.0\");\n  },\n  get BETTER_AUTH_TELEMETRY_ENDPOINT() {\n    return getEnvVar(\n      \"BETTER_AUTH_TELEMETRY_ENDPOINT\",\n      \"https://telemetry.better-auth.com/v1/track\"\n    );\n  }\n});\n\nconst COLORS_2 = 1;\nconst COLORS_16 = 4;\nconst COLORS_256 = 8;\nconst COLORS_16m = 24;\nconst TERM_ENVS = {\n  eterm: COLORS_16,\n  cons25: COLORS_16,\n  console: COLORS_16,\n  cygwin: COLORS_16,\n  dtterm: COLORS_16,\n  gnome: COLORS_16,\n  hurd: COLORS_16,\n  jfbterm: COLORS_16,\n  konsole: COLORS_16,\n  kterm: COLORS_16,\n  mlterm: COLORS_16,\n  mosh: COLORS_16m,\n  putty: COLORS_16,\n  st: COLORS_16,\n  // http://lists.schmorp.de/pipermail/rxvt-unicode/2016q2/002261.html\n  \"rxvt-unicode-24bit\": COLORS_16m,\n  // https://bugs.launchpad.net/terminator/+bug/1030562\n  terminator: COLORS_16m,\n  \"xterm-kitty\": COLORS_16m\n};\nconst CI_ENVS_MAP = new Map(\n  Object.entries({\n    APPVEYOR: COLORS_256,\n    BUILDKITE: COLORS_256,\n    CIRCLECI: COLORS_16m,\n    DRONE: COLORS_256,\n    GITEA_ACTIONS: COLORS_16m,\n    GITHUB_ACTIONS: COLORS_16m,\n    GITLAB_CI: COLORS_256,\n    TRAVIS: COLORS_256\n  })\n);\nconst TERM_ENVS_REG_EXP = [\n  /ansi/,\n  /color/,\n  /linux/,\n  /direct/,\n  /^con[0-9]*x[0-9]/,\n  /^rxvt/,\n  /^screen/,\n  /^xterm/,\n  /^vt100/,\n  /^vt220/\n];\nfunction getColorDepth() {\n  if (getEnvVar(\"FORCE_COLOR\") !== void 0) {\n    switch (getEnvVar(\"FORCE_COLOR\")) {\n      case \"\":\n      case \"1\":\n      case \"true\":\n        return COLORS_16;\n      case \"2\":\n        return COLORS_256;\n      case \"3\":\n        return COLORS_16m;\n      default:\n        return COLORS_2;\n    }\n  }\n  if (getEnvVar(\"NODE_DISABLE_COLORS\") !== void 0 && getEnvVar(\"NODE_DISABLE_COLORS\") !== \"\" || // See https://no-color.org/\n  getEnvVar(\"NO_COLOR\") !== void 0 && getEnvVar(\"NO_COLOR\") !== \"\" || // The \"dumb\" special terminal, as defined by terminfo, doesn't support\n  // ANSI color control codes.\n  // See https://invisible-island.net/ncurses/terminfo.ti.html#toc-_Specials\n  getEnvVar(\"TERM\") === \"dumb\") {\n    return COLORS_2;\n  }\n  if (getEnvVar(\"TMUX\")) {\n    return COLORS_16m;\n  }\n  if (\"TF_BUILD\" in env && \"AGENT_NAME\" in env) {\n    return COLORS_16;\n  }\n  if (\"CI\" in env) {\n    for (const { 0: envName, 1: colors } of CI_ENVS_MAP) {\n      if (envName in env) {\n        return colors;\n      }\n    }\n    if (getEnvVar(\"CI_NAME\") === \"codeship\") {\n      return COLORS_256;\n    }\n    return COLORS_2;\n  }\n  if (\"TEAMCITY_VERSION\" in env) {\n    return /^(9\\.(0*[1-9]\\d*)\\.|\\d{2,}\\.)/.exec(\n      getEnvVar(\"TEAMCITY_VERSION\")\n    ) !== null ? COLORS_16 : COLORS_2;\n  }\n  switch (getEnvVar(\"TERM_PROGRAM\")) {\n    case \"iTerm.app\":\n      if (!getEnvVar(\"TERM_PROGRAM_VERSION\") || /^[0-2]\\./.exec(getEnvVar(\"TERM_PROGRAM_VERSION\")) !== null) {\n        return COLORS_256;\n      }\n      return COLORS_16m;\n    case \"HyperTerm\":\n    case \"MacTerm\":\n      return COLORS_16m;\n    case \"Apple_Terminal\":\n      return COLORS_256;\n  }\n  if (getEnvVar(\"COLORTERM\") === \"truecolor\" || getEnvVar(\"COLORTERM\") === \"24bit\") {\n    return COLORS_16m;\n  }\n  if (getEnvVar(\"TERM\")) {\n    if (/truecolor/.exec(getEnvVar(\"TERM\")) !== null) {\n      return COLORS_16m;\n    }\n    if (/^xterm-256/.exec(getEnvVar(\"TERM\")) !== null) {\n      return COLORS_256;\n    }\n    const termEnv = getEnvVar(\"TERM\").toLowerCase();\n    if (TERM_ENVS[termEnv]) {\n      return TERM_ENVS[termEnv];\n    }\n    if (TERM_ENVS_REG_EXP.some((term) => term.exec(termEnv) !== null)) {\n      return COLORS_16;\n    }\n  }\n  if (getEnvVar(\"COLORTERM\")) {\n    return COLORS_16;\n  }\n  return COLORS_2;\n}\n\nconst TTY_COLORS = {\n  reset: \"\\x1B[0m\",\n  bright: \"\\x1B[1m\",\n  dim: \"\\x1B[2m\",\n  undim: \"\\x1B[22m\",\n  underscore: \"\\x1B[4m\",\n  blink: \"\\x1B[5m\",\n  reverse: \"\\x1B[7m\",\n  hidden: \"\\x1B[8m\",\n  fg: {\n    black: \"\\x1B[30m\",\n    red: \"\\x1B[31m\",\n    green: \"\\x1B[32m\",\n    yellow: \"\\x1B[33m\",\n    blue: \"\\x1B[34m\",\n    magenta: \"\\x1B[35m\",\n    cyan: \"\\x1B[36m\",\n    white: \"\\x1B[37m\"\n  },\n  bg: {\n    black: \"\\x1B[40m\",\n    red: \"\\x1B[41m\",\n    green: \"\\x1B[42m\",\n    yellow: \"\\x1B[43m\",\n    blue: \"\\x1B[44m\",\n    magenta: \"\\x1B[45m\",\n    cyan: \"\\x1B[46m\",\n    white: \"\\x1B[47m\"\n  }\n};\nconst levels = [\"info\", \"success\", \"warn\", \"error\", \"debug\"];\nfunction shouldPublishLog(currentLogLevel, logLevel) {\n  return levels.indexOf(logLevel) <= levels.indexOf(currentLogLevel);\n}\nconst levelColors = {\n  info: TTY_COLORS.fg.blue,\n  success: TTY_COLORS.fg.green,\n  warn: TTY_COLORS.fg.yellow,\n  error: TTY_COLORS.fg.red,\n  debug: TTY_COLORS.fg.magenta\n};\nconst formatMessage = (level, message, colorsEnabled) => {\n  const timestamp = (/* @__PURE__ */ new Date()).toISOString();\n  if (colorsEnabled) {\n    return `${TTY_COLORS.dim}${timestamp}${TTY_COLORS.reset} ${levelColors[level]}${level.toUpperCase()}${TTY_COLORS.reset} ${TTY_COLORS.bright}[Better Auth]:${TTY_COLORS.reset} ${message}`;\n  }\n  return `${timestamp} ${level.toUpperCase()} [Better Auth]: ${message}`;\n};\nconst createLogger = (options) => {\n  const enabled = options?.disabled !== true;\n  const logLevel = options?.level ?? \"error\";\n  const isDisableColorsSpecified = options?.disableColors !== void 0;\n  const colorsEnabled = isDisableColorsSpecified ? !options.disableColors : getColorDepth() !== 1;\n  const LogFunc = (level, message, args = []) => {\n    if (!enabled || !shouldPublishLog(logLevel, level)) {\n      return;\n    }\n    const formattedMessage = formatMessage(level, message, colorsEnabled);\n    if (!options || typeof options.log !== \"function\") {\n      if (level === \"error\") {\n        console.error(formattedMessage, ...args);\n      } else if (level === \"warn\") {\n        console.warn(formattedMessage, ...args);\n      } else {\n        console.log(formattedMessage, ...args);\n      }\n      return;\n    }\n    options.log(level === \"success\" ? \"info\" : level, message, ...args);\n  };\n  const logger2 = Object.fromEntries(\n    levels.map((level) => [\n      level,\n      (...[message, ...args]) => LogFunc(level, message, args)\n    ])\n  );\n  return {\n    ...logger2,\n    get level() {\n      return logLevel;\n    }\n  };\n};\nconst logger = createLogger();\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvQGJldHRlci1hdXRoL2NvcmUvZGlzdC9lbnYvaW5kZXgubWpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0EsaUVBQWlFLGFBQW9CO0FBQ3JGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7O0FBRUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUIsd0JBQXdCO0FBQ3pDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbUNBQW1DLEdBQUc7QUFDdEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxjQUFjLGVBQWUsRUFBRSxVQUFVLEVBQUUsa0JBQWtCLEVBQUUsbUJBQW1CLEVBQUUsb0JBQW9CLEVBQUUsa0JBQWtCLEVBQUUsa0JBQWtCLGdCQUFnQixrQkFBa0IsRUFBRSxRQUFRO0FBQzVMO0FBQ0EsWUFBWSxXQUFXLEVBQUUscUJBQXFCLGlCQUFpQixRQUFRO0FBQ3ZFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFRO0FBQ1I7QUFDQSxRQUFRO0FBQ1I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFMEsiLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcc2lkMDFcXE9uZURyaXZlXFxEZXNrdG9wXFxhbWQtdGVsZXBob255LXN5c3RlbVxcZnJvbnRlbmRcXG5vZGVfbW9kdWxlc1xcQGJldHRlci1hdXRoXFxjb3JlXFxkaXN0XFxlbnZcXGluZGV4Lm1qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBfZW52U2hpbSA9IC8qIEBfX1BVUkVfXyAqLyBPYmplY3QuY3JlYXRlKG51bGwpO1xuY29uc3QgX2dldEVudiA9ICh1c2VTaGltKSA9PiBnbG9iYWxUaGlzLnByb2Nlc3M/LmVudiB8fCAvL0B0cy1leHBlY3QtZXJyb3Jcbmdsb2JhbFRoaXMuRGVubz8uZW52LnRvT2JqZWN0KCkgfHwgLy9AdHMtZXhwZWN0LWVycm9yXG5nbG9iYWxUaGlzLl9fZW52X18gfHwgKHVzZVNoaW0gPyBfZW52U2hpbSA6IGdsb2JhbFRoaXMpO1xuY29uc3QgZW52ID0gbmV3IFByb3h5KF9lbnZTaGltLCB7XG4gIGdldChfLCBwcm9wKSB7XG4gICAgY29uc3QgZW52MiA9IF9nZXRFbnYoKTtcbiAgICByZXR1cm4gZW52Mltwcm9wXSA/PyBfZW52U2hpbVtwcm9wXTtcbiAgfSxcbiAgaGFzKF8sIHByb3ApIHtcbiAgICBjb25zdCBlbnYyID0gX2dldEVudigpO1xuICAgIHJldHVybiBwcm9wIGluIGVudjIgfHwgcHJvcCBpbiBfZW52U2hpbTtcbiAgfSxcbiAgc2V0KF8sIHByb3AsIHZhbHVlKSB7XG4gICAgY29uc3QgZW52MiA9IF9nZXRFbnYodHJ1ZSk7XG4gICAgZW52Mltwcm9wXSA9IHZhbHVlO1xuICAgIHJldHVybiB0cnVlO1xuICB9LFxuICBkZWxldGVQcm9wZXJ0eShfLCBwcm9wKSB7XG4gICAgaWYgKCFwcm9wKSB7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIGNvbnN0IGVudjIgPSBfZ2V0RW52KHRydWUpO1xuICAgIGRlbGV0ZSBlbnYyW3Byb3BdO1xuICAgIHJldHVybiB0cnVlO1xuICB9LFxuICBvd25LZXlzKCkge1xuICAgIGNvbnN0IGVudjIgPSBfZ2V0RW52KHRydWUpO1xuICAgIHJldHVybiBPYmplY3Qua2V5cyhlbnYyKTtcbiAgfVxufSk7XG5mdW5jdGlvbiB0b0Jvb2xlYW4odmFsKSB7XG4gIHJldHVybiB2YWwgPyB2YWwgIT09IFwiZmFsc2VcIiA6IGZhbHNlO1xufVxuY29uc3Qgbm9kZUVOViA9IHR5cGVvZiBwcm9jZXNzICE9PSBcInVuZGVmaW5lZFwiICYmIHByb2Nlc3MuZW52ICYmIHByb2Nlc3MuZW52Lk5PREVfRU5WIHx8IFwiXCI7XG5jb25zdCBpc1Byb2R1Y3Rpb24gPSBub2RlRU5WID09PSBcInByb2R1Y3Rpb25cIjtcbmNvbnN0IGlzRGV2ZWxvcG1lbnQgPSAoKSA9PiBub2RlRU5WID09PSBcImRldlwiIHx8IG5vZGVFTlYgPT09IFwiZGV2ZWxvcG1lbnRcIjtcbmNvbnN0IGlzVGVzdCA9ICgpID0+IG5vZGVFTlYgPT09IFwidGVzdFwiIHx8IHRvQm9vbGVhbihlbnYuVEVTVCk7XG5mdW5jdGlvbiBnZXRFbnZWYXIoa2V5LCBmYWxsYmFjaykge1xuICBpZiAodHlwZW9mIHByb2Nlc3MgIT09IFwidW5kZWZpbmVkXCIgJiYgcHJvY2Vzcy5lbnYpIHtcbiAgICByZXR1cm4gcHJvY2Vzcy5lbnZba2V5XSA/PyBmYWxsYmFjaztcbiAgfVxuICBpZiAodHlwZW9mIERlbm8gIT09IFwidW5kZWZpbmVkXCIpIHtcbiAgICByZXR1cm4gRGVuby5lbnYuZ2V0KGtleSkgPz8gZmFsbGJhY2s7XG4gIH1cbiAgaWYgKHR5cGVvZiBCdW4gIT09IFwidW5kZWZpbmVkXCIpIHtcbiAgICByZXR1cm4gQnVuLmVudltrZXldID8/IGZhbGxiYWNrO1xuICB9XG4gIHJldHVybiBmYWxsYmFjaztcbn1cbmZ1bmN0aW9uIGdldEJvb2xlYW5FbnZWYXIoa2V5LCBmYWxsYmFjayA9IHRydWUpIHtcbiAgY29uc3QgdmFsdWUgPSBnZXRFbnZWYXIoa2V5KTtcbiAgaWYgKCF2YWx1ZSkgcmV0dXJuIGZhbGxiYWNrO1xuICByZXR1cm4gdmFsdWUgIT09IFwiMFwiICYmIHZhbHVlLnRvTG93ZXJDYXNlKCkgIT09IFwiZmFsc2VcIiAmJiB2YWx1ZSAhPT0gXCJcIjtcbn1cbmNvbnN0IEVOViA9IE9iamVjdC5mcmVlemUoe1xuICBnZXQgQkVUVEVSX0FVVEhfU0VDUkVUKCkge1xuICAgIHJldHVybiBnZXRFbnZWYXIoXCJCRVRURVJfQVVUSF9TRUNSRVRcIik7XG4gIH0sXG4gIGdldCBBVVRIX1NFQ1JFVCgpIHtcbiAgICByZXR1cm4gZ2V0RW52VmFyKFwiQVVUSF9TRUNSRVRcIik7XG4gIH0sXG4gIGdldCBCRVRURVJfQVVUSF9URUxFTUVUUlkoKSB7XG4gICAgcmV0dXJuIGdldEVudlZhcihcIkJFVFRFUl9BVVRIX1RFTEVNRVRSWVwiKTtcbiAgfSxcbiAgZ2V0IEJFVFRFUl9BVVRIX1RFTEVNRVRSWV9JRCgpIHtcbiAgICByZXR1cm4gZ2V0RW52VmFyKFwiQkVUVEVSX0FVVEhfVEVMRU1FVFJZX0lEXCIpO1xuICB9LFxuICBnZXQgTk9ERV9FTlYoKSB7XG4gICAgcmV0dXJuIGdldEVudlZhcihcIk5PREVfRU5WXCIsIFwiZGV2ZWxvcG1lbnRcIik7XG4gIH0sXG4gIGdldCBQQUNLQUdFX1ZFUlNJT04oKSB7XG4gICAgcmV0dXJuIGdldEVudlZhcihcIlBBQ0tBR0VfVkVSU0lPTlwiLCBcIjAuMC4wXCIpO1xuICB9LFxuICBnZXQgQkVUVEVSX0FVVEhfVEVMRU1FVFJZX0VORFBPSU5UKCkge1xuICAgIHJldHVybiBnZXRFbnZWYXIoXG4gICAgICBcIkJFVFRFUl9BVVRIX1RFTEVNRVRSWV9FTkRQT0lOVFwiLFxuICAgICAgXCJodHRwczovL3RlbGVtZXRyeS5iZXR0ZXItYXV0aC5jb20vdjEvdHJhY2tcIlxuICAgICk7XG4gIH1cbn0pO1xuXG5jb25zdCBDT0xPUlNfMiA9IDE7XG5jb25zdCBDT0xPUlNfMTYgPSA0O1xuY29uc3QgQ09MT1JTXzI1NiA9IDg7XG5jb25zdCBDT0xPUlNfMTZtID0gMjQ7XG5jb25zdCBURVJNX0VOVlMgPSB7XG4gIGV0ZXJtOiBDT0xPUlNfMTYsXG4gIGNvbnMyNTogQ09MT1JTXzE2LFxuICBjb25zb2xlOiBDT0xPUlNfMTYsXG4gIGN5Z3dpbjogQ09MT1JTXzE2LFxuICBkdHRlcm06IENPTE9SU18xNixcbiAgZ25vbWU6IENPTE9SU18xNixcbiAgaHVyZDogQ09MT1JTXzE2LFxuICBqZmJ0ZXJtOiBDT0xPUlNfMTYsXG4gIGtvbnNvbGU6IENPTE9SU18xNixcbiAga3Rlcm06IENPTE9SU18xNixcbiAgbWx0ZXJtOiBDT0xPUlNfMTYsXG4gIG1vc2g6IENPTE9SU18xNm0sXG4gIHB1dHR5OiBDT0xPUlNfMTYsXG4gIHN0OiBDT0xPUlNfMTYsXG4gIC8vIGh0dHA6Ly9saXN0cy5zY2htb3JwLmRlL3BpcGVybWFpbC9yeHZ0LXVuaWNvZGUvMjAxNnEyLzAwMjI2MS5odG1sXG4gIFwicnh2dC11bmljb2RlLTI0Yml0XCI6IENPTE9SU18xNm0sXG4gIC8vIGh0dHBzOi8vYnVncy5sYXVuY2hwYWQubmV0L3Rlcm1pbmF0b3IvK2J1Zy8xMDMwNTYyXG4gIHRlcm1pbmF0b3I6IENPTE9SU18xNm0sXG4gIFwieHRlcm0ta2l0dHlcIjogQ09MT1JTXzE2bVxufTtcbmNvbnN0IENJX0VOVlNfTUFQID0gbmV3IE1hcChcbiAgT2JqZWN0LmVudHJpZXMoe1xuICAgIEFQUFZFWU9SOiBDT0xPUlNfMjU2LFxuICAgIEJVSUxES0lURTogQ09MT1JTXzI1NixcbiAgICBDSVJDTEVDSTogQ09MT1JTXzE2bSxcbiAgICBEUk9ORTogQ09MT1JTXzI1NixcbiAgICBHSVRFQV9BQ1RJT05TOiBDT0xPUlNfMTZtLFxuICAgIEdJVEhVQl9BQ1RJT05TOiBDT0xPUlNfMTZtLFxuICAgIEdJVExBQl9DSTogQ09MT1JTXzI1NixcbiAgICBUUkFWSVM6IENPTE9SU18yNTZcbiAgfSlcbik7XG5jb25zdCBURVJNX0VOVlNfUkVHX0VYUCA9IFtcbiAgL2Fuc2kvLFxuICAvY29sb3IvLFxuICAvbGludXgvLFxuICAvZGlyZWN0LyxcbiAgL15jb25bMC05XSp4WzAtOV0vLFxuICAvXnJ4dnQvLFxuICAvXnNjcmVlbi8sXG4gIC9eeHRlcm0vLFxuICAvXnZ0MTAwLyxcbiAgL152dDIyMC9cbl07XG5mdW5jdGlvbiBnZXRDb2xvckRlcHRoKCkge1xuICBpZiAoZ2V0RW52VmFyKFwiRk9SQ0VfQ09MT1JcIikgIT09IHZvaWQgMCkge1xuICAgIHN3aXRjaCAoZ2V0RW52VmFyKFwiRk9SQ0VfQ09MT1JcIikpIHtcbiAgICAgIGNhc2UgXCJcIjpcbiAgICAgIGNhc2UgXCIxXCI6XG4gICAgICBjYXNlIFwidHJ1ZVwiOlxuICAgICAgICByZXR1cm4gQ09MT1JTXzE2O1xuICAgICAgY2FzZSBcIjJcIjpcbiAgICAgICAgcmV0dXJuIENPTE9SU18yNTY7XG4gICAgICBjYXNlIFwiM1wiOlxuICAgICAgICByZXR1cm4gQ09MT1JTXzE2bTtcbiAgICAgIGRlZmF1bHQ6XG4gICAgICAgIHJldHVybiBDT0xPUlNfMjtcbiAgICB9XG4gIH1cbiAgaWYgKGdldEVudlZhcihcIk5PREVfRElTQUJMRV9DT0xPUlNcIikgIT09IHZvaWQgMCAmJiBnZXRFbnZWYXIoXCJOT0RFX0RJU0FCTEVfQ09MT1JTXCIpICE9PSBcIlwiIHx8IC8vIFNlZSBodHRwczovL25vLWNvbG9yLm9yZy9cbiAgZ2V0RW52VmFyKFwiTk9fQ09MT1JcIikgIT09IHZvaWQgMCAmJiBnZXRFbnZWYXIoXCJOT19DT0xPUlwiKSAhPT0gXCJcIiB8fCAvLyBUaGUgXCJkdW1iXCIgc3BlY2lhbCB0ZXJtaW5hbCwgYXMgZGVmaW5lZCBieSB0ZXJtaW5mbywgZG9lc24ndCBzdXBwb3J0XG4gIC8vIEFOU0kgY29sb3IgY29udHJvbCBjb2Rlcy5cbiAgLy8gU2VlIGh0dHBzOi8vaW52aXNpYmxlLWlzbGFuZC5uZXQvbmN1cnNlcy90ZXJtaW5mby50aS5odG1sI3RvYy1fU3BlY2lhbHNcbiAgZ2V0RW52VmFyKFwiVEVSTVwiKSA9PT0gXCJkdW1iXCIpIHtcbiAgICByZXR1cm4gQ09MT1JTXzI7XG4gIH1cbiAgaWYgKGdldEVudlZhcihcIlRNVVhcIikpIHtcbiAgICByZXR1cm4gQ09MT1JTXzE2bTtcbiAgfVxuICBpZiAoXCJURl9CVUlMRFwiIGluIGVudiAmJiBcIkFHRU5UX05BTUVcIiBpbiBlbnYpIHtcbiAgICByZXR1cm4gQ09MT1JTXzE2O1xuICB9XG4gIGlmIChcIkNJXCIgaW4gZW52KSB7XG4gICAgZm9yIChjb25zdCB7IDA6IGVudk5hbWUsIDE6IGNvbG9ycyB9IG9mIENJX0VOVlNfTUFQKSB7XG4gICAgICBpZiAoZW52TmFtZSBpbiBlbnYpIHtcbiAgICAgICAgcmV0dXJuIGNvbG9ycztcbiAgICAgIH1cbiAgICB9XG4gICAgaWYgKGdldEVudlZhcihcIkNJX05BTUVcIikgPT09IFwiY29kZXNoaXBcIikge1xuICAgICAgcmV0dXJuIENPTE9SU18yNTY7XG4gICAgfVxuICAgIHJldHVybiBDT0xPUlNfMjtcbiAgfVxuICBpZiAoXCJURUFNQ0lUWV9WRVJTSU9OXCIgaW4gZW52KSB7XG4gICAgcmV0dXJuIC9eKDlcXC4oMCpbMS05XVxcZCopXFwufFxcZHsyLH1cXC4pLy5leGVjKFxuICAgICAgZ2V0RW52VmFyKFwiVEVBTUNJVFlfVkVSU0lPTlwiKVxuICAgICkgIT09IG51bGwgPyBDT0xPUlNfMTYgOiBDT0xPUlNfMjtcbiAgfVxuICBzd2l0Y2ggKGdldEVudlZhcihcIlRFUk1fUFJPR1JBTVwiKSkge1xuICAgIGNhc2UgXCJpVGVybS5hcHBcIjpcbiAgICAgIGlmICghZ2V0RW52VmFyKFwiVEVSTV9QUk9HUkFNX1ZFUlNJT05cIikgfHwgL15bMC0yXVxcLi8uZXhlYyhnZXRFbnZWYXIoXCJURVJNX1BST0dSQU1fVkVSU0lPTlwiKSkgIT09IG51bGwpIHtcbiAgICAgICAgcmV0dXJuIENPTE9SU18yNTY7XG4gICAgICB9XG4gICAgICByZXR1cm4gQ09MT1JTXzE2bTtcbiAgICBjYXNlIFwiSHlwZXJUZXJtXCI6XG4gICAgY2FzZSBcIk1hY1Rlcm1cIjpcbiAgICAgIHJldHVybiBDT0xPUlNfMTZtO1xuICAgIGNhc2UgXCJBcHBsZV9UZXJtaW5hbFwiOlxuICAgICAgcmV0dXJuIENPTE9SU18yNTY7XG4gIH1cbiAgaWYgKGdldEVudlZhcihcIkNPTE9SVEVSTVwiKSA9PT0gXCJ0cnVlY29sb3JcIiB8fCBnZXRFbnZWYXIoXCJDT0xPUlRFUk1cIikgPT09IFwiMjRiaXRcIikge1xuICAgIHJldHVybiBDT0xPUlNfMTZtO1xuICB9XG4gIGlmIChnZXRFbnZWYXIoXCJURVJNXCIpKSB7XG4gICAgaWYgKC90cnVlY29sb3IvLmV4ZWMoZ2V0RW52VmFyKFwiVEVSTVwiKSkgIT09IG51bGwpIHtcbiAgICAgIHJldHVybiBDT0xPUlNfMTZtO1xuICAgIH1cbiAgICBpZiAoL154dGVybS0yNTYvLmV4ZWMoZ2V0RW52VmFyKFwiVEVSTVwiKSkgIT09IG51bGwpIHtcbiAgICAgIHJldHVybiBDT0xPUlNfMjU2O1xuICAgIH1cbiAgICBjb25zdCB0ZXJtRW52ID0gZ2V0RW52VmFyKFwiVEVSTVwiKS50b0xvd2VyQ2FzZSgpO1xuICAgIGlmIChURVJNX0VOVlNbdGVybUVudl0pIHtcbiAgICAgIHJldHVybiBURVJNX0VOVlNbdGVybUVudl07XG4gICAgfVxuICAgIGlmIChURVJNX0VOVlNfUkVHX0VYUC5zb21lKCh0ZXJtKSA9PiB0ZXJtLmV4ZWModGVybUVudikgIT09IG51bGwpKSB7XG4gICAgICByZXR1cm4gQ09MT1JTXzE2O1xuICAgIH1cbiAgfVxuICBpZiAoZ2V0RW52VmFyKFwiQ09MT1JURVJNXCIpKSB7XG4gICAgcmV0dXJuIENPTE9SU18xNjtcbiAgfVxuICByZXR1cm4gQ09MT1JTXzI7XG59XG5cbmNvbnN0IFRUWV9DT0xPUlMgPSB7XG4gIHJlc2V0OiBcIlxceDFCWzBtXCIsXG4gIGJyaWdodDogXCJcXHgxQlsxbVwiLFxuICBkaW06IFwiXFx4MUJbMm1cIixcbiAgdW5kaW06IFwiXFx4MUJbMjJtXCIsXG4gIHVuZGVyc2NvcmU6IFwiXFx4MUJbNG1cIixcbiAgYmxpbms6IFwiXFx4MUJbNW1cIixcbiAgcmV2ZXJzZTogXCJcXHgxQls3bVwiLFxuICBoaWRkZW46IFwiXFx4MUJbOG1cIixcbiAgZmc6IHtcbiAgICBibGFjazogXCJcXHgxQlszMG1cIixcbiAgICByZWQ6IFwiXFx4MUJbMzFtXCIsXG4gICAgZ3JlZW46IFwiXFx4MUJbMzJtXCIsXG4gICAgeWVsbG93OiBcIlxceDFCWzMzbVwiLFxuICAgIGJsdWU6IFwiXFx4MUJbMzRtXCIsXG4gICAgbWFnZW50YTogXCJcXHgxQlszNW1cIixcbiAgICBjeWFuOiBcIlxceDFCWzM2bVwiLFxuICAgIHdoaXRlOiBcIlxceDFCWzM3bVwiXG4gIH0sXG4gIGJnOiB7XG4gICAgYmxhY2s6IFwiXFx4MUJbNDBtXCIsXG4gICAgcmVkOiBcIlxceDFCWzQxbVwiLFxuICAgIGdyZWVuOiBcIlxceDFCWzQybVwiLFxuICAgIHllbGxvdzogXCJcXHgxQls0M21cIixcbiAgICBibHVlOiBcIlxceDFCWzQ0bVwiLFxuICAgIG1hZ2VudGE6IFwiXFx4MUJbNDVtXCIsXG4gICAgY3lhbjogXCJcXHgxQls0Nm1cIixcbiAgICB3aGl0ZTogXCJcXHgxQls0N21cIlxuICB9XG59O1xuY29uc3QgbGV2ZWxzID0gW1wiaW5mb1wiLCBcInN1Y2Nlc3NcIiwgXCJ3YXJuXCIsIFwiZXJyb3JcIiwgXCJkZWJ1Z1wiXTtcbmZ1bmN0aW9uIHNob3VsZFB1Ymxpc2hMb2coY3VycmVudExvZ0xldmVsLCBsb2dMZXZlbCkge1xuICByZXR1cm4gbGV2ZWxzLmluZGV4T2YobG9nTGV2ZWwpIDw9IGxldmVscy5pbmRleE9mKGN1cnJlbnRMb2dMZXZlbCk7XG59XG5jb25zdCBsZXZlbENvbG9ycyA9IHtcbiAgaW5mbzogVFRZX0NPTE9SUy5mZy5ibHVlLFxuICBzdWNjZXNzOiBUVFlfQ09MT1JTLmZnLmdyZWVuLFxuICB3YXJuOiBUVFlfQ09MT1JTLmZnLnllbGxvdyxcbiAgZXJyb3I6IFRUWV9DT0xPUlMuZmcucmVkLFxuICBkZWJ1ZzogVFRZX0NPTE9SUy5mZy5tYWdlbnRhXG59O1xuY29uc3QgZm9ybWF0TWVzc2FnZSA9IChsZXZlbCwgbWVzc2FnZSwgY29sb3JzRW5hYmxlZCkgPT4ge1xuICBjb25zdCB0aW1lc3RhbXAgPSAoLyogQF9fUFVSRV9fICovIG5ldyBEYXRlKCkpLnRvSVNPU3RyaW5nKCk7XG4gIGlmIChjb2xvcnNFbmFibGVkKSB7XG4gICAgcmV0dXJuIGAke1RUWV9DT0xPUlMuZGltfSR7dGltZXN0YW1wfSR7VFRZX0NPTE9SUy5yZXNldH0gJHtsZXZlbENvbG9yc1tsZXZlbF19JHtsZXZlbC50b1VwcGVyQ2FzZSgpfSR7VFRZX0NPTE9SUy5yZXNldH0gJHtUVFlfQ09MT1JTLmJyaWdodH1bQmV0dGVyIEF1dGhdOiR7VFRZX0NPTE9SUy5yZXNldH0gJHttZXNzYWdlfWA7XG4gIH1cbiAgcmV0dXJuIGAke3RpbWVzdGFtcH0gJHtsZXZlbC50b1VwcGVyQ2FzZSgpfSBbQmV0dGVyIEF1dGhdOiAke21lc3NhZ2V9YDtcbn07XG5jb25zdCBjcmVhdGVMb2dnZXIgPSAob3B0aW9ucykgPT4ge1xuICBjb25zdCBlbmFibGVkID0gb3B0aW9ucz8uZGlzYWJsZWQgIT09IHRydWU7XG4gIGNvbnN0IGxvZ0xldmVsID0gb3B0aW9ucz8ubGV2ZWwgPz8gXCJlcnJvclwiO1xuICBjb25zdCBpc0Rpc2FibGVDb2xvcnNTcGVjaWZpZWQgPSBvcHRpb25zPy5kaXNhYmxlQ29sb3JzICE9PSB2b2lkIDA7XG4gIGNvbnN0IGNvbG9yc0VuYWJsZWQgPSBpc0Rpc2FibGVDb2xvcnNTcGVjaWZpZWQgPyAhb3B0aW9ucy5kaXNhYmxlQ29sb3JzIDogZ2V0Q29sb3JEZXB0aCgpICE9PSAxO1xuICBjb25zdCBMb2dGdW5jID0gKGxldmVsLCBtZXNzYWdlLCBhcmdzID0gW10pID0+IHtcbiAgICBpZiAoIWVuYWJsZWQgfHwgIXNob3VsZFB1Ymxpc2hMb2cobG9nTGV2ZWwsIGxldmVsKSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBjb25zdCBmb3JtYXR0ZWRNZXNzYWdlID0gZm9ybWF0TWVzc2FnZShsZXZlbCwgbWVzc2FnZSwgY29sb3JzRW5hYmxlZCk7XG4gICAgaWYgKCFvcHRpb25zIHx8IHR5cGVvZiBvcHRpb25zLmxvZyAhPT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICBpZiAobGV2ZWwgPT09IFwiZXJyb3JcIikge1xuICAgICAgICBjb25zb2xlLmVycm9yKGZvcm1hdHRlZE1lc3NhZ2UsIC4uLmFyZ3MpO1xuICAgICAgfSBlbHNlIGlmIChsZXZlbCA9PT0gXCJ3YXJuXCIpIHtcbiAgICAgICAgY29uc29sZS53YXJuKGZvcm1hdHRlZE1lc3NhZ2UsIC4uLmFyZ3MpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgY29uc29sZS5sb2coZm9ybWF0dGVkTWVzc2FnZSwgLi4uYXJncyk7XG4gICAgICB9XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIG9wdGlvbnMubG9nKGxldmVsID09PSBcInN1Y2Nlc3NcIiA/IFwiaW5mb1wiIDogbGV2ZWwsIG1lc3NhZ2UsIC4uLmFyZ3MpO1xuICB9O1xuICBjb25zdCBsb2dnZXIyID0gT2JqZWN0LmZyb21FbnRyaWVzKFxuICAgIGxldmVscy5tYXAoKGxldmVsKSA9PiBbXG4gICAgICBsZXZlbCxcbiAgICAgICguLi5bbWVzc2FnZSwgLi4uYXJnc10pID0+IExvZ0Z1bmMobGV2ZWwsIG1lc3NhZ2UsIGFyZ3MpXG4gICAgXSlcbiAgKTtcbiAgcmV0dXJuIHtcbiAgICAuLi5sb2dnZXIyLFxuICAgIGdldCBsZXZlbCgpIHtcbiAgICAgIHJldHVybiBsb2dMZXZlbDtcbiAgICB9XG4gIH07XG59O1xuY29uc3QgbG9nZ2VyID0gY3JlYXRlTG9nZ2VyKCk7XG5cbmV4cG9ydCB7IEVOViwgVFRZX0NPTE9SUywgY3JlYXRlTG9nZ2VyLCBlbnYsIGdldEJvb2xlYW5FbnZWYXIsIGdldENvbG9yRGVwdGgsIGdldEVudlZhciwgaXNEZXZlbG9wbWVudCwgaXNQcm9kdWN0aW9uLCBpc1Rlc3QsIGxldmVscywgbG9nZ2VyLCBub2RlRU5WLCBzaG91bGRQdWJsaXNoTG9nIH07XG4iXSwibmFtZXMiOltdLCJpZ25vcmVMaXN0IjpbMF0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/@better-auth/core/dist/env/index.mjs\n");

/***/ }),

/***/ "(rsc)/./node_modules/@better-auth/core/dist/error/index.mjs":
/*!*************************************************************!*\
  !*** ./node_modules/@better-auth/core/dist/error/index.mjs ***!
  \*************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   BASE_ERROR_CODES: () => (/* binding */ BASE_ERROR_CODES),\n/* harmony export */   BetterAuthError: () => (/* binding */ BetterAuthError)\n/* harmony export */ });\n/* harmony import */ var _better_auth_core_utils__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @better-auth/core/utils */ \"(rsc)/./node_modules/@better-auth/core/dist/utils/index.mjs\");\n\n\nconst BASE_ERROR_CODES = (0,_better_auth_core_utils__WEBPACK_IMPORTED_MODULE_0__.defineErrorCodes)({\n  USER_NOT_FOUND: \"User not found\",\n  FAILED_TO_CREATE_USER: \"Failed to create user\",\n  FAILED_TO_CREATE_SESSION: \"Failed to create session\",\n  FAILED_TO_UPDATE_USER: \"Failed to update user\",\n  FAILED_TO_GET_SESSION: \"Failed to get session\",\n  INVALID_PASSWORD: \"Invalid password\",\n  INVALID_EMAIL: \"Invalid email\",\n  INVALID_EMAIL_OR_PASSWORD: \"Invalid email or password\",\n  SOCIAL_ACCOUNT_ALREADY_LINKED: \"Social account already linked\",\n  PROVIDER_NOT_FOUND: \"Provider not found\",\n  INVALID_TOKEN: \"Invalid token\",\n  ID_TOKEN_NOT_SUPPORTED: \"id_token not supported\",\n  FAILED_TO_GET_USER_INFO: \"Failed to get user info\",\n  USER_EMAIL_NOT_FOUND: \"User email not found\",\n  EMAIL_NOT_VERIFIED: \"Email not verified\",\n  PASSWORD_TOO_SHORT: \"Password too short\",\n  PASSWORD_TOO_LONG: \"Password too long\",\n  USER_ALREADY_EXISTS: \"User already exists.\",\n  USER_ALREADY_EXISTS_USE_ANOTHER_EMAIL: \"User already exists. Use another email.\",\n  EMAIL_CAN_NOT_BE_UPDATED: \"Email can not be updated\",\n  CREDENTIAL_ACCOUNT_NOT_FOUND: \"Credential account not found\",\n  SESSION_EXPIRED: \"Session expired. Re-authenticate to perform this action.\",\n  FAILED_TO_UNLINK_LAST_ACCOUNT: \"You can't unlink your last account\",\n  ACCOUNT_NOT_FOUND: \"Account not found\",\n  USER_ALREADY_HAS_PASSWORD: \"User already has a password. Provide that to delete the account.\"\n});\n\nclass BetterAuthError extends Error {\n  constructor(message, cause) {\n    super(message);\n    this.name = \"BetterAuthError\";\n    this.message = message;\n    this.cause = cause;\n    this.stack = \"\";\n  }\n}\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvQGJldHRlci1hdXRoL2NvcmUvZGlzdC9lcnJvci9pbmRleC5tanMiLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQTJEOztBQUUzRCx5QkFBeUIseUVBQWdCO0FBQ3pDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQzs7QUFFRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRTZDIiwic291cmNlcyI6WyJDOlxcVXNlcnNcXHNpZDAxXFxPbmVEcml2ZVxcRGVza3RvcFxcYW1kLXRlbGVwaG9ueS1zeXN0ZW1cXGZyb250ZW5kXFxub2RlX21vZHVsZXNcXEBiZXR0ZXItYXV0aFxcY29yZVxcZGlzdFxcZXJyb3JcXGluZGV4Lm1qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBkZWZpbmVFcnJvckNvZGVzIH0gZnJvbSAnQGJldHRlci1hdXRoL2NvcmUvdXRpbHMnO1xuXG5jb25zdCBCQVNFX0VSUk9SX0NPREVTID0gZGVmaW5lRXJyb3JDb2Rlcyh7XG4gIFVTRVJfTk9UX0ZPVU5EOiBcIlVzZXIgbm90IGZvdW5kXCIsXG4gIEZBSUxFRF9UT19DUkVBVEVfVVNFUjogXCJGYWlsZWQgdG8gY3JlYXRlIHVzZXJcIixcbiAgRkFJTEVEX1RPX0NSRUFURV9TRVNTSU9OOiBcIkZhaWxlZCB0byBjcmVhdGUgc2Vzc2lvblwiLFxuICBGQUlMRURfVE9fVVBEQVRFX1VTRVI6IFwiRmFpbGVkIHRvIHVwZGF0ZSB1c2VyXCIsXG4gIEZBSUxFRF9UT19HRVRfU0VTU0lPTjogXCJGYWlsZWQgdG8gZ2V0IHNlc3Npb25cIixcbiAgSU5WQUxJRF9QQVNTV09SRDogXCJJbnZhbGlkIHBhc3N3b3JkXCIsXG4gIElOVkFMSURfRU1BSUw6IFwiSW52YWxpZCBlbWFpbFwiLFxuICBJTlZBTElEX0VNQUlMX09SX1BBU1NXT1JEOiBcIkludmFsaWQgZW1haWwgb3IgcGFzc3dvcmRcIixcbiAgU09DSUFMX0FDQ09VTlRfQUxSRUFEWV9MSU5LRUQ6IFwiU29jaWFsIGFjY291bnQgYWxyZWFkeSBsaW5rZWRcIixcbiAgUFJPVklERVJfTk9UX0ZPVU5EOiBcIlByb3ZpZGVyIG5vdCBmb3VuZFwiLFxuICBJTlZBTElEX1RPS0VOOiBcIkludmFsaWQgdG9rZW5cIixcbiAgSURfVE9LRU5fTk9UX1NVUFBPUlRFRDogXCJpZF90b2tlbiBub3Qgc3VwcG9ydGVkXCIsXG4gIEZBSUxFRF9UT19HRVRfVVNFUl9JTkZPOiBcIkZhaWxlZCB0byBnZXQgdXNlciBpbmZvXCIsXG4gIFVTRVJfRU1BSUxfTk9UX0ZPVU5EOiBcIlVzZXIgZW1haWwgbm90IGZvdW5kXCIsXG4gIEVNQUlMX05PVF9WRVJJRklFRDogXCJFbWFpbCBub3QgdmVyaWZpZWRcIixcbiAgUEFTU1dPUkRfVE9PX1NIT1JUOiBcIlBhc3N3b3JkIHRvbyBzaG9ydFwiLFxuICBQQVNTV09SRF9UT09fTE9ORzogXCJQYXNzd29yZCB0b28gbG9uZ1wiLFxuICBVU0VSX0FMUkVBRFlfRVhJU1RTOiBcIlVzZXIgYWxyZWFkeSBleGlzdHMuXCIsXG4gIFVTRVJfQUxSRUFEWV9FWElTVFNfVVNFX0FOT1RIRVJfRU1BSUw6IFwiVXNlciBhbHJlYWR5IGV4aXN0cy4gVXNlIGFub3RoZXIgZW1haWwuXCIsXG4gIEVNQUlMX0NBTl9OT1RfQkVfVVBEQVRFRDogXCJFbWFpbCBjYW4gbm90IGJlIHVwZGF0ZWRcIixcbiAgQ1JFREVOVElBTF9BQ0NPVU5UX05PVF9GT1VORDogXCJDcmVkZW50aWFsIGFjY291bnQgbm90IGZvdW5kXCIsXG4gIFNFU1NJT05fRVhQSVJFRDogXCJTZXNzaW9uIGV4cGlyZWQuIFJlLWF1dGhlbnRpY2F0ZSB0byBwZXJmb3JtIHRoaXMgYWN0aW9uLlwiLFxuICBGQUlMRURfVE9fVU5MSU5LX0xBU1RfQUNDT1VOVDogXCJZb3UgY2FuJ3QgdW5saW5rIHlvdXIgbGFzdCBhY2NvdW50XCIsXG4gIEFDQ09VTlRfTk9UX0ZPVU5EOiBcIkFjY291bnQgbm90IGZvdW5kXCIsXG4gIFVTRVJfQUxSRUFEWV9IQVNfUEFTU1dPUkQ6IFwiVXNlciBhbHJlYWR5IGhhcyBhIHBhc3N3b3JkLiBQcm92aWRlIHRoYXQgdG8gZGVsZXRlIHRoZSBhY2NvdW50LlwiXG59KTtcblxuY2xhc3MgQmV0dGVyQXV0aEVycm9yIGV4dGVuZHMgRXJyb3Ige1xuICBjb25zdHJ1Y3RvcihtZXNzYWdlLCBjYXVzZSkge1xuICAgIHN1cGVyKG1lc3NhZ2UpO1xuICAgIHRoaXMubmFtZSA9IFwiQmV0dGVyQXV0aEVycm9yXCI7XG4gICAgdGhpcy5tZXNzYWdlID0gbWVzc2FnZTtcbiAgICB0aGlzLmNhdXNlID0gY2F1c2U7XG4gICAgdGhpcy5zdGFjayA9IFwiXCI7XG4gIH1cbn1cblxuZXhwb3J0IHsgQkFTRV9FUlJPUl9DT0RFUywgQmV0dGVyQXV0aEVycm9yIH07XG4iXSwibmFtZXMiOltdLCJpZ25vcmVMaXN0IjpbMF0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/@better-auth/core/dist/error/index.mjs\n");

/***/ }),

/***/ "(rsc)/./node_modules/@better-auth/core/dist/index.mjs":
/*!*******************************************************!*\
  !*** ./node_modules/@better-auth/core/dist/index.mjs ***!
  \*******************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);



/***/ }),

/***/ "(rsc)/./node_modules/@better-auth/core/dist/middleware/index.mjs":
/*!******************************************************************!*\
  !*** ./node_modules/@better-auth/core/dist/middleware/index.mjs ***!
  \******************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createAuthEndpoint: () => (/* binding */ createAuthEndpoint),\n/* harmony export */   createAuthMiddleware: () => (/* binding */ createAuthMiddleware),\n/* harmony export */   optionsMiddleware: () => (/* binding */ optionsMiddleware)\n/* harmony export */ });\n/* harmony import */ var better_call__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! better-call */ \"(rsc)/./node_modules/better-call/dist/index.js\");\n\n\nconst optionsMiddleware = (0,better_call__WEBPACK_IMPORTED_MODULE_0__.createMiddleware)(async () => {\n  return {};\n});\nconst createAuthMiddleware = better_call__WEBPACK_IMPORTED_MODULE_0__.createMiddleware.create({\n  use: [\n    optionsMiddleware,\n    /**\n     * Only use for post hooks\n     */\n    (0,better_call__WEBPACK_IMPORTED_MODULE_0__.createMiddleware)(async () => {\n      return {};\n    })\n  ]\n});\nconst createAuthEndpoint = better_call__WEBPACK_IMPORTED_MODULE_0__.createEndpoint.create({\n  use: [optionsMiddleware]\n});\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvQGJldHRlci1hdXRoL2NvcmUvZGlzdC9taWRkbGV3YXJlL2luZGV4Lm1qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7O0FBQStEOztBQUUvRCwwQkFBMEIsNkRBQWdCO0FBQzFDO0FBQ0EsQ0FBQztBQUNELDZCQUE2Qix5REFBZ0I7QUFDN0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUksNkRBQWdCO0FBQ3BCO0FBQ0EsS0FBSztBQUNMO0FBQ0EsQ0FBQztBQUNELDJCQUEyQix1REFBYztBQUN6QztBQUNBLENBQUM7O0FBRXNFIiwic291cmNlcyI6WyJDOlxcVXNlcnNcXHNpZDAxXFxPbmVEcml2ZVxcRGVza3RvcFxcYW1kLXRlbGVwaG9ueS1zeXN0ZW1cXGZyb250ZW5kXFxub2RlX21vZHVsZXNcXEBiZXR0ZXItYXV0aFxcY29yZVxcZGlzdFxcbWlkZGxld2FyZVxcaW5kZXgubWpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGNyZWF0ZU1pZGRsZXdhcmUsIGNyZWF0ZUVuZHBvaW50IH0gZnJvbSAnYmV0dGVyLWNhbGwnO1xuXG5jb25zdCBvcHRpb25zTWlkZGxld2FyZSA9IGNyZWF0ZU1pZGRsZXdhcmUoYXN5bmMgKCkgPT4ge1xuICByZXR1cm4ge307XG59KTtcbmNvbnN0IGNyZWF0ZUF1dGhNaWRkbGV3YXJlID0gY3JlYXRlTWlkZGxld2FyZS5jcmVhdGUoe1xuICB1c2U6IFtcbiAgICBvcHRpb25zTWlkZGxld2FyZSxcbiAgICAvKipcbiAgICAgKiBPbmx5IHVzZSBmb3IgcG9zdCBob29rc1xuICAgICAqL1xuICAgIGNyZWF0ZU1pZGRsZXdhcmUoYXN5bmMgKCkgPT4ge1xuICAgICAgcmV0dXJuIHt9O1xuICAgIH0pXG4gIF1cbn0pO1xuY29uc3QgY3JlYXRlQXV0aEVuZHBvaW50ID0gY3JlYXRlRW5kcG9pbnQuY3JlYXRlKHtcbiAgdXNlOiBbb3B0aW9uc01pZGRsZXdhcmVdXG59KTtcblxuZXhwb3J0IHsgY3JlYXRlQXV0aEVuZHBvaW50LCBjcmVhdGVBdXRoTWlkZGxld2FyZSwgb3B0aW9uc01pZGRsZXdhcmUgfTtcbiJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOlswXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/@better-auth/core/dist/middleware/index.mjs\n");

/***/ }),

/***/ "(rsc)/./node_modules/@better-auth/core/dist/oauth2/index.mjs":
/*!**************************************************************!*\
  !*** ./node_modules/@better-auth/core/dist/oauth2/index.mjs ***!
  \**************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   clientCredentialsToken: () => (/* binding */ clientCredentialsToken),\n/* harmony export */   createAuthorizationCodeRequest: () => (/* binding */ createAuthorizationCodeRequest),\n/* harmony export */   createAuthorizationURL: () => (/* binding */ createAuthorizationURL),\n/* harmony export */   createClientCredentialsTokenRequest: () => (/* binding */ createClientCredentialsTokenRequest),\n/* harmony export */   createRefreshAccessTokenRequest: () => (/* binding */ createRefreshAccessTokenRequest),\n/* harmony export */   generateCodeChallenge: () => (/* binding */ generateCodeChallenge),\n/* harmony export */   getOAuth2Tokens: () => (/* binding */ getOAuth2Tokens),\n/* harmony export */   refreshAccessToken: () => (/* binding */ refreshAccessToken),\n/* harmony export */   validateAuthorizationCode: () => (/* binding */ validateAuthorizationCode),\n/* harmony export */   validateToken: () => (/* binding */ validateToken)\n/* harmony export */ });\n/* harmony import */ var _better_auth_utils_base64__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @better-auth/utils/base64 */ \"(rsc)/./node_modules/@better-auth/utils/dist/base64.mjs\");\n/* harmony import */ var _better_fetch_fetch__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @better-fetch/fetch */ \"(rsc)/./node_modules/@better-fetch/fetch/dist/index.js\");\n/* harmony import */ var jose__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! jose */ \"(rsc)/./node_modules/jose/dist/webapi/jwt/verify.js\");\n\n\n\n\nfunction getOAuth2Tokens(data) {\n  const getDate = (seconds) => {\n    const now = /* @__PURE__ */ new Date();\n    return new Date(now.getTime() + seconds * 1e3);\n  };\n  return {\n    tokenType: data.token_type,\n    accessToken: data.access_token,\n    refreshToken: data.refresh_token,\n    accessTokenExpiresAt: data.expires_in ? getDate(data.expires_in) : void 0,\n    refreshTokenExpiresAt: data.refresh_token_expires_in ? getDate(data.refresh_token_expires_in) : void 0,\n    scopes: data?.scope ? typeof data.scope === \"string\" ? data.scope.split(\" \") : data.scope : [],\n    idToken: data.id_token\n  };\n}\nasync function generateCodeChallenge(codeVerifier) {\n  const encoder = new TextEncoder();\n  const data = encoder.encode(codeVerifier);\n  const hash = await crypto.subtle.digest(\"SHA-256\", data);\n  return _better_auth_utils_base64__WEBPACK_IMPORTED_MODULE_0__.base64Url.encode(new Uint8Array(hash), {\n    padding: false\n  });\n}\n\nasync function createAuthorizationURL({\n  id,\n  options,\n  authorizationEndpoint,\n  state,\n  codeVerifier,\n  scopes,\n  claims,\n  redirectURI,\n  duration,\n  prompt,\n  accessType,\n  responseType,\n  display,\n  loginHint,\n  hd,\n  responseMode,\n  additionalParams,\n  scopeJoiner\n}) {\n  const url = new URL(authorizationEndpoint);\n  url.searchParams.set(\"response_type\", responseType || \"code\");\n  const primaryClientId = Array.isArray(options.clientId) ? options.clientId[0] : options.clientId;\n  url.searchParams.set(\"client_id\", primaryClientId);\n  url.searchParams.set(\"state\", state);\n  url.searchParams.set(\"scope\", scopes.join(scopeJoiner || \" \"));\n  url.searchParams.set(\"redirect_uri\", options.redirectURI || redirectURI);\n  duration && url.searchParams.set(\"duration\", duration);\n  display && url.searchParams.set(\"display\", display);\n  loginHint && url.searchParams.set(\"login_hint\", loginHint);\n  prompt && url.searchParams.set(\"prompt\", prompt);\n  hd && url.searchParams.set(\"hd\", hd);\n  accessType && url.searchParams.set(\"access_type\", accessType);\n  responseMode && url.searchParams.set(\"response_mode\", responseMode);\n  if (codeVerifier) {\n    const codeChallenge = await generateCodeChallenge(codeVerifier);\n    url.searchParams.set(\"code_challenge_method\", \"S256\");\n    url.searchParams.set(\"code_challenge\", codeChallenge);\n  }\n  if (claims) {\n    const claimsObj = claims.reduce(\n      (acc, claim) => {\n        acc[claim] = null;\n        return acc;\n      },\n      {}\n    );\n    url.searchParams.set(\n      \"claims\",\n      JSON.stringify({\n        id_token: { email: null, email_verified: null, ...claimsObj }\n      })\n    );\n  }\n  if (additionalParams) {\n    Object.entries(additionalParams).forEach(([key, value]) => {\n      url.searchParams.set(key, value);\n    });\n  }\n  return url;\n}\n\nfunction createAuthorizationCodeRequest({\n  code,\n  codeVerifier,\n  redirectURI,\n  options,\n  authentication,\n  deviceId,\n  headers,\n  additionalParams = {},\n  resource\n}) {\n  const body = new URLSearchParams();\n  const requestHeaders = {\n    \"content-type\": \"application/x-www-form-urlencoded\",\n    accept: \"application/json\",\n    \"user-agent\": \"better-auth\",\n    ...headers\n  };\n  body.set(\"grant_type\", \"authorization_code\");\n  body.set(\"code\", code);\n  codeVerifier && body.set(\"code_verifier\", codeVerifier);\n  options.clientKey && body.set(\"client_key\", options.clientKey);\n  deviceId && body.set(\"device_id\", deviceId);\n  body.set(\"redirect_uri\", options.redirectURI || redirectURI);\n  if (resource) {\n    if (typeof resource === \"string\") {\n      body.append(\"resource\", resource);\n    } else {\n      for (const _resource of resource) {\n        body.append(\"resource\", _resource);\n      }\n    }\n  }\n  if (authentication === \"basic\") {\n    const primaryClientId = Array.isArray(options.clientId) ? options.clientId[0] : options.clientId;\n    const encodedCredentials = _better_auth_utils_base64__WEBPACK_IMPORTED_MODULE_0__.base64.encode(\n      `${primaryClientId}:${options.clientSecret ?? \"\"}`\n    );\n    requestHeaders[\"authorization\"] = `Basic ${encodedCredentials}`;\n  } else {\n    const primaryClientId = Array.isArray(options.clientId) ? options.clientId[0] : options.clientId;\n    body.set(\"client_id\", primaryClientId);\n    if (options.clientSecret) {\n      body.set(\"client_secret\", options.clientSecret);\n    }\n  }\n  for (const [key, value] of Object.entries(additionalParams)) {\n    if (!body.has(key)) body.append(key, value);\n  }\n  return {\n    body,\n    headers: requestHeaders\n  };\n}\nasync function validateAuthorizationCode({\n  code,\n  codeVerifier,\n  redirectURI,\n  options,\n  tokenEndpoint,\n  authentication,\n  deviceId,\n  headers,\n  additionalParams = {},\n  resource\n}) {\n  const { body, headers: requestHeaders } = createAuthorizationCodeRequest({\n    code,\n    codeVerifier,\n    redirectURI,\n    options,\n    authentication,\n    deviceId,\n    headers,\n    additionalParams,\n    resource\n  });\n  const { data, error } = await (0,_better_fetch_fetch__WEBPACK_IMPORTED_MODULE_1__.betterFetch)(tokenEndpoint, {\n    method: \"POST\",\n    body,\n    headers: requestHeaders\n  });\n  if (error) {\n    throw error;\n  }\n  const tokens = getOAuth2Tokens(data);\n  return tokens;\n}\nasync function validateToken(token, jwksEndpoint) {\n  const { data, error } = await (0,_better_fetch_fetch__WEBPACK_IMPORTED_MODULE_1__.betterFetch)(jwksEndpoint, {\n    method: \"GET\",\n    headers: {\n      accept: \"application/json\",\n      \"user-agent\": \"better-auth\"\n    }\n  });\n  if (error) {\n    throw error;\n  }\n  const keys = data[\"keys\"];\n  const header = JSON.parse(atob(token.split(\".\")[0]));\n  const key = keys.find((key2) => key2.kid === header.kid);\n  if (!key) {\n    throw new Error(\"Key not found\");\n  }\n  const verified = await (0,jose__WEBPACK_IMPORTED_MODULE_2__.jwtVerify)(token, key);\n  return verified;\n}\n\nfunction createRefreshAccessTokenRequest({\n  refreshToken,\n  options,\n  authentication,\n  extraParams,\n  resource\n}) {\n  const body = new URLSearchParams();\n  const headers = {\n    \"content-type\": \"application/x-www-form-urlencoded\",\n    accept: \"application/json\"\n  };\n  body.set(\"grant_type\", \"refresh_token\");\n  body.set(\"refresh_token\", refreshToken);\n  if (authentication === \"basic\") {\n    const primaryClientId = Array.isArray(options.clientId) ? options.clientId[0] : options.clientId;\n    if (primaryClientId) {\n      headers[\"authorization\"] = \"Basic \" + _better_auth_utils_base64__WEBPACK_IMPORTED_MODULE_0__.base64.encode(`${primaryClientId}:${options.clientSecret ?? \"\"}`);\n    } else {\n      headers[\"authorization\"] = \"Basic \" + _better_auth_utils_base64__WEBPACK_IMPORTED_MODULE_0__.base64.encode(`:${options.clientSecret ?? \"\"}`);\n    }\n  } else {\n    const primaryClientId = Array.isArray(options.clientId) ? options.clientId[0] : options.clientId;\n    body.set(\"client_id\", primaryClientId);\n    if (options.clientSecret) {\n      body.set(\"client_secret\", options.clientSecret);\n    }\n  }\n  if (resource) {\n    if (typeof resource === \"string\") {\n      body.append(\"resource\", resource);\n    } else {\n      for (const _resource of resource) {\n        body.append(\"resource\", _resource);\n      }\n    }\n  }\n  if (extraParams) {\n    for (const [key, value] of Object.entries(extraParams)) {\n      body.set(key, value);\n    }\n  }\n  return {\n    body,\n    headers\n  };\n}\nasync function refreshAccessToken({\n  refreshToken,\n  options,\n  tokenEndpoint,\n  authentication,\n  extraParams\n}) {\n  const { body, headers } = createRefreshAccessTokenRequest({\n    refreshToken,\n    options,\n    authentication,\n    extraParams\n  });\n  const { data, error } = await (0,_better_fetch_fetch__WEBPACK_IMPORTED_MODULE_1__.betterFetch)(tokenEndpoint, {\n    method: \"POST\",\n    body,\n    headers\n  });\n  if (error) {\n    throw error;\n  }\n  const tokens = {\n    accessToken: data.access_token,\n    refreshToken: data.refresh_token,\n    tokenType: data.token_type,\n    scopes: data.scope?.split(\" \"),\n    idToken: data.id_token\n  };\n  if (data.expires_in) {\n    const now = /* @__PURE__ */ new Date();\n    tokens.accessTokenExpiresAt = new Date(\n      now.getTime() + data.expires_in * 1e3\n    );\n  }\n  return tokens;\n}\n\nfunction createClientCredentialsTokenRequest({\n  options,\n  scope,\n  authentication,\n  resource\n}) {\n  const body = new URLSearchParams();\n  const headers = {\n    \"content-type\": \"application/x-www-form-urlencoded\",\n    accept: \"application/json\"\n  };\n  body.set(\"grant_type\", \"client_credentials\");\n  scope && body.set(\"scope\", scope);\n  if (resource) {\n    if (typeof resource === \"string\") {\n      body.append(\"resource\", resource);\n    } else {\n      for (const _resource of resource) {\n        body.append(\"resource\", _resource);\n      }\n    }\n  }\n  if (authentication === \"basic\") {\n    const primaryClientId = Array.isArray(options.clientId) ? options.clientId[0] : options.clientId;\n    const encodedCredentials = _better_auth_utils_base64__WEBPACK_IMPORTED_MODULE_0__.base64Url.encode(\n      `${primaryClientId}:${options.clientSecret}`\n    );\n    headers[\"authorization\"] = `Basic ${encodedCredentials}`;\n  } else {\n    const primaryClientId = Array.isArray(options.clientId) ? options.clientId[0] : options.clientId;\n    body.set(\"client_id\", primaryClientId);\n    body.set(\"client_secret\", options.clientSecret);\n  }\n  return {\n    body,\n    headers\n  };\n}\nasync function clientCredentialsToken({\n  options,\n  tokenEndpoint,\n  scope,\n  authentication,\n  resource\n}) {\n  const { body, headers } = createClientCredentialsTokenRequest({\n    options,\n    scope,\n    authentication,\n    resource\n  });\n  const { data, error } = await (0,_better_fetch_fetch__WEBPACK_IMPORTED_MODULE_1__.betterFetch)(tokenEndpoint, {\n    method: \"POST\",\n    body,\n    headers\n  });\n  if (error) {\n    throw error;\n  }\n  const tokens = {\n    accessToken: data.access_token,\n    tokenType: data.token_type,\n    scopes: data.scope?.split(\" \")\n  };\n  if (data.expires_in) {\n    const now = /* @__PURE__ */ new Date();\n    tokens.accessTokenExpiresAt = new Date(\n      now.getTime() + data.expires_in * 1e3\n    );\n  }\n  return tokens;\n}\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvQGJldHRlci1hdXRoL2NvcmUvZGlzdC9vYXV0aDIvaW5kZXgubWpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBOEQ7QUFDWjtBQUNqQjs7QUFFakM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTLGdFQUFTO0FBQ2xCO0FBQ0EsR0FBRztBQUNIOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0JBQW9CO0FBQ3BCLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUJBQXVCO0FBQ3ZCO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsK0JBQStCLDZEQUFNO0FBQ3JDLFNBQVMsZ0JBQWdCLEdBQUcsMkJBQTJCO0FBQ3ZEO0FBQ0EsK0NBQStDLG1CQUFtQjtBQUNsRSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHVCQUF1QjtBQUN2QjtBQUNBLENBQUM7QUFDRCxVQUFVLGdDQUFnQztBQUMxQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0gsVUFBVSxjQUFjLFFBQVEsZ0VBQVc7QUFDM0M7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVSxjQUFjLFFBQVEsZ0VBQVc7QUFDM0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5QkFBeUIsK0NBQVM7QUFDbEM7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw0Q0FBNEMsNkRBQU0sV0FBVyxnQkFBZ0IsR0FBRywyQkFBMkI7QUFDM0csTUFBTTtBQUNOLDRDQUE0Qyw2REFBTSxZQUFZLDJCQUEyQjtBQUN6RjtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNELFVBQVUsZ0JBQWdCO0FBQzFCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNILFVBQVUsY0FBYyxRQUFRLGdFQUFXO0FBQzNDO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLCtCQUErQixnRUFBUztBQUN4QyxTQUFTLGdCQUFnQixHQUFHLHFCQUFxQjtBQUNqRDtBQUNBLHdDQUF3QyxtQkFBbUI7QUFDM0QsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRCxVQUFVLGdCQUFnQjtBQUMxQjtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSCxVQUFVLGNBQWMsUUFBUSxnRUFBVztBQUMzQztBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRXNRIiwic291cmNlcyI6WyJDOlxcVXNlcnNcXHNpZDAxXFxPbmVEcml2ZVxcRGVza3RvcFxcYW1kLXRlbGVwaG9ueS1zeXN0ZW1cXGZyb250ZW5kXFxub2RlX21vZHVsZXNcXEBiZXR0ZXItYXV0aFxcY29yZVxcZGlzdFxcb2F1dGgyXFxpbmRleC5tanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgYmFzZTY0VXJsLCBiYXNlNjQgfSBmcm9tICdAYmV0dGVyLWF1dGgvdXRpbHMvYmFzZTY0JztcbmltcG9ydCB7IGJldHRlckZldGNoIH0gZnJvbSAnQGJldHRlci1mZXRjaC9mZXRjaCc7XG5pbXBvcnQgeyBqd3RWZXJpZnkgfSBmcm9tICdqb3NlJztcblxuZnVuY3Rpb24gZ2V0T0F1dGgyVG9rZW5zKGRhdGEpIHtcbiAgY29uc3QgZ2V0RGF0ZSA9IChzZWNvbmRzKSA9PiB7XG4gICAgY29uc3Qgbm93ID0gLyogQF9fUFVSRV9fICovIG5ldyBEYXRlKCk7XG4gICAgcmV0dXJuIG5ldyBEYXRlKG5vdy5nZXRUaW1lKCkgKyBzZWNvbmRzICogMWUzKTtcbiAgfTtcbiAgcmV0dXJuIHtcbiAgICB0b2tlblR5cGU6IGRhdGEudG9rZW5fdHlwZSxcbiAgICBhY2Nlc3NUb2tlbjogZGF0YS5hY2Nlc3NfdG9rZW4sXG4gICAgcmVmcmVzaFRva2VuOiBkYXRhLnJlZnJlc2hfdG9rZW4sXG4gICAgYWNjZXNzVG9rZW5FeHBpcmVzQXQ6IGRhdGEuZXhwaXJlc19pbiA/IGdldERhdGUoZGF0YS5leHBpcmVzX2luKSA6IHZvaWQgMCxcbiAgICByZWZyZXNoVG9rZW5FeHBpcmVzQXQ6IGRhdGEucmVmcmVzaF90b2tlbl9leHBpcmVzX2luID8gZ2V0RGF0ZShkYXRhLnJlZnJlc2hfdG9rZW5fZXhwaXJlc19pbikgOiB2b2lkIDAsXG4gICAgc2NvcGVzOiBkYXRhPy5zY29wZSA/IHR5cGVvZiBkYXRhLnNjb3BlID09PSBcInN0cmluZ1wiID8gZGF0YS5zY29wZS5zcGxpdChcIiBcIikgOiBkYXRhLnNjb3BlIDogW10sXG4gICAgaWRUb2tlbjogZGF0YS5pZF90b2tlblxuICB9O1xufVxuYXN5bmMgZnVuY3Rpb24gZ2VuZXJhdGVDb2RlQ2hhbGxlbmdlKGNvZGVWZXJpZmllcikge1xuICBjb25zdCBlbmNvZGVyID0gbmV3IFRleHRFbmNvZGVyKCk7XG4gIGNvbnN0IGRhdGEgPSBlbmNvZGVyLmVuY29kZShjb2RlVmVyaWZpZXIpO1xuICBjb25zdCBoYXNoID0gYXdhaXQgY3J5cHRvLnN1YnRsZS5kaWdlc3QoXCJTSEEtMjU2XCIsIGRhdGEpO1xuICByZXR1cm4gYmFzZTY0VXJsLmVuY29kZShuZXcgVWludDhBcnJheShoYXNoKSwge1xuICAgIHBhZGRpbmc6IGZhbHNlXG4gIH0pO1xufVxuXG5hc3luYyBmdW5jdGlvbiBjcmVhdGVBdXRob3JpemF0aW9uVVJMKHtcbiAgaWQsXG4gIG9wdGlvbnMsXG4gIGF1dGhvcml6YXRpb25FbmRwb2ludCxcbiAgc3RhdGUsXG4gIGNvZGVWZXJpZmllcixcbiAgc2NvcGVzLFxuICBjbGFpbXMsXG4gIHJlZGlyZWN0VVJJLFxuICBkdXJhdGlvbixcbiAgcHJvbXB0LFxuICBhY2Nlc3NUeXBlLFxuICByZXNwb25zZVR5cGUsXG4gIGRpc3BsYXksXG4gIGxvZ2luSGludCxcbiAgaGQsXG4gIHJlc3BvbnNlTW9kZSxcbiAgYWRkaXRpb25hbFBhcmFtcyxcbiAgc2NvcGVKb2luZXJcbn0pIHtcbiAgY29uc3QgdXJsID0gbmV3IFVSTChhdXRob3JpemF0aW9uRW5kcG9pbnQpO1xuICB1cmwuc2VhcmNoUGFyYW1zLnNldChcInJlc3BvbnNlX3R5cGVcIiwgcmVzcG9uc2VUeXBlIHx8IFwiY29kZVwiKTtcbiAgY29uc3QgcHJpbWFyeUNsaWVudElkID0gQXJyYXkuaXNBcnJheShvcHRpb25zLmNsaWVudElkKSA/IG9wdGlvbnMuY2xpZW50SWRbMF0gOiBvcHRpb25zLmNsaWVudElkO1xuICB1cmwuc2VhcmNoUGFyYW1zLnNldChcImNsaWVudF9pZFwiLCBwcmltYXJ5Q2xpZW50SWQpO1xuICB1cmwuc2VhcmNoUGFyYW1zLnNldChcInN0YXRlXCIsIHN0YXRlKTtcbiAgdXJsLnNlYXJjaFBhcmFtcy5zZXQoXCJzY29wZVwiLCBzY29wZXMuam9pbihzY29wZUpvaW5lciB8fCBcIiBcIikpO1xuICB1cmwuc2VhcmNoUGFyYW1zLnNldChcInJlZGlyZWN0X3VyaVwiLCBvcHRpb25zLnJlZGlyZWN0VVJJIHx8IHJlZGlyZWN0VVJJKTtcbiAgZHVyYXRpb24gJiYgdXJsLnNlYXJjaFBhcmFtcy5zZXQoXCJkdXJhdGlvblwiLCBkdXJhdGlvbik7XG4gIGRpc3BsYXkgJiYgdXJsLnNlYXJjaFBhcmFtcy5zZXQoXCJkaXNwbGF5XCIsIGRpc3BsYXkpO1xuICBsb2dpbkhpbnQgJiYgdXJsLnNlYXJjaFBhcmFtcy5zZXQoXCJsb2dpbl9oaW50XCIsIGxvZ2luSGludCk7XG4gIHByb21wdCAmJiB1cmwuc2VhcmNoUGFyYW1zLnNldChcInByb21wdFwiLCBwcm9tcHQpO1xuICBoZCAmJiB1cmwuc2VhcmNoUGFyYW1zLnNldChcImhkXCIsIGhkKTtcbiAgYWNjZXNzVHlwZSAmJiB1cmwuc2VhcmNoUGFyYW1zLnNldChcImFjY2Vzc190eXBlXCIsIGFjY2Vzc1R5cGUpO1xuICByZXNwb25zZU1vZGUgJiYgdXJsLnNlYXJjaFBhcmFtcy5zZXQoXCJyZXNwb25zZV9tb2RlXCIsIHJlc3BvbnNlTW9kZSk7XG4gIGlmIChjb2RlVmVyaWZpZXIpIHtcbiAgICBjb25zdCBjb2RlQ2hhbGxlbmdlID0gYXdhaXQgZ2VuZXJhdGVDb2RlQ2hhbGxlbmdlKGNvZGVWZXJpZmllcik7XG4gICAgdXJsLnNlYXJjaFBhcmFtcy5zZXQoXCJjb2RlX2NoYWxsZW5nZV9tZXRob2RcIiwgXCJTMjU2XCIpO1xuICAgIHVybC5zZWFyY2hQYXJhbXMuc2V0KFwiY29kZV9jaGFsbGVuZ2VcIiwgY29kZUNoYWxsZW5nZSk7XG4gIH1cbiAgaWYgKGNsYWltcykge1xuICAgIGNvbnN0IGNsYWltc09iaiA9IGNsYWltcy5yZWR1Y2UoXG4gICAgICAoYWNjLCBjbGFpbSkgPT4ge1xuICAgICAgICBhY2NbY2xhaW1dID0gbnVsbDtcbiAgICAgICAgcmV0dXJuIGFjYztcbiAgICAgIH0sXG4gICAgICB7fVxuICAgICk7XG4gICAgdXJsLnNlYXJjaFBhcmFtcy5zZXQoXG4gICAgICBcImNsYWltc1wiLFxuICAgICAgSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICBpZF90b2tlbjogeyBlbWFpbDogbnVsbCwgZW1haWxfdmVyaWZpZWQ6IG51bGwsIC4uLmNsYWltc09iaiB9XG4gICAgICB9KVxuICAgICk7XG4gIH1cbiAgaWYgKGFkZGl0aW9uYWxQYXJhbXMpIHtcbiAgICBPYmplY3QuZW50cmllcyhhZGRpdGlvbmFsUGFyYW1zKS5mb3JFYWNoKChba2V5LCB2YWx1ZV0pID0+IHtcbiAgICAgIHVybC5zZWFyY2hQYXJhbXMuc2V0KGtleSwgdmFsdWUpO1xuICAgIH0pO1xuICB9XG4gIHJldHVybiB1cmw7XG59XG5cbmZ1bmN0aW9uIGNyZWF0ZUF1dGhvcml6YXRpb25Db2RlUmVxdWVzdCh7XG4gIGNvZGUsXG4gIGNvZGVWZXJpZmllcixcbiAgcmVkaXJlY3RVUkksXG4gIG9wdGlvbnMsXG4gIGF1dGhlbnRpY2F0aW9uLFxuICBkZXZpY2VJZCxcbiAgaGVhZGVycyxcbiAgYWRkaXRpb25hbFBhcmFtcyA9IHt9LFxuICByZXNvdXJjZVxufSkge1xuICBjb25zdCBib2R5ID0gbmV3IFVSTFNlYXJjaFBhcmFtcygpO1xuICBjb25zdCByZXF1ZXN0SGVhZGVycyA9IHtcbiAgICBcImNvbnRlbnQtdHlwZVwiOiBcImFwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZFwiLFxuICAgIGFjY2VwdDogXCJhcHBsaWNhdGlvbi9qc29uXCIsXG4gICAgXCJ1c2VyLWFnZW50XCI6IFwiYmV0dGVyLWF1dGhcIixcbiAgICAuLi5oZWFkZXJzXG4gIH07XG4gIGJvZHkuc2V0KFwiZ3JhbnRfdHlwZVwiLCBcImF1dGhvcml6YXRpb25fY29kZVwiKTtcbiAgYm9keS5zZXQoXCJjb2RlXCIsIGNvZGUpO1xuICBjb2RlVmVyaWZpZXIgJiYgYm9keS5zZXQoXCJjb2RlX3ZlcmlmaWVyXCIsIGNvZGVWZXJpZmllcik7XG4gIG9wdGlvbnMuY2xpZW50S2V5ICYmIGJvZHkuc2V0KFwiY2xpZW50X2tleVwiLCBvcHRpb25zLmNsaWVudEtleSk7XG4gIGRldmljZUlkICYmIGJvZHkuc2V0KFwiZGV2aWNlX2lkXCIsIGRldmljZUlkKTtcbiAgYm9keS5zZXQoXCJyZWRpcmVjdF91cmlcIiwgb3B0aW9ucy5yZWRpcmVjdFVSSSB8fCByZWRpcmVjdFVSSSk7XG4gIGlmIChyZXNvdXJjZSkge1xuICAgIGlmICh0eXBlb2YgcmVzb3VyY2UgPT09IFwic3RyaW5nXCIpIHtcbiAgICAgIGJvZHkuYXBwZW5kKFwicmVzb3VyY2VcIiwgcmVzb3VyY2UpO1xuICAgIH0gZWxzZSB7XG4gICAgICBmb3IgKGNvbnN0IF9yZXNvdXJjZSBvZiByZXNvdXJjZSkge1xuICAgICAgICBib2R5LmFwcGVuZChcInJlc291cmNlXCIsIF9yZXNvdXJjZSk7XG4gICAgICB9XG4gICAgfVxuICB9XG4gIGlmIChhdXRoZW50aWNhdGlvbiA9PT0gXCJiYXNpY1wiKSB7XG4gICAgY29uc3QgcHJpbWFyeUNsaWVudElkID0gQXJyYXkuaXNBcnJheShvcHRpb25zLmNsaWVudElkKSA/IG9wdGlvbnMuY2xpZW50SWRbMF0gOiBvcHRpb25zLmNsaWVudElkO1xuICAgIGNvbnN0IGVuY29kZWRDcmVkZW50aWFscyA9IGJhc2U2NC5lbmNvZGUoXG4gICAgICBgJHtwcmltYXJ5Q2xpZW50SWR9OiR7b3B0aW9ucy5jbGllbnRTZWNyZXQgPz8gXCJcIn1gXG4gICAgKTtcbiAgICByZXF1ZXN0SGVhZGVyc1tcImF1dGhvcml6YXRpb25cIl0gPSBgQmFzaWMgJHtlbmNvZGVkQ3JlZGVudGlhbHN9YDtcbiAgfSBlbHNlIHtcbiAgICBjb25zdCBwcmltYXJ5Q2xpZW50SWQgPSBBcnJheS5pc0FycmF5KG9wdGlvbnMuY2xpZW50SWQpID8gb3B0aW9ucy5jbGllbnRJZFswXSA6IG9wdGlvbnMuY2xpZW50SWQ7XG4gICAgYm9keS5zZXQoXCJjbGllbnRfaWRcIiwgcHJpbWFyeUNsaWVudElkKTtcbiAgICBpZiAob3B0aW9ucy5jbGllbnRTZWNyZXQpIHtcbiAgICAgIGJvZHkuc2V0KFwiY2xpZW50X3NlY3JldFwiLCBvcHRpb25zLmNsaWVudFNlY3JldCk7XG4gICAgfVxuICB9XG4gIGZvciAoY29uc3QgW2tleSwgdmFsdWVdIG9mIE9iamVjdC5lbnRyaWVzKGFkZGl0aW9uYWxQYXJhbXMpKSB7XG4gICAgaWYgKCFib2R5LmhhcyhrZXkpKSBib2R5LmFwcGVuZChrZXksIHZhbHVlKTtcbiAgfVxuICByZXR1cm4ge1xuICAgIGJvZHksXG4gICAgaGVhZGVyczogcmVxdWVzdEhlYWRlcnNcbiAgfTtcbn1cbmFzeW5jIGZ1bmN0aW9uIHZhbGlkYXRlQXV0aG9yaXphdGlvbkNvZGUoe1xuICBjb2RlLFxuICBjb2RlVmVyaWZpZXIsXG4gIHJlZGlyZWN0VVJJLFxuICBvcHRpb25zLFxuICB0b2tlbkVuZHBvaW50LFxuICBhdXRoZW50aWNhdGlvbixcbiAgZGV2aWNlSWQsXG4gIGhlYWRlcnMsXG4gIGFkZGl0aW9uYWxQYXJhbXMgPSB7fSxcbiAgcmVzb3VyY2Vcbn0pIHtcbiAgY29uc3QgeyBib2R5LCBoZWFkZXJzOiByZXF1ZXN0SGVhZGVycyB9ID0gY3JlYXRlQXV0aG9yaXphdGlvbkNvZGVSZXF1ZXN0KHtcbiAgICBjb2RlLFxuICAgIGNvZGVWZXJpZmllcixcbiAgICByZWRpcmVjdFVSSSxcbiAgICBvcHRpb25zLFxuICAgIGF1dGhlbnRpY2F0aW9uLFxuICAgIGRldmljZUlkLFxuICAgIGhlYWRlcnMsXG4gICAgYWRkaXRpb25hbFBhcmFtcyxcbiAgICByZXNvdXJjZVxuICB9KTtcbiAgY29uc3QgeyBkYXRhLCBlcnJvciB9ID0gYXdhaXQgYmV0dGVyRmV0Y2godG9rZW5FbmRwb2ludCwge1xuICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgYm9keSxcbiAgICBoZWFkZXJzOiByZXF1ZXN0SGVhZGVyc1xuICB9KTtcbiAgaWYgKGVycm9yKSB7XG4gICAgdGhyb3cgZXJyb3I7XG4gIH1cbiAgY29uc3QgdG9rZW5zID0gZ2V0T0F1dGgyVG9rZW5zKGRhdGEpO1xuICByZXR1cm4gdG9rZW5zO1xufVxuYXN5bmMgZnVuY3Rpb24gdmFsaWRhdGVUb2tlbih0b2tlbiwgandrc0VuZHBvaW50KSB7XG4gIGNvbnN0IHsgZGF0YSwgZXJyb3IgfSA9IGF3YWl0IGJldHRlckZldGNoKGp3a3NFbmRwb2ludCwge1xuICAgIG1ldGhvZDogXCJHRVRcIixcbiAgICBoZWFkZXJzOiB7XG4gICAgICBhY2NlcHQ6IFwiYXBwbGljYXRpb24vanNvblwiLFxuICAgICAgXCJ1c2VyLWFnZW50XCI6IFwiYmV0dGVyLWF1dGhcIlxuICAgIH1cbiAgfSk7XG4gIGlmIChlcnJvcikge1xuICAgIHRocm93IGVycm9yO1xuICB9XG4gIGNvbnN0IGtleXMgPSBkYXRhW1wia2V5c1wiXTtcbiAgY29uc3QgaGVhZGVyID0gSlNPTi5wYXJzZShhdG9iKHRva2VuLnNwbGl0KFwiLlwiKVswXSkpO1xuICBjb25zdCBrZXkgPSBrZXlzLmZpbmQoKGtleTIpID0+IGtleTIua2lkID09PSBoZWFkZXIua2lkKTtcbiAgaWYgKCFrZXkpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoXCJLZXkgbm90IGZvdW5kXCIpO1xuICB9XG4gIGNvbnN0IHZlcmlmaWVkID0gYXdhaXQgand0VmVyaWZ5KHRva2VuLCBrZXkpO1xuICByZXR1cm4gdmVyaWZpZWQ7XG59XG5cbmZ1bmN0aW9uIGNyZWF0ZVJlZnJlc2hBY2Nlc3NUb2tlblJlcXVlc3Qoe1xuICByZWZyZXNoVG9rZW4sXG4gIG9wdGlvbnMsXG4gIGF1dGhlbnRpY2F0aW9uLFxuICBleHRyYVBhcmFtcyxcbiAgcmVzb3VyY2Vcbn0pIHtcbiAgY29uc3QgYm9keSA9IG5ldyBVUkxTZWFyY2hQYXJhbXMoKTtcbiAgY29uc3QgaGVhZGVycyA9IHtcbiAgICBcImNvbnRlbnQtdHlwZVwiOiBcImFwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZFwiLFxuICAgIGFjY2VwdDogXCJhcHBsaWNhdGlvbi9qc29uXCJcbiAgfTtcbiAgYm9keS5zZXQoXCJncmFudF90eXBlXCIsIFwicmVmcmVzaF90b2tlblwiKTtcbiAgYm9keS5zZXQoXCJyZWZyZXNoX3Rva2VuXCIsIHJlZnJlc2hUb2tlbik7XG4gIGlmIChhdXRoZW50aWNhdGlvbiA9PT0gXCJiYXNpY1wiKSB7XG4gICAgY29uc3QgcHJpbWFyeUNsaWVudElkID0gQXJyYXkuaXNBcnJheShvcHRpb25zLmNsaWVudElkKSA/IG9wdGlvbnMuY2xpZW50SWRbMF0gOiBvcHRpb25zLmNsaWVudElkO1xuICAgIGlmIChwcmltYXJ5Q2xpZW50SWQpIHtcbiAgICAgIGhlYWRlcnNbXCJhdXRob3JpemF0aW9uXCJdID0gXCJCYXNpYyBcIiArIGJhc2U2NC5lbmNvZGUoYCR7cHJpbWFyeUNsaWVudElkfToke29wdGlvbnMuY2xpZW50U2VjcmV0ID8/IFwiXCJ9YCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGhlYWRlcnNbXCJhdXRob3JpemF0aW9uXCJdID0gXCJCYXNpYyBcIiArIGJhc2U2NC5lbmNvZGUoYDoke29wdGlvbnMuY2xpZW50U2VjcmV0ID8/IFwiXCJ9YCk7XG4gICAgfVxuICB9IGVsc2Uge1xuICAgIGNvbnN0IHByaW1hcnlDbGllbnRJZCA9IEFycmF5LmlzQXJyYXkob3B0aW9ucy5jbGllbnRJZCkgPyBvcHRpb25zLmNsaWVudElkWzBdIDogb3B0aW9ucy5jbGllbnRJZDtcbiAgICBib2R5LnNldChcImNsaWVudF9pZFwiLCBwcmltYXJ5Q2xpZW50SWQpO1xuICAgIGlmIChvcHRpb25zLmNsaWVudFNlY3JldCkge1xuICAgICAgYm9keS5zZXQoXCJjbGllbnRfc2VjcmV0XCIsIG9wdGlvbnMuY2xpZW50U2VjcmV0KTtcbiAgICB9XG4gIH1cbiAgaWYgKHJlc291cmNlKSB7XG4gICAgaWYgKHR5cGVvZiByZXNvdXJjZSA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgYm9keS5hcHBlbmQoXCJyZXNvdXJjZVwiLCByZXNvdXJjZSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGZvciAoY29uc3QgX3Jlc291cmNlIG9mIHJlc291cmNlKSB7XG4gICAgICAgIGJvZHkuYXBwZW5kKFwicmVzb3VyY2VcIiwgX3Jlc291cmNlKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cbiAgaWYgKGV4dHJhUGFyYW1zKSB7XG4gICAgZm9yIChjb25zdCBba2V5LCB2YWx1ZV0gb2YgT2JqZWN0LmVudHJpZXMoZXh0cmFQYXJhbXMpKSB7XG4gICAgICBib2R5LnNldChrZXksIHZhbHVlKTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIHtcbiAgICBib2R5LFxuICAgIGhlYWRlcnNcbiAgfTtcbn1cbmFzeW5jIGZ1bmN0aW9uIHJlZnJlc2hBY2Nlc3NUb2tlbih7XG4gIHJlZnJlc2hUb2tlbixcbiAgb3B0aW9ucyxcbiAgdG9rZW5FbmRwb2ludCxcbiAgYXV0aGVudGljYXRpb24sXG4gIGV4dHJhUGFyYW1zXG59KSB7XG4gIGNvbnN0IHsgYm9keSwgaGVhZGVycyB9ID0gY3JlYXRlUmVmcmVzaEFjY2Vzc1Rva2VuUmVxdWVzdCh7XG4gICAgcmVmcmVzaFRva2VuLFxuICAgIG9wdGlvbnMsXG4gICAgYXV0aGVudGljYXRpb24sXG4gICAgZXh0cmFQYXJhbXNcbiAgfSk7XG4gIGNvbnN0IHsgZGF0YSwgZXJyb3IgfSA9IGF3YWl0IGJldHRlckZldGNoKHRva2VuRW5kcG9pbnQsIHtcbiAgICBtZXRob2Q6IFwiUE9TVFwiLFxuICAgIGJvZHksXG4gICAgaGVhZGVyc1xuICB9KTtcbiAgaWYgKGVycm9yKSB7XG4gICAgdGhyb3cgZXJyb3I7XG4gIH1cbiAgY29uc3QgdG9rZW5zID0ge1xuICAgIGFjY2Vzc1Rva2VuOiBkYXRhLmFjY2Vzc190b2tlbixcbiAgICByZWZyZXNoVG9rZW46IGRhdGEucmVmcmVzaF90b2tlbixcbiAgICB0b2tlblR5cGU6IGRhdGEudG9rZW5fdHlwZSxcbiAgICBzY29wZXM6IGRhdGEuc2NvcGU/LnNwbGl0KFwiIFwiKSxcbiAgICBpZFRva2VuOiBkYXRhLmlkX3Rva2VuXG4gIH07XG4gIGlmIChkYXRhLmV4cGlyZXNfaW4pIHtcbiAgICBjb25zdCBub3cgPSAvKiBAX19QVVJFX18gKi8gbmV3IERhdGUoKTtcbiAgICB0b2tlbnMuYWNjZXNzVG9rZW5FeHBpcmVzQXQgPSBuZXcgRGF0ZShcbiAgICAgIG5vdy5nZXRUaW1lKCkgKyBkYXRhLmV4cGlyZXNfaW4gKiAxZTNcbiAgICApO1xuICB9XG4gIHJldHVybiB0b2tlbnM7XG59XG5cbmZ1bmN0aW9uIGNyZWF0ZUNsaWVudENyZWRlbnRpYWxzVG9rZW5SZXF1ZXN0KHtcbiAgb3B0aW9ucyxcbiAgc2NvcGUsXG4gIGF1dGhlbnRpY2F0aW9uLFxuICByZXNvdXJjZVxufSkge1xuICBjb25zdCBib2R5ID0gbmV3IFVSTFNlYXJjaFBhcmFtcygpO1xuICBjb25zdCBoZWFkZXJzID0ge1xuICAgIFwiY29udGVudC10eXBlXCI6IFwiYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkXCIsXG4gICAgYWNjZXB0OiBcImFwcGxpY2F0aW9uL2pzb25cIlxuICB9O1xuICBib2R5LnNldChcImdyYW50X3R5cGVcIiwgXCJjbGllbnRfY3JlZGVudGlhbHNcIik7XG4gIHNjb3BlICYmIGJvZHkuc2V0KFwic2NvcGVcIiwgc2NvcGUpO1xuICBpZiAocmVzb3VyY2UpIHtcbiAgICBpZiAodHlwZW9mIHJlc291cmNlID09PSBcInN0cmluZ1wiKSB7XG4gICAgICBib2R5LmFwcGVuZChcInJlc291cmNlXCIsIHJlc291cmNlKTtcbiAgICB9IGVsc2Uge1xuICAgICAgZm9yIChjb25zdCBfcmVzb3VyY2Ugb2YgcmVzb3VyY2UpIHtcbiAgICAgICAgYm9keS5hcHBlbmQoXCJyZXNvdXJjZVwiLCBfcmVzb3VyY2UpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuICBpZiAoYXV0aGVudGljYXRpb24gPT09IFwiYmFzaWNcIikge1xuICAgIGNvbnN0IHByaW1hcnlDbGllbnRJZCA9IEFycmF5LmlzQXJyYXkob3B0aW9ucy5jbGllbnRJZCkgPyBvcHRpb25zLmNsaWVudElkWzBdIDogb3B0aW9ucy5jbGllbnRJZDtcbiAgICBjb25zdCBlbmNvZGVkQ3JlZGVudGlhbHMgPSBiYXNlNjRVcmwuZW5jb2RlKFxuICAgICAgYCR7cHJpbWFyeUNsaWVudElkfToke29wdGlvbnMuY2xpZW50U2VjcmV0fWBcbiAgICApO1xuICAgIGhlYWRlcnNbXCJhdXRob3JpemF0aW9uXCJdID0gYEJhc2ljICR7ZW5jb2RlZENyZWRlbnRpYWxzfWA7XG4gIH0gZWxzZSB7XG4gICAgY29uc3QgcHJpbWFyeUNsaWVudElkID0gQXJyYXkuaXNBcnJheShvcHRpb25zLmNsaWVudElkKSA/IG9wdGlvbnMuY2xpZW50SWRbMF0gOiBvcHRpb25zLmNsaWVudElkO1xuICAgIGJvZHkuc2V0KFwiY2xpZW50X2lkXCIsIHByaW1hcnlDbGllbnRJZCk7XG4gICAgYm9keS5zZXQoXCJjbGllbnRfc2VjcmV0XCIsIG9wdGlvbnMuY2xpZW50U2VjcmV0KTtcbiAgfVxuICByZXR1cm4ge1xuICAgIGJvZHksXG4gICAgaGVhZGVyc1xuICB9O1xufVxuYXN5bmMgZnVuY3Rpb24gY2xpZW50Q3JlZGVudGlhbHNUb2tlbih7XG4gIG9wdGlvbnMsXG4gIHRva2VuRW5kcG9pbnQsXG4gIHNjb3BlLFxuICBhdXRoZW50aWNhdGlvbixcbiAgcmVzb3VyY2Vcbn0pIHtcbiAgY29uc3QgeyBib2R5LCBoZWFkZXJzIH0gPSBjcmVhdGVDbGllbnRDcmVkZW50aWFsc1Rva2VuUmVxdWVzdCh7XG4gICAgb3B0aW9ucyxcbiAgICBzY29wZSxcbiAgICBhdXRoZW50aWNhdGlvbixcbiAgICByZXNvdXJjZVxuICB9KTtcbiAgY29uc3QgeyBkYXRhLCBlcnJvciB9ID0gYXdhaXQgYmV0dGVyRmV0Y2godG9rZW5FbmRwb2ludCwge1xuICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgYm9keSxcbiAgICBoZWFkZXJzXG4gIH0pO1xuICBpZiAoZXJyb3IpIHtcbiAgICB0aHJvdyBlcnJvcjtcbiAgfVxuICBjb25zdCB0b2tlbnMgPSB7XG4gICAgYWNjZXNzVG9rZW46IGRhdGEuYWNjZXNzX3Rva2VuLFxuICAgIHRva2VuVHlwZTogZGF0YS50b2tlbl90eXBlLFxuICAgIHNjb3BlczogZGF0YS5zY29wZT8uc3BsaXQoXCIgXCIpXG4gIH07XG4gIGlmIChkYXRhLmV4cGlyZXNfaW4pIHtcbiAgICBjb25zdCBub3cgPSAvKiBAX19QVVJFX18gKi8gbmV3IERhdGUoKTtcbiAgICB0b2tlbnMuYWNjZXNzVG9rZW5FeHBpcmVzQXQgPSBuZXcgRGF0ZShcbiAgICAgIG5vdy5nZXRUaW1lKCkgKyBkYXRhLmV4cGlyZXNfaW4gKiAxZTNcbiAgICApO1xuICB9XG4gIHJldHVybiB0b2tlbnM7XG59XG5cbmV4cG9ydCB7IGNsaWVudENyZWRlbnRpYWxzVG9rZW4sIGNyZWF0ZUF1dGhvcml6YXRpb25Db2RlUmVxdWVzdCwgY3JlYXRlQXV0aG9yaXphdGlvblVSTCwgY3JlYXRlQ2xpZW50Q3JlZGVudGlhbHNUb2tlblJlcXVlc3QsIGNyZWF0ZVJlZnJlc2hBY2Nlc3NUb2tlblJlcXVlc3QsIGdlbmVyYXRlQ29kZUNoYWxsZW5nZSwgZ2V0T0F1dGgyVG9rZW5zLCByZWZyZXNoQWNjZXNzVG9rZW4sIHZhbGlkYXRlQXV0aG9yaXphdGlvbkNvZGUsIHZhbGlkYXRlVG9rZW4gfTtcbiJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOlswXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/@better-auth/core/dist/oauth2/index.mjs\n");

/***/ }),

/***/ "(rsc)/./node_modules/@better-auth/core/dist/social-providers/index.mjs":
/*!************************************************************************!*\
  !*** ./node_modules/@better-auth/core/dist/social-providers/index.mjs ***!
  \************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   SocialProviderListEnum: () => (/* binding */ SocialProviderListEnum),\n/* harmony export */   apple: () => (/* binding */ apple),\n/* harmony export */   atlassian: () => (/* binding */ atlassian),\n/* harmony export */   cognito: () => (/* binding */ cognito),\n/* harmony export */   discord: () => (/* binding */ discord),\n/* harmony export */   dropbox: () => (/* binding */ dropbox),\n/* harmony export */   facebook: () => (/* binding */ facebook),\n/* harmony export */   figma: () => (/* binding */ figma),\n/* harmony export */   getApplePublicKey: () => (/* binding */ getApplePublicKey),\n/* harmony export */   getCognitoPublicKey: () => (/* binding */ getCognitoPublicKey),\n/* harmony export */   github: () => (/* binding */ github),\n/* harmony export */   gitlab: () => (/* binding */ gitlab),\n/* harmony export */   google: () => (/* binding */ google),\n/* harmony export */   huggingface: () => (/* binding */ huggingface),\n/* harmony export */   kakao: () => (/* binding */ kakao),\n/* harmony export */   kick: () => (/* binding */ kick),\n/* harmony export */   line: () => (/* binding */ line),\n/* harmony export */   linear: () => (/* binding */ linear),\n/* harmony export */   linkedin: () => (/* binding */ linkedin),\n/* harmony export */   microsoft: () => (/* binding */ microsoft),\n/* harmony export */   naver: () => (/* binding */ naver),\n/* harmony export */   notion: () => (/* binding */ notion),\n/* harmony export */   paypal: () => (/* binding */ paypal),\n/* harmony export */   reddit: () => (/* binding */ reddit),\n/* harmony export */   roblox: () => (/* binding */ roblox),\n/* harmony export */   salesforce: () => (/* binding */ salesforce),\n/* harmony export */   slack: () => (/* binding */ slack),\n/* harmony export */   socialProviderList: () => (/* binding */ socialProviderList),\n/* harmony export */   socialProviders: () => (/* binding */ socialProviders),\n/* harmony export */   spotify: () => (/* binding */ spotify),\n/* harmony export */   tiktok: () => (/* binding */ tiktok),\n/* harmony export */   twitch: () => (/* binding */ twitch),\n/* harmony export */   twitter: () => (/* binding */ twitter),\n/* harmony export */   vk: () => (/* binding */ vk),\n/* harmony export */   zoom: () => (/* binding */ zoom)\n/* harmony export */ });\n/* harmony import */ var zod__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! zod */ \"(rsc)/./node_modules/zod/v4/classic/external.js\");\n/* harmony import */ var _better_fetch_fetch__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @better-fetch/fetch */ \"(rsc)/./node_modules/@better-fetch/fetch/dist/index.js\");\n/* harmony import */ var better_call__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! better-call */ \"(rsc)/./node_modules/better-call/dist/index.js\");\n/* harmony import */ var jose__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! jose */ \"(rsc)/./node_modules/jose/dist/webapi/util/decode_protected_header.js\");\n/* harmony import */ var jose__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! jose */ \"(rsc)/./node_modules/jose/dist/webapi/jwt/verify.js\");\n/* harmony import */ var jose__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! jose */ \"(rsc)/./node_modules/jose/dist/webapi/util/decode_jwt.js\");\n/* harmony import */ var jose__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! jose */ \"(rsc)/./node_modules/jose/dist/webapi/key/import.js\");\n/* harmony import */ var jose__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! jose */ \"(rsc)/./node_modules/jose/dist/webapi/jwks/remote.js\");\n/* harmony import */ var _better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @better-auth/core/oauth2 */ \"(rsc)/./node_modules/@better-auth/core/dist/oauth2/index.mjs\");\n/* harmony import */ var _error_index_mjs__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../error/index.mjs */ \"(rsc)/./node_modules/@better-auth/core/dist/error/index.mjs\");\n/* harmony import */ var _better_auth_core_env__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @better-auth/core/env */ \"(rsc)/./node_modules/@better-auth/core/dist/env/index.mjs\");\n/* harmony import */ var _better_auth_utils_base64__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @better-auth/utils/base64 */ \"(rsc)/./node_modules/@better-auth/utils/dist/base64.mjs\");\n/* harmony import */ var _better_auth_core_utils__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @better-auth/core/utils */ \"(rsc)/./node_modules/@better-auth/core/dist/utils/index.mjs\");\n\n\n\n\n\n\n\n\n\n\nconst apple = (options) => {\n  const tokenEndpoint = \"https://appleid.apple.com/auth/token\";\n  return {\n    id: \"apple\",\n    name: \"Apple\",\n    async createAuthorizationURL({ state, scopes, redirectURI }) {\n      const _scope = options.disableDefaultScope ? [] : [\"email\", \"name\"];\n      options.scope && _scope.push(...options.scope);\n      scopes && _scope.push(...scopes);\n      const url = await (0,_better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.createAuthorizationURL)({\n        id: \"apple\",\n        options,\n        authorizationEndpoint: \"https://appleid.apple.com/auth/authorize\",\n        scopes: _scope,\n        state,\n        redirectURI,\n        responseMode: \"form_post\",\n        responseType: \"code id_token\"\n      });\n      return url;\n    },\n    validateAuthorizationCode: async ({ code, codeVerifier, redirectURI }) => {\n      return (0,_better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.validateAuthorizationCode)({\n        code,\n        codeVerifier,\n        redirectURI,\n        options,\n        tokenEndpoint\n      });\n    },\n    async verifyIdToken(token, nonce) {\n      if (options.disableIdTokenSignIn) {\n        return false;\n      }\n      if (options.verifyIdToken) {\n        return options.verifyIdToken(token, nonce);\n      }\n      const decodedHeader = (0,jose__WEBPACK_IMPORTED_MODULE_7__.decodeProtectedHeader)(token);\n      const { kid, alg: jwtAlg } = decodedHeader;\n      if (!kid || !jwtAlg) return false;\n      const publicKey = await getApplePublicKey(kid);\n      const { payload: jwtClaims } = await (0,jose__WEBPACK_IMPORTED_MODULE_8__.jwtVerify)(token, publicKey, {\n        algorithms: [jwtAlg],\n        issuer: \"https://appleid.apple.com\",\n        audience: options.audience && options.audience.length ? options.audience : options.appBundleIdentifier ? options.appBundleIdentifier : options.clientId,\n        maxTokenAge: \"1h\"\n      });\n      [\"email_verified\", \"is_private_email\"].forEach((field) => {\n        if (jwtClaims[field] !== void 0) {\n          jwtClaims[field] = Boolean(jwtClaims[field]);\n        }\n      });\n      if (nonce && jwtClaims.nonce !== nonce) {\n        return false;\n      }\n      return !!jwtClaims;\n    },\n    refreshAccessToken: options.refreshAccessToken ? options.refreshAccessToken : async (refreshToken) => {\n      return (0,_better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.refreshAccessToken)({\n        refreshToken,\n        options: {\n          clientId: options.clientId,\n          clientKey: options.clientKey,\n          clientSecret: options.clientSecret\n        },\n        tokenEndpoint: \"https://appleid.apple.com/auth/token\"\n      });\n    },\n    async getUserInfo(token) {\n      if (options.getUserInfo) {\n        return options.getUserInfo(token);\n      }\n      if (!token.idToken) {\n        return null;\n      }\n      const profile = (0,jose__WEBPACK_IMPORTED_MODULE_9__.decodeJwt)(token.idToken);\n      if (!profile) {\n        return null;\n      }\n      const name = token.user ? `${token.user.name?.firstName} ${token.user.name?.lastName}` : profile.name || profile.email;\n      const emailVerified = typeof profile.email_verified === \"boolean\" ? profile.email_verified : profile.email_verified === \"true\";\n      const enrichedProfile = {\n        ...profile,\n        name\n      };\n      const userMap = await options.mapProfileToUser?.(enrichedProfile);\n      return {\n        user: {\n          id: profile.sub,\n          name: enrichedProfile.name,\n          emailVerified,\n          email: profile.email,\n          ...userMap\n        },\n        data: enrichedProfile\n      };\n    },\n    options\n  };\n};\nconst getApplePublicKey = async (kid) => {\n  const APPLE_BASE_URL = \"https://appleid.apple.com\";\n  const JWKS_APPLE_URI = \"/auth/keys\";\n  const { data } = await (0,_better_fetch_fetch__WEBPACK_IMPORTED_MODULE_0__.betterFetch)(`${APPLE_BASE_URL}${JWKS_APPLE_URI}`);\n  if (!data?.keys) {\n    throw new better_call__WEBPACK_IMPORTED_MODULE_1__.APIError(\"BAD_REQUEST\", {\n      message: \"Keys not found\"\n    });\n  }\n  const jwk = data.keys.find((key) => key.kid === kid);\n  if (!jwk) {\n    throw new Error(`JWK with kid ${kid} not found`);\n  }\n  return await (0,jose__WEBPACK_IMPORTED_MODULE_10__.importJWK)(jwk, jwk.alg);\n};\n\nconst atlassian = (options) => {\n  return {\n    id: \"atlassian\",\n    name: \"Atlassian\",\n    async createAuthorizationURL({ state, scopes, codeVerifier, redirectURI }) {\n      if (!options.clientId || !options.clientSecret) {\n        _better_auth_core_env__WEBPACK_IMPORTED_MODULE_4__.logger.error(\"Client Id and Secret are required for Atlassian\");\n        throw new _error_index_mjs__WEBPACK_IMPORTED_MODULE_3__.BetterAuthError(\"CLIENT_ID_AND_SECRET_REQUIRED\");\n      }\n      if (!codeVerifier) {\n        throw new _error_index_mjs__WEBPACK_IMPORTED_MODULE_3__.BetterAuthError(\"codeVerifier is required for Atlassian\");\n      }\n      const _scopes = options.disableDefaultScope ? [] : [\"read:jira-user\", \"offline_access\"];\n      options.scope && _scopes.push(...options.scope);\n      scopes && _scopes.push(...scopes);\n      return (0,_better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.createAuthorizationURL)({\n        id: \"atlassian\",\n        options,\n        authorizationEndpoint: \"https://auth.atlassian.com/authorize\",\n        scopes: _scopes,\n        state,\n        codeVerifier,\n        redirectURI,\n        additionalParams: {\n          audience: \"api.atlassian.com\"\n        },\n        prompt: options.prompt\n      });\n    },\n    validateAuthorizationCode: async ({ code, codeVerifier, redirectURI }) => {\n      return (0,_better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.validateAuthorizationCode)({\n        code,\n        codeVerifier,\n        redirectURI,\n        options,\n        tokenEndpoint: \"https://auth.atlassian.com/oauth/token\"\n      });\n    },\n    refreshAccessToken: options.refreshAccessToken ? options.refreshAccessToken : async (refreshToken) => {\n      return (0,_better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.refreshAccessToken)({\n        refreshToken,\n        options: {\n          clientId: options.clientId,\n          clientSecret: options.clientSecret\n        },\n        tokenEndpoint: \"https://auth.atlassian.com/oauth/token\"\n      });\n    },\n    async getUserInfo(token) {\n      if (options.getUserInfo) {\n        return options.getUserInfo(token);\n      }\n      if (!token.accessToken) {\n        return null;\n      }\n      try {\n        const { data: profile } = await (0,_better_fetch_fetch__WEBPACK_IMPORTED_MODULE_0__.betterFetch)(\"https://api.atlassian.com/me\", {\n          headers: { Authorization: `Bearer ${token.accessToken}` }\n        });\n        if (!profile) return null;\n        const userMap = await options.mapProfileToUser?.(profile);\n        return {\n          user: {\n            id: profile.account_id,\n            name: profile.name,\n            email: profile.email,\n            image: profile.picture,\n            emailVerified: false,\n            ...userMap\n          },\n          data: profile\n        };\n      } catch (error) {\n        _better_auth_core_env__WEBPACK_IMPORTED_MODULE_4__.logger.error(\"Failed to fetch user info from Figma:\", error);\n        return null;\n      }\n    },\n    options\n  };\n};\n\nconst cognito = (options) => {\n  if (!options.domain || !options.region || !options.userPoolId) {\n    _better_auth_core_env__WEBPACK_IMPORTED_MODULE_4__.logger.error(\n      \"Domain, region and userPoolId are required for Amazon Cognito. Make sure to provide them in the options.\"\n    );\n    throw new _error_index_mjs__WEBPACK_IMPORTED_MODULE_3__.BetterAuthError(\"DOMAIN_AND_REGION_REQUIRED\");\n  }\n  const cleanDomain = options.domain.replace(/^https?:\\/\\//, \"\");\n  const authorizationEndpoint = `https://${cleanDomain}/oauth2/authorize`;\n  const tokenEndpoint = `https://${cleanDomain}/oauth2/token`;\n  const userInfoEndpoint = `https://${cleanDomain}/oauth2/userinfo`;\n  return {\n    id: \"cognito\",\n    name: \"Cognito\",\n    async createAuthorizationURL({ state, scopes, codeVerifier, redirectURI }) {\n      if (!options.clientId) {\n        _better_auth_core_env__WEBPACK_IMPORTED_MODULE_4__.logger.error(\n          \"ClientId is required for Amazon Cognito. Make sure to provide them in the options.\"\n        );\n        throw new _error_index_mjs__WEBPACK_IMPORTED_MODULE_3__.BetterAuthError(\"CLIENT_ID_AND_SECRET_REQUIRED\");\n      }\n      if (options.requireClientSecret && !options.clientSecret) {\n        _better_auth_core_env__WEBPACK_IMPORTED_MODULE_4__.logger.error(\n          \"Client Secret is required when requireClientSecret is true. Make sure to provide it in the options.\"\n        );\n        throw new _error_index_mjs__WEBPACK_IMPORTED_MODULE_3__.BetterAuthError(\"CLIENT_SECRET_REQUIRED\");\n      }\n      const _scopes = options.disableDefaultScope ? [] : [\"openid\", \"profile\", \"email\"];\n      options.scope && _scopes.push(...options.scope);\n      scopes && _scopes.push(...scopes);\n      const url = await (0,_better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.createAuthorizationURL)({\n        id: \"cognito\",\n        options: {\n          ...options\n        },\n        authorizationEndpoint,\n        scopes: _scopes,\n        state,\n        codeVerifier,\n        redirectURI,\n        prompt: options.prompt\n      });\n      return url;\n    },\n    validateAuthorizationCode: async ({ code, codeVerifier, redirectURI }) => {\n      return (0,_better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.validateAuthorizationCode)({\n        code,\n        codeVerifier,\n        redirectURI,\n        options,\n        tokenEndpoint\n      });\n    },\n    refreshAccessToken: options.refreshAccessToken ? options.refreshAccessToken : async (refreshToken) => {\n      return (0,_better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.refreshAccessToken)({\n        refreshToken,\n        options: {\n          clientId: options.clientId,\n          clientKey: options.clientKey,\n          clientSecret: options.clientSecret\n        },\n        tokenEndpoint\n      });\n    },\n    async verifyIdToken(token, nonce) {\n      if (options.disableIdTokenSignIn) {\n        return false;\n      }\n      if (options.verifyIdToken) {\n        return options.verifyIdToken(token, nonce);\n      }\n      try {\n        const decodedHeader = (0,jose__WEBPACK_IMPORTED_MODULE_7__.decodeProtectedHeader)(token);\n        const { kid, alg: jwtAlg } = decodedHeader;\n        if (!kid || !jwtAlg) return false;\n        const publicKey = await getCognitoPublicKey(\n          kid,\n          options.region,\n          options.userPoolId\n        );\n        const expectedIssuer = `https://cognito-idp.${options.region}.amazonaws.com/${options.userPoolId}`;\n        const { payload: jwtClaims } = await (0,jose__WEBPACK_IMPORTED_MODULE_8__.jwtVerify)(token, publicKey, {\n          algorithms: [jwtAlg],\n          issuer: expectedIssuer,\n          audience: options.clientId,\n          maxTokenAge: \"1h\"\n        });\n        if (nonce && jwtClaims.nonce !== nonce) {\n          return false;\n        }\n        return true;\n      } catch (error) {\n        _better_auth_core_env__WEBPACK_IMPORTED_MODULE_4__.logger.error(\"Failed to verify ID token:\", error);\n        return false;\n      }\n    },\n    async getUserInfo(token) {\n      if (options.getUserInfo) {\n        return options.getUserInfo(token);\n      }\n      if (token.idToken) {\n        try {\n          const profile = (0,jose__WEBPACK_IMPORTED_MODULE_9__.decodeJwt)(token.idToken);\n          if (!profile) {\n            return null;\n          }\n          const name = profile.name || profile.given_name || profile.username || profile.email;\n          const enrichedProfile = {\n            ...profile,\n            name\n          };\n          const userMap = await options.mapProfileToUser?.(enrichedProfile);\n          return {\n            user: {\n              id: profile.sub,\n              name: enrichedProfile.name,\n              email: profile.email,\n              image: profile.picture,\n              emailVerified: profile.email_verified,\n              ...userMap\n            },\n            data: enrichedProfile\n          };\n        } catch (error) {\n          _better_auth_core_env__WEBPACK_IMPORTED_MODULE_4__.logger.error(\"Failed to decode ID token:\", error);\n        }\n      }\n      if (token.accessToken) {\n        try {\n          const { data: userInfo } = await (0,_better_fetch_fetch__WEBPACK_IMPORTED_MODULE_0__.betterFetch)(\n            userInfoEndpoint,\n            {\n              headers: {\n                Authorization: `Bearer ${token.accessToken}`\n              }\n            }\n          );\n          if (userInfo) {\n            const userMap = await options.mapProfileToUser?.(userInfo);\n            return {\n              user: {\n                id: userInfo.sub,\n                name: userInfo.name || userInfo.given_name || userInfo.username,\n                email: userInfo.email,\n                image: userInfo.picture,\n                emailVerified: userInfo.email_verified,\n                ...userMap\n              },\n              data: userInfo\n            };\n          }\n        } catch (error) {\n          _better_auth_core_env__WEBPACK_IMPORTED_MODULE_4__.logger.error(\"Failed to fetch user info from Cognito:\", error);\n        }\n      }\n      return null;\n    },\n    options\n  };\n};\nconst getCognitoPublicKey = async (kid, region, userPoolId) => {\n  const COGNITO_JWKS_URI = `https://cognito-idp.${region}.amazonaws.com/${userPoolId}/.well-known/jwks.json`;\n  try {\n    const { data } = await (0,_better_fetch_fetch__WEBPACK_IMPORTED_MODULE_0__.betterFetch)(COGNITO_JWKS_URI);\n    if (!data?.keys) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_1__.APIError(\"BAD_REQUEST\", {\n        message: \"Keys not found\"\n      });\n    }\n    const jwk = data.keys.find((key) => key.kid === kid);\n    if (!jwk) {\n      throw new Error(`JWK with kid ${kid} not found`);\n    }\n    return await (0,jose__WEBPACK_IMPORTED_MODULE_10__.importJWK)(jwk, jwk.alg);\n  } catch (error) {\n    _better_auth_core_env__WEBPACK_IMPORTED_MODULE_4__.logger.error(\"Failed to fetch Cognito public key:\", error);\n    throw error;\n  }\n};\n\nconst discord = (options) => {\n  return {\n    id: \"discord\",\n    name: \"Discord\",\n    createAuthorizationURL({ state, scopes, redirectURI }) {\n      const _scopes = options.disableDefaultScope ? [] : [\"identify\", \"email\"];\n      scopes && _scopes.push(...scopes);\n      options.scope && _scopes.push(...options.scope);\n      const hasBotScope = _scopes.includes(\"bot\");\n      const permissionsParam = hasBotScope && options.permissions !== void 0 ? `&permissions=${options.permissions}` : \"\";\n      return new URL(\n        `https://discord.com/api/oauth2/authorize?scope=${_scopes.join(\n          \"+\"\n        )}&response_type=code&client_id=${options.clientId}&redirect_uri=${encodeURIComponent(\n          options.redirectURI || redirectURI\n        )}&state=${state}&prompt=${options.prompt || \"none\"}${permissionsParam}`\n      );\n    },\n    validateAuthorizationCode: async ({ code, redirectURI }) => {\n      return (0,_better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.validateAuthorizationCode)({\n        code,\n        redirectURI,\n        options,\n        tokenEndpoint: \"https://discord.com/api/oauth2/token\"\n      });\n    },\n    refreshAccessToken: options.refreshAccessToken ? options.refreshAccessToken : async (refreshToken) => {\n      return (0,_better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.refreshAccessToken)({\n        refreshToken,\n        options: {\n          clientId: options.clientId,\n          clientKey: options.clientKey,\n          clientSecret: options.clientSecret\n        },\n        tokenEndpoint: \"https://discord.com/api/oauth2/token\"\n      });\n    },\n    async getUserInfo(token) {\n      if (options.getUserInfo) {\n        return options.getUserInfo(token);\n      }\n      const { data: profile, error } = await (0,_better_fetch_fetch__WEBPACK_IMPORTED_MODULE_0__.betterFetch)(\n        \"https://discord.com/api/users/@me\",\n        {\n          headers: {\n            authorization: `Bearer ${token.accessToken}`\n          }\n        }\n      );\n      if (error) {\n        return null;\n      }\n      if (profile.avatar === null) {\n        const defaultAvatarNumber = profile.discriminator === \"0\" ? Number(BigInt(profile.id) >> BigInt(22)) % 6 : parseInt(profile.discriminator) % 5;\n        profile.image_url = `https://cdn.discordapp.com/embed/avatars/${defaultAvatarNumber}.png`;\n      } else {\n        const format = profile.avatar.startsWith(\"a_\") ? \"gif\" : \"png\";\n        profile.image_url = `https://cdn.discordapp.com/avatars/${profile.id}/${profile.avatar}.${format}`;\n      }\n      const userMap = await options.mapProfileToUser?.(profile);\n      return {\n        user: {\n          id: profile.id,\n          name: profile.global_name || profile.username || \"\",\n          email: profile.email,\n          emailVerified: profile.verified,\n          image: profile.image_url,\n          ...userMap\n        },\n        data: profile\n      };\n    },\n    options\n  };\n};\n\nconst facebook = (options) => {\n  return {\n    id: \"facebook\",\n    name: \"Facebook\",\n    async createAuthorizationURL({ state, scopes, redirectURI, loginHint }) {\n      const _scopes = options.disableDefaultScope ? [] : [\"email\", \"public_profile\"];\n      options.scope && _scopes.push(...options.scope);\n      scopes && _scopes.push(...scopes);\n      return await (0,_better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.createAuthorizationURL)({\n        id: \"facebook\",\n        options,\n        authorizationEndpoint: \"https://www.facebook.com/v21.0/dialog/oauth\",\n        scopes: _scopes,\n        state,\n        redirectURI,\n        loginHint,\n        additionalParams: options.configId ? {\n          config_id: options.configId\n        } : {}\n      });\n    },\n    validateAuthorizationCode: async ({ code, redirectURI }) => {\n      return (0,_better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.validateAuthorizationCode)({\n        code,\n        redirectURI,\n        options,\n        tokenEndpoint: \"https://graph.facebook.com/oauth/access_token\"\n      });\n    },\n    async verifyIdToken(token, nonce) {\n      if (options.disableIdTokenSignIn) {\n        return false;\n      }\n      if (options.verifyIdToken) {\n        return options.verifyIdToken(token, nonce);\n      }\n      if (token.split(\".\").length === 3) {\n        try {\n          const { payload: jwtClaims } = await (0,jose__WEBPACK_IMPORTED_MODULE_8__.jwtVerify)(\n            token,\n            (0,jose__WEBPACK_IMPORTED_MODULE_11__.createRemoteJWKSet)(\n              // https://developers.facebook.com/docs/facebook-login/limited-login/token/#jwks\n              new URL(\n                \"https://limited.facebook.com/.well-known/oauth/openid/jwks/\"\n              )\n            ),\n            {\n              algorithms: [\"RS256\"],\n              audience: options.clientId,\n              issuer: \"https://www.facebook.com\"\n            }\n          );\n          if (nonce && jwtClaims.nonce !== nonce) {\n            return false;\n          }\n          return !!jwtClaims;\n        } catch (error) {\n          return false;\n        }\n      }\n      return true;\n    },\n    refreshAccessToken: options.refreshAccessToken ? options.refreshAccessToken : async (refreshToken) => {\n      return (0,_better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.refreshAccessToken)({\n        refreshToken,\n        options: {\n          clientId: options.clientId,\n          clientKey: options.clientKey,\n          clientSecret: options.clientSecret\n        },\n        tokenEndpoint: \"https://graph.facebook.com/v18.0/oauth/access_token\"\n      });\n    },\n    async getUserInfo(token) {\n      if (options.getUserInfo) {\n        return options.getUserInfo(token);\n      }\n      if (token.idToken && token.idToken.split(\".\").length === 3) {\n        const profile2 = (0,jose__WEBPACK_IMPORTED_MODULE_9__.decodeJwt)(token.idToken);\n        const user = {\n          id: profile2.sub,\n          name: profile2.name,\n          email: profile2.email,\n          picture: {\n            data: {\n              url: profile2.picture,\n              height: 100,\n              width: 100,\n              is_silhouette: false\n            }\n          }\n        };\n        const userMap2 = await options.mapProfileToUser?.({\n          ...user,\n          email_verified: true\n        });\n        return {\n          user: {\n            ...user,\n            emailVerified: true,\n            ...userMap2\n          },\n          data: profile2\n        };\n      }\n      const fields = [\n        \"id\",\n        \"name\",\n        \"email\",\n        \"picture\",\n        ...options?.fields || []\n      ];\n      const { data: profile, error } = await (0,_better_fetch_fetch__WEBPACK_IMPORTED_MODULE_0__.betterFetch)(\n        \"https://graph.facebook.com/me?fields=\" + fields.join(\",\"),\n        {\n          auth: {\n            type: \"Bearer\",\n            token: token.accessToken\n          }\n        }\n      );\n      if (error) {\n        return null;\n      }\n      const userMap = await options.mapProfileToUser?.(profile);\n      return {\n        user: {\n          id: profile.id,\n          name: profile.name,\n          email: profile.email,\n          image: profile.picture.data.url,\n          emailVerified: profile.email_verified,\n          ...userMap\n        },\n        data: profile\n      };\n    },\n    options\n  };\n};\n\nconst figma = (options) => {\n  return {\n    id: \"figma\",\n    name: \"Figma\",\n    async createAuthorizationURL({ state, scopes, codeVerifier, redirectURI }) {\n      if (!options.clientId || !options.clientSecret) {\n        _better_auth_core_env__WEBPACK_IMPORTED_MODULE_4__.logger.error(\n          \"Client Id and Client Secret are required for Figma. Make sure to provide them in the options.\"\n        );\n        throw new _error_index_mjs__WEBPACK_IMPORTED_MODULE_3__.BetterAuthError(\"CLIENT_ID_AND_SECRET_REQUIRED\");\n      }\n      if (!codeVerifier) {\n        throw new _error_index_mjs__WEBPACK_IMPORTED_MODULE_3__.BetterAuthError(\"codeVerifier is required for Figma\");\n      }\n      const _scopes = options.disableDefaultScope ? [] : [\"file_read\"];\n      options.scope && _scopes.push(...options.scope);\n      scopes && _scopes.push(...scopes);\n      const url = await (0,_better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.createAuthorizationURL)({\n        id: \"figma\",\n        options,\n        authorizationEndpoint: \"https://www.figma.com/oauth\",\n        scopes: _scopes,\n        state,\n        codeVerifier,\n        redirectURI\n      });\n      return url;\n    },\n    validateAuthorizationCode: async ({ code, codeVerifier, redirectURI }) => {\n      return (0,_better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.validateAuthorizationCode)({\n        code,\n        codeVerifier,\n        redirectURI,\n        options,\n        tokenEndpoint: \"https://www.figma.com/api/oauth/token\"\n      });\n    },\n    refreshAccessToken: options.refreshAccessToken ? options.refreshAccessToken : async (refreshToken) => {\n      return (0,_better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.refreshAccessToken)({\n        refreshToken,\n        options: {\n          clientId: options.clientId,\n          clientKey: options.clientKey,\n          clientSecret: options.clientSecret\n        },\n        tokenEndpoint: \"https://www.figma.com/api/oauth/token\"\n      });\n    },\n    async getUserInfo(token) {\n      if (options.getUserInfo) {\n        return options.getUserInfo(token);\n      }\n      try {\n        const { data: profile } = await (0,_better_fetch_fetch__WEBPACK_IMPORTED_MODULE_0__.betterFetch)(\n          \"https://api.figma.com/v1/me\",\n          {\n            headers: {\n              Authorization: `Bearer ${token.accessToken}`\n            }\n          }\n        );\n        if (!profile) {\n          _better_auth_core_env__WEBPACK_IMPORTED_MODULE_4__.logger.error(\"Failed to fetch user from Figma\");\n          return null;\n        }\n        const userMap = await options.mapProfileToUser?.(profile);\n        return {\n          user: {\n            id: profile.id,\n            name: profile.handle,\n            email: profile.email,\n            image: profile.img_url,\n            emailVerified: !!profile.email,\n            ...userMap\n          },\n          data: profile\n        };\n      } catch (error) {\n        _better_auth_core_env__WEBPACK_IMPORTED_MODULE_4__.logger.error(\"Failed to fetch user info from Figma:\", error);\n        return null;\n      }\n    },\n    options\n  };\n};\n\nconst github = (options) => {\n  const tokenEndpoint = \"https://github.com/login/oauth/access_token\";\n  return {\n    id: \"github\",\n    name: \"GitHub\",\n    createAuthorizationURL({ state, scopes, loginHint, redirectURI }) {\n      const _scopes = options.disableDefaultScope ? [] : [\"read:user\", \"user:email\"];\n      options.scope && _scopes.push(...options.scope);\n      scopes && _scopes.push(...scopes);\n      return (0,_better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.createAuthorizationURL)({\n        id: \"github\",\n        options,\n        authorizationEndpoint: \"https://github.com/login/oauth/authorize\",\n        scopes: _scopes,\n        state,\n        redirectURI,\n        loginHint,\n        prompt: options.prompt\n      });\n    },\n    validateAuthorizationCode: async ({ code, redirectURI }) => {\n      return (0,_better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.validateAuthorizationCode)({\n        code,\n        redirectURI,\n        options,\n        tokenEndpoint\n      });\n    },\n    refreshAccessToken: options.refreshAccessToken ? options.refreshAccessToken : async (refreshToken) => {\n      return (0,_better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.refreshAccessToken)({\n        refreshToken,\n        options: {\n          clientId: options.clientId,\n          clientKey: options.clientKey,\n          clientSecret: options.clientSecret\n        },\n        tokenEndpoint: \"https://github.com/login/oauth/access_token\"\n      });\n    },\n    async getUserInfo(token) {\n      if (options.getUserInfo) {\n        return options.getUserInfo(token);\n      }\n      const { data: profile, error } = await (0,_better_fetch_fetch__WEBPACK_IMPORTED_MODULE_0__.betterFetch)(\n        \"https://api.github.com/user\",\n        {\n          headers: {\n            \"User-Agent\": \"better-auth\",\n            authorization: `Bearer ${token.accessToken}`\n          }\n        }\n      );\n      if (error) {\n        return null;\n      }\n      const { data: emails } = await (0,_better_fetch_fetch__WEBPACK_IMPORTED_MODULE_0__.betterFetch)(\"https://api.github.com/user/emails\", {\n        headers: {\n          Authorization: `Bearer ${token.accessToken}`,\n          \"User-Agent\": \"better-auth\"\n        }\n      });\n      if (!profile.email && emails) {\n        profile.email = (emails.find((e) => e.primary) ?? emails[0])?.email;\n      }\n      const emailVerified = emails?.find((e) => e.email === profile.email)?.verified ?? false;\n      const userMap = await options.mapProfileToUser?.(profile);\n      return {\n        user: {\n          id: profile.id,\n          name: profile.name || profile.login,\n          email: profile.email,\n          image: profile.avatar_url,\n          emailVerified,\n          ...userMap\n        },\n        data: profile\n      };\n    },\n    options\n  };\n};\n\nconst google = (options) => {\n  return {\n    id: \"google\",\n    name: \"Google\",\n    async createAuthorizationURL({\n      state,\n      scopes,\n      codeVerifier,\n      redirectURI,\n      loginHint,\n      display\n    }) {\n      if (!options.clientId || !options.clientSecret) {\n        _better_auth_core_env__WEBPACK_IMPORTED_MODULE_4__.logger.error(\n          \"Client Id and Client Secret is required for Google. Make sure to provide them in the options.\"\n        );\n        throw new _error_index_mjs__WEBPACK_IMPORTED_MODULE_3__.BetterAuthError(\"CLIENT_ID_AND_SECRET_REQUIRED\");\n      }\n      if (!codeVerifier) {\n        throw new _error_index_mjs__WEBPACK_IMPORTED_MODULE_3__.BetterAuthError(\"codeVerifier is required for Google\");\n      }\n      const _scopes = options.disableDefaultScope ? [] : [\"email\", \"profile\", \"openid\"];\n      options.scope && _scopes.push(...options.scope);\n      scopes && _scopes.push(...scopes);\n      const url = await (0,_better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.createAuthorizationURL)({\n        id: \"google\",\n        options,\n        authorizationEndpoint: \"https://accounts.google.com/o/oauth2/auth\",\n        scopes: _scopes,\n        state,\n        codeVerifier,\n        redirectURI,\n        prompt: options.prompt,\n        accessType: options.accessType,\n        display: display || options.display,\n        loginHint,\n        hd: options.hd,\n        additionalParams: {\n          include_granted_scopes: \"true\"\n        }\n      });\n      return url;\n    },\n    validateAuthorizationCode: async ({ code, codeVerifier, redirectURI }) => {\n      return (0,_better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.validateAuthorizationCode)({\n        code,\n        codeVerifier,\n        redirectURI,\n        options,\n        tokenEndpoint: \"https://oauth2.googleapis.com/token\"\n      });\n    },\n    refreshAccessToken: options.refreshAccessToken ? options.refreshAccessToken : async (refreshToken) => {\n      return (0,_better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.refreshAccessToken)({\n        refreshToken,\n        options: {\n          clientId: options.clientId,\n          clientKey: options.clientKey,\n          clientSecret: options.clientSecret\n        },\n        tokenEndpoint: \"https://www.googleapis.com/oauth2/v4/token\"\n      });\n    },\n    async verifyIdToken(token, nonce) {\n      if (options.disableIdTokenSignIn) {\n        return false;\n      }\n      if (options.verifyIdToken) {\n        return options.verifyIdToken(token, nonce);\n      }\n      const googlePublicKeyUrl = `https://www.googleapis.com/oauth2/v3/tokeninfo?id_token=${token}`;\n      const { data: tokenInfo } = await (0,_better_fetch_fetch__WEBPACK_IMPORTED_MODULE_0__.betterFetch)(googlePublicKeyUrl);\n      if (!tokenInfo) {\n        return false;\n      }\n      const isValid = tokenInfo.aud === options.clientId && (tokenInfo.iss === \"https://accounts.google.com\" || tokenInfo.iss === \"accounts.google.com\");\n      return isValid;\n    },\n    async getUserInfo(token) {\n      if (options.getUserInfo) {\n        return options.getUserInfo(token);\n      }\n      if (!token.idToken) {\n        return null;\n      }\n      const user = (0,jose__WEBPACK_IMPORTED_MODULE_9__.decodeJwt)(token.idToken);\n      const userMap = await options.mapProfileToUser?.(user);\n      return {\n        user: {\n          id: user.sub,\n          name: user.name,\n          email: user.email,\n          image: user.picture,\n          emailVerified: user.email_verified,\n          ...userMap\n        },\n        data: user\n      };\n    },\n    options\n  };\n};\n\nconst kick = (options) => {\n  return {\n    id: \"kick\",\n    name: \"Kick\",\n    createAuthorizationURL({ state, scopes, redirectURI, codeVerifier }) {\n      const _scopes = options.disableDefaultScope ? [] : [\"user:read\"];\n      options.scope && _scopes.push(...options.scope);\n      scopes && _scopes.push(...scopes);\n      return (0,_better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.createAuthorizationURL)({\n        id: \"kick\",\n        redirectURI,\n        options,\n        authorizationEndpoint: \"https://id.kick.com/oauth/authorize\",\n        scopes: _scopes,\n        codeVerifier,\n        state\n      });\n    },\n    async validateAuthorizationCode({ code, redirectURI, codeVerifier }) {\n      return (0,_better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.validateAuthorizationCode)({\n        code,\n        redirectURI,\n        options,\n        tokenEndpoint: \"https://id.kick.com/oauth/token\",\n        codeVerifier\n      });\n    },\n    async getUserInfo(token) {\n      if (options.getUserInfo) {\n        return options.getUserInfo(token);\n      }\n      const { data, error } = await (0,_better_fetch_fetch__WEBPACK_IMPORTED_MODULE_0__.betterFetch)(\"https://api.kick.com/public/v1/users\", {\n        method: \"GET\",\n        headers: {\n          Authorization: `Bearer ${token.accessToken}`\n        }\n      });\n      if (error) {\n        return null;\n      }\n      const profile = data.data[0];\n      const userMap = await options.mapProfileToUser?.(profile);\n      return {\n        user: {\n          id: profile.user_id,\n          name: profile.name,\n          email: profile.email,\n          image: profile.profile_picture,\n          emailVerified: true,\n          ...userMap\n        },\n        data: profile\n      };\n    },\n    options\n  };\n};\n\nconst huggingface = (options) => {\n  return {\n    id: \"huggingface\",\n    name: \"Hugging Face\",\n    createAuthorizationURL({ state, scopes, codeVerifier, redirectURI }) {\n      const _scopes = options.disableDefaultScope ? [] : [\"openid\", \"profile\", \"email\"];\n      options.scope && _scopes.push(...options.scope);\n      scopes && _scopes.push(...scopes);\n      return (0,_better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.createAuthorizationURL)({\n        id: \"huggingface\",\n        options,\n        authorizationEndpoint: \"https://huggingface.co/oauth/authorize\",\n        scopes: _scopes,\n        state,\n        codeVerifier,\n        redirectURI\n      });\n    },\n    validateAuthorizationCode: async ({ code, codeVerifier, redirectURI }) => {\n      return (0,_better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.validateAuthorizationCode)({\n        code,\n        codeVerifier,\n        redirectURI,\n        options,\n        tokenEndpoint: \"https://huggingface.co/oauth/token\"\n      });\n    },\n    refreshAccessToken: options.refreshAccessToken ? options.refreshAccessToken : async (refreshToken) => {\n      return (0,_better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.refreshAccessToken)({\n        refreshToken,\n        options: {\n          clientId: options.clientId,\n          clientKey: options.clientKey,\n          clientSecret: options.clientSecret\n        },\n        tokenEndpoint: \"https://huggingface.co/oauth/token\"\n      });\n    },\n    async getUserInfo(token) {\n      if (options.getUserInfo) {\n        return options.getUserInfo(token);\n      }\n      const { data: profile, error } = await (0,_better_fetch_fetch__WEBPACK_IMPORTED_MODULE_0__.betterFetch)(\n        \"https://huggingface.co/oauth/userinfo\",\n        {\n          method: \"GET\",\n          headers: {\n            Authorization: `Bearer ${token.accessToken}`\n          }\n        }\n      );\n      if (error) {\n        return null;\n      }\n      const userMap = await options.mapProfileToUser?.(profile);\n      return {\n        user: {\n          id: profile.sub,\n          name: profile.name || profile.preferred_username,\n          email: profile.email,\n          image: profile.picture,\n          emailVerified: profile.email_verified ?? false,\n          ...userMap\n        },\n        data: profile\n      };\n    },\n    options\n  };\n};\n\nconst microsoft = (options) => {\n  const tenant = options.tenantId || \"common\";\n  const authority = options.authority || \"https://login.microsoftonline.com\";\n  const authorizationEndpoint = `${authority}/${tenant}/oauth2/v2.0/authorize`;\n  const tokenEndpoint = `${authority}/${tenant}/oauth2/v2.0/token`;\n  return {\n    id: \"microsoft\",\n    name: \"Microsoft EntraID\",\n    createAuthorizationURL(data) {\n      const scopes = options.disableDefaultScope ? [] : [\"openid\", \"profile\", \"email\", \"User.Read\", \"offline_access\"];\n      options.scope && scopes.push(...options.scope);\n      data.scopes && scopes.push(...data.scopes);\n      return (0,_better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.createAuthorizationURL)({\n        id: \"microsoft\",\n        options,\n        authorizationEndpoint,\n        state: data.state,\n        codeVerifier: data.codeVerifier,\n        scopes,\n        redirectURI: data.redirectURI,\n        prompt: options.prompt,\n        loginHint: data.loginHint\n      });\n    },\n    validateAuthorizationCode({ code, codeVerifier, redirectURI }) {\n      return (0,_better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.validateAuthorizationCode)({\n        code,\n        codeVerifier,\n        redirectURI,\n        options,\n        tokenEndpoint\n      });\n    },\n    async getUserInfo(token) {\n      if (options.getUserInfo) {\n        return options.getUserInfo(token);\n      }\n      if (!token.idToken) {\n        return null;\n      }\n      const user = (0,jose__WEBPACK_IMPORTED_MODULE_9__.decodeJwt)(token.idToken);\n      const profilePhotoSize = options.profilePhotoSize || 48;\n      await (0,_better_fetch_fetch__WEBPACK_IMPORTED_MODULE_0__.betterFetch)(\n        `https://graph.microsoft.com/v1.0/me/photos/${profilePhotoSize}x${profilePhotoSize}/$value`,\n        {\n          headers: {\n            Authorization: `Bearer ${token.accessToken}`\n          },\n          async onResponse(context) {\n            if (options.disableProfilePhoto || !context.response.ok) {\n              return;\n            }\n            try {\n              const response = context.response.clone();\n              const pictureBuffer = await response.arrayBuffer();\n              const pictureBase64 = _better_auth_utils_base64__WEBPACK_IMPORTED_MODULE_5__.base64.encode(pictureBuffer);\n              user.picture = `data:image/jpeg;base64, ${pictureBase64}`;\n            } catch (e) {\n              _better_auth_core_env__WEBPACK_IMPORTED_MODULE_4__.logger.error(\n                e && typeof e === \"object\" && \"name\" in e ? e.name : \"\",\n                e\n              );\n            }\n          }\n        }\n      );\n      const userMap = await options.mapProfileToUser?.(user);\n      return {\n        user: {\n          id: user.sub,\n          name: user.name,\n          email: user.email,\n          image: user.picture,\n          emailVerified: true,\n          ...userMap\n        },\n        data: user\n      };\n    },\n    refreshAccessToken: options.refreshAccessToken ? options.refreshAccessToken : async (refreshToken) => {\n      const scopes = options.disableDefaultScope ? [] : [\"openid\", \"profile\", \"email\", \"User.Read\", \"offline_access\"];\n      options.scope && scopes.push(...options.scope);\n      return (0,_better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.refreshAccessToken)({\n        refreshToken,\n        options: {\n          clientId: options.clientId,\n          clientSecret: options.clientSecret\n        },\n        extraParams: {\n          scope: scopes.join(\" \")\n          // Include the scopes in request to microsoft\n        },\n        tokenEndpoint\n      });\n    },\n    options\n  };\n};\n\nconst slack = (options) => {\n  return {\n    id: \"slack\",\n    name: \"Slack\",\n    createAuthorizationURL({ state, scopes, redirectURI }) {\n      const _scopes = options.disableDefaultScope ? [] : [\"openid\", \"profile\", \"email\"];\n      scopes && _scopes.push(...scopes);\n      options.scope && _scopes.push(...options.scope);\n      const url = new URL(\"https://slack.com/openid/connect/authorize\");\n      url.searchParams.set(\"scope\", _scopes.join(\" \"));\n      url.searchParams.set(\"response_type\", \"code\");\n      url.searchParams.set(\"client_id\", options.clientId);\n      url.searchParams.set(\"redirect_uri\", options.redirectURI || redirectURI);\n      url.searchParams.set(\"state\", state);\n      return url;\n    },\n    validateAuthorizationCode: async ({ code, redirectURI }) => {\n      return (0,_better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.validateAuthorizationCode)({\n        code,\n        redirectURI,\n        options,\n        tokenEndpoint: \"https://slack.com/api/openid.connect.token\"\n      });\n    },\n    refreshAccessToken: options.refreshAccessToken ? options.refreshAccessToken : async (refreshToken) => {\n      return (0,_better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.refreshAccessToken)({\n        refreshToken,\n        options: {\n          clientId: options.clientId,\n          clientKey: options.clientKey,\n          clientSecret: options.clientSecret\n        },\n        tokenEndpoint: \"https://slack.com/api/openid.connect.token\"\n      });\n    },\n    async getUserInfo(token) {\n      if (options.getUserInfo) {\n        return options.getUserInfo(token);\n      }\n      const { data: profile, error } = await (0,_better_fetch_fetch__WEBPACK_IMPORTED_MODULE_0__.betterFetch)(\n        \"https://slack.com/api/openid.connect.userInfo\",\n        {\n          headers: {\n            authorization: `Bearer ${token.accessToken}`\n          }\n        }\n      );\n      if (error) {\n        return null;\n      }\n      const userMap = await options.mapProfileToUser?.(profile);\n      return {\n        user: {\n          id: profile[\"https://slack.com/user_id\"],\n          name: profile.name || \"\",\n          email: profile.email,\n          emailVerified: profile.email_verified,\n          image: profile.picture || profile[\"https://slack.com/user_image_512\"],\n          ...userMap\n        },\n        data: profile\n      };\n    },\n    options\n  };\n};\n\nconst notion = (options) => {\n  const tokenEndpoint = \"https://api.notion.com/v1/oauth/token\";\n  return {\n    id: \"notion\",\n    name: \"Notion\",\n    createAuthorizationURL({ state, scopes, loginHint, redirectURI }) {\n      const _scopes = options.disableDefaultScope ? [] : [];\n      options.scope && _scopes.push(...options.scope);\n      scopes && _scopes.push(...scopes);\n      return (0,_better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.createAuthorizationURL)({\n        id: \"notion\",\n        options,\n        authorizationEndpoint: \"https://api.notion.com/v1/oauth/authorize\",\n        scopes: _scopes,\n        state,\n        redirectURI,\n        loginHint,\n        additionalParams: {\n          owner: \"user\"\n        }\n      });\n    },\n    validateAuthorizationCode: async ({ code, redirectURI }) => {\n      return (0,_better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.validateAuthorizationCode)({\n        code,\n        redirectURI,\n        options,\n        tokenEndpoint,\n        authentication: \"basic\"\n      });\n    },\n    refreshAccessToken: options.refreshAccessToken ? options.refreshAccessToken : async (refreshToken) => {\n      return (0,_better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.refreshAccessToken)({\n        refreshToken,\n        options: {\n          clientId: options.clientId,\n          clientKey: options.clientKey,\n          clientSecret: options.clientSecret\n        },\n        tokenEndpoint\n      });\n    },\n    async getUserInfo(token) {\n      if (options.getUserInfo) {\n        return options.getUserInfo(token);\n      }\n      const { data: profile, error } = await (0,_better_fetch_fetch__WEBPACK_IMPORTED_MODULE_0__.betterFetch)(\"https://api.notion.com/v1/users/me\", {\n        headers: {\n          Authorization: `Bearer ${token.accessToken}`,\n          \"Notion-Version\": \"2022-06-28\"\n        }\n      });\n      if (error || !profile) {\n        return null;\n      }\n      const userProfile = profile.bot?.owner?.user;\n      if (!userProfile) {\n        return null;\n      }\n      const userMap = await options.mapProfileToUser?.(userProfile);\n      return {\n        user: {\n          id: userProfile.id,\n          name: userProfile.name || \"Notion User\",\n          email: userProfile.person?.email || null,\n          image: userProfile.avatar_url,\n          emailVerified: !!userProfile.person?.email,\n          ...userMap\n        },\n        data: userProfile\n      };\n    },\n    options\n  };\n};\n\nconst spotify = (options) => {\n  return {\n    id: \"spotify\",\n    name: \"Spotify\",\n    createAuthorizationURL({ state, scopes, codeVerifier, redirectURI }) {\n      const _scopes = options.disableDefaultScope ? [] : [\"user-read-email\"];\n      options.scope && _scopes.push(...options.scope);\n      scopes && _scopes.push(...scopes);\n      return (0,_better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.createAuthorizationURL)({\n        id: \"spotify\",\n        options,\n        authorizationEndpoint: \"https://accounts.spotify.com/authorize\",\n        scopes: _scopes,\n        state,\n        codeVerifier,\n        redirectURI\n      });\n    },\n    validateAuthorizationCode: async ({ code, codeVerifier, redirectURI }) => {\n      return (0,_better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.validateAuthorizationCode)({\n        code,\n        codeVerifier,\n        redirectURI,\n        options,\n        tokenEndpoint: \"https://accounts.spotify.com/api/token\"\n      });\n    },\n    refreshAccessToken: options.refreshAccessToken ? options.refreshAccessToken : async (refreshToken) => {\n      return (0,_better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.refreshAccessToken)({\n        refreshToken,\n        options: {\n          clientId: options.clientId,\n          clientKey: options.clientKey,\n          clientSecret: options.clientSecret\n        },\n        tokenEndpoint: \"https://accounts.spotify.com/api/token\"\n      });\n    },\n    async getUserInfo(token) {\n      if (options.getUserInfo) {\n        return options.getUserInfo(token);\n      }\n      const { data: profile, error } = await (0,_better_fetch_fetch__WEBPACK_IMPORTED_MODULE_0__.betterFetch)(\n        \"https://api.spotify.com/v1/me\",\n        {\n          method: \"GET\",\n          headers: {\n            Authorization: `Bearer ${token.accessToken}`\n          }\n        }\n      );\n      if (error) {\n        return null;\n      }\n      const userMap = await options.mapProfileToUser?.(profile);\n      return {\n        user: {\n          id: profile.id,\n          name: profile.display_name,\n          email: profile.email,\n          image: profile.images[0]?.url,\n          emailVerified: false,\n          ...userMap\n        },\n        data: profile\n      };\n    },\n    options\n  };\n};\n\nconst twitch = (options) => {\n  return {\n    id: \"twitch\",\n    name: \"Twitch\",\n    createAuthorizationURL({ state, scopes, redirectURI }) {\n      const _scopes = options.disableDefaultScope ? [] : [\"user:read:email\", \"openid\"];\n      options.scope && _scopes.push(...options.scope);\n      scopes && _scopes.push(...scopes);\n      return (0,_better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.createAuthorizationURL)({\n        id: \"twitch\",\n        redirectURI,\n        options,\n        authorizationEndpoint: \"https://id.twitch.tv/oauth2/authorize\",\n        scopes: _scopes,\n        state,\n        claims: options.claims || [\n          \"email\",\n          \"email_verified\",\n          \"preferred_username\",\n          \"picture\"\n        ]\n      });\n    },\n    validateAuthorizationCode: async ({ code, redirectURI }) => {\n      return (0,_better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.validateAuthorizationCode)({\n        code,\n        redirectURI,\n        options,\n        tokenEndpoint: \"https://id.twitch.tv/oauth2/token\"\n      });\n    },\n    refreshAccessToken: options.refreshAccessToken ? options.refreshAccessToken : async (refreshToken) => {\n      return (0,_better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.refreshAccessToken)({\n        refreshToken,\n        options: {\n          clientId: options.clientId,\n          clientKey: options.clientKey,\n          clientSecret: options.clientSecret\n        },\n        tokenEndpoint: \"https://id.twitch.tv/oauth2/token\"\n      });\n    },\n    async getUserInfo(token) {\n      if (options.getUserInfo) {\n        return options.getUserInfo(token);\n      }\n      const idToken = token.idToken;\n      if (!idToken) {\n        _better_auth_core_env__WEBPACK_IMPORTED_MODULE_4__.logger.error(\"No idToken found in token\");\n        return null;\n      }\n      const profile = (0,jose__WEBPACK_IMPORTED_MODULE_9__.decodeJwt)(idToken);\n      const userMap = await options.mapProfileToUser?.(profile);\n      return {\n        user: {\n          id: profile.sub,\n          name: profile.preferred_username,\n          email: profile.email,\n          image: profile.picture,\n          emailVerified: profile.email_verified,\n          ...userMap\n        },\n        data: profile\n      };\n    },\n    options\n  };\n};\n\nconst twitter = (options) => {\n  return {\n    id: \"twitter\",\n    name: \"Twitter\",\n    createAuthorizationURL(data) {\n      const _scopes = options.disableDefaultScope ? [] : [\"users.read\", \"tweet.read\", \"offline.access\", \"users.email\"];\n      options.scope && _scopes.push(...options.scope);\n      data.scopes && _scopes.push(...data.scopes);\n      return (0,_better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.createAuthorizationURL)({\n        id: \"twitter\",\n        options,\n        authorizationEndpoint: \"https://x.com/i/oauth2/authorize\",\n        scopes: _scopes,\n        state: data.state,\n        codeVerifier: data.codeVerifier,\n        redirectURI: data.redirectURI\n      });\n    },\n    validateAuthorizationCode: async ({ code, codeVerifier, redirectURI }) => {\n      return (0,_better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.validateAuthorizationCode)({\n        code,\n        codeVerifier,\n        authentication: \"basic\",\n        redirectURI,\n        options,\n        tokenEndpoint: \"https://api.x.com/2/oauth2/token\"\n      });\n    },\n    refreshAccessToken: options.refreshAccessToken ? options.refreshAccessToken : async (refreshToken) => {\n      return (0,_better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.refreshAccessToken)({\n        refreshToken,\n        options: {\n          clientId: options.clientId,\n          clientKey: options.clientKey,\n          clientSecret: options.clientSecret\n        },\n        authentication: \"basic\",\n        tokenEndpoint: \"https://api.x.com/2/oauth2/token\"\n      });\n    },\n    async getUserInfo(token) {\n      if (options.getUserInfo) {\n        return options.getUserInfo(token);\n      }\n      const { data: profile, error: profileError } = await (0,_better_fetch_fetch__WEBPACK_IMPORTED_MODULE_0__.betterFetch)(\n        \"https://api.x.com/2/users/me?user.fields=profile_image_url\",\n        {\n          method: \"GET\",\n          headers: {\n            Authorization: `Bearer ${token.accessToken}`\n          }\n        }\n      );\n      if (profileError) {\n        return null;\n      }\n      const { data: emailData, error: emailError } = await (0,_better_fetch_fetch__WEBPACK_IMPORTED_MODULE_0__.betterFetch)(\"https://api.x.com/2/users/me?user.fields=confirmed_email\", {\n        method: \"GET\",\n        headers: {\n          Authorization: `Bearer ${token.accessToken}`\n        }\n      });\n      let emailVerified = false;\n      if (!emailError && emailData?.data?.confirmed_email) {\n        profile.data.email = emailData.data.confirmed_email;\n        emailVerified = true;\n      }\n      const userMap = await options.mapProfileToUser?.(profile);\n      return {\n        user: {\n          id: profile.data.id,\n          name: profile.data.name,\n          email: profile.data.email || profile.data.username || null,\n          image: profile.data.profile_image_url,\n          emailVerified,\n          ...userMap\n        },\n        data: profile\n      };\n    },\n    options\n  };\n};\n\nconst dropbox = (options) => {\n  const tokenEndpoint = \"https://api.dropboxapi.com/oauth2/token\";\n  return {\n    id: \"dropbox\",\n    name: \"Dropbox\",\n    createAuthorizationURL: async ({\n      state,\n      scopes,\n      codeVerifier,\n      redirectURI\n    }) => {\n      const _scopes = options.disableDefaultScope ? [] : [\"account_info.read\"];\n      options.scope && _scopes.push(...options.scope);\n      scopes && _scopes.push(...scopes);\n      const additionalParams = {};\n      if (options.accessType) {\n        additionalParams.token_access_type = options.accessType;\n      }\n      return await (0,_better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.createAuthorizationURL)({\n        id: \"dropbox\",\n        options,\n        authorizationEndpoint: \"https://www.dropbox.com/oauth2/authorize\",\n        scopes: _scopes,\n        state,\n        redirectURI,\n        codeVerifier,\n        additionalParams\n      });\n    },\n    validateAuthorizationCode: async ({ code, codeVerifier, redirectURI }) => {\n      return await (0,_better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.validateAuthorizationCode)({\n        code,\n        codeVerifier,\n        redirectURI,\n        options,\n        tokenEndpoint\n      });\n    },\n    refreshAccessToken: options.refreshAccessToken ? options.refreshAccessToken : async (refreshToken) => {\n      return (0,_better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.refreshAccessToken)({\n        refreshToken,\n        options: {\n          clientId: options.clientId,\n          clientKey: options.clientKey,\n          clientSecret: options.clientSecret\n        },\n        tokenEndpoint: \"https://api.dropbox.com/oauth2/token\"\n      });\n    },\n    async getUserInfo(token) {\n      if (options.getUserInfo) {\n        return options.getUserInfo(token);\n      }\n      const { data: profile, error } = await (0,_better_fetch_fetch__WEBPACK_IMPORTED_MODULE_0__.betterFetch)(\n        \"https://api.dropboxapi.com/2/users/get_current_account\",\n        {\n          method: \"POST\",\n          headers: {\n            Authorization: `Bearer ${token.accessToken}`\n          }\n        }\n      );\n      if (error) {\n        return null;\n      }\n      const userMap = await options.mapProfileToUser?.(profile);\n      return {\n        user: {\n          id: profile.account_id,\n          name: profile.name?.display_name,\n          email: profile.email,\n          emailVerified: profile.email_verified || false,\n          image: profile.profile_photo_url,\n          ...userMap\n        },\n        data: profile\n      };\n    },\n    options\n  };\n};\n\nconst linear = (options) => {\n  const tokenEndpoint = \"https://api.linear.app/oauth/token\";\n  return {\n    id: \"linear\",\n    name: \"Linear\",\n    createAuthorizationURL({ state, scopes, loginHint, redirectURI }) {\n      const _scopes = options.disableDefaultScope ? [] : [\"read\"];\n      options.scope && _scopes.push(...options.scope);\n      scopes && _scopes.push(...scopes);\n      return (0,_better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.createAuthorizationURL)({\n        id: \"linear\",\n        options,\n        authorizationEndpoint: \"https://linear.app/oauth/authorize\",\n        scopes: _scopes,\n        state,\n        redirectURI,\n        loginHint\n      });\n    },\n    validateAuthorizationCode: async ({ code, redirectURI }) => {\n      return (0,_better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.validateAuthorizationCode)({\n        code,\n        redirectURI,\n        options,\n        tokenEndpoint\n      });\n    },\n    refreshAccessToken: options.refreshAccessToken ? options.refreshAccessToken : async (refreshToken) => {\n      return (0,_better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.refreshAccessToken)({\n        refreshToken,\n        options: {\n          clientId: options.clientId,\n          clientKey: options.clientKey,\n          clientSecret: options.clientSecret\n        },\n        tokenEndpoint\n      });\n    },\n    async getUserInfo(token) {\n      if (options.getUserInfo) {\n        return options.getUserInfo(token);\n      }\n      const { data: profile, error } = await (0,_better_fetch_fetch__WEBPACK_IMPORTED_MODULE_0__.betterFetch)(\n        \"https://api.linear.app/graphql\",\n        {\n          method: \"POST\",\n          headers: {\n            \"Content-Type\": \"application/json\",\n            Authorization: `Bearer ${token.accessToken}`\n          },\n          body: JSON.stringify({\n            query: `\n\t\t\t\t\t\t\tquery {\n\t\t\t\t\t\t\t\tviewer {\n\t\t\t\t\t\t\t\t\tid\n\t\t\t\t\t\t\t\t\tname\n\t\t\t\t\t\t\t\t\temail\n\t\t\t\t\t\t\t\t\tavatarUrl\n\t\t\t\t\t\t\t\t\tactive\n\t\t\t\t\t\t\t\t\tcreatedAt\n\t\t\t\t\t\t\t\t\tupdatedAt\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t`\n          })\n        }\n      );\n      if (error || !profile?.data?.viewer) {\n        return null;\n      }\n      const userData = profile.data.viewer;\n      const userMap = await options.mapProfileToUser?.(userData);\n      return {\n        user: {\n          id: profile.data.viewer.id,\n          name: profile.data.viewer.name,\n          email: profile.data.viewer.email,\n          image: profile.data.viewer.avatarUrl,\n          emailVerified: true,\n          ...userMap\n        },\n        data: userData\n      };\n    },\n    options\n  };\n};\n\nconst linkedin = (options) => {\n  const authorizationEndpoint = \"https://www.linkedin.com/oauth/v2/authorization\";\n  const tokenEndpoint = \"https://www.linkedin.com/oauth/v2/accessToken\";\n  return {\n    id: \"linkedin\",\n    name: \"Linkedin\",\n    createAuthorizationURL: async ({\n      state,\n      scopes,\n      redirectURI,\n      loginHint\n    }) => {\n      const _scopes = options.disableDefaultScope ? [] : [\"profile\", \"email\", \"openid\"];\n      options.scope && _scopes.push(...options.scope);\n      scopes && _scopes.push(...scopes);\n      return await (0,_better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.createAuthorizationURL)({\n        id: \"linkedin\",\n        options,\n        authorizationEndpoint,\n        scopes: _scopes,\n        state,\n        loginHint,\n        redirectURI\n      });\n    },\n    validateAuthorizationCode: async ({ code, redirectURI }) => {\n      return await (0,_better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.validateAuthorizationCode)({\n        code,\n        redirectURI,\n        options,\n        tokenEndpoint\n      });\n    },\n    refreshAccessToken: options.refreshAccessToken ? options.refreshAccessToken : async (refreshToken) => {\n      return (0,_better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.refreshAccessToken)({\n        refreshToken,\n        options: {\n          clientId: options.clientId,\n          clientKey: options.clientKey,\n          clientSecret: options.clientSecret\n        },\n        tokenEndpoint\n      });\n    },\n    async getUserInfo(token) {\n      if (options.getUserInfo) {\n        return options.getUserInfo(token);\n      }\n      const { data: profile, error } = await (0,_better_fetch_fetch__WEBPACK_IMPORTED_MODULE_0__.betterFetch)(\n        \"https://api.linkedin.com/v2/userinfo\",\n        {\n          method: \"GET\",\n          headers: {\n            Authorization: `Bearer ${token.accessToken}`\n          }\n        }\n      );\n      if (error) {\n        return null;\n      }\n      const userMap = await options.mapProfileToUser?.(profile);\n      return {\n        user: {\n          id: profile.sub,\n          name: profile.name,\n          email: profile.email,\n          emailVerified: profile.email_verified || false,\n          image: profile.picture,\n          ...userMap\n        },\n        data: profile\n      };\n    },\n    options\n  };\n};\n\nconst cleanDoubleSlashes = (input = \"\") => {\n  return input.split(\"://\").map((str) => str.replace(/\\/{2,}/g, \"/\")).join(\"://\");\n};\nconst issuerToEndpoints = (issuer) => {\n  let baseUrl = issuer || \"https://gitlab.com\";\n  return {\n    authorizationEndpoint: cleanDoubleSlashes(`${baseUrl}/oauth/authorize`),\n    tokenEndpoint: cleanDoubleSlashes(`${baseUrl}/oauth/token`),\n    userinfoEndpoint: cleanDoubleSlashes(`${baseUrl}/api/v4/user`)\n  };\n};\nconst gitlab = (options) => {\n  const { authorizationEndpoint, tokenEndpoint, userinfoEndpoint } = issuerToEndpoints(options.issuer);\n  const issuerId = \"gitlab\";\n  const issuerName = \"Gitlab\";\n  return {\n    id: issuerId,\n    name: issuerName,\n    createAuthorizationURL: async ({\n      state,\n      scopes,\n      codeVerifier,\n      loginHint,\n      redirectURI\n    }) => {\n      const _scopes = options.disableDefaultScope ? [] : [\"read_user\"];\n      options.scope && _scopes.push(...options.scope);\n      scopes && _scopes.push(...scopes);\n      return await (0,_better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.createAuthorizationURL)({\n        id: issuerId,\n        options,\n        authorizationEndpoint,\n        scopes: _scopes,\n        state,\n        redirectURI,\n        codeVerifier,\n        loginHint\n      });\n    },\n    validateAuthorizationCode: async ({ code, redirectURI, codeVerifier }) => {\n      return (0,_better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.validateAuthorizationCode)({\n        code,\n        redirectURI,\n        options,\n        codeVerifier,\n        tokenEndpoint\n      });\n    },\n    refreshAccessToken: options.refreshAccessToken ? options.refreshAccessToken : async (refreshToken) => {\n      return (0,_better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.refreshAccessToken)({\n        refreshToken,\n        options: {\n          clientId: options.clientId,\n          clientKey: options.clientKey,\n          clientSecret: options.clientSecret\n        },\n        tokenEndpoint\n      });\n    },\n    async getUserInfo(token) {\n      if (options.getUserInfo) {\n        return options.getUserInfo(token);\n      }\n      const { data: profile, error } = await (0,_better_fetch_fetch__WEBPACK_IMPORTED_MODULE_0__.betterFetch)(\n        userinfoEndpoint,\n        { headers: { authorization: `Bearer ${token.accessToken}` } }\n      );\n      if (error || profile.state !== \"active\" || profile.locked) {\n        return null;\n      }\n      const userMap = await options.mapProfileToUser?.(profile);\n      return {\n        user: {\n          id: profile.id,\n          name: profile.name ?? profile.username,\n          email: profile.email,\n          image: profile.avatar_url,\n          emailVerified: true,\n          ...userMap\n        },\n        data: profile\n      };\n    },\n    options\n  };\n};\n\nconst tiktok = (options) => {\n  return {\n    id: \"tiktok\",\n    name: \"TikTok\",\n    createAuthorizationURL({ state, scopes, redirectURI }) {\n      const _scopes = options.disableDefaultScope ? [] : [\"user.info.profile\"];\n      options.scope && _scopes.push(...options.scope);\n      scopes && _scopes.push(...scopes);\n      return new URL(\n        `https://www.tiktok.com/v2/auth/authorize?scope=${_scopes.join(\n          \",\"\n        )}&response_type=code&client_key=${options.clientKey}&redirect_uri=${encodeURIComponent(\n          options.redirectURI || redirectURI\n        )}&state=${state}`\n      );\n    },\n    validateAuthorizationCode: async ({ code, redirectURI }) => {\n      return (0,_better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.validateAuthorizationCode)({\n        code,\n        redirectURI: options.redirectURI || redirectURI,\n        options: {\n          clientKey: options.clientKey,\n          clientSecret: options.clientSecret\n        },\n        tokenEndpoint: \"https://open.tiktokapis.com/v2/oauth/token/\"\n      });\n    },\n    refreshAccessToken: options.refreshAccessToken ? options.refreshAccessToken : async (refreshToken) => {\n      return (0,_better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.refreshAccessToken)({\n        refreshToken,\n        options: {\n          clientSecret: options.clientSecret\n        },\n        tokenEndpoint: \"https://open.tiktokapis.com/v2/oauth/token/\",\n        authentication: \"post\",\n        extraParams: {\n          client_key: options.clientKey\n        }\n      });\n    },\n    async getUserInfo(token) {\n      if (options.getUserInfo) {\n        return options.getUserInfo(token);\n      }\n      const fields = [\n        \"open_id\",\n        \"avatar_large_url\",\n        \"display_name\",\n        \"username\"\n      ];\n      const { data: profile, error } = await (0,_better_fetch_fetch__WEBPACK_IMPORTED_MODULE_0__.betterFetch)(\n        `https://open.tiktokapis.com/v2/user/info/?fields=${fields.join(\",\")}`,\n        {\n          headers: {\n            authorization: `Bearer ${token.accessToken}`\n          }\n        }\n      );\n      if (error) {\n        return null;\n      }\n      return {\n        user: {\n          email: profile.data.user.email || profile.data.user.username,\n          id: profile.data.user.open_id,\n          name: profile.data.user.display_name || profile.data.user.username,\n          image: profile.data.user.avatar_large_url,\n          /** @note Tiktok does not provide emailVerified or even email*/\n          emailVerified: profile.data.user.email ? true : false\n        },\n        data: profile\n      };\n    },\n    options\n  };\n};\n\nconst reddit = (options) => {\n  return {\n    id: \"reddit\",\n    name: \"Reddit\",\n    createAuthorizationURL({ state, scopes, redirectURI }) {\n      const _scopes = options.disableDefaultScope ? [] : [\"identity\"];\n      options.scope && _scopes.push(...options.scope);\n      scopes && _scopes.push(...scopes);\n      return (0,_better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.createAuthorizationURL)({\n        id: \"reddit\",\n        options,\n        authorizationEndpoint: \"https://www.reddit.com/api/v1/authorize\",\n        scopes: _scopes,\n        state,\n        redirectURI,\n        duration: options.duration\n      });\n    },\n    validateAuthorizationCode: async ({ code, redirectURI }) => {\n      const body = new URLSearchParams({\n        grant_type: \"authorization_code\",\n        code,\n        redirect_uri: options.redirectURI || redirectURI\n      });\n      const headers = {\n        \"content-type\": \"application/x-www-form-urlencoded\",\n        accept: \"text/plain\",\n        \"user-agent\": \"better-auth\",\n        Authorization: `Basic ${_better_auth_utils_base64__WEBPACK_IMPORTED_MODULE_5__.base64.encode(\n          `${options.clientId}:${options.clientSecret}`\n        )}`\n      };\n      const { data, error } = await (0,_better_fetch_fetch__WEBPACK_IMPORTED_MODULE_0__.betterFetch)(\n        \"https://www.reddit.com/api/v1/access_token\",\n        {\n          method: \"POST\",\n          headers,\n          body: body.toString()\n        }\n      );\n      if (error) {\n        throw error;\n      }\n      return (0,_better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.getOAuth2Tokens)(data);\n    },\n    refreshAccessToken: options.refreshAccessToken ? options.refreshAccessToken : async (refreshToken) => {\n      return (0,_better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.refreshAccessToken)({\n        refreshToken,\n        options: {\n          clientId: options.clientId,\n          clientKey: options.clientKey,\n          clientSecret: options.clientSecret\n        },\n        authentication: \"basic\",\n        tokenEndpoint: \"https://www.reddit.com/api/v1/access_token\"\n      });\n    },\n    async getUserInfo(token) {\n      if (options.getUserInfo) {\n        return options.getUserInfo(token);\n      }\n      const { data: profile, error } = await (0,_better_fetch_fetch__WEBPACK_IMPORTED_MODULE_0__.betterFetch)(\n        \"https://oauth.reddit.com/api/v1/me\",\n        {\n          headers: {\n            Authorization: `Bearer ${token.accessToken}`,\n            \"User-Agent\": \"better-auth\"\n          }\n        }\n      );\n      if (error) {\n        return null;\n      }\n      const userMap = await options.mapProfileToUser?.(profile);\n      return {\n        user: {\n          id: profile.id,\n          name: profile.name,\n          email: profile.oauth_client_id,\n          emailVerified: profile.has_verified_email,\n          image: profile.icon_img?.split(\"?\")[0],\n          ...userMap\n        },\n        data: profile\n      };\n    },\n    options\n  };\n};\n\nconst roblox = (options) => {\n  return {\n    id: \"roblox\",\n    name: \"Roblox\",\n    createAuthorizationURL({ state, scopes, redirectURI }) {\n      const _scopes = options.disableDefaultScope ? [] : [\"openid\", \"profile\"];\n      options.scope && _scopes.push(...options.scope);\n      scopes && _scopes.push(...scopes);\n      return new URL(\n        `https://apis.roblox.com/oauth/v1/authorize?scope=${_scopes.join(\n          \"+\"\n        )}&response_type=code&client_id=${options.clientId}&redirect_uri=${encodeURIComponent(\n          options.redirectURI || redirectURI\n        )}&state=${state}&prompt=${options.prompt || \"select_account consent\"}`\n      );\n    },\n    validateAuthorizationCode: async ({ code, redirectURI }) => {\n      return (0,_better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.validateAuthorizationCode)({\n        code,\n        redirectURI: options.redirectURI || redirectURI,\n        options,\n        tokenEndpoint: \"https://apis.roblox.com/oauth/v1/token\",\n        authentication: \"post\"\n      });\n    },\n    refreshAccessToken: options.refreshAccessToken ? options.refreshAccessToken : async (refreshToken) => {\n      return (0,_better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.refreshAccessToken)({\n        refreshToken,\n        options: {\n          clientId: options.clientId,\n          clientKey: options.clientKey,\n          clientSecret: options.clientSecret\n        },\n        tokenEndpoint: \"https://apis.roblox.com/oauth/v1/token\"\n      });\n    },\n    async getUserInfo(token) {\n      if (options.getUserInfo) {\n        return options.getUserInfo(token);\n      }\n      const { data: profile, error } = await (0,_better_fetch_fetch__WEBPACK_IMPORTED_MODULE_0__.betterFetch)(\n        \"https://apis.roblox.com/oauth/v1/userinfo\",\n        {\n          headers: {\n            authorization: `Bearer ${token.accessToken}`\n          }\n        }\n      );\n      if (error) {\n        return null;\n      }\n      const userMap = await options.mapProfileToUser?.(profile);\n      return {\n        user: {\n          id: profile.sub,\n          name: profile.nickname || profile.preferred_username || \"\",\n          image: profile.picture,\n          email: profile.preferred_username || null,\n          // Roblox does not provide email\n          emailVerified: true,\n          ...userMap\n        },\n        data: {\n          ...profile\n        }\n      };\n    },\n    options\n  };\n};\n\nconst salesforce = (options) => {\n  const environment = options.environment ?? \"production\";\n  const isSandbox = environment === \"sandbox\";\n  const authorizationEndpoint = options.loginUrl ? `https://${options.loginUrl}/services/oauth2/authorize` : isSandbox ? \"https://test.salesforce.com/services/oauth2/authorize\" : \"https://login.salesforce.com/services/oauth2/authorize\";\n  const tokenEndpoint = options.loginUrl ? `https://${options.loginUrl}/services/oauth2/token` : isSandbox ? \"https://test.salesforce.com/services/oauth2/token\" : \"https://login.salesforce.com/services/oauth2/token\";\n  const userInfoEndpoint = options.loginUrl ? `https://${options.loginUrl}/services/oauth2/userinfo` : isSandbox ? \"https://test.salesforce.com/services/oauth2/userinfo\" : \"https://login.salesforce.com/services/oauth2/userinfo\";\n  return {\n    id: \"salesforce\",\n    name: \"Salesforce\",\n    async createAuthorizationURL({ state, scopes, codeVerifier, redirectURI }) {\n      if (!options.clientId || !options.clientSecret) {\n        _better_auth_core_env__WEBPACK_IMPORTED_MODULE_4__.logger.error(\n          \"Client Id and Client Secret are required for Salesforce. Make sure to provide them in the options.\"\n        );\n        throw new _error_index_mjs__WEBPACK_IMPORTED_MODULE_3__.BetterAuthError(\"CLIENT_ID_AND_SECRET_REQUIRED\");\n      }\n      if (!codeVerifier) {\n        throw new _error_index_mjs__WEBPACK_IMPORTED_MODULE_3__.BetterAuthError(\"codeVerifier is required for Salesforce\");\n      }\n      const _scopes = options.disableDefaultScope ? [] : [\"openid\", \"email\", \"profile\"];\n      options.scope && _scopes.push(...options.scope);\n      scopes && _scopes.push(...scopes);\n      return (0,_better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.createAuthorizationURL)({\n        id: \"salesforce\",\n        options,\n        authorizationEndpoint,\n        scopes: _scopes,\n        state,\n        codeVerifier,\n        redirectURI: options.redirectURI || redirectURI\n      });\n    },\n    validateAuthorizationCode: async ({ code, codeVerifier, redirectURI }) => {\n      return (0,_better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.validateAuthorizationCode)({\n        code,\n        codeVerifier,\n        redirectURI: options.redirectURI || redirectURI,\n        options,\n        tokenEndpoint\n      });\n    },\n    refreshAccessToken: options.refreshAccessToken ? options.refreshAccessToken : async (refreshToken) => {\n      return (0,_better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.refreshAccessToken)({\n        refreshToken,\n        options: {\n          clientId: options.clientId,\n          clientSecret: options.clientSecret\n        },\n        tokenEndpoint\n      });\n    },\n    async getUserInfo(token) {\n      if (options.getUserInfo) {\n        return options.getUserInfo(token);\n      }\n      try {\n        const { data: user } = await (0,_better_fetch_fetch__WEBPACK_IMPORTED_MODULE_0__.betterFetch)(\n          userInfoEndpoint,\n          {\n            headers: {\n              Authorization: `Bearer ${token.accessToken}`\n            }\n          }\n        );\n        if (!user) {\n          _better_auth_core_env__WEBPACK_IMPORTED_MODULE_4__.logger.error(\"Failed to fetch user info from Salesforce\");\n          return null;\n        }\n        const userMap = await options.mapProfileToUser?.(user);\n        return {\n          user: {\n            id: user.user_id,\n            name: user.name,\n            email: user.email,\n            image: user.photos?.picture || user.photos?.thumbnail,\n            emailVerified: user.email_verified ?? false,\n            ...userMap\n          },\n          data: user\n        };\n      } catch (error) {\n        _better_auth_core_env__WEBPACK_IMPORTED_MODULE_4__.logger.error(\"Failed to fetch user info from Salesforce:\", error);\n        return null;\n      }\n    },\n    options\n  };\n};\n\nconst vk = (options) => {\n  return {\n    id: \"vk\",\n    name: \"VK\",\n    async createAuthorizationURL({ state, scopes, codeVerifier, redirectURI }) {\n      const _scopes = options.disableDefaultScope ? [] : [\"email\", \"phone\"];\n      options.scope && _scopes.push(...options.scope);\n      scopes && _scopes.push(...scopes);\n      const authorizationEndpoint = \"https://id.vk.com/authorize\";\n      return (0,_better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.createAuthorizationURL)({\n        id: \"vk\",\n        options,\n        authorizationEndpoint,\n        scopes: _scopes,\n        state,\n        redirectURI,\n        codeVerifier\n      });\n    },\n    validateAuthorizationCode: async ({\n      code,\n      codeVerifier,\n      redirectURI,\n      deviceId\n    }) => {\n      return (0,_better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.validateAuthorizationCode)({\n        code,\n        codeVerifier,\n        redirectURI: options.redirectURI || redirectURI,\n        options,\n        deviceId,\n        tokenEndpoint: \"https://id.vk.com/oauth2/auth\"\n      });\n    },\n    refreshAccessToken: options.refreshAccessToken ? options.refreshAccessToken : async (refreshToken) => {\n      return (0,_better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.refreshAccessToken)({\n        refreshToken,\n        options: {\n          clientId: options.clientId,\n          clientKey: options.clientKey,\n          clientSecret: options.clientSecret\n        },\n        tokenEndpoint: \"https://id.vk.com/oauth2/auth\"\n      });\n    },\n    async getUserInfo(data) {\n      if (options.getUserInfo) {\n        return options.getUserInfo(data);\n      }\n      if (!data.accessToken) {\n        return null;\n      }\n      const formBody = new URLSearchParams({\n        access_token: data.accessToken,\n        client_id: options.clientId\n      }).toString();\n      const { data: profile, error } = await (0,_better_fetch_fetch__WEBPACK_IMPORTED_MODULE_0__.betterFetch)(\n        \"https://id.vk.com/oauth2/user_info\",\n        {\n          method: \"POST\",\n          headers: {\n            \"Content-Type\": \"application/x-www-form-urlencoded\"\n          },\n          body: formBody\n        }\n      );\n      if (error) {\n        return null;\n      }\n      if (!profile.user.email) {\n        return null;\n      }\n      const userMap = await options.mapProfileToUser?.(profile);\n      return {\n        user: {\n          id: profile.user.user_id,\n          first_name: profile.user.first_name,\n          last_name: profile.user.last_name,\n          email: profile.user.email,\n          image: profile.user.avatar,\n          /** @note VK does not provide emailVerified*/\n          emailVerified: !!profile.user.email,\n          birthday: profile.user.birthday,\n          sex: profile.user.sex,\n          name: `${profile.user.first_name} ${profile.user.last_name}`,\n          ...userMap\n        },\n        data: profile\n      };\n    },\n    options\n  };\n};\n\nconst zoom = (userOptions) => {\n  const options = {\n    pkce: true,\n    ...userOptions\n  };\n  return {\n    id: \"zoom\",\n    name: \"Zoom\",\n    createAuthorizationURL: async ({ state, redirectURI, codeVerifier }) => {\n      const params = new URLSearchParams({\n        response_type: \"code\",\n        redirect_uri: options.redirectURI ? options.redirectURI : redirectURI,\n        client_id: options.clientId,\n        state\n      });\n      if (options.pkce) {\n        const codeChallenge = await (0,_better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.generateCodeChallenge)(codeVerifier);\n        params.set(\"code_challenge_method\", \"S256\");\n        params.set(\"code_challenge\", codeChallenge);\n      }\n      const url = new URL(\"https://zoom.us/oauth/authorize\");\n      url.search = params.toString();\n      return url;\n    },\n    validateAuthorizationCode: async ({ code, redirectURI, codeVerifier }) => {\n      return (0,_better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.validateAuthorizationCode)({\n        code,\n        redirectURI: options.redirectURI || redirectURI,\n        codeVerifier,\n        options,\n        tokenEndpoint: \"https://zoom.us/oauth/token\",\n        authentication: \"post\"\n      });\n    },\n    async getUserInfo(token) {\n      if (options.getUserInfo) {\n        return options.getUserInfo(token);\n      }\n      const { data: profile, error } = await (0,_better_fetch_fetch__WEBPACK_IMPORTED_MODULE_0__.betterFetch)(\n        \"https://api.zoom.us/v2/users/me\",\n        {\n          headers: {\n            authorization: `Bearer ${token.accessToken}`\n          }\n        }\n      );\n      if (error) {\n        return null;\n      }\n      const userMap = await options.mapProfileToUser?.(profile);\n      return {\n        user: {\n          id: profile.id,\n          name: profile.display_name,\n          image: profile.pic_url,\n          email: profile.email,\n          emailVerified: Boolean(profile.verified),\n          ...userMap\n        },\n        data: {\n          ...profile\n        }\n      };\n    }\n  };\n};\n\nconst kakao = (options) => {\n  return {\n    id: \"kakao\",\n    name: \"Kakao\",\n    createAuthorizationURL({ state, scopes, redirectURI }) {\n      const _scopes = options.disableDefaultScope ? [] : [\"account_email\", \"profile_image\", \"profile_nickname\"];\n      options.scope && _scopes.push(...options.scope);\n      scopes && _scopes.push(...scopes);\n      return (0,_better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.createAuthorizationURL)({\n        id: \"kakao\",\n        options,\n        authorizationEndpoint: \"https://kauth.kakao.com/oauth/authorize\",\n        scopes: _scopes,\n        state,\n        redirectURI\n      });\n    },\n    validateAuthorizationCode: async ({ code, redirectURI }) => {\n      return (0,_better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.validateAuthorizationCode)({\n        code,\n        redirectURI,\n        options,\n        tokenEndpoint: \"https://kauth.kakao.com/oauth/token\"\n      });\n    },\n    refreshAccessToken: options.refreshAccessToken ? options.refreshAccessToken : async (refreshToken) => {\n      return (0,_better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.refreshAccessToken)({\n        refreshToken,\n        options: {\n          clientId: options.clientId,\n          clientKey: options.clientKey,\n          clientSecret: options.clientSecret\n        },\n        tokenEndpoint: \"https://kauth.kakao.com/oauth/token\"\n      });\n    },\n    async getUserInfo(token) {\n      if (options.getUserInfo) {\n        return options.getUserInfo(token);\n      }\n      const { data: profile, error } = await (0,_better_fetch_fetch__WEBPACK_IMPORTED_MODULE_0__.betterFetch)(\n        \"https://kapi.kakao.com/v2/user/me\",\n        {\n          headers: {\n            Authorization: `Bearer ${token.accessToken}`\n          }\n        }\n      );\n      if (error || !profile) {\n        return null;\n      }\n      const userMap = await options.mapProfileToUser?.(profile);\n      const account = profile.kakao_account || {};\n      const kakaoProfile = account.profile || {};\n      const user = {\n        id: String(profile.id),\n        name: kakaoProfile.nickname || account.name || void 0,\n        email: account.email,\n        image: kakaoProfile.profile_image_url || kakaoProfile.thumbnail_image_url,\n        emailVerified: !!account.is_email_valid && !!account.is_email_verified,\n        ...userMap\n      };\n      return {\n        user,\n        data: profile\n      };\n    },\n    options\n  };\n};\n\nconst naver = (options) => {\n  return {\n    id: \"naver\",\n    name: \"Naver\",\n    createAuthorizationURL({ state, scopes, redirectURI }) {\n      const _scopes = options.disableDefaultScope ? [] : [\"profile\", \"email\"];\n      options.scope && _scopes.push(...options.scope);\n      scopes && _scopes.push(...scopes);\n      return (0,_better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.createAuthorizationURL)({\n        id: \"naver\",\n        options,\n        authorizationEndpoint: \"https://nid.naver.com/oauth2.0/authorize\",\n        scopes: _scopes,\n        state,\n        redirectURI\n      });\n    },\n    validateAuthorizationCode: async ({ code, redirectURI }) => {\n      return (0,_better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.validateAuthorizationCode)({\n        code,\n        redirectURI,\n        options,\n        tokenEndpoint: \"https://nid.naver.com/oauth2.0/token\"\n      });\n    },\n    refreshAccessToken: options.refreshAccessToken ? options.refreshAccessToken : async (refreshToken) => {\n      return (0,_better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.refreshAccessToken)({\n        refreshToken,\n        options: {\n          clientId: options.clientId,\n          clientKey: options.clientKey,\n          clientSecret: options.clientSecret\n        },\n        tokenEndpoint: \"https://nid.naver.com/oauth2.0/token\"\n      });\n    },\n    async getUserInfo(token) {\n      if (options.getUserInfo) {\n        return options.getUserInfo(token);\n      }\n      const { data: profile, error } = await (0,_better_fetch_fetch__WEBPACK_IMPORTED_MODULE_0__.betterFetch)(\n        \"https://openapi.naver.com/v1/nid/me\",\n        {\n          headers: {\n            Authorization: `Bearer ${token.accessToken}`\n          }\n        }\n      );\n      if (error || !profile || profile.resultcode !== \"00\") {\n        return null;\n      }\n      const userMap = await options.mapProfileToUser?.(profile);\n      const res = profile.response || {};\n      const user = {\n        id: res.id,\n        name: res.name || res.nickname,\n        email: res.email,\n        image: res.profile_image,\n        emailVerified: false,\n        ...userMap\n      };\n      return {\n        user,\n        data: profile\n      };\n    },\n    options\n  };\n};\n\nconst line = (options) => {\n  const authorizationEndpoint = \"https://access.line.me/oauth2/v2.1/authorize\";\n  const tokenEndpoint = \"https://api.line.me/oauth2/v2.1/token\";\n  const userInfoEndpoint = \"https://api.line.me/oauth2/v2.1/userinfo\";\n  const verifyIdTokenEndpoint = \"https://api.line.me/oauth2/v2.1/verify\";\n  return {\n    id: \"line\",\n    name: \"LINE\",\n    async createAuthorizationURL({\n      state,\n      scopes,\n      codeVerifier,\n      redirectURI,\n      loginHint\n    }) {\n      const _scopes = options.disableDefaultScope ? [] : [\"openid\", \"profile\", \"email\"];\n      options.scope && _scopes.push(...options.scope);\n      scopes && _scopes.push(...scopes);\n      return await (0,_better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.createAuthorizationURL)({\n        id: \"line\",\n        options,\n        authorizationEndpoint,\n        scopes: _scopes,\n        state,\n        codeVerifier,\n        redirectURI,\n        loginHint\n      });\n    },\n    validateAuthorizationCode: async ({ code, codeVerifier, redirectURI }) => {\n      return (0,_better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.validateAuthorizationCode)({\n        code,\n        codeVerifier,\n        redirectURI,\n        options,\n        tokenEndpoint\n      });\n    },\n    refreshAccessToken: options.refreshAccessToken ? options.refreshAccessToken : async (refreshToken) => {\n      return (0,_better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.refreshAccessToken)({\n        refreshToken,\n        options: {\n          clientId: options.clientId,\n          clientSecret: options.clientSecret\n        },\n        tokenEndpoint\n      });\n    },\n    async verifyIdToken(token, nonce) {\n      if (options.disableIdTokenSignIn) {\n        return false;\n      }\n      if (options.verifyIdToken) {\n        return options.verifyIdToken(token, nonce);\n      }\n      const body = new URLSearchParams();\n      body.set(\"id_token\", token);\n      body.set(\"client_id\", options.clientId);\n      if (nonce) body.set(\"nonce\", nonce);\n      const { data, error } = await (0,_better_fetch_fetch__WEBPACK_IMPORTED_MODULE_0__.betterFetch)(\n        verifyIdTokenEndpoint,\n        {\n          method: \"POST\",\n          headers: {\n            \"content-type\": \"application/x-www-form-urlencoded\"\n          },\n          body\n        }\n      );\n      if (error || !data) {\n        return false;\n      }\n      if (data.aud !== options.clientId) return false;\n      if (nonce && data.nonce && data.nonce !== nonce) return false;\n      return true;\n    },\n    async getUserInfo(token) {\n      if (options.getUserInfo) {\n        return options.getUserInfo(token);\n      }\n      let profile = null;\n      if (token.idToken) {\n        try {\n          profile = (0,jose__WEBPACK_IMPORTED_MODULE_9__.decodeJwt)(token.idToken);\n        } catch {\n        }\n      }\n      if (!profile) {\n        const { data } = await (0,_better_fetch_fetch__WEBPACK_IMPORTED_MODULE_0__.betterFetch)(userInfoEndpoint, {\n          headers: {\n            authorization: `Bearer ${token.accessToken}`\n          }\n        });\n        profile = data || null;\n      }\n      if (!profile) return null;\n      const userMap = await options.mapProfileToUser?.(profile);\n      const id = profile.sub || profile.userId;\n      const name = profile.name || profile.displayName;\n      const image = profile.picture || profile.pictureUrl || void 0;\n      const email = profile.email;\n      return {\n        user: {\n          id,\n          name,\n          email,\n          image,\n          // LINE does not expose email verification status in ID token/userinfo\n          emailVerified: false,\n          ...userMap\n        },\n        data: profile\n      };\n    },\n    options\n  };\n};\n\nconst paypal = (options) => {\n  const environment = options.environment || \"sandbox\";\n  const isSandbox = environment === \"sandbox\";\n  const authorizationEndpoint = isSandbox ? \"https://www.sandbox.paypal.com/signin/authorize\" : \"https://www.paypal.com/signin/authorize\";\n  const tokenEndpoint = isSandbox ? \"https://api-m.sandbox.paypal.com/v1/oauth2/token\" : \"https://api-m.paypal.com/v1/oauth2/token\";\n  const userInfoEndpoint = isSandbox ? \"https://api-m.sandbox.paypal.com/v1/identity/oauth2/userinfo\" : \"https://api-m.paypal.com/v1/identity/oauth2/userinfo\";\n  return {\n    id: \"paypal\",\n    name: \"PayPal\",\n    async createAuthorizationURL({ state, codeVerifier, redirectURI }) {\n      if (!options.clientId || !options.clientSecret) {\n        _better_auth_core_env__WEBPACK_IMPORTED_MODULE_4__.logger.error(\n          \"Client Id and Client Secret is required for PayPal. Make sure to provide them in the options.\"\n        );\n        throw new _error_index_mjs__WEBPACK_IMPORTED_MODULE_3__.BetterAuthError(\"CLIENT_ID_AND_SECRET_REQUIRED\");\n      }\n      const _scopes = [];\n      const url = await (0,_better_auth_core_oauth2__WEBPACK_IMPORTED_MODULE_2__.createAuthorizationURL)({\n        id: \"paypal\",\n        options,\n        authorizationEndpoint,\n        scopes: _scopes,\n        state,\n        codeVerifier,\n        redirectURI,\n        prompt: options.prompt\n      });\n      return url;\n    },\n    validateAuthorizationCode: async ({ code, redirectURI }) => {\n      const credentials = _better_auth_utils_base64__WEBPACK_IMPORTED_MODULE_5__.base64.encode(\n        `${options.clientId}:${options.clientSecret}`\n      );\n      try {\n        const response = await (0,_better_fetch_fetch__WEBPACK_IMPORTED_MODULE_0__.betterFetch)(tokenEndpoint, {\n          method: \"POST\",\n          headers: {\n            Authorization: `Basic ${credentials}`,\n            Accept: \"application/json\",\n            \"Accept-Language\": \"en_US\",\n            \"Content-Type\": \"application/x-www-form-urlencoded\"\n          },\n          body: new URLSearchParams({\n            grant_type: \"authorization_code\",\n            code,\n            redirect_uri: redirectURI\n          }).toString()\n        });\n        if (!response.data) {\n          throw new _error_index_mjs__WEBPACK_IMPORTED_MODULE_3__.BetterAuthError(\"FAILED_TO_GET_ACCESS_TOKEN\");\n        }\n        const data = response.data;\n        const result = {\n          accessToken: data.access_token,\n          refreshToken: data.refresh_token,\n          accessTokenExpiresAt: data.expires_in ? new Date(Date.now() + data.expires_in * 1e3) : void 0,\n          idToken: data.id_token\n        };\n        return result;\n      } catch (error) {\n        _better_auth_core_env__WEBPACK_IMPORTED_MODULE_4__.logger.error(\"PayPal token exchange failed:\", error);\n        throw new _error_index_mjs__WEBPACK_IMPORTED_MODULE_3__.BetterAuthError(\"FAILED_TO_GET_ACCESS_TOKEN\");\n      }\n    },\n    refreshAccessToken: options.refreshAccessToken ? options.refreshAccessToken : async (refreshToken) => {\n      const credentials = _better_auth_utils_base64__WEBPACK_IMPORTED_MODULE_5__.base64.encode(\n        `${options.clientId}:${options.clientSecret}`\n      );\n      try {\n        const response = await (0,_better_fetch_fetch__WEBPACK_IMPORTED_MODULE_0__.betterFetch)(tokenEndpoint, {\n          method: \"POST\",\n          headers: {\n            Authorization: `Basic ${credentials}`,\n            Accept: \"application/json\",\n            \"Accept-Language\": \"en_US\",\n            \"Content-Type\": \"application/x-www-form-urlencoded\"\n          },\n          body: new URLSearchParams({\n            grant_type: \"refresh_token\",\n            refresh_token: refreshToken\n          }).toString()\n        });\n        if (!response.data) {\n          throw new _error_index_mjs__WEBPACK_IMPORTED_MODULE_3__.BetterAuthError(\"FAILED_TO_REFRESH_ACCESS_TOKEN\");\n        }\n        const data = response.data;\n        return {\n          accessToken: data.access_token,\n          refreshToken: data.refresh_token,\n          accessTokenExpiresAt: data.expires_in ? new Date(Date.now() + data.expires_in * 1e3) : void 0\n        };\n      } catch (error) {\n        _better_auth_core_env__WEBPACK_IMPORTED_MODULE_4__.logger.error(\"PayPal token refresh failed:\", error);\n        throw new _error_index_mjs__WEBPACK_IMPORTED_MODULE_3__.BetterAuthError(\"FAILED_TO_REFRESH_ACCESS_TOKEN\");\n      }\n    },\n    async verifyIdToken(token, nonce) {\n      if (options.disableIdTokenSignIn) {\n        return false;\n      }\n      if (options.verifyIdToken) {\n        return options.verifyIdToken(token, nonce);\n      }\n      try {\n        const payload = (0,jose__WEBPACK_IMPORTED_MODULE_9__.decodeJwt)(token);\n        return !!payload.sub;\n      } catch (error) {\n        _better_auth_core_env__WEBPACK_IMPORTED_MODULE_4__.logger.error(\"Failed to verify PayPal ID token:\", error);\n        return false;\n      }\n    },\n    async getUserInfo(token) {\n      if (options.getUserInfo) {\n        return options.getUserInfo(token);\n      }\n      if (!token.accessToken) {\n        _better_auth_core_env__WEBPACK_IMPORTED_MODULE_4__.logger.error(\"Access token is required to fetch PayPal user info\");\n        return null;\n      }\n      try {\n        const response = await (0,_better_fetch_fetch__WEBPACK_IMPORTED_MODULE_0__.betterFetch)(\n          `${userInfoEndpoint}?schema=paypalv1.1`,\n          {\n            headers: {\n              Authorization: `Bearer ${token.accessToken}`,\n              Accept: \"application/json\"\n            }\n          }\n        );\n        if (!response.data) {\n          _better_auth_core_env__WEBPACK_IMPORTED_MODULE_4__.logger.error(\"Failed to fetch user info from PayPal\");\n          return null;\n        }\n        const userInfo = response.data;\n        const userMap = await options.mapProfileToUser?.(userInfo);\n        const result = {\n          user: {\n            id: userInfo.user_id,\n            name: userInfo.name,\n            email: userInfo.email,\n            image: userInfo.picture,\n            emailVerified: userInfo.email_verified,\n            ...userMap\n          },\n          data: userInfo\n        };\n        return result;\n      } catch (error) {\n        _better_auth_core_env__WEBPACK_IMPORTED_MODULE_4__.logger.error(\"Failed to fetch user info from PayPal:\", error);\n        return null;\n      }\n    },\n    options\n  };\n};\n\nconst socialProviders = {\n  apple,\n  atlassian,\n  cognito,\n  discord,\n  facebook,\n  figma,\n  github,\n  microsoft,\n  google,\n  huggingface,\n  slack,\n  spotify,\n  twitch,\n  twitter,\n  dropbox,\n  kick,\n  linear,\n  linkedin,\n  gitlab,\n  tiktok,\n  reddit,\n  roblox,\n  salesforce,\n  vk,\n  zoom,\n  notion,\n  kakao,\n  naver,\n  line,\n  paypal\n};\nconst socialProviderList = Object.keys(socialProviders);\nconst SocialProviderListEnum = zod__WEBPACK_IMPORTED_MODULE_12__[\"enum\"](socialProviderList).or(zod__WEBPACK_IMPORTED_MODULE_12__.string());\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvQGJldHRlci1hdXRoL2NvcmUvZGlzdC9zb2NpYWwtcHJvdmlkZXJzL2luZGV4Lm1qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBeUI7QUFDeUI7QUFDWDtBQUMyRDtBQUN1RDtBQUNwRztBQUNOO0FBQ0k7QUFDbEI7O0FBRWpDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtQ0FBbUMsNEJBQTRCO0FBQy9EO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QixnRkFBc0I7QUFDOUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBLEtBQUs7QUFDTCx3Q0FBd0MsaUNBQWlDO0FBQ3pFLGFBQWEsbUZBQXlCO0FBQ3RDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1AsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNEJBQTRCLDJEQUFxQjtBQUNqRCxjQUFjLG1CQUFtQjtBQUNqQztBQUNBO0FBQ0EsY0FBYyxxQkFBcUIsUUFBUSwrQ0FBUztBQUNwRDtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLGFBQWEsNEVBQWtCO0FBQy9CO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQSxPQUFPO0FBQ1AsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esc0JBQXNCLCtDQUFTO0FBQy9CO0FBQ0E7QUFDQTtBQUNBLG1DQUFtQyw0QkFBNEIsRUFBRSwwQkFBMEI7QUFDM0Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FB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QTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0E7QUFDQSxRQUFRO0FBQ1IsUUFBUSx5REFBTTtBQUNkO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLCtCQUErQix5Q0FBTSx3QkFBd0Isd0NBQVE7O0FBRW1TIiwic291cmNlcyI6WyJDOlxcVXNlcnNcXHNpZDAxXFxPbmVEcml2ZVxcRGVza3RvcFxcYW1kLXRlbGVwaG9ueS1zeXN0ZW1cXGZyb250ZW5kXFxub2RlX21vZHVsZXNcXEBiZXR0ZXItYXV0aFxcY29yZVxcZGlzdFxcc29jaWFsLXByb3ZpZGVyc1xcaW5kZXgubWpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCAqIGFzIHogZnJvbSAnem9kJztcbmltcG9ydCB7IGJldHRlckZldGNoIH0gZnJvbSAnQGJldHRlci1mZXRjaC9mZXRjaCc7XG5pbXBvcnQgeyBBUElFcnJvciB9IGZyb20gJ2JldHRlci1jYWxsJztcbmltcG9ydCB7IGRlY29kZUp3dCwgZGVjb2RlUHJvdGVjdGVkSGVhZGVyLCBqd3RWZXJpZnksIGltcG9ydEpXSywgY3JlYXRlUmVtb3RlSldLU2V0IH0gZnJvbSAnam9zZSc7XG5pbXBvcnQgeyByZWZyZXNoQWNjZXNzVG9rZW4sIHZhbGlkYXRlQXV0aG9yaXphdGlvbkNvZGUsIGNyZWF0ZUF1dGhvcml6YXRpb25VUkwsIGdldE9BdXRoMlRva2VucywgZ2VuZXJhdGVDb2RlQ2hhbGxlbmdlIH0gZnJvbSAnQGJldHRlci1hdXRoL2NvcmUvb2F1dGgyJztcbmltcG9ydCB7IEJldHRlckF1dGhFcnJvciB9IGZyb20gJy4uL2Vycm9yL2luZGV4Lm1qcyc7XG5pbXBvcnQgeyBsb2dnZXIgfSBmcm9tICdAYmV0dGVyLWF1dGgvY29yZS9lbnYnO1xuaW1wb3J0IHsgYmFzZTY0IH0gZnJvbSAnQGJldHRlci1hdXRoL3V0aWxzL2Jhc2U2NCc7XG5pbXBvcnQgJ0BiZXR0ZXItYXV0aC9jb3JlL3V0aWxzJztcblxuY29uc3QgYXBwbGUgPSAob3B0aW9ucykgPT4ge1xuICBjb25zdCB0b2tlbkVuZHBvaW50ID0gXCJodHRwczovL2FwcGxlaWQuYXBwbGUuY29tL2F1dGgvdG9rZW5cIjtcbiAgcmV0dXJuIHtcbiAgICBpZDogXCJhcHBsZVwiLFxuICAgIG5hbWU6IFwiQXBwbGVcIixcbiAgICBhc3luYyBjcmVhdGVBdXRob3JpemF0aW9uVVJMKHsgc3RhdGUsIHNjb3BlcywgcmVkaXJlY3RVUkkgfSkge1xuICAgICAgY29uc3QgX3Njb3BlID0gb3B0aW9ucy5kaXNhYmxlRGVmYXVsdFNjb3BlID8gW10gOiBbXCJlbWFpbFwiLCBcIm5hbWVcIl07XG4gICAgICBvcHRpb25zLnNjb3BlICYmIF9zY29wZS5wdXNoKC4uLm9wdGlvbnMuc2NvcGUpO1xuICAgICAgc2NvcGVzICYmIF9zY29wZS5wdXNoKC4uLnNjb3Blcyk7XG4gICAgICBjb25zdCB1cmwgPSBhd2FpdCBjcmVhdGVBdXRob3JpemF0aW9uVVJMKHtcbiAgICAgICAgaWQ6IFwiYXBwbGVcIixcbiAgICAgICAgb3B0aW9ucyxcbiAgICAgICAgYXV0aG9yaXphdGlvbkVuZHBvaW50OiBcImh0dHBzOi8vYXBwbGVpZC5hcHBsZS5jb20vYXV0aC9hdXRob3JpemVcIixcbiAgICAgICAgc2NvcGVzOiBfc2NvcGUsXG4gICAgICAgIHN0YXRlLFxuICAgICAgICByZWRpcmVjdFVSSSxcbiAgICAgICAgcmVzcG9uc2VNb2RlOiBcImZvcm1fcG9zdFwiLFxuICAgICAgICByZXNwb25zZVR5cGU6IFwiY29kZSBpZF90b2tlblwiXG4gICAgICB9KTtcbiAgICAgIHJldHVybiB1cmw7XG4gICAgfSxcbiAgICB2YWxpZGF0ZUF1dGhvcml6YXRpb25Db2RlOiBhc3luYyAoeyBjb2RlLCBjb2RlVmVyaWZpZXIsIHJlZGlyZWN0VVJJIH0pID0+IHtcbiAgICAgIHJldHVybiB2YWxpZGF0ZUF1dGhvcml6YXRpb25Db2RlKHtcbiAgICAgICAgY29kZSxcbiAgICAgICAgY29kZVZlcmlmaWVyLFxuICAgICAgICByZWRpcmVjdFVSSSxcbiAgICAgICAgb3B0aW9ucyxcbiAgICAgICAgdG9rZW5FbmRwb2ludFxuICAgICAgfSk7XG4gICAgfSxcbiAgICBhc3luYyB2ZXJpZnlJZFRva2VuKHRva2VuLCBub25jZSkge1xuICAgICAgaWYgKG9wdGlvbnMuZGlzYWJsZUlkVG9rZW5TaWduSW4pIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfVxuICAgICAgaWYgKG9wdGlvbnMudmVyaWZ5SWRUb2tlbikge1xuICAgICAgICByZXR1cm4gb3B0aW9ucy52ZXJpZnlJZFRva2VuKHRva2VuLCBub25jZSk7XG4gICAgICB9XG4gICAgICBjb25zdCBkZWNvZGVkSGVhZGVyID0gZGVjb2RlUHJvdGVjdGVkSGVhZGVyKHRva2VuKTtcbiAgICAgIGNvbnN0IHsga2lkLCBhbGc6IGp3dEFsZyB9ID0gZGVjb2RlZEhlYWRlcjtcbiAgICAgIGlmICgha2lkIHx8ICFqd3RBbGcpIHJldHVybiBmYWxzZTtcbiAgICAgIGNvbnN0IHB1YmxpY0tleSA9IGF3YWl0IGdldEFwcGxlUHVibGljS2V5KGtpZCk7XG4gICAgICBjb25zdCB7IHBheWxvYWQ6IGp3dENsYWltcyB9ID0gYXdhaXQgand0VmVyaWZ5KHRva2VuLCBwdWJsaWNLZXksIHtcbiAgICAgICAgYWxnb3JpdGhtczogW2p3dEFsZ10sXG4gICAgICAgIGlzc3VlcjogXCJodHRwczovL2FwcGxlaWQuYXBwbGUuY29tXCIsXG4gICAgICAgIGF1ZGllbmNlOiBvcHRpb25zLmF1ZGllbmNlICYmIG9wdGlvbnMuYXVkaWVuY2UubGVuZ3RoID8gb3B0aW9ucy5hdWRpZW5jZSA6IG9wdGlvbnMuYXBwQnVuZGxlSWRlbnRpZmllciA/IG9wdGlvbnMuYXBwQnVuZGxlSWRlbnRpZmllciA6IG9wdGlvbnMuY2xpZW50SWQsXG4gICAgICAgIG1heFRva2VuQWdlOiBcIjFoXCJcbiAgICAgIH0pO1xuICAgICAgW1wiZW1haWxfdmVyaWZpZWRcIiwgXCJpc19wcml2YXRlX2VtYWlsXCJdLmZvckVhY2goKGZpZWxkKSA9PiB7XG4gICAgICAgIGlmIChqd3RDbGFpbXNbZmllbGRdICE9PSB2b2lkIDApIHtcbiAgICAgICAgICBqd3RDbGFpbXNbZmllbGRdID0gQm9vbGVhbihqd3RDbGFpbXNbZmllbGRdKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgICBpZiAobm9uY2UgJiYgand0Q2xhaW1zLm5vbmNlICE9PSBub25jZSkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9XG4gICAgICByZXR1cm4gISFqd3RDbGFpbXM7XG4gICAgfSxcbiAgICByZWZyZXNoQWNjZXNzVG9rZW46IG9wdGlvbnMucmVmcmVzaEFjY2Vzc1Rva2VuID8gb3B0aW9ucy5yZWZyZXNoQWNjZXNzVG9rZW4gOiBhc3luYyAocmVmcmVzaFRva2VuKSA9PiB7XG4gICAgICByZXR1cm4gcmVmcmVzaEFjY2Vzc1Rva2VuKHtcbiAgICAgICAgcmVmcmVzaFRva2VuLFxuICAgICAgICBvcHRpb25zOiB7XG4gICAgICAgICAgY2xpZW50SWQ6IG9wdGlvbnMuY2xpZW50SWQsXG4gICAgICAgICAgY2xpZW50S2V5OiBvcHRpb25zLmNsaWVudEtleSxcbiAgICAgICAgICBjbGllbnRTZWNyZXQ6IG9wdGlvbnMuY2xpZW50U2VjcmV0XG4gICAgICAgIH0sXG4gICAgICAgIHRva2VuRW5kcG9pbnQ6IFwiaHR0cHM6Ly9hcHBsZWlkLmFwcGxlLmNvbS9hdXRoL3Rva2VuXCJcbiAgICAgIH0pO1xuICAgIH0sXG4gICAgYXN5bmMgZ2V0VXNlckluZm8odG9rZW4pIHtcbiAgICAgIGlmIChvcHRpb25zLmdldFVzZXJJbmZvKSB7XG4gICAgICAgIHJldHVybiBvcHRpb25zLmdldFVzZXJJbmZvKHRva2VuKTtcbiAgICAgIH1cbiAgICAgIGlmICghdG9rZW4uaWRUb2tlbikge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgIH1cbiAgICAgIGNvbnN0IHByb2ZpbGUgPSBkZWNvZGVKd3QodG9rZW4uaWRUb2tlbik7XG4gICAgICBpZiAoIXByb2ZpbGUpIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICB9XG4gICAgICBjb25zdCBuYW1lID0gdG9rZW4udXNlciA/IGAke3Rva2VuLnVzZXIubmFtZT8uZmlyc3ROYW1lfSAke3Rva2VuLnVzZXIubmFtZT8ubGFzdE5hbWV9YCA6IHByb2ZpbGUubmFtZSB8fCBwcm9maWxlLmVtYWlsO1xuICAgICAgY29uc3QgZW1haWxWZXJpZmllZCA9IHR5cGVvZiBwcm9maWxlLmVtYWlsX3ZlcmlmaWVkID09PSBcImJvb2xlYW5cIiA/IHByb2ZpbGUuZW1haWxfdmVyaWZpZWQgOiBwcm9maWxlLmVtYWlsX3ZlcmlmaWVkID09PSBcInRydWVcIjtcbiAgICAgIGNvbnN0IGVucmljaGVkUHJvZmlsZSA9IHtcbiAgICAgICAgLi4ucHJvZmlsZSxcbiAgICAgICAgbmFtZVxuICAgICAgfTtcbiAgICAgIGNvbnN0IHVzZXJNYXAgPSBhd2FpdCBvcHRpb25zLm1hcFByb2ZpbGVUb1VzZXI/LihlbnJpY2hlZFByb2ZpbGUpO1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgdXNlcjoge1xuICAgICAgICAgIGlkOiBwcm9maWxlLnN1YixcbiAgICAgICAgICBuYW1lOiBlbnJpY2hlZFByb2ZpbGUubmFtZSxcbiAgICAgICAgICBlbWFpbFZlcmlmaWVkLFxuICAgICAgICAgIGVtYWlsOiBwcm9maWxlLmVtYWlsLFxuICAgICAgICAgIC4uLnVzZXJNYXBcbiAgICAgICAgfSxcbiAgICAgICAgZGF0YTogZW5yaWNoZWRQcm9maWxlXG4gICAgICB9O1xuICAgIH0sXG4gICAgb3B0aW9uc1xuICB9O1xufTtcbmNvbnN0IGdldEFwcGxlUHVibGljS2V5ID0gYXN5bmMgKGtpZCkgPT4ge1xuICBjb25zdCBBUFBMRV9CQVNFX1VSTCA9IFwiaHR0cHM6Ly9hcHBsZWlkLmFwcGxlLmNvbVwiO1xuICBjb25zdCBKV0tTX0FQUExFX1VSSSA9IFwiL2F1dGgva2V5c1wiO1xuICBjb25zdCB7IGRhdGEgfSA9IGF3YWl0IGJldHRlckZldGNoKGAke0FQUExFX0JBU0VfVVJMfSR7SldLU19BUFBMRV9VUkl9YCk7XG4gIGlmICghZGF0YT8ua2V5cykge1xuICAgIHRocm93IG5ldyBBUElFcnJvcihcIkJBRF9SRVFVRVNUXCIsIHtcbiAgICAgIG1lc3NhZ2U6IFwiS2V5cyBub3QgZm91bmRcIlxuICAgIH0pO1xuICB9XG4gIGNvbnN0IGp3ayA9IGRhdGEua2V5cy5maW5kKChrZXkpID0+IGtleS5raWQgPT09IGtpZCk7XG4gIGlmICghandrKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKGBKV0sgd2l0aCBraWQgJHtraWR9IG5vdCBmb3VuZGApO1xuICB9XG4gIHJldHVybiBhd2FpdCBpbXBvcnRKV0soandrLCBqd2suYWxnKTtcbn07XG5cbmNvbnN0IGF0bGFzc2lhbiA9IChvcHRpb25zKSA9PiB7XG4gIHJldHVybiB7XG4gICAgaWQ6IFwiYXRsYXNzaWFuXCIsXG4gICAgbmFtZTogXCJBdGxhc3NpYW5cIixcbiAgICBhc3luYyBjcmVhdGVBdXRob3JpemF0aW9uVVJMKHsgc3RhdGUsIHNjb3BlcywgY29kZVZlcmlmaWVyLCByZWRpcmVjdFVSSSB9KSB7XG4gICAgICBpZiAoIW9wdGlvbnMuY2xpZW50SWQgfHwgIW9wdGlvbnMuY2xpZW50U2VjcmV0KSB7XG4gICAgICAgIGxvZ2dlci5lcnJvcihcIkNsaWVudCBJZCBhbmQgU2VjcmV0IGFyZSByZXF1aXJlZCBmb3IgQXRsYXNzaWFuXCIpO1xuICAgICAgICB0aHJvdyBuZXcgQmV0dGVyQXV0aEVycm9yKFwiQ0xJRU5UX0lEX0FORF9TRUNSRVRfUkVRVUlSRURcIik7XG4gICAgICB9XG4gICAgICBpZiAoIWNvZGVWZXJpZmllcikge1xuICAgICAgICB0aHJvdyBuZXcgQmV0dGVyQXV0aEVycm9yKFwiY29kZVZlcmlmaWVyIGlzIHJlcXVpcmVkIGZvciBBdGxhc3NpYW5cIik7XG4gICAgICB9XG4gICAgICBjb25zdCBfc2NvcGVzID0gb3B0aW9ucy5kaXNhYmxlRGVmYXVsdFNjb3BlID8gW10gOiBbXCJyZWFkOmppcmEtdXNlclwiLCBcIm9mZmxpbmVfYWNjZXNzXCJdO1xuICAgICAgb3B0aW9ucy5zY29wZSAmJiBfc2NvcGVzLnB1c2goLi4ub3B0aW9ucy5zY29wZSk7XG4gICAgICBzY29wZXMgJiYgX3Njb3Blcy5wdXNoKC4uLnNjb3Blcyk7XG4gICAgICByZXR1cm4gY3JlYXRlQXV0aG9yaXphdGlvblVSTCh7XG4gICAgICAgIGlkOiBcImF0bGFzc2lhblwiLFxuICAgICAgICBvcHRpb25zLFxuICAgICAgICBhdXRob3JpemF0aW9uRW5kcG9pbnQ6IFwiaHR0cHM6Ly9hdXRoLmF0bGFzc2lhbi5jb20vYXV0aG9yaXplXCIsXG4gICAgICAgIHNjb3BlczogX3Njb3BlcyxcbiAgICAgICAgc3RhdGUsXG4gICAgICAgIGNvZGVWZXJpZmllcixcbiAgICAgICAgcmVkaXJlY3RVUkksXG4gICAgICAgIGFkZGl0aW9uYWxQYXJhbXM6IHtcbiAgICAgICAgICBhdWRpZW5jZTogXCJhcGkuYXRsYXNzaWFuLmNvbVwiXG4gICAgICAgIH0sXG4gICAgICAgIHByb21wdDogb3B0aW9ucy5wcm9tcHRcbiAgICAgIH0pO1xuICAgIH0sXG4gICAgdmFsaWRhdGVBdXRob3JpemF0aW9uQ29kZTogYXN5bmMgKHsgY29kZSwgY29kZVZlcmlmaWVyLCByZWRpcmVjdFVSSSB9KSA9PiB7XG4gICAgICByZXR1cm4gdmFsaWRhdGVBdXRob3JpemF0aW9uQ29kZSh7XG4gICAgICAgIGNvZGUsXG4gICAgICAgIGNvZGVWZXJpZmllcixcbiAgICAgICAgcmVkaXJlY3RVUkksXG4gICAgICAgIG9wdGlvbnMsXG4gICAgICAgIHRva2VuRW5kcG9pbnQ6IFwiaHR0cHM6Ly9hdXRoLmF0bGFzc2lhbi5jb20vb2F1dGgvdG9rZW5cIlxuICAgICAgfSk7XG4gICAgfSxcbiAgICByZWZyZXNoQWNjZXNzVG9rZW46IG9wdGlvbnMucmVmcmVzaEFjY2Vzc1Rva2VuID8gb3B0aW9ucy5yZWZyZXNoQWNjZXNzVG9rZW4gOiBhc3luYyAocmVmcmVzaFRva2VuKSA9PiB7XG4gICAgICByZXR1cm4gcmVmcmVzaEFjY2Vzc1Rva2VuKHtcbiAgICAgICAgcmVmcmVzaFRva2VuLFxuICAgICAgICBvcHRpb25zOiB7XG4gICAgICAgICAgY2xpZW50SWQ6IG9wdGlvbnMuY2xpZW50SWQsXG4gICAgICAgICAgY2xpZW50U2VjcmV0OiBvcHRpb25zLmNsaWVudFNlY3JldFxuICAgICAgICB9LFxuICAgICAgICB0b2tlbkVuZHBvaW50OiBcImh0dHBzOi8vYXV0aC5hdGxhc3NpYW4uY29tL29hdXRoL3Rva2VuXCJcbiAgICAgIH0pO1xuICAgIH0sXG4gICAgYXN5bmMgZ2V0VXNlckluZm8odG9rZW4pIHtcbiAgICAgIGlmIChvcHRpb25zLmdldFVzZXJJbmZvKSB7XG4gICAgICAgIHJldHVybiBvcHRpb25zLmdldFVzZXJJbmZvKHRva2VuKTtcbiAgICAgIH1cbiAgICAgIGlmICghdG9rZW4uYWNjZXNzVG9rZW4pIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICB9XG4gICAgICB0cnkge1xuICAgICAgICBjb25zdCB7IGRhdGE6IHByb2ZpbGUgfSA9IGF3YWl0IGJldHRlckZldGNoKFwiaHR0cHM6Ly9hcGkuYXRsYXNzaWFuLmNvbS9tZVwiLCB7XG4gICAgICAgICAgaGVhZGVyczogeyBBdXRob3JpemF0aW9uOiBgQmVhcmVyICR7dG9rZW4uYWNjZXNzVG9rZW59YCB9XG4gICAgICAgIH0pO1xuICAgICAgICBpZiAoIXByb2ZpbGUpIHJldHVybiBudWxsO1xuICAgICAgICBjb25zdCB1c2VyTWFwID0gYXdhaXQgb3B0aW9ucy5tYXBQcm9maWxlVG9Vc2VyPy4ocHJvZmlsZSk7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgdXNlcjoge1xuICAgICAgICAgICAgaWQ6IHByb2ZpbGUuYWNjb3VudF9pZCxcbiAgICAgICAgICAgIG5hbWU6IHByb2ZpbGUubmFtZSxcbiAgICAgICAgICAgIGVtYWlsOiBwcm9maWxlLmVtYWlsLFxuICAgICAgICAgICAgaW1hZ2U6IHByb2ZpbGUucGljdHVyZSxcbiAgICAgICAgICAgIGVtYWlsVmVyaWZpZWQ6IGZhbHNlLFxuICAgICAgICAgICAgLi4udXNlck1hcFxuICAgICAgICAgIH0sXG4gICAgICAgICAgZGF0YTogcHJvZmlsZVxuICAgICAgICB9O1xuICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgbG9nZ2VyLmVycm9yKFwiRmFpbGVkIHRvIGZldGNoIHVzZXIgaW5mbyBmcm9tIEZpZ21hOlwiLCBlcnJvcik7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgICAgfVxuICAgIH0sXG4gICAgb3B0aW9uc1xuICB9O1xufTtcblxuY29uc3QgY29nbml0byA9IChvcHRpb25zKSA9PiB7XG4gIGlmICghb3B0aW9ucy5kb21haW4gfHwgIW9wdGlvbnMucmVnaW9uIHx8ICFvcHRpb25zLnVzZXJQb29sSWQpIHtcbiAgICBsb2dnZXIuZXJyb3IoXG4gICAgICBcIkRvbWFpbiwgcmVnaW9uIGFuZCB1c2VyUG9vbElkIGFyZSByZXF1aXJlZCBmb3IgQW1hem9uIENvZ25pdG8uIE1ha2Ugc3VyZSB0byBwcm92aWRlIHRoZW0gaW4gdGhlIG9wdGlvbnMuXCJcbiAgICApO1xuICAgIHRocm93IG5ldyBCZXR0ZXJBdXRoRXJyb3IoXCJET01BSU5fQU5EX1JFR0lPTl9SRVFVSVJFRFwiKTtcbiAgfVxuICBjb25zdCBjbGVhbkRvbWFpbiA9IG9wdGlvbnMuZG9tYWluLnJlcGxhY2UoL15odHRwcz86XFwvXFwvLywgXCJcIik7XG4gIGNvbnN0IGF1dGhvcml6YXRpb25FbmRwb2ludCA9IGBodHRwczovLyR7Y2xlYW5Eb21haW59L29hdXRoMi9hdXRob3JpemVgO1xuICBjb25zdCB0b2tlbkVuZHBvaW50ID0gYGh0dHBzOi8vJHtjbGVhbkRvbWFpbn0vb2F1dGgyL3Rva2VuYDtcbiAgY29uc3QgdXNlckluZm9FbmRwb2ludCA9IGBodHRwczovLyR7Y2xlYW5Eb21haW59L29hdXRoMi91c2VyaW5mb2A7XG4gIHJldHVybiB7XG4gICAgaWQ6IFwiY29nbml0b1wiLFxuICAgIG5hbWU6IFwiQ29nbml0b1wiLFxuICAgIGFzeW5jIGNyZWF0ZUF1dGhvcml6YXRpb25VUkwoeyBzdGF0ZSwgc2NvcGVzLCBjb2RlVmVyaWZpZXIsIHJlZGlyZWN0VVJJIH0pIHtcbiAgICAgIGlmICghb3B0aW9ucy5jbGllbnRJZCkge1xuICAgICAgICBsb2dnZXIuZXJyb3IoXG4gICAgICAgICAgXCJDbGllbnRJZCBpcyByZXF1aXJlZCBmb3IgQW1hem9uIENvZ25pdG8uIE1ha2Ugc3VyZSB0byBwcm92aWRlIHRoZW0gaW4gdGhlIG9wdGlvbnMuXCJcbiAgICAgICAgKTtcbiAgICAgICAgdGhyb3cgbmV3IEJldHRlckF1dGhFcnJvcihcIkNMSUVOVF9JRF9BTkRfU0VDUkVUX1JFUVVJUkVEXCIpO1xuICAgICAgfVxuICAgICAgaWYgKG9wdGlvbnMucmVxdWlyZUNsaWVudFNlY3JldCAmJiAhb3B0aW9ucy5jbGllbnRTZWNyZXQpIHtcbiAgICAgICAgbG9nZ2VyLmVycm9yKFxuICAgICAgICAgIFwiQ2xpZW50IFNlY3JldCBpcyByZXF1aXJlZCB3aGVuIHJlcXVpcmVDbGllbnRTZWNyZXQgaXMgdHJ1ZS4gTWFrZSBzdXJlIHRvIHByb3ZpZGUgaXQgaW4gdGhlIG9wdGlvbnMuXCJcbiAgICAgICAgKTtcbiAgICAgICAgdGhyb3cgbmV3IEJldHRlckF1dGhFcnJvcihcIkNMSUVOVF9TRUNSRVRfUkVRVUlSRURcIik7XG4gICAgICB9XG4gICAgICBjb25zdCBfc2NvcGVzID0gb3B0aW9ucy5kaXNhYmxlRGVmYXVsdFNjb3BlID8gW10gOiBbXCJvcGVuaWRcIiwgXCJwcm9maWxlXCIsIFwiZW1haWxcIl07XG4gICAgICBvcHRpb25zLnNjb3BlICYmIF9zY29wZXMucHVzaCguLi5vcHRpb25zLnNjb3BlKTtcbiAgICAgIHNjb3BlcyAmJiBfc2NvcGVzLnB1c2goLi4uc2NvcGVzKTtcbiAgICAgIGNvbnN0IHVybCA9IGF3YWl0IGNyZWF0ZUF1dGhvcml6YXRpb25VUkwoe1xuICAgICAgICBpZDogXCJjb2duaXRvXCIsXG4gICAgICAgIG9wdGlvbnM6IHtcbiAgICAgICAgICAuLi5vcHRpb25zXG4gICAgICAgIH0sXG4gICAgICAgIGF1dGhvcml6YXRpb25FbmRwb2ludCxcbiAgICAgICAgc2NvcGVzOiBfc2NvcGVzLFxuICAgICAgICBzdGF0ZSxcbiAgICAgICAgY29kZVZlcmlmaWVyLFxuICAgICAgICByZWRpcmVjdFVSSSxcbiAgICAgICAgcHJvbXB0OiBvcHRpb25zLnByb21wdFxuICAgICAgfSk7XG4gICAgICByZXR1cm4gdXJsO1xuICAgIH0sXG4gICAgdmFsaWRhdGVBdXRob3JpemF0aW9uQ29kZTogYXN5bmMgKHsgY29kZSwgY29kZVZlcmlmaWVyLCByZWRpcmVjdFVSSSB9KSA9PiB7XG4gICAgICByZXR1cm4gdmFsaWRhdGVBdXRob3JpemF0aW9uQ29kZSh7XG4gICAgICAgIGNvZGUsXG4gICAgICAgIGNvZGVWZXJpZmllcixcbiAgICAgICAgcmVkaXJlY3RVUkksXG4gICAgICAgIG9wdGlvbnMsXG4gICAgICAgIHRva2VuRW5kcG9pbnRcbiAgICAgIH0pO1xuICAgIH0sXG4gICAgcmVmcmVzaEFjY2Vzc1Rva2VuOiBvcHRpb25zLnJlZnJlc2hBY2Nlc3NUb2tlbiA/IG9wdGlvbnMucmVmcmVzaEFjY2Vzc1Rva2VuIDogYXN5bmMgKHJlZnJlc2hUb2tlbikgPT4ge1xuICAgICAgcmV0dXJuIHJlZnJlc2hBY2Nlc3NUb2tlbih7XG4gICAgICAgIHJlZnJlc2hUb2tlbixcbiAgICAgICAgb3B0aW9uczoge1xuICAgICAgICAgIGNsaWVudElkOiBvcHRpb25zLmNsaWVudElkLFxuICAgICAgICAgIGNsaWVudEtleTogb3B0aW9ucy5jbGllbnRLZXksXG4gICAgICAgICAgY2xpZW50U2VjcmV0OiBvcHRpb25zLmNsaWVudFNlY3JldFxuICAgICAgICB9LFxuICAgICAgICB0b2tlbkVuZHBvaW50XG4gICAgICB9KTtcbiAgICB9LFxuICAgIGFzeW5jIHZlcmlmeUlkVG9rZW4odG9rZW4sIG5vbmNlKSB7XG4gICAgICBpZiAob3B0aW9ucy5kaXNhYmxlSWRUb2tlblNpZ25Jbikge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9XG4gICAgICBpZiAob3B0aW9ucy52ZXJpZnlJZFRva2VuKSB7XG4gICAgICAgIHJldHVybiBvcHRpb25zLnZlcmlmeUlkVG9rZW4odG9rZW4sIG5vbmNlKTtcbiAgICAgIH1cbiAgICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IGRlY29kZWRIZWFkZXIgPSBkZWNvZGVQcm90ZWN0ZWRIZWFkZXIodG9rZW4pO1xuICAgICAgICBjb25zdCB7IGtpZCwgYWxnOiBqd3RBbGcgfSA9IGRlY29kZWRIZWFkZXI7XG4gICAgICAgIGlmICgha2lkIHx8ICFqd3RBbGcpIHJldHVybiBmYWxzZTtcbiAgICAgICAgY29uc3QgcHVibGljS2V5ID0gYXdhaXQgZ2V0Q29nbml0b1B1YmxpY0tleShcbiAgICAgICAgICBraWQsXG4gICAgICAgICAgb3B0aW9ucy5yZWdpb24sXG4gICAgICAgICAgb3B0aW9ucy51c2VyUG9vbElkXG4gICAgICAgICk7XG4gICAgICAgIGNvbnN0IGV4cGVjdGVkSXNzdWVyID0gYGh0dHBzOi8vY29nbml0by1pZHAuJHtvcHRpb25zLnJlZ2lvbn0uYW1hem9uYXdzLmNvbS8ke29wdGlvbnMudXNlclBvb2xJZH1gO1xuICAgICAgICBjb25zdCB7IHBheWxvYWQ6IGp3dENsYWltcyB9ID0gYXdhaXQgand0VmVyaWZ5KHRva2VuLCBwdWJsaWNLZXksIHtcbiAgICAgICAgICBhbGdvcml0aG1zOiBband0QWxnXSxcbiAgICAgICAgICBpc3N1ZXI6IGV4cGVjdGVkSXNzdWVyLFxuICAgICAgICAgIGF1ZGllbmNlOiBvcHRpb25zLmNsaWVudElkLFxuICAgICAgICAgIG1heFRva2VuQWdlOiBcIjFoXCJcbiAgICAgICAgfSk7XG4gICAgICAgIGlmIChub25jZSAmJiBqd3RDbGFpbXMubm9uY2UgIT09IG5vbmNlKSB7XG4gICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgbG9nZ2VyLmVycm9yKFwiRmFpbGVkIHRvIHZlcmlmeSBJRCB0b2tlbjpcIiwgZXJyb3IpO1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9XG4gICAgfSxcbiAgICBhc3luYyBnZXRVc2VySW5mbyh0b2tlbikge1xuICAgICAgaWYgKG9wdGlvbnMuZ2V0VXNlckluZm8pIHtcbiAgICAgICAgcmV0dXJuIG9wdGlvbnMuZ2V0VXNlckluZm8odG9rZW4pO1xuICAgICAgfVxuICAgICAgaWYgKHRva2VuLmlkVG9rZW4pIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICBjb25zdCBwcm9maWxlID0gZGVjb2RlSnd0KHRva2VuLmlkVG9rZW4pO1xuICAgICAgICAgIGlmICghcHJvZmlsZSkge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgfVxuICAgICAgICAgIGNvbnN0IG5hbWUgPSBwcm9maWxlLm5hbWUgfHwgcHJvZmlsZS5naXZlbl9uYW1lIHx8IHByb2ZpbGUudXNlcm5hbWUgfHwgcHJvZmlsZS5lbWFpbDtcbiAgICAgICAgICBjb25zdCBlbnJpY2hlZFByb2ZpbGUgPSB7XG4gICAgICAgICAgICAuLi5wcm9maWxlLFxuICAgICAgICAgICAgbmFtZVxuICAgICAgICAgIH07XG4gICAgICAgICAgY29uc3QgdXNlck1hcCA9IGF3YWl0IG9wdGlvbnMubWFwUHJvZmlsZVRvVXNlcj8uKGVucmljaGVkUHJvZmlsZSk7XG4gICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHVzZXI6IHtcbiAgICAgICAgICAgICAgaWQ6IHByb2ZpbGUuc3ViLFxuICAgICAgICAgICAgICBuYW1lOiBlbnJpY2hlZFByb2ZpbGUubmFtZSxcbiAgICAgICAgICAgICAgZW1haWw6IHByb2ZpbGUuZW1haWwsXG4gICAgICAgICAgICAgIGltYWdlOiBwcm9maWxlLnBpY3R1cmUsXG4gICAgICAgICAgICAgIGVtYWlsVmVyaWZpZWQ6IHByb2ZpbGUuZW1haWxfdmVyaWZpZWQsXG4gICAgICAgICAgICAgIC4uLnVzZXJNYXBcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBkYXRhOiBlbnJpY2hlZFByb2ZpbGVcbiAgICAgICAgICB9O1xuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgIGxvZ2dlci5lcnJvcihcIkZhaWxlZCB0byBkZWNvZGUgSUQgdG9rZW46XCIsIGVycm9yKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgaWYgKHRva2VuLmFjY2Vzc1Rva2VuKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgY29uc3QgeyBkYXRhOiB1c2VySW5mbyB9ID0gYXdhaXQgYmV0dGVyRmV0Y2goXG4gICAgICAgICAgICB1c2VySW5mb0VuZHBvaW50LFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgICAgICAgQXV0aG9yaXphdGlvbjogYEJlYXJlciAke3Rva2VuLmFjY2Vzc1Rva2VufWBcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICk7XG4gICAgICAgICAgaWYgKHVzZXJJbmZvKSB7XG4gICAgICAgICAgICBjb25zdCB1c2VyTWFwID0gYXdhaXQgb3B0aW9ucy5tYXBQcm9maWxlVG9Vc2VyPy4odXNlckluZm8pO1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgdXNlcjoge1xuICAgICAgICAgICAgICAgIGlkOiB1c2VySW5mby5zdWIsXG4gICAgICAgICAgICAgICAgbmFtZTogdXNlckluZm8ubmFtZSB8fCB1c2VySW5mby5naXZlbl9uYW1lIHx8IHVzZXJJbmZvLnVzZXJuYW1lLFxuICAgICAgICAgICAgICAgIGVtYWlsOiB1c2VySW5mby5lbWFpbCxcbiAgICAgICAgICAgICAgICBpbWFnZTogdXNlckluZm8ucGljdHVyZSxcbiAgICAgICAgICAgICAgICBlbWFpbFZlcmlmaWVkOiB1c2VySW5mby5lbWFpbF92ZXJpZmllZCxcbiAgICAgICAgICAgICAgICAuLi51c2VyTWFwXG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgIGRhdGE6IHVzZXJJbmZvXG4gICAgICAgICAgICB9O1xuICAgICAgICAgIH1cbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICBsb2dnZXIuZXJyb3IoXCJGYWlsZWQgdG8gZmV0Y2ggdXNlciBpbmZvIGZyb20gQ29nbml0bzpcIiwgZXJyb3IpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9LFxuICAgIG9wdGlvbnNcbiAgfTtcbn07XG5jb25zdCBnZXRDb2duaXRvUHVibGljS2V5ID0gYXN5bmMgKGtpZCwgcmVnaW9uLCB1c2VyUG9vbElkKSA9PiB7XG4gIGNvbnN0IENPR05JVE9fSldLU19VUkkgPSBgaHR0cHM6Ly9jb2duaXRvLWlkcC4ke3JlZ2lvbn0uYW1hem9uYXdzLmNvbS8ke3VzZXJQb29sSWR9Ly53ZWxsLWtub3duL2p3a3MuanNvbmA7XG4gIHRyeSB7XG4gICAgY29uc3QgeyBkYXRhIH0gPSBhd2FpdCBiZXR0ZXJGZXRjaChDT0dOSVRPX0pXS1NfVVJJKTtcbiAgICBpZiAoIWRhdGE/LmtleXMpIHtcbiAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIkJBRF9SRVFVRVNUXCIsIHtcbiAgICAgICAgbWVzc2FnZTogXCJLZXlzIG5vdCBmb3VuZFwiXG4gICAgICB9KTtcbiAgICB9XG4gICAgY29uc3QgandrID0gZGF0YS5rZXlzLmZpbmQoKGtleSkgPT4ga2V5LmtpZCA9PT0ga2lkKTtcbiAgICBpZiAoIWp3aykge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGBKV0sgd2l0aCBraWQgJHtraWR9IG5vdCBmb3VuZGApO1xuICAgIH1cbiAgICByZXR1cm4gYXdhaXQgaW1wb3J0SldLKGp3aywgandrLmFsZyk7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgbG9nZ2VyLmVycm9yKFwiRmFpbGVkIHRvIGZldGNoIENvZ25pdG8gcHVibGljIGtleTpcIiwgZXJyb3IpO1xuICAgIHRocm93IGVycm9yO1xuICB9XG59O1xuXG5jb25zdCBkaXNjb3JkID0gKG9wdGlvbnMpID0+IHtcbiAgcmV0dXJuIHtcbiAgICBpZDogXCJkaXNjb3JkXCIsXG4gICAgbmFtZTogXCJEaXNjb3JkXCIsXG4gICAgY3JlYXRlQXV0aG9yaXphdGlvblVSTCh7IHN0YXRlLCBzY29wZXMsIHJlZGlyZWN0VVJJIH0pIHtcbiAgICAgIGNvbnN0IF9zY29wZXMgPSBvcHRpb25zLmRpc2FibGVEZWZhdWx0U2NvcGUgPyBbXSA6IFtcImlkZW50aWZ5XCIsIFwiZW1haWxcIl07XG4gICAgICBzY29wZXMgJiYgX3Njb3Blcy5wdXNoKC4uLnNjb3Blcyk7XG4gICAgICBvcHRpb25zLnNjb3BlICYmIF9zY29wZXMucHVzaCguLi5vcHRpb25zLnNjb3BlKTtcbiAgICAgIGNvbnN0IGhhc0JvdFNjb3BlID0gX3Njb3Blcy5pbmNsdWRlcyhcImJvdFwiKTtcbiAgICAgIGNvbnN0IHBlcm1pc3Npb25zUGFyYW0gPSBoYXNCb3RTY29wZSAmJiBvcHRpb25zLnBlcm1pc3Npb25zICE9PSB2b2lkIDAgPyBgJnBlcm1pc3Npb25zPSR7b3B0aW9ucy5wZXJtaXNzaW9uc31gIDogXCJcIjtcbiAgICAgIHJldHVybiBuZXcgVVJMKFxuICAgICAgICBgaHR0cHM6Ly9kaXNjb3JkLmNvbS9hcGkvb2F1dGgyL2F1dGhvcml6ZT9zY29wZT0ke19zY29wZXMuam9pbihcbiAgICAgICAgICBcIitcIlxuICAgICAgICApfSZyZXNwb25zZV90eXBlPWNvZGUmY2xpZW50X2lkPSR7b3B0aW9ucy5jbGllbnRJZH0mcmVkaXJlY3RfdXJpPSR7ZW5jb2RlVVJJQ29tcG9uZW50KFxuICAgICAgICAgIG9wdGlvbnMucmVkaXJlY3RVUkkgfHwgcmVkaXJlY3RVUklcbiAgICAgICAgKX0mc3RhdGU9JHtzdGF0ZX0mcHJvbXB0PSR7b3B0aW9ucy5wcm9tcHQgfHwgXCJub25lXCJ9JHtwZXJtaXNzaW9uc1BhcmFtfWBcbiAgICAgICk7XG4gICAgfSxcbiAgICB2YWxpZGF0ZUF1dGhvcml6YXRpb25Db2RlOiBhc3luYyAoeyBjb2RlLCByZWRpcmVjdFVSSSB9KSA9PiB7XG4gICAgICByZXR1cm4gdmFsaWRhdGVBdXRob3JpemF0aW9uQ29kZSh7XG4gICAgICAgIGNvZGUsXG4gICAgICAgIHJlZGlyZWN0VVJJLFxuICAgICAgICBvcHRpb25zLFxuICAgICAgICB0b2tlbkVuZHBvaW50OiBcImh0dHBzOi8vZGlzY29yZC5jb20vYXBpL29hdXRoMi90b2tlblwiXG4gICAgICB9KTtcbiAgICB9LFxuICAgIHJlZnJlc2hBY2Nlc3NUb2tlbjogb3B0aW9ucy5yZWZyZXNoQWNjZXNzVG9rZW4gPyBvcHRpb25zLnJlZnJlc2hBY2Nlc3NUb2tlbiA6IGFzeW5jIChyZWZyZXNoVG9rZW4pID0+IHtcbiAgICAgIHJldHVybiByZWZyZXNoQWNjZXNzVG9rZW4oe1xuICAgICAgICByZWZyZXNoVG9rZW4sXG4gICAgICAgIG9wdGlvbnM6IHtcbiAgICAgICAgICBjbGllbnRJZDogb3B0aW9ucy5jbGllbnRJZCxcbiAgICAgICAgICBjbGllbnRLZXk6IG9wdGlvbnMuY2xpZW50S2V5LFxuICAgICAgICAgIGNsaWVudFNlY3JldDogb3B0aW9ucy5jbGllbnRTZWNyZXRcbiAgICAgICAgfSxcbiAgICAgICAgdG9rZW5FbmRwb2ludDogXCJodHRwczovL2Rpc2NvcmQuY29tL2FwaS9vYXV0aDIvdG9rZW5cIlxuICAgICAgfSk7XG4gICAgfSxcbiAgICBhc3luYyBnZXRVc2VySW5mbyh0b2tlbikge1xuICAgICAgaWYgKG9wdGlvbnMuZ2V0VXNlckluZm8pIHtcbiAgICAgICAgcmV0dXJuIG9wdGlvbnMuZ2V0VXNlckluZm8odG9rZW4pO1xuICAgICAgfVxuICAgICAgY29uc3QgeyBkYXRhOiBwcm9maWxlLCBlcnJvciB9ID0gYXdhaXQgYmV0dGVyRmV0Y2goXG4gICAgICAgIFwiaHR0cHM6Ly9kaXNjb3JkLmNvbS9hcGkvdXNlcnMvQG1lXCIsXG4gICAgICAgIHtcbiAgICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgICBhdXRob3JpemF0aW9uOiBgQmVhcmVyICR7dG9rZW4uYWNjZXNzVG9rZW59YFxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgKTtcbiAgICAgIGlmIChlcnJvcikge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgIH1cbiAgICAgIGlmIChwcm9maWxlLmF2YXRhciA9PT0gbnVsbCkge1xuICAgICAgICBjb25zdCBkZWZhdWx0QXZhdGFyTnVtYmVyID0gcHJvZmlsZS5kaXNjcmltaW5hdG9yID09PSBcIjBcIiA/IE51bWJlcihCaWdJbnQocHJvZmlsZS5pZCkgPj4gQmlnSW50KDIyKSkgJSA2IDogcGFyc2VJbnQocHJvZmlsZS5kaXNjcmltaW5hdG9yKSAlIDU7XG4gICAgICAgIHByb2ZpbGUuaW1hZ2VfdXJsID0gYGh0dHBzOi8vY2RuLmRpc2NvcmRhcHAuY29tL2VtYmVkL2F2YXRhcnMvJHtkZWZhdWx0QXZhdGFyTnVtYmVyfS5wbmdgO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgY29uc3QgZm9ybWF0ID0gcHJvZmlsZS5hdmF0YXIuc3RhcnRzV2l0aChcImFfXCIpID8gXCJnaWZcIiA6IFwicG5nXCI7XG4gICAgICAgIHByb2ZpbGUuaW1hZ2VfdXJsID0gYGh0dHBzOi8vY2RuLmRpc2NvcmRhcHAuY29tL2F2YXRhcnMvJHtwcm9maWxlLmlkfS8ke3Byb2ZpbGUuYXZhdGFyfS4ke2Zvcm1hdH1gO1xuICAgICAgfVxuICAgICAgY29uc3QgdXNlck1hcCA9IGF3YWl0IG9wdGlvbnMubWFwUHJvZmlsZVRvVXNlcj8uKHByb2ZpbGUpO1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgdXNlcjoge1xuICAgICAgICAgIGlkOiBwcm9maWxlLmlkLFxuICAgICAgICAgIG5hbWU6IHByb2ZpbGUuZ2xvYmFsX25hbWUgfHwgcHJvZmlsZS51c2VybmFtZSB8fCBcIlwiLFxuICAgICAgICAgIGVtYWlsOiBwcm9maWxlLmVtYWlsLFxuICAgICAgICAgIGVtYWlsVmVyaWZpZWQ6IHByb2ZpbGUudmVyaWZpZWQsXG4gICAgICAgICAgaW1hZ2U6IHByb2ZpbGUuaW1hZ2VfdXJsLFxuICAgICAgICAgIC4uLnVzZXJNYXBcbiAgICAgICAgfSxcbiAgICAgICAgZGF0YTogcHJvZmlsZVxuICAgICAgfTtcbiAgICB9LFxuICAgIG9wdGlvbnNcbiAgfTtcbn07XG5cbmNvbnN0IGZhY2Vib29rID0gKG9wdGlvbnMpID0+IHtcbiAgcmV0dXJuIHtcbiAgICBpZDogXCJmYWNlYm9va1wiLFxuICAgIG5hbWU6IFwiRmFjZWJvb2tcIixcbiAgICBhc3luYyBjcmVhdGVBdXRob3JpemF0aW9uVVJMKHsgc3RhdGUsIHNjb3BlcywgcmVkaXJlY3RVUkksIGxvZ2luSGludCB9KSB7XG4gICAgICBjb25zdCBfc2NvcGVzID0gb3B0aW9ucy5kaXNhYmxlRGVmYXVsdFNjb3BlID8gW10gOiBbXCJlbWFpbFwiLCBcInB1YmxpY19wcm9maWxlXCJdO1xuICAgICAgb3B0aW9ucy5zY29wZSAmJiBfc2NvcGVzLnB1c2goLi4ub3B0aW9ucy5zY29wZSk7XG4gICAgICBzY29wZXMgJiYgX3Njb3Blcy5wdXNoKC4uLnNjb3Blcyk7XG4gICAgICByZXR1cm4gYXdhaXQgY3JlYXRlQXV0aG9yaXphdGlvblVSTCh7XG4gICAgICAgIGlkOiBcImZhY2Vib29rXCIsXG4gICAgICAgIG9wdGlvbnMsXG4gICAgICAgIGF1dGhvcml6YXRpb25FbmRwb2ludDogXCJodHRwczovL3d3dy5mYWNlYm9vay5jb20vdjIxLjAvZGlhbG9nL29hdXRoXCIsXG4gICAgICAgIHNjb3BlczogX3Njb3BlcyxcbiAgICAgICAgc3RhdGUsXG4gICAgICAgIHJlZGlyZWN0VVJJLFxuICAgICAgICBsb2dpbkhpbnQsXG4gICAgICAgIGFkZGl0aW9uYWxQYXJhbXM6IG9wdGlvbnMuY29uZmlnSWQgPyB7XG4gICAgICAgICAgY29uZmlnX2lkOiBvcHRpb25zLmNvbmZpZ0lkXG4gICAgICAgIH0gOiB7fVxuICAgICAgfSk7XG4gICAgfSxcbiAgICB2YWxpZGF0ZUF1dGhvcml6YXRpb25Db2RlOiBhc3luYyAoeyBjb2RlLCByZWRpcmVjdFVSSSB9KSA9PiB7XG4gICAgICByZXR1cm4gdmFsaWRhdGVBdXRob3JpemF0aW9uQ29kZSh7XG4gICAgICAgIGNvZGUsXG4gICAgICAgIHJlZGlyZWN0VVJJLFxuICAgICAgICBvcHRpb25zLFxuICAgICAgICB0b2tlbkVuZHBvaW50OiBcImh0dHBzOi8vZ3JhcGguZmFjZWJvb2suY29tL29hdXRoL2FjY2Vzc190b2tlblwiXG4gICAgICB9KTtcbiAgICB9LFxuICAgIGFzeW5jIHZlcmlmeUlkVG9rZW4odG9rZW4sIG5vbmNlKSB7XG4gICAgICBpZiAob3B0aW9ucy5kaXNhYmxlSWRUb2tlblNpZ25Jbikge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9XG4gICAgICBpZiAob3B0aW9ucy52ZXJpZnlJZFRva2VuKSB7XG4gICAgICAgIHJldHVybiBvcHRpb25zLnZlcmlmeUlkVG9rZW4odG9rZW4sIG5vbmNlKTtcbiAgICAgIH1cbiAgICAgIGlmICh0b2tlbi5zcGxpdChcIi5cIikubGVuZ3RoID09PSAzKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgY29uc3QgeyBwYXlsb2FkOiBqd3RDbGFpbXMgfSA9IGF3YWl0IGp3dFZlcmlmeShcbiAgICAgICAgICAgIHRva2VuLFxuICAgICAgICAgICAgY3JlYXRlUmVtb3RlSldLU2V0KFxuICAgICAgICAgICAgICAvLyBodHRwczovL2RldmVsb3BlcnMuZmFjZWJvb2suY29tL2RvY3MvZmFjZWJvb2stbG9naW4vbGltaXRlZC1sb2dpbi90b2tlbi8jandrc1xuICAgICAgICAgICAgICBuZXcgVVJMKFxuICAgICAgICAgICAgICAgIFwiaHR0cHM6Ly9saW1pdGVkLmZhY2Vib29rLmNvbS8ud2VsbC1rbm93bi9vYXV0aC9vcGVuaWQvandrcy9cIlxuICAgICAgICAgICAgICApXG4gICAgICAgICAgICApLFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICBhbGdvcml0aG1zOiBbXCJSUzI1NlwiXSxcbiAgICAgICAgICAgICAgYXVkaWVuY2U6IG9wdGlvbnMuY2xpZW50SWQsXG4gICAgICAgICAgICAgIGlzc3VlcjogXCJodHRwczovL3d3dy5mYWNlYm9vay5jb21cIlxuICAgICAgICAgICAgfVxuICAgICAgICAgICk7XG4gICAgICAgICAgaWYgKG5vbmNlICYmIGp3dENsYWltcy5ub25jZSAhPT0gbm9uY2UpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuICEhand0Q2xhaW1zO1xuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfSxcbiAgICByZWZyZXNoQWNjZXNzVG9rZW46IG9wdGlvbnMucmVmcmVzaEFjY2Vzc1Rva2VuID8gb3B0aW9ucy5yZWZyZXNoQWNjZXNzVG9rZW4gOiBhc3luYyAocmVmcmVzaFRva2VuKSA9PiB7XG4gICAgICByZXR1cm4gcmVmcmVzaEFjY2Vzc1Rva2VuKHtcbiAgICAgICAgcmVmcmVzaFRva2VuLFxuICAgICAgICBvcHRpb25zOiB7XG4gICAgICAgICAgY2xpZW50SWQ6IG9wdGlvbnMuY2xpZW50SWQsXG4gICAgICAgICAgY2xpZW50S2V5OiBvcHRpb25zLmNsaWVudEtleSxcbiAgICAgICAgICBjbGllbnRTZWNyZXQ6IG9wdGlvbnMuY2xpZW50U2VjcmV0XG4gICAgICAgIH0sXG4gICAgICAgIHRva2VuRW5kcG9pbnQ6IFwiaHR0cHM6Ly9ncmFwaC5mYWNlYm9vay5jb20vdjE4LjAvb2F1dGgvYWNjZXNzX3Rva2VuXCJcbiAgICAgIH0pO1xuICAgIH0sXG4gICAgYXN5bmMgZ2V0VXNlckluZm8odG9rZW4pIHtcbiAgICAgIGlmIChvcHRpb25zLmdldFVzZXJJbmZvKSB7XG4gICAgICAgIHJldHVybiBvcHRpb25zLmdldFVzZXJJbmZvKHRva2VuKTtcbiAgICAgIH1cbiAgICAgIGlmICh0b2tlbi5pZFRva2VuICYmIHRva2VuLmlkVG9rZW4uc3BsaXQoXCIuXCIpLmxlbmd0aCA9PT0gMykge1xuICAgICAgICBjb25zdCBwcm9maWxlMiA9IGRlY29kZUp3dCh0b2tlbi5pZFRva2VuKTtcbiAgICAgICAgY29uc3QgdXNlciA9IHtcbiAgICAgICAgICBpZDogcHJvZmlsZTIuc3ViLFxuICAgICAgICAgIG5hbWU6IHByb2ZpbGUyLm5hbWUsXG4gICAgICAgICAgZW1haWw6IHByb2ZpbGUyLmVtYWlsLFxuICAgICAgICAgIHBpY3R1cmU6IHtcbiAgICAgICAgICAgIGRhdGE6IHtcbiAgICAgICAgICAgICAgdXJsOiBwcm9maWxlMi5waWN0dXJlLFxuICAgICAgICAgICAgICBoZWlnaHQ6IDEwMCxcbiAgICAgICAgICAgICAgd2lkdGg6IDEwMCxcbiAgICAgICAgICAgICAgaXNfc2lsaG91ZXR0ZTogZmFsc2VcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIGNvbnN0IHVzZXJNYXAyID0gYXdhaXQgb3B0aW9ucy5tYXBQcm9maWxlVG9Vc2VyPy4oe1xuICAgICAgICAgIC4uLnVzZXIsXG4gICAgICAgICAgZW1haWxfdmVyaWZpZWQ6IHRydWVcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgdXNlcjoge1xuICAgICAgICAgICAgLi4udXNlcixcbiAgICAgICAgICAgIGVtYWlsVmVyaWZpZWQ6IHRydWUsXG4gICAgICAgICAgICAuLi51c2VyTWFwMlxuICAgICAgICAgIH0sXG4gICAgICAgICAgZGF0YTogcHJvZmlsZTJcbiAgICAgICAgfTtcbiAgICAgIH1cbiAgICAgIGNvbnN0IGZpZWxkcyA9IFtcbiAgICAgICAgXCJpZFwiLFxuICAgICAgICBcIm5hbWVcIixcbiAgICAgICAgXCJlbWFpbFwiLFxuICAgICAgICBcInBpY3R1cmVcIixcbiAgICAgICAgLi4ub3B0aW9ucz8uZmllbGRzIHx8IFtdXG4gICAgICBdO1xuICAgICAgY29uc3QgeyBkYXRhOiBwcm9maWxlLCBlcnJvciB9ID0gYXdhaXQgYmV0dGVyRmV0Y2goXG4gICAgICAgIFwiaHR0cHM6Ly9ncmFwaC5mYWNlYm9vay5jb20vbWU/ZmllbGRzPVwiICsgZmllbGRzLmpvaW4oXCIsXCIpLFxuICAgICAgICB7XG4gICAgICAgICAgYXV0aDoge1xuICAgICAgICAgICAgdHlwZTogXCJCZWFyZXJcIixcbiAgICAgICAgICAgIHRva2VuOiB0b2tlbi5hY2Nlc3NUb2tlblxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgKTtcbiAgICAgIGlmIChlcnJvcikge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgIH1cbiAgICAgIGNvbnN0IHVzZXJNYXAgPSBhd2FpdCBvcHRpb25zLm1hcFByb2ZpbGVUb1VzZXI/Lihwcm9maWxlKTtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHVzZXI6IHtcbiAgICAgICAgICBpZDogcHJvZmlsZS5pZCxcbiAgICAgICAgICBuYW1lOiBwcm9maWxlLm5hbWUsXG4gICAgICAgICAgZW1haWw6IHByb2ZpbGUuZW1haWwsXG4gICAgICAgICAgaW1hZ2U6IHByb2ZpbGUucGljdHVyZS5kYXRhLnVybCxcbiAgICAgICAgICBlbWFpbFZlcmlmaWVkOiBwcm9maWxlLmVtYWlsX3ZlcmlmaWVkLFxuICAgICAgICAgIC4uLnVzZXJNYXBcbiAgICAgICAgfSxcbiAgICAgICAgZGF0YTogcHJvZmlsZVxuICAgICAgfTtcbiAgICB9LFxuICAgIG9wdGlvbnNcbiAgfTtcbn07XG5cbmNvbnN0IGZpZ21hID0gKG9wdGlvbnMpID0+IHtcbiAgcmV0dXJuIHtcbiAgICBpZDogXCJmaWdtYVwiLFxuICAgIG5hbWU6IFwiRmlnbWFcIixcbiAgICBhc3luYyBjcmVhdGVBdXRob3JpemF0aW9uVVJMKHsgc3RhdGUsIHNjb3BlcywgY29kZVZlcmlmaWVyLCByZWRpcmVjdFVSSSB9KSB7XG4gICAgICBpZiAoIW9wdGlvbnMuY2xpZW50SWQgfHwgIW9wdGlvbnMuY2xpZW50U2VjcmV0KSB7XG4gICAgICAgIGxvZ2dlci5lcnJvcihcbiAgICAgICAgICBcIkNsaWVudCBJZCBhbmQgQ2xpZW50IFNlY3JldCBhcmUgcmVxdWlyZWQgZm9yIEZpZ21hLiBNYWtlIHN1cmUgdG8gcHJvdmlkZSB0aGVtIGluIHRoZSBvcHRpb25zLlwiXG4gICAgICAgICk7XG4gICAgICAgIHRocm93IG5ldyBCZXR0ZXJBdXRoRXJyb3IoXCJDTElFTlRfSURfQU5EX1NFQ1JFVF9SRVFVSVJFRFwiKTtcbiAgICAgIH1cbiAgICAgIGlmICghY29kZVZlcmlmaWVyKSB7XG4gICAgICAgIHRocm93IG5ldyBCZXR0ZXJBdXRoRXJyb3IoXCJjb2RlVmVyaWZpZXIgaXMgcmVxdWlyZWQgZm9yIEZpZ21hXCIpO1xuICAgICAgfVxuICAgICAgY29uc3QgX3Njb3BlcyA9IG9wdGlvbnMuZGlzYWJsZURlZmF1bHRTY29wZSA/IFtdIDogW1wiZmlsZV9yZWFkXCJdO1xuICAgICAgb3B0aW9ucy5zY29wZSAmJiBfc2NvcGVzLnB1c2goLi4ub3B0aW9ucy5zY29wZSk7XG4gICAgICBzY29wZXMgJiYgX3Njb3Blcy5wdXNoKC4uLnNjb3Blcyk7XG4gICAgICBjb25zdCB1cmwgPSBhd2FpdCBjcmVhdGVBdXRob3JpemF0aW9uVVJMKHtcbiAgICAgICAgaWQ6IFwiZmlnbWFcIixcbiAgICAgICAgb3B0aW9ucyxcbiAgICAgICAgYXV0aG9yaXphdGlvbkVuZHBvaW50OiBcImh0dHBzOi8vd3d3LmZpZ21hLmNvbS9vYXV0aFwiLFxuICAgICAgICBzY29wZXM6IF9zY29wZXMsXG4gICAgICAgIHN0YXRlLFxuICAgICAgICBjb2RlVmVyaWZpZXIsXG4gICAgICAgIHJlZGlyZWN0VVJJXG4gICAgICB9KTtcbiAgICAgIHJldHVybiB1cmw7XG4gICAgfSxcbiAgICB2YWxpZGF0ZUF1dGhvcml6YXRpb25Db2RlOiBhc3luYyAoeyBjb2RlLCBjb2RlVmVyaWZpZXIsIHJlZGlyZWN0VVJJIH0pID0+IHtcbiAgICAgIHJldHVybiB2YWxpZGF0ZUF1dGhvcml6YXRpb25Db2RlKHtcbiAgICAgICAgY29kZSxcbiAgICAgICAgY29kZVZlcmlmaWVyLFxuICAgICAgICByZWRpcmVjdFVSSSxcbiAgICAgICAgb3B0aW9ucyxcbiAgICAgICAgdG9rZW5FbmRwb2ludDogXCJodHRwczovL3d3dy5maWdtYS5jb20vYXBpL29hdXRoL3Rva2VuXCJcbiAgICAgIH0pO1xuICAgIH0sXG4gICAgcmVmcmVzaEFjY2Vzc1Rva2VuOiBvcHRpb25zLnJlZnJlc2hBY2Nlc3NUb2tlbiA/IG9wdGlvbnMucmVmcmVzaEFjY2Vzc1Rva2VuIDogYXN5bmMgKHJlZnJlc2hUb2tlbikgPT4ge1xuICAgICAgcmV0dXJuIHJlZnJlc2hBY2Nlc3NUb2tlbih7XG4gICAgICAgIHJlZnJlc2hUb2tlbixcbiAgICAgICAgb3B0aW9uczoge1xuICAgICAgICAgIGNsaWVudElkOiBvcHRpb25zLmNsaWVudElkLFxuICAgICAgICAgIGNsaWVudEtleTogb3B0aW9ucy5jbGllbnRLZXksXG4gICAgICAgICAgY2xpZW50U2VjcmV0OiBvcHRpb25zLmNsaWVudFNlY3JldFxuICAgICAgICB9LFxuICAgICAgICB0b2tlbkVuZHBvaW50OiBcImh0dHBzOi8vd3d3LmZpZ21hLmNvbS9hcGkvb2F1dGgvdG9rZW5cIlxuICAgICAgfSk7XG4gICAgfSxcbiAgICBhc3luYyBnZXRVc2VySW5mbyh0b2tlbikge1xuICAgICAgaWYgKG9wdGlvbnMuZ2V0VXNlckluZm8pIHtcbiAgICAgICAgcmV0dXJuIG9wdGlvbnMuZ2V0VXNlckluZm8odG9rZW4pO1xuICAgICAgfVxuICAgICAgdHJ5IHtcbiAgICAgICAgY29uc3QgeyBkYXRhOiBwcm9maWxlIH0gPSBhd2FpdCBiZXR0ZXJGZXRjaChcbiAgICAgICAgICBcImh0dHBzOi8vYXBpLmZpZ21hLmNvbS92MS9tZVwiLFxuICAgICAgICAgIHtcbiAgICAgICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAgICAgQXV0aG9yaXphdGlvbjogYEJlYXJlciAke3Rva2VuLmFjY2Vzc1Rva2VufWBcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgICk7XG4gICAgICAgIGlmICghcHJvZmlsZSkge1xuICAgICAgICAgIGxvZ2dlci5lcnJvcihcIkZhaWxlZCB0byBmZXRjaCB1c2VyIGZyb20gRmlnbWFcIik7XG4gICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgdXNlck1hcCA9IGF3YWl0IG9wdGlvbnMubWFwUHJvZmlsZVRvVXNlcj8uKHByb2ZpbGUpO1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIHVzZXI6IHtcbiAgICAgICAgICAgIGlkOiBwcm9maWxlLmlkLFxuICAgICAgICAgICAgbmFtZTogcHJvZmlsZS5oYW5kbGUsXG4gICAgICAgICAgICBlbWFpbDogcHJvZmlsZS5lbWFpbCxcbiAgICAgICAgICAgIGltYWdlOiBwcm9maWxlLmltZ191cmwsXG4gICAgICAgICAgICBlbWFpbFZlcmlmaWVkOiAhIXByb2ZpbGUuZW1haWwsXG4gICAgICAgICAgICAuLi51c2VyTWFwXG4gICAgICAgICAgfSxcbiAgICAgICAgICBkYXRhOiBwcm9maWxlXG4gICAgICAgIH07XG4gICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICBsb2dnZXIuZXJyb3IoXCJGYWlsZWQgdG8gZmV0Y2ggdXNlciBpbmZvIGZyb20gRmlnbWE6XCIsIGVycm9yKTtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICB9XG4gICAgfSxcbiAgICBvcHRpb25zXG4gIH07XG59O1xuXG5jb25zdCBnaXRodWIgPSAob3B0aW9ucykgPT4ge1xuICBjb25zdCB0b2tlbkVuZHBvaW50ID0gXCJodHRwczovL2dpdGh1Yi5jb20vbG9naW4vb2F1dGgvYWNjZXNzX3Rva2VuXCI7XG4gIHJldHVybiB7XG4gICAgaWQ6IFwiZ2l0aHViXCIsXG4gICAgbmFtZTogXCJHaXRIdWJcIixcbiAgICBjcmVhdGVBdXRob3JpemF0aW9uVVJMKHsgc3RhdGUsIHNjb3BlcywgbG9naW5IaW50LCByZWRpcmVjdFVSSSB9KSB7XG4gICAgICBjb25zdCBfc2NvcGVzID0gb3B0aW9ucy5kaXNhYmxlRGVmYXVsdFNjb3BlID8gW10gOiBbXCJyZWFkOnVzZXJcIiwgXCJ1c2VyOmVtYWlsXCJdO1xuICAgICAgb3B0aW9ucy5zY29wZSAmJiBfc2NvcGVzLnB1c2goLi4ub3B0aW9ucy5zY29wZSk7XG4gICAgICBzY29wZXMgJiYgX3Njb3Blcy5wdXNoKC4uLnNjb3Blcyk7XG4gICAgICByZXR1cm4gY3JlYXRlQXV0aG9yaXphdGlvblVSTCh7XG4gICAgICAgIGlkOiBcImdpdGh1YlwiLFxuICAgICAgICBvcHRpb25zLFxuICAgICAgICBhdXRob3JpemF0aW9uRW5kcG9pbnQ6IFwiaHR0cHM6Ly9naXRodWIuY29tL2xvZ2luL29hdXRoL2F1dGhvcml6ZVwiLFxuICAgICAgICBzY29wZXM6IF9zY29wZXMsXG4gICAgICAgIHN0YXRlLFxuICAgICAgICByZWRpcmVjdFVSSSxcbiAgICAgICAgbG9naW5IaW50LFxuICAgICAgICBwcm9tcHQ6IG9wdGlvbnMucHJvbXB0XG4gICAgICB9KTtcbiAgICB9LFxuICAgIHZhbGlkYXRlQXV0aG9yaXphdGlvbkNvZGU6IGFzeW5jICh7IGNvZGUsIHJlZGlyZWN0VVJJIH0pID0+IHtcbiAgICAgIHJldHVybiB2YWxpZGF0ZUF1dGhvcml6YXRpb25Db2RlKHtcbiAgICAgICAgY29kZSxcbiAgICAgICAgcmVkaXJlY3RVUkksXG4gICAgICAgIG9wdGlvbnMsXG4gICAgICAgIHRva2VuRW5kcG9pbnRcbiAgICAgIH0pO1xuICAgIH0sXG4gICAgcmVmcmVzaEFjY2Vzc1Rva2VuOiBvcHRpb25zLnJlZnJlc2hBY2Nlc3NUb2tlbiA/IG9wdGlvbnMucmVmcmVzaEFjY2Vzc1Rva2VuIDogYXN5bmMgKHJlZnJlc2hUb2tlbikgPT4ge1xuICAgICAgcmV0dXJuIHJlZnJlc2hBY2Nlc3NUb2tlbih7XG4gICAgICAgIHJlZnJlc2hUb2tlbixcbiAgICAgICAgb3B0aW9uczoge1xuICAgICAgICAgIGNsaWVudElkOiBvcHRpb25zLmNsaWVudElkLFxuICAgICAgICAgIGNsaWVudEtleTogb3B0aW9ucy5jbGllbnRLZXksXG4gICAgICAgICAgY2xpZW50U2VjcmV0OiBvcHRpb25zLmNsaWVudFNlY3JldFxuICAgICAgICB9LFxuICAgICAgICB0b2tlbkVuZHBvaW50OiBcImh0dHBzOi8vZ2l0aHViLmNvbS9sb2dpbi9vYXV0aC9hY2Nlc3NfdG9rZW5cIlxuICAgICAgfSk7XG4gICAgfSxcbiAgICBhc3luYyBnZXRVc2VySW5mbyh0b2tlbikge1xuICAgICAgaWYgKG9wdGlvbnMuZ2V0VXNlckluZm8pIHtcbiAgICAgICAgcmV0dXJuIG9wdGlvbnMuZ2V0VXNlckluZm8odG9rZW4pO1xuICAgICAgfVxuICAgICAgY29uc3QgeyBkYXRhOiBwcm9maWxlLCBlcnJvciB9ID0gYXdhaXQgYmV0dGVyRmV0Y2goXG4gICAgICAgIFwiaHR0cHM6Ly9hcGkuZ2l0aHViLmNvbS91c2VyXCIsXG4gICAgICAgIHtcbiAgICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgICBcIlVzZXItQWdlbnRcIjogXCJiZXR0ZXItYXV0aFwiLFxuICAgICAgICAgICAgYXV0aG9yaXphdGlvbjogYEJlYXJlciAke3Rva2VuLmFjY2Vzc1Rva2VufWBcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICk7XG4gICAgICBpZiAoZXJyb3IpIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICB9XG4gICAgICBjb25zdCB7IGRhdGE6IGVtYWlscyB9ID0gYXdhaXQgYmV0dGVyRmV0Y2goXCJodHRwczovL2FwaS5naXRodWIuY29tL3VzZXIvZW1haWxzXCIsIHtcbiAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgIEF1dGhvcml6YXRpb246IGBCZWFyZXIgJHt0b2tlbi5hY2Nlc3NUb2tlbn1gLFxuICAgICAgICAgIFwiVXNlci1BZ2VudFwiOiBcImJldHRlci1hdXRoXCJcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgICBpZiAoIXByb2ZpbGUuZW1haWwgJiYgZW1haWxzKSB7XG4gICAgICAgIHByb2ZpbGUuZW1haWwgPSAoZW1haWxzLmZpbmQoKGUpID0+IGUucHJpbWFyeSkgPz8gZW1haWxzWzBdKT8uZW1haWw7XG4gICAgICB9XG4gICAgICBjb25zdCBlbWFpbFZlcmlmaWVkID0gZW1haWxzPy5maW5kKChlKSA9PiBlLmVtYWlsID09PSBwcm9maWxlLmVtYWlsKT8udmVyaWZpZWQgPz8gZmFsc2U7XG4gICAgICBjb25zdCB1c2VyTWFwID0gYXdhaXQgb3B0aW9ucy5tYXBQcm9maWxlVG9Vc2VyPy4ocHJvZmlsZSk7XG4gICAgICByZXR1cm4ge1xuICAgICAgICB1c2VyOiB7XG4gICAgICAgICAgaWQ6IHByb2ZpbGUuaWQsXG4gICAgICAgICAgbmFtZTogcHJvZmlsZS5uYW1lIHx8IHByb2ZpbGUubG9naW4sXG4gICAgICAgICAgZW1haWw6IHByb2ZpbGUuZW1haWwsXG4gICAgICAgICAgaW1hZ2U6IHByb2ZpbGUuYXZhdGFyX3VybCxcbiAgICAgICAgICBlbWFpbFZlcmlmaWVkLFxuICAgICAgICAgIC4uLnVzZXJNYXBcbiAgICAgICAgfSxcbiAgICAgICAgZGF0YTogcHJvZmlsZVxuICAgICAgfTtcbiAgICB9LFxuICAgIG9wdGlvbnNcbiAgfTtcbn07XG5cbmNvbnN0IGdvb2dsZSA9IChvcHRpb25zKSA9PiB7XG4gIHJldHVybiB7XG4gICAgaWQ6IFwiZ29vZ2xlXCIsXG4gICAgbmFtZTogXCJHb29nbGVcIixcbiAgICBhc3luYyBjcmVhdGVBdXRob3JpemF0aW9uVVJMKHtcbiAgICAgIHN0YXRlLFxuICAgICAgc2NvcGVzLFxuICAgICAgY29kZVZlcmlmaWVyLFxuICAgICAgcmVkaXJlY3RVUkksXG4gICAgICBsb2dpbkhpbnQsXG4gICAgICBkaXNwbGF5XG4gICAgfSkge1xuICAgICAgaWYgKCFvcHRpb25zLmNsaWVudElkIHx8ICFvcHRpb25zLmNsaWVudFNlY3JldCkge1xuICAgICAgICBsb2dnZXIuZXJyb3IoXG4gICAgICAgICAgXCJDbGllbnQgSWQgYW5kIENsaWVudCBTZWNyZXQgaXMgcmVxdWlyZWQgZm9yIEdvb2dsZS4gTWFrZSBzdXJlIHRvIHByb3ZpZGUgdGhlbSBpbiB0aGUgb3B0aW9ucy5cIlxuICAgICAgICApO1xuICAgICAgICB0aHJvdyBuZXcgQmV0dGVyQXV0aEVycm9yKFwiQ0xJRU5UX0lEX0FORF9TRUNSRVRfUkVRVUlSRURcIik7XG4gICAgICB9XG4gICAgICBpZiAoIWNvZGVWZXJpZmllcikge1xuICAgICAgICB0aHJvdyBuZXcgQmV0dGVyQXV0aEVycm9yKFwiY29kZVZlcmlmaWVyIGlzIHJlcXVpcmVkIGZvciBHb29nbGVcIik7XG4gICAgICB9XG4gICAgICBjb25zdCBfc2NvcGVzID0gb3B0aW9ucy5kaXNhYmxlRGVmYXVsdFNjb3BlID8gW10gOiBbXCJlbWFpbFwiLCBcInByb2ZpbGVcIiwgXCJvcGVuaWRcIl07XG4gICAgICBvcHRpb25zLnNjb3BlICYmIF9zY29wZXMucHVzaCguLi5vcHRpb25zLnNjb3BlKTtcbiAgICAgIHNjb3BlcyAmJiBfc2NvcGVzLnB1c2goLi4uc2NvcGVzKTtcbiAgICAgIGNvbnN0IHVybCA9IGF3YWl0IGNyZWF0ZUF1dGhvcml6YXRpb25VUkwoe1xuICAgICAgICBpZDogXCJnb29nbGVcIixcbiAgICAgICAgb3B0aW9ucyxcbiAgICAgICAgYXV0aG9yaXphdGlvbkVuZHBvaW50OiBcImh0dHBzOi8vYWNjb3VudHMuZ29vZ2xlLmNvbS9vL29hdXRoMi9hdXRoXCIsXG4gICAgICAgIHNjb3BlczogX3Njb3BlcyxcbiAgICAgICAgc3RhdGUsXG4gICAgICAgIGNvZGVWZXJpZmllcixcbiAgICAgICAgcmVkaXJlY3RVUkksXG4gICAgICAgIHByb21wdDogb3B0aW9ucy5wcm9tcHQsXG4gICAgICAgIGFjY2Vzc1R5cGU6IG9wdGlvbnMuYWNjZXNzVHlwZSxcbiAgICAgICAgZGlzcGxheTogZGlzcGxheSB8fCBvcHRpb25zLmRpc3BsYXksXG4gICAgICAgIGxvZ2luSGludCxcbiAgICAgICAgaGQ6IG9wdGlvbnMuaGQsXG4gICAgICAgIGFkZGl0aW9uYWxQYXJhbXM6IHtcbiAgICAgICAgICBpbmNsdWRlX2dyYW50ZWRfc2NvcGVzOiBcInRydWVcIlxuICAgICAgICB9XG4gICAgICB9KTtcbiAgICAgIHJldHVybiB1cmw7XG4gICAgfSxcbiAgICB2YWxpZGF0ZUF1dGhvcml6YXRpb25Db2RlOiBhc3luYyAoeyBjb2RlLCBjb2RlVmVyaWZpZXIsIHJlZGlyZWN0VVJJIH0pID0+IHtcbiAgICAgIHJldHVybiB2YWxpZGF0ZUF1dGhvcml6YXRpb25Db2RlKHtcbiAgICAgICAgY29kZSxcbiAgICAgICAgY29kZVZlcmlmaWVyLFxuICAgICAgICByZWRpcmVjdFVSSSxcbiAgICAgICAgb3B0aW9ucyxcbiAgICAgICAgdG9rZW5FbmRwb2ludDogXCJodHRwczovL29hdXRoMi5nb29nbGVhcGlzLmNvbS90b2tlblwiXG4gICAgICB9KTtcbiAgICB9LFxuICAgIHJlZnJlc2hBY2Nlc3NUb2tlbjogb3B0aW9ucy5yZWZyZXNoQWNjZXNzVG9rZW4gPyBvcHRpb25zLnJlZnJlc2hBY2Nlc3NUb2tlbiA6IGFzeW5jIChyZWZyZXNoVG9rZW4pID0+IHtcbiAgICAgIHJldHVybiByZWZyZXNoQWNjZXNzVG9rZW4oe1xuICAgICAgICByZWZyZXNoVG9rZW4sXG4gICAgICAgIG9wdGlvbnM6IHtcbiAgICAgICAgICBjbGllbnRJZDogb3B0aW9ucy5jbGllbnRJZCxcbiAgICAgICAgICBjbGllbnRLZXk6IG9wdGlvbnMuY2xpZW50S2V5LFxuICAgICAgICAgIGNsaWVudFNlY3JldDogb3B0aW9ucy5jbGllbnRTZWNyZXRcbiAgICAgICAgfSxcbiAgICAgICAgdG9rZW5FbmRwb2ludDogXCJodHRwczovL3d3dy5nb29nbGVhcGlzLmNvbS9vYXV0aDIvdjQvdG9rZW5cIlxuICAgICAgfSk7XG4gICAgfSxcbiAgICBhc3luYyB2ZXJpZnlJZFRva2VuKHRva2VuLCBub25jZSkge1xuICAgICAgaWYgKG9wdGlvbnMuZGlzYWJsZUlkVG9rZW5TaWduSW4pIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfVxuICAgICAgaWYgKG9wdGlvbnMudmVyaWZ5SWRUb2tlbikge1xuICAgICAgICByZXR1cm4gb3B0aW9ucy52ZXJpZnlJZFRva2VuKHRva2VuLCBub25jZSk7XG4gICAgICB9XG4gICAgICBjb25zdCBnb29nbGVQdWJsaWNLZXlVcmwgPSBgaHR0cHM6Ly93d3cuZ29vZ2xlYXBpcy5jb20vb2F1dGgyL3YzL3Rva2VuaW5mbz9pZF90b2tlbj0ke3Rva2VufWA7XG4gICAgICBjb25zdCB7IGRhdGE6IHRva2VuSW5mbyB9ID0gYXdhaXQgYmV0dGVyRmV0Y2goZ29vZ2xlUHVibGljS2V5VXJsKTtcbiAgICAgIGlmICghdG9rZW5JbmZvKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH1cbiAgICAgIGNvbnN0IGlzVmFsaWQgPSB0b2tlbkluZm8uYXVkID09PSBvcHRpb25zLmNsaWVudElkICYmICh0b2tlbkluZm8uaXNzID09PSBcImh0dHBzOi8vYWNjb3VudHMuZ29vZ2xlLmNvbVwiIHx8IHRva2VuSW5mby5pc3MgPT09IFwiYWNjb3VudHMuZ29vZ2xlLmNvbVwiKTtcbiAgICAgIHJldHVybiBpc1ZhbGlkO1xuICAgIH0sXG4gICAgYXN5bmMgZ2V0VXNlckluZm8odG9rZW4pIHtcbiAgICAgIGlmIChvcHRpb25zLmdldFVzZXJJbmZvKSB7XG4gICAgICAgIHJldHVybiBvcHRpb25zLmdldFVzZXJJbmZvKHRva2VuKTtcbiAgICAgIH1cbiAgICAgIGlmICghdG9rZW4uaWRUb2tlbikge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgIH1cbiAgICAgIGNvbnN0IHVzZXIgPSBkZWNvZGVKd3QodG9rZW4uaWRUb2tlbik7XG4gICAgICBjb25zdCB1c2VyTWFwID0gYXdhaXQgb3B0aW9ucy5tYXBQcm9maWxlVG9Vc2VyPy4odXNlcik7XG4gICAgICByZXR1cm4ge1xuICAgICAgICB1c2VyOiB7XG4gICAgICAgICAgaWQ6IHVzZXIuc3ViLFxuICAgICAgICAgIG5hbWU6IHVzZXIubmFtZSxcbiAgICAgICAgICBlbWFpbDogdXNlci5lbWFpbCxcbiAgICAgICAgICBpbWFnZTogdXNlci5waWN0dXJlLFxuICAgICAgICAgIGVtYWlsVmVyaWZpZWQ6IHVzZXIuZW1haWxfdmVyaWZpZWQsXG4gICAgICAgICAgLi4udXNlck1hcFxuICAgICAgICB9LFxuICAgICAgICBkYXRhOiB1c2VyXG4gICAgICB9O1xuICAgIH0sXG4gICAgb3B0aW9uc1xuICB9O1xufTtcblxuY29uc3Qga2ljayA9IChvcHRpb25zKSA9PiB7XG4gIHJldHVybiB7XG4gICAgaWQ6IFwia2lja1wiLFxuICAgIG5hbWU6IFwiS2lja1wiLFxuICAgIGNyZWF0ZUF1dGhvcml6YXRpb25VUkwoeyBzdGF0ZSwgc2NvcGVzLCByZWRpcmVjdFVSSSwgY29kZVZlcmlmaWVyIH0pIHtcbiAgICAgIGNvbnN0IF9zY29wZXMgPSBvcHRpb25zLmRpc2FibGVEZWZhdWx0U2NvcGUgPyBbXSA6IFtcInVzZXI6cmVhZFwiXTtcbiAgICAgIG9wdGlvbnMuc2NvcGUgJiYgX3Njb3Blcy5wdXNoKC4uLm9wdGlvbnMuc2NvcGUpO1xuICAgICAgc2NvcGVzICYmIF9zY29wZXMucHVzaCguLi5zY29wZXMpO1xuICAgICAgcmV0dXJuIGNyZWF0ZUF1dGhvcml6YXRpb25VUkwoe1xuICAgICAgICBpZDogXCJraWNrXCIsXG4gICAgICAgIHJlZGlyZWN0VVJJLFxuICAgICAgICBvcHRpb25zLFxuICAgICAgICBhdXRob3JpemF0aW9uRW5kcG9pbnQ6IFwiaHR0cHM6Ly9pZC5raWNrLmNvbS9vYXV0aC9hdXRob3JpemVcIixcbiAgICAgICAgc2NvcGVzOiBfc2NvcGVzLFxuICAgICAgICBjb2RlVmVyaWZpZXIsXG4gICAgICAgIHN0YXRlXG4gICAgICB9KTtcbiAgICB9LFxuICAgIGFzeW5jIHZhbGlkYXRlQXV0aG9yaXphdGlvbkNvZGUoeyBjb2RlLCByZWRpcmVjdFVSSSwgY29kZVZlcmlmaWVyIH0pIHtcbiAgICAgIHJldHVybiB2YWxpZGF0ZUF1dGhvcml6YXRpb25Db2RlKHtcbiAgICAgICAgY29kZSxcbiAgICAgICAgcmVkaXJlY3RVUkksXG4gICAgICAgIG9wdGlvbnMsXG4gICAgICAgIHRva2VuRW5kcG9pbnQ6IFwiaHR0cHM6Ly9pZC5raWNrLmNvbS9vYXV0aC90b2tlblwiLFxuICAgICAgICBjb2RlVmVyaWZpZXJcbiAgICAgIH0pO1xuICAgIH0sXG4gICAgYXN5bmMgZ2V0VXNlckluZm8odG9rZW4pIHtcbiAgICAgIGlmIChvcHRpb25zLmdldFVzZXJJbmZvKSB7XG4gICAgICAgIHJldHVybiBvcHRpb25zLmdldFVzZXJJbmZvKHRva2VuKTtcbiAgICAgIH1cbiAgICAgIGNvbnN0IHsgZGF0YSwgZXJyb3IgfSA9IGF3YWl0IGJldHRlckZldGNoKFwiaHR0cHM6Ly9hcGkua2ljay5jb20vcHVibGljL3YxL3VzZXJzXCIsIHtcbiAgICAgICAgbWV0aG9kOiBcIkdFVFwiLFxuICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgQXV0aG9yaXphdGlvbjogYEJlYXJlciAke3Rva2VuLmFjY2Vzc1Rva2VufWBcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgICBpZiAoZXJyb3IpIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICB9XG4gICAgICBjb25zdCBwcm9maWxlID0gZGF0YS5kYXRhWzBdO1xuICAgICAgY29uc3QgdXNlck1hcCA9IGF3YWl0IG9wdGlvbnMubWFwUHJvZmlsZVRvVXNlcj8uKHByb2ZpbGUpO1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgdXNlcjoge1xuICAgICAgICAgIGlkOiBwcm9maWxlLnVzZXJfaWQsXG4gICAgICAgICAgbmFtZTogcHJvZmlsZS5uYW1lLFxuICAgICAgICAgIGVtYWlsOiBwcm9maWxlLmVtYWlsLFxuICAgICAgICAgIGltYWdlOiBwcm9maWxlLnByb2ZpbGVfcGljdHVyZSxcbiAgICAgICAgICBlbWFpbFZlcmlmaWVkOiB0cnVlLFxuICAgICAgICAgIC4uLnVzZXJNYXBcbiAgICAgICAgfSxcbiAgICAgICAgZGF0YTogcHJvZmlsZVxuICAgICAgfTtcbiAgICB9LFxuICAgIG9wdGlvbnNcbiAgfTtcbn07XG5cbmNvbnN0IGh1Z2dpbmdmYWNlID0gKG9wdGlvbnMpID0+IHtcbiAgcmV0dXJuIHtcbiAgICBpZDogXCJodWdnaW5nZmFjZVwiLFxuICAgIG5hbWU6IFwiSHVnZ2luZyBGYWNlXCIsXG4gICAgY3JlYXRlQXV0aG9yaXphdGlvblVSTCh7IHN0YXRlLCBzY29wZXMsIGNvZGVWZXJpZmllciwgcmVkaXJlY3RVUkkgfSkge1xuICAgICAgY29uc3QgX3Njb3BlcyA9IG9wdGlvbnMuZGlzYWJsZURlZmF1bHRTY29wZSA/IFtdIDogW1wib3BlbmlkXCIsIFwicHJvZmlsZVwiLCBcImVtYWlsXCJdO1xuICAgICAgb3B0aW9ucy5zY29wZSAmJiBfc2NvcGVzLnB1c2goLi4ub3B0aW9ucy5zY29wZSk7XG4gICAgICBzY29wZXMgJiYgX3Njb3Blcy5wdXNoKC4uLnNjb3Blcyk7XG4gICAgICByZXR1cm4gY3JlYXRlQXV0aG9yaXphdGlvblVSTCh7XG4gICAgICAgIGlkOiBcImh1Z2dpbmdmYWNlXCIsXG4gICAgICAgIG9wdGlvbnMsXG4gICAgICAgIGF1dGhvcml6YXRpb25FbmRwb2ludDogXCJodHRwczovL2h1Z2dpbmdmYWNlLmNvL29hdXRoL2F1dGhvcml6ZVwiLFxuICAgICAgICBzY29wZXM6IF9zY29wZXMsXG4gICAgICAgIHN0YXRlLFxuICAgICAgICBjb2RlVmVyaWZpZXIsXG4gICAgICAgIHJlZGlyZWN0VVJJXG4gICAgICB9KTtcbiAgICB9LFxuICAgIHZhbGlkYXRlQXV0aG9yaXphdGlvbkNvZGU6IGFzeW5jICh7IGNvZGUsIGNvZGVWZXJpZmllciwgcmVkaXJlY3RVUkkgfSkgPT4ge1xuICAgICAgcmV0dXJuIHZhbGlkYXRlQXV0aG9yaXphdGlvbkNvZGUoe1xuICAgICAgICBjb2RlLFxuICAgICAgICBjb2RlVmVyaWZpZXIsXG4gICAgICAgIHJlZGlyZWN0VVJJLFxuICAgICAgICBvcHRpb25zLFxuICAgICAgICB0b2tlbkVuZHBvaW50OiBcImh0dHBzOi8vaHVnZ2luZ2ZhY2UuY28vb2F1dGgvdG9rZW5cIlxuICAgICAgfSk7XG4gICAgfSxcbiAgICByZWZyZXNoQWNjZXNzVG9rZW46IG9wdGlvbnMucmVmcmVzaEFjY2Vzc1Rva2VuID8gb3B0aW9ucy5yZWZyZXNoQWNjZXNzVG9rZW4gOiBhc3luYyAocmVmcmVzaFRva2VuKSA9PiB7XG4gICAgICByZXR1cm4gcmVmcmVzaEFjY2Vzc1Rva2VuKHtcbiAgICAgICAgcmVmcmVzaFRva2VuLFxuICAgICAgICBvcHRpb25zOiB7XG4gICAgICAgICAgY2xpZW50SWQ6IG9wdGlvbnMuY2xpZW50SWQsXG4gICAgICAgICAgY2xpZW50S2V5OiBvcHRpb25zLmNsaWVudEtleSxcbiAgICAgICAgICBjbGllbnRTZWNyZXQ6IG9wdGlvbnMuY2xpZW50U2VjcmV0XG4gICAgICAgIH0sXG4gICAgICAgIHRva2VuRW5kcG9pbnQ6IFwiaHR0cHM6Ly9odWdnaW5nZmFjZS5jby9vYXV0aC90b2tlblwiXG4gICAgICB9KTtcbiAgICB9LFxuICAgIGFzeW5jIGdldFVzZXJJbmZvKHRva2VuKSB7XG4gICAgICBpZiAob3B0aW9ucy5nZXRVc2VySW5mbykge1xuICAgICAgICByZXR1cm4gb3B0aW9ucy5nZXRVc2VySW5mbyh0b2tlbik7XG4gICAgICB9XG4gICAgICBjb25zdCB7IGRhdGE6IHByb2ZpbGUsIGVycm9yIH0gPSBhd2FpdCBiZXR0ZXJGZXRjaChcbiAgICAgICAgXCJodHRwczovL2h1Z2dpbmdmYWNlLmNvL29hdXRoL3VzZXJpbmZvXCIsXG4gICAgICAgIHtcbiAgICAgICAgICBtZXRob2Q6IFwiR0VUXCIsXG4gICAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICAgQXV0aG9yaXphdGlvbjogYEJlYXJlciAke3Rva2VuLmFjY2Vzc1Rva2VufWBcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICk7XG4gICAgICBpZiAoZXJyb3IpIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICB9XG4gICAgICBjb25zdCB1c2VyTWFwID0gYXdhaXQgb3B0aW9ucy5tYXBQcm9maWxlVG9Vc2VyPy4ocHJvZmlsZSk7XG4gICAgICByZXR1cm4ge1xuICAgICAgICB1c2VyOiB7XG4gICAgICAgICAgaWQ6IHByb2ZpbGUuc3ViLFxuICAgICAgICAgIG5hbWU6IHByb2ZpbGUubmFtZSB8fCBwcm9maWxlLnByZWZlcnJlZF91c2VybmFtZSxcbiAgICAgICAgICBlbWFpbDogcHJvZmlsZS5lbWFpbCxcbiAgICAgICAgICBpbWFnZTogcHJvZmlsZS5waWN0dXJlLFxuICAgICAgICAgIGVtYWlsVmVyaWZpZWQ6IHByb2ZpbGUuZW1haWxfdmVyaWZpZWQgPz8gZmFsc2UsXG4gICAgICAgICAgLi4udXNlck1hcFxuICAgICAgICB9LFxuICAgICAgICBkYXRhOiBwcm9maWxlXG4gICAgICB9O1xuICAgIH0sXG4gICAgb3B0aW9uc1xuICB9O1xufTtcblxuY29uc3QgbWljcm9zb2Z0ID0gKG9wdGlvbnMpID0+IHtcbiAgY29uc3QgdGVuYW50ID0gb3B0aW9ucy50ZW5hbnRJZCB8fCBcImNvbW1vblwiO1xuICBjb25zdCBhdXRob3JpdHkgPSBvcHRpb25zLmF1dGhvcml0eSB8fCBcImh0dHBzOi8vbG9naW4ubWljcm9zb2Z0b25saW5lLmNvbVwiO1xuICBjb25zdCBhdXRob3JpemF0aW9uRW5kcG9pbnQgPSBgJHthdXRob3JpdHl9LyR7dGVuYW50fS9vYXV0aDIvdjIuMC9hdXRob3JpemVgO1xuICBjb25zdCB0b2tlbkVuZHBvaW50ID0gYCR7YXV0aG9yaXR5fS8ke3RlbmFudH0vb2F1dGgyL3YyLjAvdG9rZW5gO1xuICByZXR1cm4ge1xuICAgIGlkOiBcIm1pY3Jvc29mdFwiLFxuICAgIG5hbWU6IFwiTWljcm9zb2Z0IEVudHJhSURcIixcbiAgICBjcmVhdGVBdXRob3JpemF0aW9uVVJMKGRhdGEpIHtcbiAgICAgIGNvbnN0IHNjb3BlcyA9IG9wdGlvbnMuZGlzYWJsZURlZmF1bHRTY29wZSA/IFtdIDogW1wib3BlbmlkXCIsIFwicHJvZmlsZVwiLCBcImVtYWlsXCIsIFwiVXNlci5SZWFkXCIsIFwib2ZmbGluZV9hY2Nlc3NcIl07XG4gICAgICBvcHRpb25zLnNjb3BlICYmIHNjb3Blcy5wdXNoKC4uLm9wdGlvbnMuc2NvcGUpO1xuICAgICAgZGF0YS5zY29wZXMgJiYgc2NvcGVzLnB1c2goLi4uZGF0YS5zY29wZXMpO1xuICAgICAgcmV0dXJuIGNyZWF0ZUF1dGhvcml6YXRpb25VUkwoe1xuICAgICAgICBpZDogXCJtaWNyb3NvZnRcIixcbiAgICAgICAgb3B0aW9ucyxcbiAgICAgICAgYXV0aG9yaXphdGlvbkVuZHBvaW50LFxuICAgICAgICBzdGF0ZTogZGF0YS5zdGF0ZSxcbiAgICAgICAgY29kZVZlcmlmaWVyOiBkYXRhLmNvZGVWZXJpZmllcixcbiAgICAgICAgc2NvcGVzLFxuICAgICAgICByZWRpcmVjdFVSSTogZGF0YS5yZWRpcmVjdFVSSSxcbiAgICAgICAgcHJvbXB0OiBvcHRpb25zLnByb21wdCxcbiAgICAgICAgbG9naW5IaW50OiBkYXRhLmxvZ2luSGludFxuICAgICAgfSk7XG4gICAgfSxcbiAgICB2YWxpZGF0ZUF1dGhvcml6YXRpb25Db2RlKHsgY29kZSwgY29kZVZlcmlmaWVyLCByZWRpcmVjdFVSSSB9KSB7XG4gICAgICByZXR1cm4gdmFsaWRhdGVBdXRob3JpemF0aW9uQ29kZSh7XG4gICAgICAgIGNvZGUsXG4gICAgICAgIGNvZGVWZXJpZmllcixcbiAgICAgICAgcmVkaXJlY3RVUkksXG4gICAgICAgIG9wdGlvbnMsXG4gICAgICAgIHRva2VuRW5kcG9pbnRcbiAgICAgIH0pO1xuICAgIH0sXG4gICAgYXN5bmMgZ2V0VXNlckluZm8odG9rZW4pIHtcbiAgICAgIGlmIChvcHRpb25zLmdldFVzZXJJbmZvKSB7XG4gICAgICAgIHJldHVybiBvcHRpb25zLmdldFVzZXJJbmZvKHRva2VuKTtcbiAgICAgIH1cbiAgICAgIGlmICghdG9rZW4uaWRUb2tlbikge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgIH1cbiAgICAgIGNvbnN0IHVzZXIgPSBkZWNvZGVKd3QodG9rZW4uaWRUb2tlbik7XG4gICAgICBjb25zdCBwcm9maWxlUGhvdG9TaXplID0gb3B0aW9ucy5wcm9maWxlUGhvdG9TaXplIHx8IDQ4O1xuICAgICAgYXdhaXQgYmV0dGVyRmV0Y2goXG4gICAgICAgIGBodHRwczovL2dyYXBoLm1pY3Jvc29mdC5jb20vdjEuMC9tZS9waG90b3MvJHtwcm9maWxlUGhvdG9TaXplfXgke3Byb2ZpbGVQaG90b1NpemV9LyR2YWx1ZWAsXG4gICAgICAgIHtcbiAgICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgICBBdXRob3JpemF0aW9uOiBgQmVhcmVyICR7dG9rZW4uYWNjZXNzVG9rZW59YFxuICAgICAgICAgIH0sXG4gICAgICAgICAgYXN5bmMgb25SZXNwb25zZShjb250ZXh0KSB7XG4gICAgICAgICAgICBpZiAob3B0aW9ucy5kaXNhYmxlUHJvZmlsZVBob3RvIHx8ICFjb250ZXh0LnJlc3BvbnNlLm9rKSB7XG4gICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgIGNvbnN0IHJlc3BvbnNlID0gY29udGV4dC5yZXNwb25zZS5jbG9uZSgpO1xuICAgICAgICAgICAgICBjb25zdCBwaWN0dXJlQnVmZmVyID0gYXdhaXQgcmVzcG9uc2UuYXJyYXlCdWZmZXIoKTtcbiAgICAgICAgICAgICAgY29uc3QgcGljdHVyZUJhc2U2NCA9IGJhc2U2NC5lbmNvZGUocGljdHVyZUJ1ZmZlcik7XG4gICAgICAgICAgICAgIHVzZXIucGljdHVyZSA9IGBkYXRhOmltYWdlL2pwZWc7YmFzZTY0LCAke3BpY3R1cmVCYXNlNjR9YDtcbiAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgICAgbG9nZ2VyLmVycm9yKFxuICAgICAgICAgICAgICAgIGUgJiYgdHlwZW9mIGUgPT09IFwib2JqZWN0XCIgJiYgXCJuYW1lXCIgaW4gZSA/IGUubmFtZSA6IFwiXCIsXG4gICAgICAgICAgICAgICAgZVxuICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgKTtcbiAgICAgIGNvbnN0IHVzZXJNYXAgPSBhd2FpdCBvcHRpb25zLm1hcFByb2ZpbGVUb1VzZXI/Lih1c2VyKTtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHVzZXI6IHtcbiAgICAgICAgICBpZDogdXNlci5zdWIsXG4gICAgICAgICAgbmFtZTogdXNlci5uYW1lLFxuICAgICAgICAgIGVtYWlsOiB1c2VyLmVtYWlsLFxuICAgICAgICAgIGltYWdlOiB1c2VyLnBpY3R1cmUsXG4gICAgICAgICAgZW1haWxWZXJpZmllZDogdHJ1ZSxcbiAgICAgICAgICAuLi51c2VyTWFwXG4gICAgICAgIH0sXG4gICAgICAgIGRhdGE6IHVzZXJcbiAgICAgIH07XG4gICAgfSxcbiAgICByZWZyZXNoQWNjZXNzVG9rZW46IG9wdGlvbnMucmVmcmVzaEFjY2Vzc1Rva2VuID8gb3B0aW9ucy5yZWZyZXNoQWNjZXNzVG9rZW4gOiBhc3luYyAocmVmcmVzaFRva2VuKSA9PiB7XG4gICAgICBjb25zdCBzY29wZXMgPSBvcHRpb25zLmRpc2FibGVEZWZhdWx0U2NvcGUgPyBbXSA6IFtcIm9wZW5pZFwiLCBcInByb2ZpbGVcIiwgXCJlbWFpbFwiLCBcIlVzZXIuUmVhZFwiLCBcIm9mZmxpbmVfYWNjZXNzXCJdO1xuICAgICAgb3B0aW9ucy5zY29wZSAmJiBzY29wZXMucHVzaCguLi5vcHRpb25zLnNjb3BlKTtcbiAgICAgIHJldHVybiByZWZyZXNoQWNjZXNzVG9rZW4oe1xuICAgICAgICByZWZyZXNoVG9rZW4sXG4gICAgICAgIG9wdGlvbnM6IHtcbiAgICAgICAgICBjbGllbnRJZDogb3B0aW9ucy5jbGllbnRJZCxcbiAgICAgICAgICBjbGllbnRTZWNyZXQ6IG9wdGlvbnMuY2xpZW50U2VjcmV0XG4gICAgICAgIH0sXG4gICAgICAgIGV4dHJhUGFyYW1zOiB7XG4gICAgICAgICAgc2NvcGU6IHNjb3Blcy5qb2luKFwiIFwiKVxuICAgICAgICAgIC8vIEluY2x1ZGUgdGhlIHNjb3BlcyBpbiByZXF1ZXN0IHRvIG1pY3Jvc29mdFxuICAgICAgICB9LFxuICAgICAgICB0b2tlbkVuZHBvaW50XG4gICAgICB9KTtcbiAgICB9LFxuICAgIG9wdGlvbnNcbiAgfTtcbn07XG5cbmNvbnN0IHNsYWNrID0gKG9wdGlvbnMpID0+IHtcbiAgcmV0dXJuIHtcbiAgICBpZDogXCJzbGFja1wiLFxuICAgIG5hbWU6IFwiU2xhY2tcIixcbiAgICBjcmVhdGVBdXRob3JpemF0aW9uVVJMKHsgc3RhdGUsIHNjb3BlcywgcmVkaXJlY3RVUkkgfSkge1xuICAgICAgY29uc3QgX3Njb3BlcyA9IG9wdGlvbnMuZGlzYWJsZURlZmF1bHRTY29wZSA/IFtdIDogW1wib3BlbmlkXCIsIFwicHJvZmlsZVwiLCBcImVtYWlsXCJdO1xuICAgICAgc2NvcGVzICYmIF9zY29wZXMucHVzaCguLi5zY29wZXMpO1xuICAgICAgb3B0aW9ucy5zY29wZSAmJiBfc2NvcGVzLnB1c2goLi4ub3B0aW9ucy5zY29wZSk7XG4gICAgICBjb25zdCB1cmwgPSBuZXcgVVJMKFwiaHR0cHM6Ly9zbGFjay5jb20vb3BlbmlkL2Nvbm5lY3QvYXV0aG9yaXplXCIpO1xuICAgICAgdXJsLnNlYXJjaFBhcmFtcy5zZXQoXCJzY29wZVwiLCBfc2NvcGVzLmpvaW4oXCIgXCIpKTtcbiAgICAgIHVybC5zZWFyY2hQYXJhbXMuc2V0KFwicmVzcG9uc2VfdHlwZVwiLCBcImNvZGVcIik7XG4gICAgICB1cmwuc2VhcmNoUGFyYW1zLnNldChcImNsaWVudF9pZFwiLCBvcHRpb25zLmNsaWVudElkKTtcbiAgICAgIHVybC5zZWFyY2hQYXJhbXMuc2V0KFwicmVkaXJlY3RfdXJpXCIsIG9wdGlvbnMucmVkaXJlY3RVUkkgfHwgcmVkaXJlY3RVUkkpO1xuICAgICAgdXJsLnNlYXJjaFBhcmFtcy5zZXQoXCJzdGF0ZVwiLCBzdGF0ZSk7XG4gICAgICByZXR1cm4gdXJsO1xuICAgIH0sXG4gICAgdmFsaWRhdGVBdXRob3JpemF0aW9uQ29kZTogYXN5bmMgKHsgY29kZSwgcmVkaXJlY3RVUkkgfSkgPT4ge1xuICAgICAgcmV0dXJuIHZhbGlkYXRlQXV0aG9yaXphdGlvbkNvZGUoe1xuICAgICAgICBjb2RlLFxuICAgICAgICByZWRpcmVjdFVSSSxcbiAgICAgICAgb3B0aW9ucyxcbiAgICAgICAgdG9rZW5FbmRwb2ludDogXCJodHRwczovL3NsYWNrLmNvbS9hcGkvb3BlbmlkLmNvbm5lY3QudG9rZW5cIlxuICAgICAgfSk7XG4gICAgfSxcbiAgICByZWZyZXNoQWNjZXNzVG9rZW46IG9wdGlvbnMucmVmcmVzaEFjY2Vzc1Rva2VuID8gb3B0aW9ucy5yZWZyZXNoQWNjZXNzVG9rZW4gOiBhc3luYyAocmVmcmVzaFRva2VuKSA9PiB7XG4gICAgICByZXR1cm4gcmVmcmVzaEFjY2Vzc1Rva2VuKHtcbiAgICAgICAgcmVmcmVzaFRva2VuLFxuICAgICAgICBvcHRpb25zOiB7XG4gICAgICAgICAgY2xpZW50SWQ6IG9wdGlvbnMuY2xpZW50SWQsXG4gICAgICAgICAgY2xpZW50S2V5OiBvcHRpb25zLmNsaWVudEtleSxcbiAgICAgICAgICBjbGllbnRTZWNyZXQ6IG9wdGlvbnMuY2xpZW50U2VjcmV0XG4gICAgICAgIH0sXG4gICAgICAgIHRva2VuRW5kcG9pbnQ6IFwiaHR0cHM6Ly9zbGFjay5jb20vYXBpL29wZW5pZC5jb25uZWN0LnRva2VuXCJcbiAgICAgIH0pO1xuICAgIH0sXG4gICAgYXN5bmMgZ2V0VXNlckluZm8odG9rZW4pIHtcbiAgICAgIGlmIChvcHRpb25zLmdldFVzZXJJbmZvKSB7XG4gICAgICAgIHJldHVybiBvcHRpb25zLmdldFVzZXJJbmZvKHRva2VuKTtcbiAgICAgIH1cbiAgICAgIGNvbnN0IHsgZGF0YTogcHJvZmlsZSwgZXJyb3IgfSA9IGF3YWl0IGJldHRlckZldGNoKFxuICAgICAgICBcImh0dHBzOi8vc2xhY2suY29tL2FwaS9vcGVuaWQuY29ubmVjdC51c2VySW5mb1wiLFxuICAgICAgICB7XG4gICAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICAgYXV0aG9yaXphdGlvbjogYEJlYXJlciAke3Rva2VuLmFjY2Vzc1Rva2VufWBcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICk7XG4gICAgICBpZiAoZXJyb3IpIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICB9XG4gICAgICBjb25zdCB1c2VyTWFwID0gYXdhaXQgb3B0aW9ucy5tYXBQcm9maWxlVG9Vc2VyPy4ocHJvZmlsZSk7XG4gICAgICByZXR1cm4ge1xuICAgICAgICB1c2VyOiB7XG4gICAgICAgICAgaWQ6IHByb2ZpbGVbXCJodHRwczovL3NsYWNrLmNvbS91c2VyX2lkXCJdLFxuICAgICAgICAgIG5hbWU6IHByb2ZpbGUubmFtZSB8fCBcIlwiLFxuICAgICAgICAgIGVtYWlsOiBwcm9maWxlLmVtYWlsLFxuICAgICAgICAgIGVtYWlsVmVyaWZpZWQ6IHByb2ZpbGUuZW1haWxfdmVyaWZpZWQsXG4gICAgICAgICAgaW1hZ2U6IHByb2ZpbGUucGljdHVyZSB8fCBwcm9maWxlW1wiaHR0cHM6Ly9zbGFjay5jb20vdXNlcl9pbWFnZV81MTJcIl0sXG4gICAgICAgICAgLi4udXNlck1hcFxuICAgICAgICB9LFxuICAgICAgICBkYXRhOiBwcm9maWxlXG4gICAgICB9O1xuICAgIH0sXG4gICAgb3B0aW9uc1xuICB9O1xufTtcblxuY29uc3Qgbm90aW9uID0gKG9wdGlvbnMpID0+IHtcbiAgY29uc3QgdG9rZW5FbmRwb2ludCA9IFwiaHR0cHM6Ly9hcGkubm90aW9uLmNvbS92MS9vYXV0aC90b2tlblwiO1xuICByZXR1cm4ge1xuICAgIGlkOiBcIm5vdGlvblwiLFxuICAgIG5hbWU6IFwiTm90aW9uXCIsXG4gICAgY3JlYXRlQXV0aG9yaXphdGlvblVSTCh7IHN0YXRlLCBzY29wZXMsIGxvZ2luSGludCwgcmVkaXJlY3RVUkkgfSkge1xuICAgICAgY29uc3QgX3Njb3BlcyA9IG9wdGlvbnMuZGlzYWJsZURlZmF1bHRTY29wZSA/IFtdIDogW107XG4gICAgICBvcHRpb25zLnNjb3BlICYmIF9zY29wZXMucHVzaCguLi5vcHRpb25zLnNjb3BlKTtcbiAgICAgIHNjb3BlcyAmJiBfc2NvcGVzLnB1c2goLi4uc2NvcGVzKTtcbiAgICAgIHJldHVybiBjcmVhdGVBdXRob3JpemF0aW9uVVJMKHtcbiAgICAgICAgaWQ6IFwibm90aW9uXCIsXG4gICAgICAgIG9wdGlvbnMsXG4gICAgICAgIGF1dGhvcml6YXRpb25FbmRwb2ludDogXCJodHRwczovL2FwaS5ub3Rpb24uY29tL3YxL29hdXRoL2F1dGhvcml6ZVwiLFxuICAgICAgICBzY29wZXM6IF9zY29wZXMsXG4gICAgICAgIHN0YXRlLFxuICAgICAgICByZWRpcmVjdFVSSSxcbiAgICAgICAgbG9naW5IaW50LFxuICAgICAgICBhZGRpdGlvbmFsUGFyYW1zOiB7XG4gICAgICAgICAgb3duZXI6IFwidXNlclwiXG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH0sXG4gICAgdmFsaWRhdGVBdXRob3JpemF0aW9uQ29kZTogYXN5bmMgKHsgY29kZSwgcmVkaXJlY3RVUkkgfSkgPT4ge1xuICAgICAgcmV0dXJuIHZhbGlkYXRlQXV0aG9yaXphdGlvbkNvZGUoe1xuICAgICAgICBjb2RlLFxuICAgICAgICByZWRpcmVjdFVSSSxcbiAgICAgICAgb3B0aW9ucyxcbiAgICAgICAgdG9rZW5FbmRwb2ludCxcbiAgICAgICAgYXV0aGVudGljYXRpb246IFwiYmFzaWNcIlxuICAgICAgfSk7XG4gICAgfSxcbiAgICByZWZyZXNoQWNjZXNzVG9rZW46IG9wdGlvbnMucmVmcmVzaEFjY2Vzc1Rva2VuID8gb3B0aW9ucy5yZWZyZXNoQWNjZXNzVG9rZW4gOiBhc3luYyAocmVmcmVzaFRva2VuKSA9PiB7XG4gICAgICByZXR1cm4gcmVmcmVzaEFjY2Vzc1Rva2VuKHtcbiAgICAgICAgcmVmcmVzaFRva2VuLFxuICAgICAgICBvcHRpb25zOiB7XG4gICAgICAgICAgY2xpZW50SWQ6IG9wdGlvbnMuY2xpZW50SWQsXG4gICAgICAgICAgY2xpZW50S2V5OiBvcHRpb25zLmNsaWVudEtleSxcbiAgICAgICAgICBjbGllbnRTZWNyZXQ6IG9wdGlvbnMuY2xpZW50U2VjcmV0XG4gICAgICAgIH0sXG4gICAgICAgIHRva2VuRW5kcG9pbnRcbiAgICAgIH0pO1xuICAgIH0sXG4gICAgYXN5bmMgZ2V0VXNlckluZm8odG9rZW4pIHtcbiAgICAgIGlmIChvcHRpb25zLmdldFVzZXJJbmZvKSB7XG4gICAgICAgIHJldHVybiBvcHRpb25zLmdldFVzZXJJbmZvKHRva2VuKTtcbiAgICAgIH1cbiAgICAgIGNvbnN0IHsgZGF0YTogcHJvZmlsZSwgZXJyb3IgfSA9IGF3YWl0IGJldHRlckZldGNoKFwiaHR0cHM6Ly9hcGkubm90aW9uLmNvbS92MS91c2Vycy9tZVwiLCB7XG4gICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICBBdXRob3JpemF0aW9uOiBgQmVhcmVyICR7dG9rZW4uYWNjZXNzVG9rZW59YCxcbiAgICAgICAgICBcIk5vdGlvbi1WZXJzaW9uXCI6IFwiMjAyMi0wNi0yOFwiXG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgICAgaWYgKGVycm9yIHx8ICFwcm9maWxlKSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgICAgfVxuICAgICAgY29uc3QgdXNlclByb2ZpbGUgPSBwcm9maWxlLmJvdD8ub3duZXI/LnVzZXI7XG4gICAgICBpZiAoIXVzZXJQcm9maWxlKSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgICAgfVxuICAgICAgY29uc3QgdXNlck1hcCA9IGF3YWl0IG9wdGlvbnMubWFwUHJvZmlsZVRvVXNlcj8uKHVzZXJQcm9maWxlKTtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHVzZXI6IHtcbiAgICAgICAgICBpZDogdXNlclByb2ZpbGUuaWQsXG4gICAgICAgICAgbmFtZTogdXNlclByb2ZpbGUubmFtZSB8fCBcIk5vdGlvbiBVc2VyXCIsXG4gICAgICAgICAgZW1haWw6IHVzZXJQcm9maWxlLnBlcnNvbj8uZW1haWwgfHwgbnVsbCxcbiAgICAgICAgICBpbWFnZTogdXNlclByb2ZpbGUuYXZhdGFyX3VybCxcbiAgICAgICAgICBlbWFpbFZlcmlmaWVkOiAhIXVzZXJQcm9maWxlLnBlcnNvbj8uZW1haWwsXG4gICAgICAgICAgLi4udXNlck1hcFxuICAgICAgICB9LFxuICAgICAgICBkYXRhOiB1c2VyUHJvZmlsZVxuICAgICAgfTtcbiAgICB9LFxuICAgIG9wdGlvbnNcbiAgfTtcbn07XG5cbmNvbnN0IHNwb3RpZnkgPSAob3B0aW9ucykgPT4ge1xuICByZXR1cm4ge1xuICAgIGlkOiBcInNwb3RpZnlcIixcbiAgICBuYW1lOiBcIlNwb3RpZnlcIixcbiAgICBjcmVhdGVBdXRob3JpemF0aW9uVVJMKHsgc3RhdGUsIHNjb3BlcywgY29kZVZlcmlmaWVyLCByZWRpcmVjdFVSSSB9KSB7XG4gICAgICBjb25zdCBfc2NvcGVzID0gb3B0aW9ucy5kaXNhYmxlRGVmYXVsdFNjb3BlID8gW10gOiBbXCJ1c2VyLXJlYWQtZW1haWxcIl07XG4gICAgICBvcHRpb25zLnNjb3BlICYmIF9zY29wZXMucHVzaCguLi5vcHRpb25zLnNjb3BlKTtcbiAgICAgIHNjb3BlcyAmJiBfc2NvcGVzLnB1c2goLi4uc2NvcGVzKTtcbiAgICAgIHJldHVybiBjcmVhdGVBdXRob3JpemF0aW9uVVJMKHtcbiAgICAgICAgaWQ6IFwic3BvdGlmeVwiLFxuICAgICAgICBvcHRpb25zLFxuICAgICAgICBhdXRob3JpemF0aW9uRW5kcG9pbnQ6IFwiaHR0cHM6Ly9hY2NvdW50cy5zcG90aWZ5LmNvbS9hdXRob3JpemVcIixcbiAgICAgICAgc2NvcGVzOiBfc2NvcGVzLFxuICAgICAgICBzdGF0ZSxcbiAgICAgICAgY29kZVZlcmlmaWVyLFxuICAgICAgICByZWRpcmVjdFVSSVxuICAgICAgfSk7XG4gICAgfSxcbiAgICB2YWxpZGF0ZUF1dGhvcml6YXRpb25Db2RlOiBhc3luYyAoeyBjb2RlLCBjb2RlVmVyaWZpZXIsIHJlZGlyZWN0VVJJIH0pID0+IHtcbiAgICAgIHJldHVybiB2YWxpZGF0ZUF1dGhvcml6YXRpb25Db2RlKHtcbiAgICAgICAgY29kZSxcbiAgICAgICAgY29kZVZlcmlmaWVyLFxuICAgICAgICByZWRpcmVjdFVSSSxcbiAgICAgICAgb3B0aW9ucyxcbiAgICAgICAgdG9rZW5FbmRwb2ludDogXCJodHRwczovL2FjY291bnRzLnNwb3RpZnkuY29tL2FwaS90b2tlblwiXG4gICAgICB9KTtcbiAgICB9LFxuICAgIHJlZnJlc2hBY2Nlc3NUb2tlbjogb3B0aW9ucy5yZWZyZXNoQWNjZXNzVG9rZW4gPyBvcHRpb25zLnJlZnJlc2hBY2Nlc3NUb2tlbiA6IGFzeW5jIChyZWZyZXNoVG9rZW4pID0+IHtcbiAgICAgIHJldHVybiByZWZyZXNoQWNjZXNzVG9rZW4oe1xuICAgICAgICByZWZyZXNoVG9rZW4sXG4gICAgICAgIG9wdGlvbnM6IHtcbiAgICAgICAgICBjbGllbnRJZDogb3B0aW9ucy5jbGllbnRJZCxcbiAgICAgICAgICBjbGllbnRLZXk6IG9wdGlvbnMuY2xpZW50S2V5LFxuICAgICAgICAgIGNsaWVudFNlY3JldDogb3B0aW9ucy5jbGllbnRTZWNyZXRcbiAgICAgICAgfSxcbiAgICAgICAgdG9rZW5FbmRwb2ludDogXCJodHRwczovL2FjY291bnRzLnNwb3RpZnkuY29tL2FwaS90b2tlblwiXG4gICAgICB9KTtcbiAgICB9LFxuICAgIGFzeW5jIGdldFVzZXJJbmZvKHRva2VuKSB7XG4gICAgICBpZiAob3B0aW9ucy5nZXRVc2VySW5mbykge1xuICAgICAgICByZXR1cm4gb3B0aW9ucy5nZXRVc2VySW5mbyh0b2tlbik7XG4gICAgICB9XG4gICAgICBjb25zdCB7IGRhdGE6IHByb2ZpbGUsIGVycm9yIH0gPSBhd2FpdCBiZXR0ZXJGZXRjaChcbiAgICAgICAgXCJodHRwczovL2FwaS5zcG90aWZ5LmNvbS92MS9tZVwiLFxuICAgICAgICB7XG4gICAgICAgICAgbWV0aG9kOiBcIkdFVFwiLFxuICAgICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAgIEF1dGhvcml6YXRpb246IGBCZWFyZXIgJHt0b2tlbi5hY2Nlc3NUb2tlbn1gXG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICApO1xuICAgICAgaWYgKGVycm9yKSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgICAgfVxuICAgICAgY29uc3QgdXNlck1hcCA9IGF3YWl0IG9wdGlvbnMubWFwUHJvZmlsZVRvVXNlcj8uKHByb2ZpbGUpO1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgdXNlcjoge1xuICAgICAgICAgIGlkOiBwcm9maWxlLmlkLFxuICAgICAgICAgIG5hbWU6IHByb2ZpbGUuZGlzcGxheV9uYW1lLFxuICAgICAgICAgIGVtYWlsOiBwcm9maWxlLmVtYWlsLFxuICAgICAgICAgIGltYWdlOiBwcm9maWxlLmltYWdlc1swXT8udXJsLFxuICAgICAgICAgIGVtYWlsVmVyaWZpZWQ6IGZhbHNlLFxuICAgICAgICAgIC4uLnVzZXJNYXBcbiAgICAgICAgfSxcbiAgICAgICAgZGF0YTogcHJvZmlsZVxuICAgICAgfTtcbiAgICB9LFxuICAgIG9wdGlvbnNcbiAgfTtcbn07XG5cbmNvbnN0IHR3aXRjaCA9IChvcHRpb25zKSA9PiB7XG4gIHJldHVybiB7XG4gICAgaWQ6IFwidHdpdGNoXCIsXG4gICAgbmFtZTogXCJUd2l0Y2hcIixcbiAgICBjcmVhdGVBdXRob3JpemF0aW9uVVJMKHsgc3RhdGUsIHNjb3BlcywgcmVkaXJlY3RVUkkgfSkge1xuICAgICAgY29uc3QgX3Njb3BlcyA9IG9wdGlvbnMuZGlzYWJsZURlZmF1bHRTY29wZSA/IFtdIDogW1widXNlcjpyZWFkOmVtYWlsXCIsIFwib3BlbmlkXCJdO1xuICAgICAgb3B0aW9ucy5zY29wZSAmJiBfc2NvcGVzLnB1c2goLi4ub3B0aW9ucy5zY29wZSk7XG4gICAgICBzY29wZXMgJiYgX3Njb3Blcy5wdXNoKC4uLnNjb3Blcyk7XG4gICAgICByZXR1cm4gY3JlYXRlQXV0aG9yaXphdGlvblVSTCh7XG4gICAgICAgIGlkOiBcInR3aXRjaFwiLFxuICAgICAgICByZWRpcmVjdFVSSSxcbiAgICAgICAgb3B0aW9ucyxcbiAgICAgICAgYXV0aG9yaXphdGlvbkVuZHBvaW50OiBcImh0dHBzOi8vaWQudHdpdGNoLnR2L29hdXRoMi9hdXRob3JpemVcIixcbiAgICAgICAgc2NvcGVzOiBfc2NvcGVzLFxuICAgICAgICBzdGF0ZSxcbiAgICAgICAgY2xhaW1zOiBvcHRpb25zLmNsYWltcyB8fCBbXG4gICAgICAgICAgXCJlbWFpbFwiLFxuICAgICAgICAgIFwiZW1haWxfdmVyaWZpZWRcIixcbiAgICAgICAgICBcInByZWZlcnJlZF91c2VybmFtZVwiLFxuICAgICAgICAgIFwicGljdHVyZVwiXG4gICAgICAgIF1cbiAgICAgIH0pO1xuICAgIH0sXG4gICAgdmFsaWRhdGVBdXRob3JpemF0aW9uQ29kZTogYXN5bmMgKHsgY29kZSwgcmVkaXJlY3RVUkkgfSkgPT4ge1xuICAgICAgcmV0dXJuIHZhbGlkYXRlQXV0aG9yaXphdGlvbkNvZGUoe1xuICAgICAgICBjb2RlLFxuICAgICAgICByZWRpcmVjdFVSSSxcbiAgICAgICAgb3B0aW9ucyxcbiAgICAgICAgdG9rZW5FbmRwb2ludDogXCJodHRwczovL2lkLnR3aXRjaC50di9vYXV0aDIvdG9rZW5cIlxuICAgICAgfSk7XG4gICAgfSxcbiAgICByZWZyZXNoQWNjZXNzVG9rZW46IG9wdGlvbnMucmVmcmVzaEFjY2Vzc1Rva2VuID8gb3B0aW9ucy5yZWZyZXNoQWNjZXNzVG9rZW4gOiBhc3luYyAocmVmcmVzaFRva2VuKSA9PiB7XG4gICAgICByZXR1cm4gcmVmcmVzaEFjY2Vzc1Rva2VuKHtcbiAgICAgICAgcmVmcmVzaFRva2VuLFxuICAgICAgICBvcHRpb25zOiB7XG4gICAgICAgICAgY2xpZW50SWQ6IG9wdGlvbnMuY2xpZW50SWQsXG4gICAgICAgICAgY2xpZW50S2V5OiBvcHRpb25zLmNsaWVudEtleSxcbiAgICAgICAgICBjbGllbnRTZWNyZXQ6IG9wdGlvbnMuY2xpZW50U2VjcmV0XG4gICAgICAgIH0sXG4gICAgICAgIHRva2VuRW5kcG9pbnQ6IFwiaHR0cHM6Ly9pZC50d2l0Y2gudHYvb2F1dGgyL3Rva2VuXCJcbiAgICAgIH0pO1xuICAgIH0sXG4gICAgYXN5bmMgZ2V0VXNlckluZm8odG9rZW4pIHtcbiAgICAgIGlmIChvcHRpb25zLmdldFVzZXJJbmZvKSB7XG4gICAgICAgIHJldHVybiBvcHRpb25zLmdldFVzZXJJbmZvKHRva2VuKTtcbiAgICAgIH1cbiAgICAgIGNvbnN0IGlkVG9rZW4gPSB0b2tlbi5pZFRva2VuO1xuICAgICAgaWYgKCFpZFRva2VuKSB7XG4gICAgICAgIGxvZ2dlci5lcnJvcihcIk5vIGlkVG9rZW4gZm91bmQgaW4gdG9rZW5cIik7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgICAgfVxuICAgICAgY29uc3QgcHJvZmlsZSA9IGRlY29kZUp3dChpZFRva2VuKTtcbiAgICAgIGNvbnN0IHVzZXJNYXAgPSBhd2FpdCBvcHRpb25zLm1hcFByb2ZpbGVUb1VzZXI/Lihwcm9maWxlKTtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHVzZXI6IHtcbiAgICAgICAgICBpZDogcHJvZmlsZS5zdWIsXG4gICAgICAgICAgbmFtZTogcHJvZmlsZS5wcmVmZXJyZWRfdXNlcm5hbWUsXG4gICAgICAgICAgZW1haWw6IHByb2ZpbGUuZW1haWwsXG4gICAgICAgICAgaW1hZ2U6IHByb2ZpbGUucGljdHVyZSxcbiAgICAgICAgICBlbWFpbFZlcmlmaWVkOiBwcm9maWxlLmVtYWlsX3ZlcmlmaWVkLFxuICAgICAgICAgIC4uLnVzZXJNYXBcbiAgICAgICAgfSxcbiAgICAgICAgZGF0YTogcHJvZmlsZVxuICAgICAgfTtcbiAgICB9LFxuICAgIG9wdGlvbnNcbiAgfTtcbn07XG5cbmNvbnN0IHR3aXR0ZXIgPSAob3B0aW9ucykgPT4ge1xuICByZXR1cm4ge1xuICAgIGlkOiBcInR3aXR0ZXJcIixcbiAgICBuYW1lOiBcIlR3aXR0ZXJcIixcbiAgICBjcmVhdGVBdXRob3JpemF0aW9uVVJMKGRhdGEpIHtcbiAgICAgIGNvbnN0IF9zY29wZXMgPSBvcHRpb25zLmRpc2FibGVEZWZhdWx0U2NvcGUgPyBbXSA6IFtcInVzZXJzLnJlYWRcIiwgXCJ0d2VldC5yZWFkXCIsIFwib2ZmbGluZS5hY2Nlc3NcIiwgXCJ1c2Vycy5lbWFpbFwiXTtcbiAgICAgIG9wdGlvbnMuc2NvcGUgJiYgX3Njb3Blcy5wdXNoKC4uLm9wdGlvbnMuc2NvcGUpO1xuICAgICAgZGF0YS5zY29wZXMgJiYgX3Njb3Blcy5wdXNoKC4uLmRhdGEuc2NvcGVzKTtcbiAgICAgIHJldHVybiBjcmVhdGVBdXRob3JpemF0aW9uVVJMKHtcbiAgICAgICAgaWQ6IFwidHdpdHRlclwiLFxuICAgICAgICBvcHRpb25zLFxuICAgICAgICBhdXRob3JpemF0aW9uRW5kcG9pbnQ6IFwiaHR0cHM6Ly94LmNvbS9pL29hdXRoMi9hdXRob3JpemVcIixcbiAgICAgICAgc2NvcGVzOiBfc2NvcGVzLFxuICAgICAgICBzdGF0ZTogZGF0YS5zdGF0ZSxcbiAgICAgICAgY29kZVZlcmlmaWVyOiBkYXRhLmNvZGVWZXJpZmllcixcbiAgICAgICAgcmVkaXJlY3RVUkk6IGRhdGEucmVkaXJlY3RVUklcbiAgICAgIH0pO1xuICAgIH0sXG4gICAgdmFsaWRhdGVBdXRob3JpemF0aW9uQ29kZTogYXN5bmMgKHsgY29kZSwgY29kZVZlcmlmaWVyLCByZWRpcmVjdFVSSSB9KSA9PiB7XG4gICAgICByZXR1cm4gdmFsaWRhdGVBdXRob3JpemF0aW9uQ29kZSh7XG4gICAgICAgIGNvZGUsXG4gICAgICAgIGNvZGVWZXJpZmllcixcbiAgICAgICAgYXV0aGVudGljYXRpb246IFwiYmFzaWNcIixcbiAgICAgICAgcmVkaXJlY3RVUkksXG4gICAgICAgIG9wdGlvbnMsXG4gICAgICAgIHRva2VuRW5kcG9pbnQ6IFwiaHR0cHM6Ly9hcGkueC5jb20vMi9vYXV0aDIvdG9rZW5cIlxuICAgICAgfSk7XG4gICAgfSxcbiAgICByZWZyZXNoQWNjZXNzVG9rZW46IG9wdGlvbnMucmVmcmVzaEFjY2Vzc1Rva2VuID8gb3B0aW9ucy5yZWZyZXNoQWNjZXNzVG9rZW4gOiBhc3luYyAocmVmcmVzaFRva2VuKSA9PiB7XG4gICAgICByZXR1cm4gcmVmcmVzaEFjY2Vzc1Rva2VuKHtcbiAgICAgICAgcmVmcmVzaFRva2VuLFxuICAgICAgICBvcHRpb25zOiB7XG4gICAgICAgICAgY2xpZW50SWQ6IG9wdGlvbnMuY2xpZW50SWQsXG4gICAgICAgICAgY2xpZW50S2V5OiBvcHRpb25zLmNsaWVudEtleSxcbiAgICAgICAgICBjbGllbnRTZWNyZXQ6IG9wdGlvbnMuY2xpZW50U2VjcmV0XG4gICAgICAgIH0sXG4gICAgICAgIGF1dGhlbnRpY2F0aW9uOiBcImJhc2ljXCIsXG4gICAgICAgIHRva2VuRW5kcG9pbnQ6IFwiaHR0cHM6Ly9hcGkueC5jb20vMi9vYXV0aDIvdG9rZW5cIlxuICAgICAgfSk7XG4gICAgfSxcbiAgICBhc3luYyBnZXRVc2VySW5mbyh0b2tlbikge1xuICAgICAgaWYgKG9wdGlvbnMuZ2V0VXNlckluZm8pIHtcbiAgICAgICAgcmV0dXJuIG9wdGlvbnMuZ2V0VXNlckluZm8odG9rZW4pO1xuICAgICAgfVxuICAgICAgY29uc3QgeyBkYXRhOiBwcm9maWxlLCBlcnJvcjogcHJvZmlsZUVycm9yIH0gPSBhd2FpdCBiZXR0ZXJGZXRjaChcbiAgICAgICAgXCJodHRwczovL2FwaS54LmNvbS8yL3VzZXJzL21lP3VzZXIuZmllbGRzPXByb2ZpbGVfaW1hZ2VfdXJsXCIsXG4gICAgICAgIHtcbiAgICAgICAgICBtZXRob2Q6IFwiR0VUXCIsXG4gICAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICAgQXV0aG9yaXphdGlvbjogYEJlYXJlciAke3Rva2VuLmFjY2Vzc1Rva2VufWBcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICk7XG4gICAgICBpZiAocHJvZmlsZUVycm9yKSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgICAgfVxuICAgICAgY29uc3QgeyBkYXRhOiBlbWFpbERhdGEsIGVycm9yOiBlbWFpbEVycm9yIH0gPSBhd2FpdCBiZXR0ZXJGZXRjaChcImh0dHBzOi8vYXBpLnguY29tLzIvdXNlcnMvbWU/dXNlci5maWVsZHM9Y29uZmlybWVkX2VtYWlsXCIsIHtcbiAgICAgICAgbWV0aG9kOiBcIkdFVFwiLFxuICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgQXV0aG9yaXphdGlvbjogYEJlYXJlciAke3Rva2VuLmFjY2Vzc1Rva2VufWBcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgICBsZXQgZW1haWxWZXJpZmllZCA9IGZhbHNlO1xuICAgICAgaWYgKCFlbWFpbEVycm9yICYmIGVtYWlsRGF0YT8uZGF0YT8uY29uZmlybWVkX2VtYWlsKSB7XG4gICAgICAgIHByb2ZpbGUuZGF0YS5lbWFpbCA9IGVtYWlsRGF0YS5kYXRhLmNvbmZpcm1lZF9lbWFpbDtcbiAgICAgICAgZW1haWxWZXJpZmllZCA9IHRydWU7XG4gICAgICB9XG4gICAgICBjb25zdCB1c2VyTWFwID0gYXdhaXQgb3B0aW9ucy5tYXBQcm9maWxlVG9Vc2VyPy4ocHJvZmlsZSk7XG4gICAgICByZXR1cm4ge1xuICAgICAgICB1c2VyOiB7XG4gICAgICAgICAgaWQ6IHByb2ZpbGUuZGF0YS5pZCxcbiAgICAgICAgICBuYW1lOiBwcm9maWxlLmRhdGEubmFtZSxcbiAgICAgICAgICBlbWFpbDogcHJvZmlsZS5kYXRhLmVtYWlsIHx8IHByb2ZpbGUuZGF0YS51c2VybmFtZSB8fCBudWxsLFxuICAgICAgICAgIGltYWdlOiBwcm9maWxlLmRhdGEucHJvZmlsZV9pbWFnZV91cmwsXG4gICAgICAgICAgZW1haWxWZXJpZmllZCxcbiAgICAgICAgICAuLi51c2VyTWFwXG4gICAgICAgIH0sXG4gICAgICAgIGRhdGE6IHByb2ZpbGVcbiAgICAgIH07XG4gICAgfSxcbiAgICBvcHRpb25zXG4gIH07XG59O1xuXG5jb25zdCBkcm9wYm94ID0gKG9wdGlvbnMpID0+IHtcbiAgY29uc3QgdG9rZW5FbmRwb2ludCA9IFwiaHR0cHM6Ly9hcGkuZHJvcGJveGFwaS5jb20vb2F1dGgyL3Rva2VuXCI7XG4gIHJldHVybiB7XG4gICAgaWQ6IFwiZHJvcGJveFwiLFxuICAgIG5hbWU6IFwiRHJvcGJveFwiLFxuICAgIGNyZWF0ZUF1dGhvcml6YXRpb25VUkw6IGFzeW5jICh7XG4gICAgICBzdGF0ZSxcbiAgICAgIHNjb3BlcyxcbiAgICAgIGNvZGVWZXJpZmllcixcbiAgICAgIHJlZGlyZWN0VVJJXG4gICAgfSkgPT4ge1xuICAgICAgY29uc3QgX3Njb3BlcyA9IG9wdGlvbnMuZGlzYWJsZURlZmF1bHRTY29wZSA/IFtdIDogW1wiYWNjb3VudF9pbmZvLnJlYWRcIl07XG4gICAgICBvcHRpb25zLnNjb3BlICYmIF9zY29wZXMucHVzaCguLi5vcHRpb25zLnNjb3BlKTtcbiAgICAgIHNjb3BlcyAmJiBfc2NvcGVzLnB1c2goLi4uc2NvcGVzKTtcbiAgICAgIGNvbnN0IGFkZGl0aW9uYWxQYXJhbXMgPSB7fTtcbiAgICAgIGlmIChvcHRpb25zLmFjY2Vzc1R5cGUpIHtcbiAgICAgICAgYWRkaXRpb25hbFBhcmFtcy50b2tlbl9hY2Nlc3NfdHlwZSA9IG9wdGlvbnMuYWNjZXNzVHlwZTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBhd2FpdCBjcmVhdGVBdXRob3JpemF0aW9uVVJMKHtcbiAgICAgICAgaWQ6IFwiZHJvcGJveFwiLFxuICAgICAgICBvcHRpb25zLFxuICAgICAgICBhdXRob3JpemF0aW9uRW5kcG9pbnQ6IFwiaHR0cHM6Ly93d3cuZHJvcGJveC5jb20vb2F1dGgyL2F1dGhvcml6ZVwiLFxuICAgICAgICBzY29wZXM6IF9zY29wZXMsXG4gICAgICAgIHN0YXRlLFxuICAgICAgICByZWRpcmVjdFVSSSxcbiAgICAgICAgY29kZVZlcmlmaWVyLFxuICAgICAgICBhZGRpdGlvbmFsUGFyYW1zXG4gICAgICB9KTtcbiAgICB9LFxuICAgIHZhbGlkYXRlQXV0aG9yaXphdGlvbkNvZGU6IGFzeW5jICh7IGNvZGUsIGNvZGVWZXJpZmllciwgcmVkaXJlY3RVUkkgfSkgPT4ge1xuICAgICAgcmV0dXJuIGF3YWl0IHZhbGlkYXRlQXV0aG9yaXphdGlvbkNvZGUoe1xuICAgICAgICBjb2RlLFxuICAgICAgICBjb2RlVmVyaWZpZXIsXG4gICAgICAgIHJlZGlyZWN0VVJJLFxuICAgICAgICBvcHRpb25zLFxuICAgICAgICB0b2tlbkVuZHBvaW50XG4gICAgICB9KTtcbiAgICB9LFxuICAgIHJlZnJlc2hBY2Nlc3NUb2tlbjogb3B0aW9ucy5yZWZyZXNoQWNjZXNzVG9rZW4gPyBvcHRpb25zLnJlZnJlc2hBY2Nlc3NUb2tlbiA6IGFzeW5jIChyZWZyZXNoVG9rZW4pID0+IHtcbiAgICAgIHJldHVybiByZWZyZXNoQWNjZXNzVG9rZW4oe1xuICAgICAgICByZWZyZXNoVG9rZW4sXG4gICAgICAgIG9wdGlvbnM6IHtcbiAgICAgICAgICBjbGllbnRJZDogb3B0aW9ucy5jbGllbnRJZCxcbiAgICAgICAgICBjbGllbnRLZXk6IG9wdGlvbnMuY2xpZW50S2V5LFxuICAgICAgICAgIGNsaWVudFNlY3JldDogb3B0aW9ucy5jbGllbnRTZWNyZXRcbiAgICAgICAgfSxcbiAgICAgICAgdG9rZW5FbmRwb2ludDogXCJodHRwczovL2FwaS5kcm9wYm94LmNvbS9vYXV0aDIvdG9rZW5cIlxuICAgICAgfSk7XG4gICAgfSxcbiAgICBhc3luYyBnZXRVc2VySW5mbyh0b2tlbikge1xuICAgICAgaWYgKG9wdGlvbnMuZ2V0VXNlckluZm8pIHtcbiAgICAgICAgcmV0dXJuIG9wdGlvbnMuZ2V0VXNlckluZm8odG9rZW4pO1xuICAgICAgfVxuICAgICAgY29uc3QgeyBkYXRhOiBwcm9maWxlLCBlcnJvciB9ID0gYXdhaXQgYmV0dGVyRmV0Y2goXG4gICAgICAgIFwiaHR0cHM6Ly9hcGkuZHJvcGJveGFwaS5jb20vMi91c2Vycy9nZXRfY3VycmVudF9hY2NvdW50XCIsXG4gICAgICAgIHtcbiAgICAgICAgICBtZXRob2Q6IFwiUE9TVFwiLFxuICAgICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAgIEF1dGhvcml6YXRpb246IGBCZWFyZXIgJHt0b2tlbi5hY2Nlc3NUb2tlbn1gXG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICApO1xuICAgICAgaWYgKGVycm9yKSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgICAgfVxuICAgICAgY29uc3QgdXNlck1hcCA9IGF3YWl0IG9wdGlvbnMubWFwUHJvZmlsZVRvVXNlcj8uKHByb2ZpbGUpO1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgdXNlcjoge1xuICAgICAgICAgIGlkOiBwcm9maWxlLmFjY291bnRfaWQsXG4gICAgICAgICAgbmFtZTogcHJvZmlsZS5uYW1lPy5kaXNwbGF5X25hbWUsXG4gICAgICAgICAgZW1haWw6IHByb2ZpbGUuZW1haWwsXG4gICAgICAgICAgZW1haWxWZXJpZmllZDogcHJvZmlsZS5lbWFpbF92ZXJpZmllZCB8fCBmYWxzZSxcbiAgICAgICAgICBpbWFnZTogcHJvZmlsZS5wcm9maWxlX3Bob3RvX3VybCxcbiAgICAgICAgICAuLi51c2VyTWFwXG4gICAgICAgIH0sXG4gICAgICAgIGRhdGE6IHByb2ZpbGVcbiAgICAgIH07XG4gICAgfSxcbiAgICBvcHRpb25zXG4gIH07XG59O1xuXG5jb25zdCBsaW5lYXIgPSAob3B0aW9ucykgPT4ge1xuICBjb25zdCB0b2tlbkVuZHBvaW50ID0gXCJodHRwczovL2FwaS5saW5lYXIuYXBwL29hdXRoL3Rva2VuXCI7XG4gIHJldHVybiB7XG4gICAgaWQ6IFwibGluZWFyXCIsXG4gICAgbmFtZTogXCJMaW5lYXJcIixcbiAgICBjcmVhdGVBdXRob3JpemF0aW9uVVJMKHsgc3RhdGUsIHNjb3BlcywgbG9naW5IaW50LCByZWRpcmVjdFVSSSB9KSB7XG4gICAgICBjb25zdCBfc2NvcGVzID0gb3B0aW9ucy5kaXNhYmxlRGVmYXVsdFNjb3BlID8gW10gOiBbXCJyZWFkXCJdO1xuICAgICAgb3B0aW9ucy5zY29wZSAmJiBfc2NvcGVzLnB1c2goLi4ub3B0aW9ucy5zY29wZSk7XG4gICAgICBzY29wZXMgJiYgX3Njb3Blcy5wdXNoKC4uLnNjb3Blcyk7XG4gICAgICByZXR1cm4gY3JlYXRlQXV0aG9yaXphdGlvblVSTCh7XG4gICAgICAgIGlkOiBcImxpbmVhclwiLFxuICAgICAgICBvcHRpb25zLFxuICAgICAgICBhdXRob3JpemF0aW9uRW5kcG9pbnQ6IFwiaHR0cHM6Ly9saW5lYXIuYXBwL29hdXRoL2F1dGhvcml6ZVwiLFxuICAgICAgICBzY29wZXM6IF9zY29wZXMsXG4gICAgICAgIHN0YXRlLFxuICAgICAgICByZWRpcmVjdFVSSSxcbiAgICAgICAgbG9naW5IaW50XG4gICAgICB9KTtcbiAgICB9LFxuICAgIHZhbGlkYXRlQXV0aG9yaXphdGlvbkNvZGU6IGFzeW5jICh7IGNvZGUsIHJlZGlyZWN0VVJJIH0pID0+IHtcbiAgICAgIHJldHVybiB2YWxpZGF0ZUF1dGhvcml6YXRpb25Db2RlKHtcbiAgICAgICAgY29kZSxcbiAgICAgICAgcmVkaXJlY3RVUkksXG4gICAgICAgIG9wdGlvbnMsXG4gICAgICAgIHRva2VuRW5kcG9pbnRcbiAgICAgIH0pO1xuICAgIH0sXG4gICAgcmVmcmVzaEFjY2Vzc1Rva2VuOiBvcHRpb25zLnJlZnJlc2hBY2Nlc3NUb2tlbiA/IG9wdGlvbnMucmVmcmVzaEFjY2Vzc1Rva2VuIDogYXN5bmMgKHJlZnJlc2hUb2tlbikgPT4ge1xuICAgICAgcmV0dXJuIHJlZnJlc2hBY2Nlc3NUb2tlbih7XG4gICAgICAgIHJlZnJlc2hUb2tlbixcbiAgICAgICAgb3B0aW9uczoge1xuICAgICAgICAgIGNsaWVudElkOiBvcHRpb25zLmNsaWVudElkLFxuICAgICAgICAgIGNsaWVudEtleTogb3B0aW9ucy5jbGllbnRLZXksXG4gICAgICAgICAgY2xpZW50U2VjcmV0OiBvcHRpb25zLmNsaWVudFNlY3JldFxuICAgICAgICB9LFxuICAgICAgICB0b2tlbkVuZHBvaW50XG4gICAgICB9KTtcbiAgICB9LFxuICAgIGFzeW5jIGdldFVzZXJJbmZvKHRva2VuKSB7XG4gICAgICBpZiAob3B0aW9ucy5nZXRVc2VySW5mbykge1xuICAgICAgICByZXR1cm4gb3B0aW9ucy5nZXRVc2VySW5mbyh0b2tlbik7XG4gICAgICB9XG4gICAgICBjb25zdCB7IGRhdGE6IHByb2ZpbGUsIGVycm9yIH0gPSBhd2FpdCBiZXR0ZXJGZXRjaChcbiAgICAgICAgXCJodHRwczovL2FwaS5saW5lYXIuYXBwL2dyYXBocWxcIixcbiAgICAgICAge1xuICAgICAgICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIsXG4gICAgICAgICAgICBBdXRob3JpemF0aW9uOiBgQmVhcmVyICR7dG9rZW4uYWNjZXNzVG9rZW59YFxuICAgICAgICAgIH0sXG4gICAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICAgICAgcXVlcnk6IGBcblx0XHRcdFx0XHRcdFx0cXVlcnkge1xuXHRcdFx0XHRcdFx0XHRcdHZpZXdlciB7XG5cdFx0XHRcdFx0XHRcdFx0XHRpZFxuXHRcdFx0XHRcdFx0XHRcdFx0bmFtZVxuXHRcdFx0XHRcdFx0XHRcdFx0ZW1haWxcblx0XHRcdFx0XHRcdFx0XHRcdGF2YXRhclVybFxuXHRcdFx0XHRcdFx0XHRcdFx0YWN0aXZlXG5cdFx0XHRcdFx0XHRcdFx0XHRjcmVhdGVkQXRcblx0XHRcdFx0XHRcdFx0XHRcdHVwZGF0ZWRBdFxuXHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0YFxuICAgICAgICAgIH0pXG4gICAgICAgIH1cbiAgICAgICk7XG4gICAgICBpZiAoZXJyb3IgfHwgIXByb2ZpbGU/LmRhdGE/LnZpZXdlcikge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgIH1cbiAgICAgIGNvbnN0IHVzZXJEYXRhID0gcHJvZmlsZS5kYXRhLnZpZXdlcjtcbiAgICAgIGNvbnN0IHVzZXJNYXAgPSBhd2FpdCBvcHRpb25zLm1hcFByb2ZpbGVUb1VzZXI/Lih1c2VyRGF0YSk7XG4gICAgICByZXR1cm4ge1xuICAgICAgICB1c2VyOiB7XG4gICAgICAgICAgaWQ6IHByb2ZpbGUuZGF0YS52aWV3ZXIuaWQsXG4gICAgICAgICAgbmFtZTogcHJvZmlsZS5kYXRhLnZpZXdlci5uYW1lLFxuICAgICAgICAgIGVtYWlsOiBwcm9maWxlLmRhdGEudmlld2VyLmVtYWlsLFxuICAgICAgICAgIGltYWdlOiBwcm9maWxlLmRhdGEudmlld2VyLmF2YXRhclVybCxcbiAgICAgICAgICBlbWFpbFZlcmlmaWVkOiB0cnVlLFxuICAgICAgICAgIC4uLnVzZXJNYXBcbiAgICAgICAgfSxcbiAgICAgICAgZGF0YTogdXNlckRhdGFcbiAgICAgIH07XG4gICAgfSxcbiAgICBvcHRpb25zXG4gIH07XG59O1xuXG5jb25zdCBsaW5rZWRpbiA9IChvcHRpb25zKSA9PiB7XG4gIGNvbnN0IGF1dGhvcml6YXRpb25FbmRwb2ludCA9IFwiaHR0cHM6Ly93d3cubGlua2VkaW4uY29tL29hdXRoL3YyL2F1dGhvcml6YXRpb25cIjtcbiAgY29uc3QgdG9rZW5FbmRwb2ludCA9IFwiaHR0cHM6Ly93d3cubGlua2VkaW4uY29tL29hdXRoL3YyL2FjY2Vzc1Rva2VuXCI7XG4gIHJldHVybiB7XG4gICAgaWQ6IFwibGlua2VkaW5cIixcbiAgICBuYW1lOiBcIkxpbmtlZGluXCIsXG4gICAgY3JlYXRlQXV0aG9yaXphdGlvblVSTDogYXN5bmMgKHtcbiAgICAgIHN0YXRlLFxuICAgICAgc2NvcGVzLFxuICAgICAgcmVkaXJlY3RVUkksXG4gICAgICBsb2dpbkhpbnRcbiAgICB9KSA9PiB7XG4gICAgICBjb25zdCBfc2NvcGVzID0gb3B0aW9ucy5kaXNhYmxlRGVmYXVsdFNjb3BlID8gW10gOiBbXCJwcm9maWxlXCIsIFwiZW1haWxcIiwgXCJvcGVuaWRcIl07XG4gICAgICBvcHRpb25zLnNjb3BlICYmIF9zY29wZXMucHVzaCguLi5vcHRpb25zLnNjb3BlKTtcbiAgICAgIHNjb3BlcyAmJiBfc2NvcGVzLnB1c2goLi4uc2NvcGVzKTtcbiAgICAgIHJldHVybiBhd2FpdCBjcmVhdGVBdXRob3JpemF0aW9uVVJMKHtcbiAgICAgICAgaWQ6IFwibGlua2VkaW5cIixcbiAgICAgICAgb3B0aW9ucyxcbiAgICAgICAgYXV0aG9yaXphdGlvbkVuZHBvaW50LFxuICAgICAgICBzY29wZXM6IF9zY29wZXMsXG4gICAgICAgIHN0YXRlLFxuICAgICAgICBsb2dpbkhpbnQsXG4gICAgICAgIHJlZGlyZWN0VVJJXG4gICAgICB9KTtcbiAgICB9LFxuICAgIHZhbGlkYXRlQXV0aG9yaXphdGlvbkNvZGU6IGFzeW5jICh7IGNvZGUsIHJlZGlyZWN0VVJJIH0pID0+IHtcbiAgICAgIHJldHVybiBhd2FpdCB2YWxpZGF0ZUF1dGhvcml6YXRpb25Db2RlKHtcbiAgICAgICAgY29kZSxcbiAgICAgICAgcmVkaXJlY3RVUkksXG4gICAgICAgIG9wdGlvbnMsXG4gICAgICAgIHRva2VuRW5kcG9pbnRcbiAgICAgIH0pO1xuICAgIH0sXG4gICAgcmVmcmVzaEFjY2Vzc1Rva2VuOiBvcHRpb25zLnJlZnJlc2hBY2Nlc3NUb2tlbiA/IG9wdGlvbnMucmVmcmVzaEFjY2Vzc1Rva2VuIDogYXN5bmMgKHJlZnJlc2hUb2tlbikgPT4ge1xuICAgICAgcmV0dXJuIHJlZnJlc2hBY2Nlc3NUb2tlbih7XG4gICAgICAgIHJlZnJlc2hUb2tlbixcbiAgICAgICAgb3B0aW9uczoge1xuICAgICAgICAgIGNsaWVudElkOiBvcHRpb25zLmNsaWVudElkLFxuICAgICAgICAgIGNsaWVudEtleTogb3B0aW9ucy5jbGllbnRLZXksXG4gICAgICAgICAgY2xpZW50U2VjcmV0OiBvcHRpb25zLmNsaWVudFNlY3JldFxuICAgICAgICB9LFxuICAgICAgICB0b2tlbkVuZHBvaW50XG4gICAgICB9KTtcbiAgICB9LFxuICAgIGFzeW5jIGdldFVzZXJJbmZvKHRva2VuKSB7XG4gICAgICBpZiAob3B0aW9ucy5nZXRVc2VySW5mbykge1xuICAgICAgICByZXR1cm4gb3B0aW9ucy5nZXRVc2VySW5mbyh0b2tlbik7XG4gICAgICB9XG4gICAgICBjb25zdCB7IGRhdGE6IHByb2ZpbGUsIGVycm9yIH0gPSBhd2FpdCBiZXR0ZXJGZXRjaChcbiAgICAgICAgXCJodHRwczovL2FwaS5saW5rZWRpbi5jb20vdjIvdXNlcmluZm9cIixcbiAgICAgICAge1xuICAgICAgICAgIG1ldGhvZDogXCJHRVRcIixcbiAgICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgICBBdXRob3JpemF0aW9uOiBgQmVhcmVyICR7dG9rZW4uYWNjZXNzVG9rZW59YFxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgKTtcbiAgICAgIGlmIChlcnJvcikge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgIH1cbiAgICAgIGNvbnN0IHVzZXJNYXAgPSBhd2FpdCBvcHRpb25zLm1hcFByb2ZpbGVUb1VzZXI/Lihwcm9maWxlKTtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHVzZXI6IHtcbiAgICAgICAgICBpZDogcHJvZmlsZS5zdWIsXG4gICAgICAgICAgbmFtZTogcHJvZmlsZS5uYW1lLFxuICAgICAgICAgIGVtYWlsOiBwcm9maWxlLmVtYWlsLFxuICAgICAgICAgIGVtYWlsVmVyaWZpZWQ6IHByb2ZpbGUuZW1haWxfdmVyaWZpZWQgfHwgZmFsc2UsXG4gICAgICAgICAgaW1hZ2U6IHByb2ZpbGUucGljdHVyZSxcbiAgICAgICAgICAuLi51c2VyTWFwXG4gICAgICAgIH0sXG4gICAgICAgIGRhdGE6IHByb2ZpbGVcbiAgICAgIH07XG4gICAgfSxcbiAgICBvcHRpb25zXG4gIH07XG59O1xuXG5jb25zdCBjbGVhbkRvdWJsZVNsYXNoZXMgPSAoaW5wdXQgPSBcIlwiKSA9PiB7XG4gIHJldHVybiBpbnB1dC5zcGxpdChcIjovL1wiKS5tYXAoKHN0cikgPT4gc3RyLnJlcGxhY2UoL1xcL3syLH0vZywgXCIvXCIpKS5qb2luKFwiOi8vXCIpO1xufTtcbmNvbnN0IGlzc3VlclRvRW5kcG9pbnRzID0gKGlzc3VlcikgPT4ge1xuICBsZXQgYmFzZVVybCA9IGlzc3VlciB8fCBcImh0dHBzOi8vZ2l0bGFiLmNvbVwiO1xuICByZXR1cm4ge1xuICAgIGF1dGhvcml6YXRpb25FbmRwb2ludDogY2xlYW5Eb3VibGVTbGFzaGVzKGAke2Jhc2VVcmx9L29hdXRoL2F1dGhvcml6ZWApLFxuICAgIHRva2VuRW5kcG9pbnQ6IGNsZWFuRG91YmxlU2xhc2hlcyhgJHtiYXNlVXJsfS9vYXV0aC90b2tlbmApLFxuICAgIHVzZXJpbmZvRW5kcG9pbnQ6IGNsZWFuRG91YmxlU2xhc2hlcyhgJHtiYXNlVXJsfS9hcGkvdjQvdXNlcmApXG4gIH07XG59O1xuY29uc3QgZ2l0bGFiID0gKG9wdGlvbnMpID0+IHtcbiAgY29uc3QgeyBhdXRob3JpemF0aW9uRW5kcG9pbnQsIHRva2VuRW5kcG9pbnQsIHVzZXJpbmZvRW5kcG9pbnQgfSA9IGlzc3VlclRvRW5kcG9pbnRzKG9wdGlvbnMuaXNzdWVyKTtcbiAgY29uc3QgaXNzdWVySWQgPSBcImdpdGxhYlwiO1xuICBjb25zdCBpc3N1ZXJOYW1lID0gXCJHaXRsYWJcIjtcbiAgcmV0dXJuIHtcbiAgICBpZDogaXNzdWVySWQsXG4gICAgbmFtZTogaXNzdWVyTmFtZSxcbiAgICBjcmVhdGVBdXRob3JpemF0aW9uVVJMOiBhc3luYyAoe1xuICAgICAgc3RhdGUsXG4gICAgICBzY29wZXMsXG4gICAgICBjb2RlVmVyaWZpZXIsXG4gICAgICBsb2dpbkhpbnQsXG4gICAgICByZWRpcmVjdFVSSVxuICAgIH0pID0+IHtcbiAgICAgIGNvbnN0IF9zY29wZXMgPSBvcHRpb25zLmRpc2FibGVEZWZhdWx0U2NvcGUgPyBbXSA6IFtcInJlYWRfdXNlclwiXTtcbiAgICAgIG9wdGlvbnMuc2NvcGUgJiYgX3Njb3Blcy5wdXNoKC4uLm9wdGlvbnMuc2NvcGUpO1xuICAgICAgc2NvcGVzICYmIF9zY29wZXMucHVzaCguLi5zY29wZXMpO1xuICAgICAgcmV0dXJuIGF3YWl0IGNyZWF0ZUF1dGhvcml6YXRpb25VUkwoe1xuICAgICAgICBpZDogaXNzdWVySWQsXG4gICAgICAgIG9wdGlvbnMsXG4gICAgICAgIGF1dGhvcml6YXRpb25FbmRwb2ludCxcbiAgICAgICAgc2NvcGVzOiBfc2NvcGVzLFxuICAgICAgICBzdGF0ZSxcbiAgICAgICAgcmVkaXJlY3RVUkksXG4gICAgICAgIGNvZGVWZXJpZmllcixcbiAgICAgICAgbG9naW5IaW50XG4gICAgICB9KTtcbiAgICB9LFxuICAgIHZhbGlkYXRlQXV0aG9yaXphdGlvbkNvZGU6IGFzeW5jICh7IGNvZGUsIHJlZGlyZWN0VVJJLCBjb2RlVmVyaWZpZXIgfSkgPT4ge1xuICAgICAgcmV0dXJuIHZhbGlkYXRlQXV0aG9yaXphdGlvbkNvZGUoe1xuICAgICAgICBjb2RlLFxuICAgICAgICByZWRpcmVjdFVSSSxcbiAgICAgICAgb3B0aW9ucyxcbiAgICAgICAgY29kZVZlcmlmaWVyLFxuICAgICAgICB0b2tlbkVuZHBvaW50XG4gICAgICB9KTtcbiAgICB9LFxuICAgIHJlZnJlc2hBY2Nlc3NUb2tlbjogb3B0aW9ucy5yZWZyZXNoQWNjZXNzVG9rZW4gPyBvcHRpb25zLnJlZnJlc2hBY2Nlc3NUb2tlbiA6IGFzeW5jIChyZWZyZXNoVG9rZW4pID0+IHtcbiAgICAgIHJldHVybiByZWZyZXNoQWNjZXNzVG9rZW4oe1xuICAgICAgICByZWZyZXNoVG9rZW4sXG4gICAgICAgIG9wdGlvbnM6IHtcbiAgICAgICAgICBjbGllbnRJZDogb3B0aW9ucy5jbGllbnRJZCxcbiAgICAgICAgICBjbGllbnRLZXk6IG9wdGlvbnMuY2xpZW50S2V5LFxuICAgICAgICAgIGNsaWVudFNlY3JldDogb3B0aW9ucy5jbGllbnRTZWNyZXRcbiAgICAgICAgfSxcbiAgICAgICAgdG9rZW5FbmRwb2ludFxuICAgICAgfSk7XG4gICAgfSxcbiAgICBhc3luYyBnZXRVc2VySW5mbyh0b2tlbikge1xuICAgICAgaWYgKG9wdGlvbnMuZ2V0VXNlckluZm8pIHtcbiAgICAgICAgcmV0dXJuIG9wdGlvbnMuZ2V0VXNlckluZm8odG9rZW4pO1xuICAgICAgfVxuICAgICAgY29uc3QgeyBkYXRhOiBwcm9maWxlLCBlcnJvciB9ID0gYXdhaXQgYmV0dGVyRmV0Y2goXG4gICAgICAgIHVzZXJpbmZvRW5kcG9pbnQsXG4gICAgICAgIHsgaGVhZGVyczogeyBhdXRob3JpemF0aW9uOiBgQmVhcmVyICR7dG9rZW4uYWNjZXNzVG9rZW59YCB9IH1cbiAgICAgICk7XG4gICAgICBpZiAoZXJyb3IgfHwgcHJvZmlsZS5zdGF0ZSAhPT0gXCJhY3RpdmVcIiB8fCBwcm9maWxlLmxvY2tlZCkge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgIH1cbiAgICAgIGNvbnN0IHVzZXJNYXAgPSBhd2FpdCBvcHRpb25zLm1hcFByb2ZpbGVUb1VzZXI/Lihwcm9maWxlKTtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHVzZXI6IHtcbiAgICAgICAgICBpZDogcHJvZmlsZS5pZCxcbiAgICAgICAgICBuYW1lOiBwcm9maWxlLm5hbWUgPz8gcHJvZmlsZS51c2VybmFtZSxcbiAgICAgICAgICBlbWFpbDogcHJvZmlsZS5lbWFpbCxcbiAgICAgICAgICBpbWFnZTogcHJvZmlsZS5hdmF0YXJfdXJsLFxuICAgICAgICAgIGVtYWlsVmVyaWZpZWQ6IHRydWUsXG4gICAgICAgICAgLi4udXNlck1hcFxuICAgICAgICB9LFxuICAgICAgICBkYXRhOiBwcm9maWxlXG4gICAgICB9O1xuICAgIH0sXG4gICAgb3B0aW9uc1xuICB9O1xufTtcblxuY29uc3QgdGlrdG9rID0gKG9wdGlvbnMpID0+IHtcbiAgcmV0dXJuIHtcbiAgICBpZDogXCJ0aWt0b2tcIixcbiAgICBuYW1lOiBcIlRpa1Rva1wiLFxuICAgIGNyZWF0ZUF1dGhvcml6YXRpb25VUkwoeyBzdGF0ZSwgc2NvcGVzLCByZWRpcmVjdFVSSSB9KSB7XG4gICAgICBjb25zdCBfc2NvcGVzID0gb3B0aW9ucy5kaXNhYmxlRGVmYXVsdFNjb3BlID8gW10gOiBbXCJ1c2VyLmluZm8ucHJvZmlsZVwiXTtcbiAgICAgIG9wdGlvbnMuc2NvcGUgJiYgX3Njb3Blcy5wdXNoKC4uLm9wdGlvbnMuc2NvcGUpO1xuICAgICAgc2NvcGVzICYmIF9zY29wZXMucHVzaCguLi5zY29wZXMpO1xuICAgICAgcmV0dXJuIG5ldyBVUkwoXG4gICAgICAgIGBodHRwczovL3d3dy50aWt0b2suY29tL3YyL2F1dGgvYXV0aG9yaXplP3Njb3BlPSR7X3Njb3Blcy5qb2luKFxuICAgICAgICAgIFwiLFwiXG4gICAgICAgICl9JnJlc3BvbnNlX3R5cGU9Y29kZSZjbGllbnRfa2V5PSR7b3B0aW9ucy5jbGllbnRLZXl9JnJlZGlyZWN0X3VyaT0ke2VuY29kZVVSSUNvbXBvbmVudChcbiAgICAgICAgICBvcHRpb25zLnJlZGlyZWN0VVJJIHx8IHJlZGlyZWN0VVJJXG4gICAgICAgICl9JnN0YXRlPSR7c3RhdGV9YFxuICAgICAgKTtcbiAgICB9LFxuICAgIHZhbGlkYXRlQXV0aG9yaXphdGlvbkNvZGU6IGFzeW5jICh7IGNvZGUsIHJlZGlyZWN0VVJJIH0pID0+IHtcbiAgICAgIHJldHVybiB2YWxpZGF0ZUF1dGhvcml6YXRpb25Db2RlKHtcbiAgICAgICAgY29kZSxcbiAgICAgICAgcmVkaXJlY3RVUkk6IG9wdGlvbnMucmVkaXJlY3RVUkkgfHwgcmVkaXJlY3RVUkksXG4gICAgICAgIG9wdGlvbnM6IHtcbiAgICAgICAgICBjbGllbnRLZXk6IG9wdGlvbnMuY2xpZW50S2V5LFxuICAgICAgICAgIGNsaWVudFNlY3JldDogb3B0aW9ucy5jbGllbnRTZWNyZXRcbiAgICAgICAgfSxcbiAgICAgICAgdG9rZW5FbmRwb2ludDogXCJodHRwczovL29wZW4udGlrdG9rYXBpcy5jb20vdjIvb2F1dGgvdG9rZW4vXCJcbiAgICAgIH0pO1xuICAgIH0sXG4gICAgcmVmcmVzaEFjY2Vzc1Rva2VuOiBvcHRpb25zLnJlZnJlc2hBY2Nlc3NUb2tlbiA/IG9wdGlvbnMucmVmcmVzaEFjY2Vzc1Rva2VuIDogYXN5bmMgKHJlZnJlc2hUb2tlbikgPT4ge1xuICAgICAgcmV0dXJuIHJlZnJlc2hBY2Nlc3NUb2tlbih7XG4gICAgICAgIHJlZnJlc2hUb2tlbixcbiAgICAgICAgb3B0aW9uczoge1xuICAgICAgICAgIGNsaWVudFNlY3JldDogb3B0aW9ucy5jbGllbnRTZWNyZXRcbiAgICAgICAgfSxcbiAgICAgICAgdG9rZW5FbmRwb2ludDogXCJodHRwczovL29wZW4udGlrdG9rYXBpcy5jb20vdjIvb2F1dGgvdG9rZW4vXCIsXG4gICAgICAgIGF1dGhlbnRpY2F0aW9uOiBcInBvc3RcIixcbiAgICAgICAgZXh0cmFQYXJhbXM6IHtcbiAgICAgICAgICBjbGllbnRfa2V5OiBvcHRpb25zLmNsaWVudEtleVxuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9LFxuICAgIGFzeW5jIGdldFVzZXJJbmZvKHRva2VuKSB7XG4gICAgICBpZiAob3B0aW9ucy5nZXRVc2VySW5mbykge1xuICAgICAgICByZXR1cm4gb3B0aW9ucy5nZXRVc2VySW5mbyh0b2tlbik7XG4gICAgICB9XG4gICAgICBjb25zdCBmaWVsZHMgPSBbXG4gICAgICAgIFwib3Blbl9pZFwiLFxuICAgICAgICBcImF2YXRhcl9sYXJnZV91cmxcIixcbiAgICAgICAgXCJkaXNwbGF5X25hbWVcIixcbiAgICAgICAgXCJ1c2VybmFtZVwiXG4gICAgICBdO1xuICAgICAgY29uc3QgeyBkYXRhOiBwcm9maWxlLCBlcnJvciB9ID0gYXdhaXQgYmV0dGVyRmV0Y2goXG4gICAgICAgIGBodHRwczovL29wZW4udGlrdG9rYXBpcy5jb20vdjIvdXNlci9pbmZvLz9maWVsZHM9JHtmaWVsZHMuam9pbihcIixcIil9YCxcbiAgICAgICAge1xuICAgICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAgIGF1dGhvcml6YXRpb246IGBCZWFyZXIgJHt0b2tlbi5hY2Nlc3NUb2tlbn1gXG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICApO1xuICAgICAgaWYgKGVycm9yKSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgdXNlcjoge1xuICAgICAgICAgIGVtYWlsOiBwcm9maWxlLmRhdGEudXNlci5lbWFpbCB8fCBwcm9maWxlLmRhdGEudXNlci51c2VybmFtZSxcbiAgICAgICAgICBpZDogcHJvZmlsZS5kYXRhLnVzZXIub3Blbl9pZCxcbiAgICAgICAgICBuYW1lOiBwcm9maWxlLmRhdGEudXNlci5kaXNwbGF5X25hbWUgfHwgcHJvZmlsZS5kYXRhLnVzZXIudXNlcm5hbWUsXG4gICAgICAgICAgaW1hZ2U6IHByb2ZpbGUuZGF0YS51c2VyLmF2YXRhcl9sYXJnZV91cmwsXG4gICAgICAgICAgLyoqIEBub3RlIFRpa3RvayBkb2VzIG5vdCBwcm92aWRlIGVtYWlsVmVyaWZpZWQgb3IgZXZlbiBlbWFpbCovXG4gICAgICAgICAgZW1haWxWZXJpZmllZDogcHJvZmlsZS5kYXRhLnVzZXIuZW1haWwgPyB0cnVlIDogZmFsc2VcbiAgICAgICAgfSxcbiAgICAgICAgZGF0YTogcHJvZmlsZVxuICAgICAgfTtcbiAgICB9LFxuICAgIG9wdGlvbnNcbiAgfTtcbn07XG5cbmNvbnN0IHJlZGRpdCA9IChvcHRpb25zKSA9PiB7XG4gIHJldHVybiB7XG4gICAgaWQ6IFwicmVkZGl0XCIsXG4gICAgbmFtZTogXCJSZWRkaXRcIixcbiAgICBjcmVhdGVBdXRob3JpemF0aW9uVVJMKHsgc3RhdGUsIHNjb3BlcywgcmVkaXJlY3RVUkkgfSkge1xuICAgICAgY29uc3QgX3Njb3BlcyA9IG9wdGlvbnMuZGlzYWJsZURlZmF1bHRTY29wZSA/IFtdIDogW1wiaWRlbnRpdHlcIl07XG4gICAgICBvcHRpb25zLnNjb3BlICYmIF9zY29wZXMucHVzaCguLi5vcHRpb25zLnNjb3BlKTtcbiAgICAgIHNjb3BlcyAmJiBfc2NvcGVzLnB1c2goLi4uc2NvcGVzKTtcbiAgICAgIHJldHVybiBjcmVhdGVBdXRob3JpemF0aW9uVVJMKHtcbiAgICAgICAgaWQ6IFwicmVkZGl0XCIsXG4gICAgICAgIG9wdGlvbnMsXG4gICAgICAgIGF1dGhvcml6YXRpb25FbmRwb2ludDogXCJodHRwczovL3d3dy5yZWRkaXQuY29tL2FwaS92MS9hdXRob3JpemVcIixcbiAgICAgICAgc2NvcGVzOiBfc2NvcGVzLFxuICAgICAgICBzdGF0ZSxcbiAgICAgICAgcmVkaXJlY3RVUkksXG4gICAgICAgIGR1cmF0aW9uOiBvcHRpb25zLmR1cmF0aW9uXG4gICAgICB9KTtcbiAgICB9LFxuICAgIHZhbGlkYXRlQXV0aG9yaXphdGlvbkNvZGU6IGFzeW5jICh7IGNvZGUsIHJlZGlyZWN0VVJJIH0pID0+IHtcbiAgICAgIGNvbnN0IGJvZHkgPSBuZXcgVVJMU2VhcmNoUGFyYW1zKHtcbiAgICAgICAgZ3JhbnRfdHlwZTogXCJhdXRob3JpemF0aW9uX2NvZGVcIixcbiAgICAgICAgY29kZSxcbiAgICAgICAgcmVkaXJlY3RfdXJpOiBvcHRpb25zLnJlZGlyZWN0VVJJIHx8IHJlZGlyZWN0VVJJXG4gICAgICB9KTtcbiAgICAgIGNvbnN0IGhlYWRlcnMgPSB7XG4gICAgICAgIFwiY29udGVudC10eXBlXCI6IFwiYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkXCIsXG4gICAgICAgIGFjY2VwdDogXCJ0ZXh0L3BsYWluXCIsXG4gICAgICAgIFwidXNlci1hZ2VudFwiOiBcImJldHRlci1hdXRoXCIsXG4gICAgICAgIEF1dGhvcml6YXRpb246IGBCYXNpYyAke2Jhc2U2NC5lbmNvZGUoXG4gICAgICAgICAgYCR7b3B0aW9ucy5jbGllbnRJZH06JHtvcHRpb25zLmNsaWVudFNlY3JldH1gXG4gICAgICAgICl9YFxuICAgICAgfTtcbiAgICAgIGNvbnN0IHsgZGF0YSwgZXJyb3IgfSA9IGF3YWl0IGJldHRlckZldGNoKFxuICAgICAgICBcImh0dHBzOi8vd3d3LnJlZGRpdC5jb20vYXBpL3YxL2FjY2Vzc190b2tlblwiLFxuICAgICAgICB7XG4gICAgICAgICAgbWV0aG9kOiBcIlBPU1RcIixcbiAgICAgICAgICBoZWFkZXJzLFxuICAgICAgICAgIGJvZHk6IGJvZHkudG9TdHJpbmcoKVxuICAgICAgICB9XG4gICAgICApO1xuICAgICAgaWYgKGVycm9yKSB7XG4gICAgICAgIHRocm93IGVycm9yO1xuICAgICAgfVxuICAgICAgcmV0dXJuIGdldE9BdXRoMlRva2VucyhkYXRhKTtcbiAgICB9LFxuICAgIHJlZnJlc2hBY2Nlc3NUb2tlbjogb3B0aW9ucy5yZWZyZXNoQWNjZXNzVG9rZW4gPyBvcHRpb25zLnJlZnJlc2hBY2Nlc3NUb2tlbiA6IGFzeW5jIChyZWZyZXNoVG9rZW4pID0+IHtcbiAgICAgIHJldHVybiByZWZyZXNoQWNjZXNzVG9rZW4oe1xuICAgICAgICByZWZyZXNoVG9rZW4sXG4gICAgICAgIG9wdGlvbnM6IHtcbiAgICAgICAgICBjbGllbnRJZDogb3B0aW9ucy5jbGllbnRJZCxcbiAgICAgICAgICBjbGllbnRLZXk6IG9wdGlvbnMuY2xpZW50S2V5LFxuICAgICAgICAgIGNsaWVudFNlY3JldDogb3B0aW9ucy5jbGllbnRTZWNyZXRcbiAgICAgICAgfSxcbiAgICAgICAgYXV0aGVudGljYXRpb246IFwiYmFzaWNcIixcbiAgICAgICAgdG9rZW5FbmRwb2ludDogXCJodHRwczovL3d3dy5yZWRkaXQuY29tL2FwaS92MS9hY2Nlc3NfdG9rZW5cIlxuICAgICAgfSk7XG4gICAgfSxcbiAgICBhc3luYyBnZXRVc2VySW5mbyh0b2tlbikge1xuICAgICAgaWYgKG9wdGlvbnMuZ2V0VXNlckluZm8pIHtcbiAgICAgICAgcmV0dXJuIG9wdGlvbnMuZ2V0VXNlckluZm8odG9rZW4pO1xuICAgICAgfVxuICAgICAgY29uc3QgeyBkYXRhOiBwcm9maWxlLCBlcnJvciB9ID0gYXdhaXQgYmV0dGVyRmV0Y2goXG4gICAgICAgIFwiaHR0cHM6Ly9vYXV0aC5yZWRkaXQuY29tL2FwaS92MS9tZVwiLFxuICAgICAgICB7XG4gICAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICAgQXV0aG9yaXphdGlvbjogYEJlYXJlciAke3Rva2VuLmFjY2Vzc1Rva2VufWAsXG4gICAgICAgICAgICBcIlVzZXItQWdlbnRcIjogXCJiZXR0ZXItYXV0aFwiXG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICApO1xuICAgICAgaWYgKGVycm9yKSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgICAgfVxuICAgICAgY29uc3QgdXNlck1hcCA9IGF3YWl0IG9wdGlvbnMubWFwUHJvZmlsZVRvVXNlcj8uKHByb2ZpbGUpO1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgdXNlcjoge1xuICAgICAgICAgIGlkOiBwcm9maWxlLmlkLFxuICAgICAgICAgIG5hbWU6IHByb2ZpbGUubmFtZSxcbiAgICAgICAgICBlbWFpbDogcHJvZmlsZS5vYXV0aF9jbGllbnRfaWQsXG4gICAgICAgICAgZW1haWxWZXJpZmllZDogcHJvZmlsZS5oYXNfdmVyaWZpZWRfZW1haWwsXG4gICAgICAgICAgaW1hZ2U6IHByb2ZpbGUuaWNvbl9pbWc/LnNwbGl0KFwiP1wiKVswXSxcbiAgICAgICAgICAuLi51c2VyTWFwXG4gICAgICAgIH0sXG4gICAgICAgIGRhdGE6IHByb2ZpbGVcbiAgICAgIH07XG4gICAgfSxcbiAgICBvcHRpb25zXG4gIH07XG59O1xuXG5jb25zdCByb2Jsb3ggPSAob3B0aW9ucykgPT4ge1xuICByZXR1cm4ge1xuICAgIGlkOiBcInJvYmxveFwiLFxuICAgIG5hbWU6IFwiUm9ibG94XCIsXG4gICAgY3JlYXRlQXV0aG9yaXphdGlvblVSTCh7IHN0YXRlLCBzY29wZXMsIHJlZGlyZWN0VVJJIH0pIHtcbiAgICAgIGNvbnN0IF9zY29wZXMgPSBvcHRpb25zLmRpc2FibGVEZWZhdWx0U2NvcGUgPyBbXSA6IFtcIm9wZW5pZFwiLCBcInByb2ZpbGVcIl07XG4gICAgICBvcHRpb25zLnNjb3BlICYmIF9zY29wZXMucHVzaCguLi5vcHRpb25zLnNjb3BlKTtcbiAgICAgIHNjb3BlcyAmJiBfc2NvcGVzLnB1c2goLi4uc2NvcGVzKTtcbiAgICAgIHJldHVybiBuZXcgVVJMKFxuICAgICAgICBgaHR0cHM6Ly9hcGlzLnJvYmxveC5jb20vb2F1dGgvdjEvYXV0aG9yaXplP3Njb3BlPSR7X3Njb3Blcy5qb2luKFxuICAgICAgICAgIFwiK1wiXG4gICAgICAgICl9JnJlc3BvbnNlX3R5cGU9Y29kZSZjbGllbnRfaWQ9JHtvcHRpb25zLmNsaWVudElkfSZyZWRpcmVjdF91cmk9JHtlbmNvZGVVUklDb21wb25lbnQoXG4gICAgICAgICAgb3B0aW9ucy5yZWRpcmVjdFVSSSB8fCByZWRpcmVjdFVSSVxuICAgICAgICApfSZzdGF0ZT0ke3N0YXRlfSZwcm9tcHQ9JHtvcHRpb25zLnByb21wdCB8fCBcInNlbGVjdF9hY2NvdW50IGNvbnNlbnRcIn1gXG4gICAgICApO1xuICAgIH0sXG4gICAgdmFsaWRhdGVBdXRob3JpemF0aW9uQ29kZTogYXN5bmMgKHsgY29kZSwgcmVkaXJlY3RVUkkgfSkgPT4ge1xuICAgICAgcmV0dXJuIHZhbGlkYXRlQXV0aG9yaXphdGlvbkNvZGUoe1xuICAgICAgICBjb2RlLFxuICAgICAgICByZWRpcmVjdFVSSTogb3B0aW9ucy5yZWRpcmVjdFVSSSB8fCByZWRpcmVjdFVSSSxcbiAgICAgICAgb3B0aW9ucyxcbiAgICAgICAgdG9rZW5FbmRwb2ludDogXCJodHRwczovL2FwaXMucm9ibG94LmNvbS9vYXV0aC92MS90b2tlblwiLFxuICAgICAgICBhdXRoZW50aWNhdGlvbjogXCJwb3N0XCJcbiAgICAgIH0pO1xuICAgIH0sXG4gICAgcmVmcmVzaEFjY2Vzc1Rva2VuOiBvcHRpb25zLnJlZnJlc2hBY2Nlc3NUb2tlbiA/IG9wdGlvbnMucmVmcmVzaEFjY2Vzc1Rva2VuIDogYXN5bmMgKHJlZnJlc2hUb2tlbikgPT4ge1xuICAgICAgcmV0dXJuIHJlZnJlc2hBY2Nlc3NUb2tlbih7XG4gICAgICAgIHJlZnJlc2hUb2tlbixcbiAgICAgICAgb3B0aW9uczoge1xuICAgICAgICAgIGNsaWVudElkOiBvcHRpb25zLmNsaWVudElkLFxuICAgICAgICAgIGNsaWVudEtleTogb3B0aW9ucy5jbGllbnRLZXksXG4gICAgICAgICAgY2xpZW50U2VjcmV0OiBvcHRpb25zLmNsaWVudFNlY3JldFxuICAgICAgICB9LFxuICAgICAgICB0b2tlbkVuZHBvaW50OiBcImh0dHBzOi8vYXBpcy5yb2Jsb3guY29tL29hdXRoL3YxL3Rva2VuXCJcbiAgICAgIH0pO1xuICAgIH0sXG4gICAgYXN5bmMgZ2V0VXNlckluZm8odG9rZW4pIHtcbiAgICAgIGlmIChvcHRpb25zLmdldFVzZXJJbmZvKSB7XG4gICAgICAgIHJldHVybiBvcHRpb25zLmdldFVzZXJJbmZvKHRva2VuKTtcbiAgICAgIH1cbiAgICAgIGNvbnN0IHsgZGF0YTogcHJvZmlsZSwgZXJyb3IgfSA9IGF3YWl0IGJldHRlckZldGNoKFxuICAgICAgICBcImh0dHBzOi8vYXBpcy5yb2Jsb3guY29tL29hdXRoL3YxL3VzZXJpbmZvXCIsXG4gICAgICAgIHtcbiAgICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgICBhdXRob3JpemF0aW9uOiBgQmVhcmVyICR7dG9rZW4uYWNjZXNzVG9rZW59YFxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgKTtcbiAgICAgIGlmIChlcnJvcikge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgIH1cbiAgICAgIGNvbnN0IHVzZXJNYXAgPSBhd2FpdCBvcHRpb25zLm1hcFByb2ZpbGVUb1VzZXI/Lihwcm9maWxlKTtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHVzZXI6IHtcbiAgICAgICAgICBpZDogcHJvZmlsZS5zdWIsXG4gICAgICAgICAgbmFtZTogcHJvZmlsZS5uaWNrbmFtZSB8fCBwcm9maWxlLnByZWZlcnJlZF91c2VybmFtZSB8fCBcIlwiLFxuICAgICAgICAgIGltYWdlOiBwcm9maWxlLnBpY3R1cmUsXG4gICAgICAgICAgZW1haWw6IHByb2ZpbGUucHJlZmVycmVkX3VzZXJuYW1lIHx8IG51bGwsXG4gICAgICAgICAgLy8gUm9ibG94IGRvZXMgbm90IHByb3ZpZGUgZW1haWxcbiAgICAgICAgICBlbWFpbFZlcmlmaWVkOiB0cnVlLFxuICAgICAgICAgIC4uLnVzZXJNYXBcbiAgICAgICAgfSxcbiAgICAgICAgZGF0YToge1xuICAgICAgICAgIC4uLnByb2ZpbGVcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICB9LFxuICAgIG9wdGlvbnNcbiAgfTtcbn07XG5cbmNvbnN0IHNhbGVzZm9yY2UgPSAob3B0aW9ucykgPT4ge1xuICBjb25zdCBlbnZpcm9ubWVudCA9IG9wdGlvbnMuZW52aXJvbm1lbnQgPz8gXCJwcm9kdWN0aW9uXCI7XG4gIGNvbnN0IGlzU2FuZGJveCA9IGVudmlyb25tZW50ID09PSBcInNhbmRib3hcIjtcbiAgY29uc3QgYXV0aG9yaXphdGlvbkVuZHBvaW50ID0gb3B0aW9ucy5sb2dpblVybCA/IGBodHRwczovLyR7b3B0aW9ucy5sb2dpblVybH0vc2VydmljZXMvb2F1dGgyL2F1dGhvcml6ZWAgOiBpc1NhbmRib3ggPyBcImh0dHBzOi8vdGVzdC5zYWxlc2ZvcmNlLmNvbS9zZXJ2aWNlcy9vYXV0aDIvYXV0aG9yaXplXCIgOiBcImh0dHBzOi8vbG9naW4uc2FsZXNmb3JjZS5jb20vc2VydmljZXMvb2F1dGgyL2F1dGhvcml6ZVwiO1xuICBjb25zdCB0b2tlbkVuZHBvaW50ID0gb3B0aW9ucy5sb2dpblVybCA/IGBodHRwczovLyR7b3B0aW9ucy5sb2dpblVybH0vc2VydmljZXMvb2F1dGgyL3Rva2VuYCA6IGlzU2FuZGJveCA/IFwiaHR0cHM6Ly90ZXN0LnNhbGVzZm9yY2UuY29tL3NlcnZpY2VzL29hdXRoMi90b2tlblwiIDogXCJodHRwczovL2xvZ2luLnNhbGVzZm9yY2UuY29tL3NlcnZpY2VzL29hdXRoMi90b2tlblwiO1xuICBjb25zdCB1c2VySW5mb0VuZHBvaW50ID0gb3B0aW9ucy5sb2dpblVybCA/IGBodHRwczovLyR7b3B0aW9ucy5sb2dpblVybH0vc2VydmljZXMvb2F1dGgyL3VzZXJpbmZvYCA6IGlzU2FuZGJveCA/IFwiaHR0cHM6Ly90ZXN0LnNhbGVzZm9yY2UuY29tL3NlcnZpY2VzL29hdXRoMi91c2VyaW5mb1wiIDogXCJodHRwczovL2xvZ2luLnNhbGVzZm9yY2UuY29tL3NlcnZpY2VzL29hdXRoMi91c2VyaW5mb1wiO1xuICByZXR1cm4ge1xuICAgIGlkOiBcInNhbGVzZm9yY2VcIixcbiAgICBuYW1lOiBcIlNhbGVzZm9yY2VcIixcbiAgICBhc3luYyBjcmVhdGVBdXRob3JpemF0aW9uVVJMKHsgc3RhdGUsIHNjb3BlcywgY29kZVZlcmlmaWVyLCByZWRpcmVjdFVSSSB9KSB7XG4gICAgICBpZiAoIW9wdGlvbnMuY2xpZW50SWQgfHwgIW9wdGlvbnMuY2xpZW50U2VjcmV0KSB7XG4gICAgICAgIGxvZ2dlci5lcnJvcihcbiAgICAgICAgICBcIkNsaWVudCBJZCBhbmQgQ2xpZW50IFNlY3JldCBhcmUgcmVxdWlyZWQgZm9yIFNhbGVzZm9yY2UuIE1ha2Ugc3VyZSB0byBwcm92aWRlIHRoZW0gaW4gdGhlIG9wdGlvbnMuXCJcbiAgICAgICAgKTtcbiAgICAgICAgdGhyb3cgbmV3IEJldHRlckF1dGhFcnJvcihcIkNMSUVOVF9JRF9BTkRfU0VDUkVUX1JFUVVJUkVEXCIpO1xuICAgICAgfVxuICAgICAgaWYgKCFjb2RlVmVyaWZpZXIpIHtcbiAgICAgICAgdGhyb3cgbmV3IEJldHRlckF1dGhFcnJvcihcImNvZGVWZXJpZmllciBpcyByZXF1aXJlZCBmb3IgU2FsZXNmb3JjZVwiKTtcbiAgICAgIH1cbiAgICAgIGNvbnN0IF9zY29wZXMgPSBvcHRpb25zLmRpc2FibGVEZWZhdWx0U2NvcGUgPyBbXSA6IFtcIm9wZW5pZFwiLCBcImVtYWlsXCIsIFwicHJvZmlsZVwiXTtcbiAgICAgIG9wdGlvbnMuc2NvcGUgJiYgX3Njb3Blcy5wdXNoKC4uLm9wdGlvbnMuc2NvcGUpO1xuICAgICAgc2NvcGVzICYmIF9zY29wZXMucHVzaCguLi5zY29wZXMpO1xuICAgICAgcmV0dXJuIGNyZWF0ZUF1dGhvcml6YXRpb25VUkwoe1xuICAgICAgICBpZDogXCJzYWxlc2ZvcmNlXCIsXG4gICAgICAgIG9wdGlvbnMsXG4gICAgICAgIGF1dGhvcml6YXRpb25FbmRwb2ludCxcbiAgICAgICAgc2NvcGVzOiBfc2NvcGVzLFxuICAgICAgICBzdGF0ZSxcbiAgICAgICAgY29kZVZlcmlmaWVyLFxuICAgICAgICByZWRpcmVjdFVSSTogb3B0aW9ucy5yZWRpcmVjdFVSSSB8fCByZWRpcmVjdFVSSVxuICAgICAgfSk7XG4gICAgfSxcbiAgICB2YWxpZGF0ZUF1dGhvcml6YXRpb25Db2RlOiBhc3luYyAoeyBjb2RlLCBjb2RlVmVyaWZpZXIsIHJlZGlyZWN0VVJJIH0pID0+IHtcbiAgICAgIHJldHVybiB2YWxpZGF0ZUF1dGhvcml6YXRpb25Db2RlKHtcbiAgICAgICAgY29kZSxcbiAgICAgICAgY29kZVZlcmlmaWVyLFxuICAgICAgICByZWRpcmVjdFVSSTogb3B0aW9ucy5yZWRpcmVjdFVSSSB8fCByZWRpcmVjdFVSSSxcbiAgICAgICAgb3B0aW9ucyxcbiAgICAgICAgdG9rZW5FbmRwb2ludFxuICAgICAgfSk7XG4gICAgfSxcbiAgICByZWZyZXNoQWNjZXNzVG9rZW46IG9wdGlvbnMucmVmcmVzaEFjY2Vzc1Rva2VuID8gb3B0aW9ucy5yZWZyZXNoQWNjZXNzVG9rZW4gOiBhc3luYyAocmVmcmVzaFRva2VuKSA9PiB7XG4gICAgICByZXR1cm4gcmVmcmVzaEFjY2Vzc1Rva2VuKHtcbiAgICAgICAgcmVmcmVzaFRva2VuLFxuICAgICAgICBvcHRpb25zOiB7XG4gICAgICAgICAgY2xpZW50SWQ6IG9wdGlvbnMuY2xpZW50SWQsXG4gICAgICAgICAgY2xpZW50U2VjcmV0OiBvcHRpb25zLmNsaWVudFNlY3JldFxuICAgICAgICB9LFxuICAgICAgICB0b2tlbkVuZHBvaW50XG4gICAgICB9KTtcbiAgICB9LFxuICAgIGFzeW5jIGdldFVzZXJJbmZvKHRva2VuKSB7XG4gICAgICBpZiAob3B0aW9ucy5nZXRVc2VySW5mbykge1xuICAgICAgICByZXR1cm4gb3B0aW9ucy5nZXRVc2VySW5mbyh0b2tlbik7XG4gICAgICB9XG4gICAgICB0cnkge1xuICAgICAgICBjb25zdCB7IGRhdGE6IHVzZXIgfSA9IGF3YWl0IGJldHRlckZldGNoKFxuICAgICAgICAgIHVzZXJJbmZvRW5kcG9pbnQsXG4gICAgICAgICAge1xuICAgICAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICAgICBBdXRob3JpemF0aW9uOiBgQmVhcmVyICR7dG9rZW4uYWNjZXNzVG9rZW59YFxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgKTtcbiAgICAgICAgaWYgKCF1c2VyKSB7XG4gICAgICAgICAgbG9nZ2VyLmVycm9yKFwiRmFpbGVkIHRvIGZldGNoIHVzZXIgaW5mbyBmcm9tIFNhbGVzZm9yY2VcIik7XG4gICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgdXNlck1hcCA9IGF3YWl0IG9wdGlvbnMubWFwUHJvZmlsZVRvVXNlcj8uKHVzZXIpO1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIHVzZXI6IHtcbiAgICAgICAgICAgIGlkOiB1c2VyLnVzZXJfaWQsXG4gICAgICAgICAgICBuYW1lOiB1c2VyLm5hbWUsXG4gICAgICAgICAgICBlbWFpbDogdXNlci5lbWFpbCxcbiAgICAgICAgICAgIGltYWdlOiB1c2VyLnBob3Rvcz8ucGljdHVyZSB8fCB1c2VyLnBob3Rvcz8udGh1bWJuYWlsLFxuICAgICAgICAgICAgZW1haWxWZXJpZmllZDogdXNlci5lbWFpbF92ZXJpZmllZCA/PyBmYWxzZSxcbiAgICAgICAgICAgIC4uLnVzZXJNYXBcbiAgICAgICAgICB9LFxuICAgICAgICAgIGRhdGE6IHVzZXJcbiAgICAgICAgfTtcbiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIGxvZ2dlci5lcnJvcihcIkZhaWxlZCB0byBmZXRjaCB1c2VyIGluZm8gZnJvbSBTYWxlc2ZvcmNlOlwiLCBlcnJvcik7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgICAgfVxuICAgIH0sXG4gICAgb3B0aW9uc1xuICB9O1xufTtcblxuY29uc3QgdmsgPSAob3B0aW9ucykgPT4ge1xuICByZXR1cm4ge1xuICAgIGlkOiBcInZrXCIsXG4gICAgbmFtZTogXCJWS1wiLFxuICAgIGFzeW5jIGNyZWF0ZUF1dGhvcml6YXRpb25VUkwoeyBzdGF0ZSwgc2NvcGVzLCBjb2RlVmVyaWZpZXIsIHJlZGlyZWN0VVJJIH0pIHtcbiAgICAgIGNvbnN0IF9zY29wZXMgPSBvcHRpb25zLmRpc2FibGVEZWZhdWx0U2NvcGUgPyBbXSA6IFtcImVtYWlsXCIsIFwicGhvbmVcIl07XG4gICAgICBvcHRpb25zLnNjb3BlICYmIF9zY29wZXMucHVzaCguLi5vcHRpb25zLnNjb3BlKTtcbiAgICAgIHNjb3BlcyAmJiBfc2NvcGVzLnB1c2goLi4uc2NvcGVzKTtcbiAgICAgIGNvbnN0IGF1dGhvcml6YXRpb25FbmRwb2ludCA9IFwiaHR0cHM6Ly9pZC52ay5jb20vYXV0aG9yaXplXCI7XG4gICAgICByZXR1cm4gY3JlYXRlQXV0aG9yaXphdGlvblVSTCh7XG4gICAgICAgIGlkOiBcInZrXCIsXG4gICAgICAgIG9wdGlvbnMsXG4gICAgICAgIGF1dGhvcml6YXRpb25FbmRwb2ludCxcbiAgICAgICAgc2NvcGVzOiBfc2NvcGVzLFxuICAgICAgICBzdGF0ZSxcbiAgICAgICAgcmVkaXJlY3RVUkksXG4gICAgICAgIGNvZGVWZXJpZmllclxuICAgICAgfSk7XG4gICAgfSxcbiAgICB2YWxpZGF0ZUF1dGhvcml6YXRpb25Db2RlOiBhc3luYyAoe1xuICAgICAgY29kZSxcbiAgICAgIGNvZGVWZXJpZmllcixcbiAgICAgIHJlZGlyZWN0VVJJLFxuICAgICAgZGV2aWNlSWRcbiAgICB9KSA9PiB7XG4gICAgICByZXR1cm4gdmFsaWRhdGVBdXRob3JpemF0aW9uQ29kZSh7XG4gICAgICAgIGNvZGUsXG4gICAgICAgIGNvZGVWZXJpZmllcixcbiAgICAgICAgcmVkaXJlY3RVUkk6IG9wdGlvbnMucmVkaXJlY3RVUkkgfHwgcmVkaXJlY3RVUkksXG4gICAgICAgIG9wdGlvbnMsXG4gICAgICAgIGRldmljZUlkLFxuICAgICAgICB0b2tlbkVuZHBvaW50OiBcImh0dHBzOi8vaWQudmsuY29tL29hdXRoMi9hdXRoXCJcbiAgICAgIH0pO1xuICAgIH0sXG4gICAgcmVmcmVzaEFjY2Vzc1Rva2VuOiBvcHRpb25zLnJlZnJlc2hBY2Nlc3NUb2tlbiA/IG9wdGlvbnMucmVmcmVzaEFjY2Vzc1Rva2VuIDogYXN5bmMgKHJlZnJlc2hUb2tlbikgPT4ge1xuICAgICAgcmV0dXJuIHJlZnJlc2hBY2Nlc3NUb2tlbih7XG4gICAgICAgIHJlZnJlc2hUb2tlbixcbiAgICAgICAgb3B0aW9uczoge1xuICAgICAgICAgIGNsaWVudElkOiBvcHRpb25zLmNsaWVudElkLFxuICAgICAgICAgIGNsaWVudEtleTogb3B0aW9ucy5jbGllbnRLZXksXG4gICAgICAgICAgY2xpZW50U2VjcmV0OiBvcHRpb25zLmNsaWVudFNlY3JldFxuICAgICAgICB9LFxuICAgICAgICB0b2tlbkVuZHBvaW50OiBcImh0dHBzOi8vaWQudmsuY29tL29hdXRoMi9hdXRoXCJcbiAgICAgIH0pO1xuICAgIH0sXG4gICAgYXN5bmMgZ2V0VXNlckluZm8oZGF0YSkge1xuICAgICAgaWYgKG9wdGlvbnMuZ2V0VXNlckluZm8pIHtcbiAgICAgICAgcmV0dXJuIG9wdGlvbnMuZ2V0VXNlckluZm8oZGF0YSk7XG4gICAgICB9XG4gICAgICBpZiAoIWRhdGEuYWNjZXNzVG9rZW4pIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICB9XG4gICAgICBjb25zdCBmb3JtQm9keSA9IG5ldyBVUkxTZWFyY2hQYXJhbXMoe1xuICAgICAgICBhY2Nlc3NfdG9rZW46IGRhdGEuYWNjZXNzVG9rZW4sXG4gICAgICAgIGNsaWVudF9pZDogb3B0aW9ucy5jbGllbnRJZFxuICAgICAgfSkudG9TdHJpbmcoKTtcbiAgICAgIGNvbnN0IHsgZGF0YTogcHJvZmlsZSwgZXJyb3IgfSA9IGF3YWl0IGJldHRlckZldGNoKFxuICAgICAgICBcImh0dHBzOi8vaWQudmsuY29tL29hdXRoMi91c2VyX2luZm9cIixcbiAgICAgICAge1xuICAgICAgICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWRcIlxuICAgICAgICAgIH0sXG4gICAgICAgICAgYm9keTogZm9ybUJvZHlcbiAgICAgICAgfVxuICAgICAgKTtcbiAgICAgIGlmIChlcnJvcikge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgIH1cbiAgICAgIGlmICghcHJvZmlsZS51c2VyLmVtYWlsKSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgICAgfVxuICAgICAgY29uc3QgdXNlck1hcCA9IGF3YWl0IG9wdGlvbnMubWFwUHJvZmlsZVRvVXNlcj8uKHByb2ZpbGUpO1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgdXNlcjoge1xuICAgICAgICAgIGlkOiBwcm9maWxlLnVzZXIudXNlcl9pZCxcbiAgICAgICAgICBmaXJzdF9uYW1lOiBwcm9maWxlLnVzZXIuZmlyc3RfbmFtZSxcbiAgICAgICAgICBsYXN0X25hbWU6IHByb2ZpbGUudXNlci5sYXN0X25hbWUsXG4gICAgICAgICAgZW1haWw6IHByb2ZpbGUudXNlci5lbWFpbCxcbiAgICAgICAgICBpbWFnZTogcHJvZmlsZS51c2VyLmF2YXRhcixcbiAgICAgICAgICAvKiogQG5vdGUgVksgZG9lcyBub3QgcHJvdmlkZSBlbWFpbFZlcmlmaWVkKi9cbiAgICAgICAgICBlbWFpbFZlcmlmaWVkOiAhIXByb2ZpbGUudXNlci5lbWFpbCxcbiAgICAgICAgICBiaXJ0aGRheTogcHJvZmlsZS51c2VyLmJpcnRoZGF5LFxuICAgICAgICAgIHNleDogcHJvZmlsZS51c2VyLnNleCxcbiAgICAgICAgICBuYW1lOiBgJHtwcm9maWxlLnVzZXIuZmlyc3RfbmFtZX0gJHtwcm9maWxlLnVzZXIubGFzdF9uYW1lfWAsXG4gICAgICAgICAgLi4udXNlck1hcFxuICAgICAgICB9LFxuICAgICAgICBkYXRhOiBwcm9maWxlXG4gICAgICB9O1xuICAgIH0sXG4gICAgb3B0aW9uc1xuICB9O1xufTtcblxuY29uc3Qgem9vbSA9ICh1c2VyT3B0aW9ucykgPT4ge1xuICBjb25zdCBvcHRpb25zID0ge1xuICAgIHBrY2U6IHRydWUsXG4gICAgLi4udXNlck9wdGlvbnNcbiAgfTtcbiAgcmV0dXJuIHtcbiAgICBpZDogXCJ6b29tXCIsXG4gICAgbmFtZTogXCJab29tXCIsXG4gICAgY3JlYXRlQXV0aG9yaXphdGlvblVSTDogYXN5bmMgKHsgc3RhdGUsIHJlZGlyZWN0VVJJLCBjb2RlVmVyaWZpZXIgfSkgPT4ge1xuICAgICAgY29uc3QgcGFyYW1zID0gbmV3IFVSTFNlYXJjaFBhcmFtcyh7XG4gICAgICAgIHJlc3BvbnNlX3R5cGU6IFwiY29kZVwiLFxuICAgICAgICByZWRpcmVjdF91cmk6IG9wdGlvbnMucmVkaXJlY3RVUkkgPyBvcHRpb25zLnJlZGlyZWN0VVJJIDogcmVkaXJlY3RVUkksXG4gICAgICAgIGNsaWVudF9pZDogb3B0aW9ucy5jbGllbnRJZCxcbiAgICAgICAgc3RhdGVcbiAgICAgIH0pO1xuICAgICAgaWYgKG9wdGlvbnMucGtjZSkge1xuICAgICAgICBjb25zdCBjb2RlQ2hhbGxlbmdlID0gYXdhaXQgZ2VuZXJhdGVDb2RlQ2hhbGxlbmdlKGNvZGVWZXJpZmllcik7XG4gICAgICAgIHBhcmFtcy5zZXQoXCJjb2RlX2NoYWxsZW5nZV9tZXRob2RcIiwgXCJTMjU2XCIpO1xuICAgICAgICBwYXJhbXMuc2V0KFwiY29kZV9jaGFsbGVuZ2VcIiwgY29kZUNoYWxsZW5nZSk7XG4gICAgICB9XG4gICAgICBjb25zdCB1cmwgPSBuZXcgVVJMKFwiaHR0cHM6Ly96b29tLnVzL29hdXRoL2F1dGhvcml6ZVwiKTtcbiAgICAgIHVybC5zZWFyY2ggPSBwYXJhbXMudG9TdHJpbmcoKTtcbiAgICAgIHJldHVybiB1cmw7XG4gICAgfSxcbiAgICB2YWxpZGF0ZUF1dGhvcml6YXRpb25Db2RlOiBhc3luYyAoeyBjb2RlLCByZWRpcmVjdFVSSSwgY29kZVZlcmlmaWVyIH0pID0+IHtcbiAgICAgIHJldHVybiB2YWxpZGF0ZUF1dGhvcml6YXRpb25Db2RlKHtcbiAgICAgICAgY29kZSxcbiAgICAgICAgcmVkaXJlY3RVUkk6IG9wdGlvbnMucmVkaXJlY3RVUkkgfHwgcmVkaXJlY3RVUkksXG4gICAgICAgIGNvZGVWZXJpZmllcixcbiAgICAgICAgb3B0aW9ucyxcbiAgICAgICAgdG9rZW5FbmRwb2ludDogXCJodHRwczovL3pvb20udXMvb2F1dGgvdG9rZW5cIixcbiAgICAgICAgYXV0aGVudGljYXRpb246IFwicG9zdFwiXG4gICAgICB9KTtcbiAgICB9LFxuICAgIGFzeW5jIGdldFVzZXJJbmZvKHRva2VuKSB7XG4gICAgICBpZiAob3B0aW9ucy5nZXRVc2VySW5mbykge1xuICAgICAgICByZXR1cm4gb3B0aW9ucy5nZXRVc2VySW5mbyh0b2tlbik7XG4gICAgICB9XG4gICAgICBjb25zdCB7IGRhdGE6IHByb2ZpbGUsIGVycm9yIH0gPSBhd2FpdCBiZXR0ZXJGZXRjaChcbiAgICAgICAgXCJodHRwczovL2FwaS56b29tLnVzL3YyL3VzZXJzL21lXCIsXG4gICAgICAgIHtcbiAgICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgICBhdXRob3JpemF0aW9uOiBgQmVhcmVyICR7dG9rZW4uYWNjZXNzVG9rZW59YFxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgKTtcbiAgICAgIGlmIChlcnJvcikge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgIH1cbiAgICAgIGNvbnN0IHVzZXJNYXAgPSBhd2FpdCBvcHRpb25zLm1hcFByb2ZpbGVUb1VzZXI/Lihwcm9maWxlKTtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHVzZXI6IHtcbiAgICAgICAgICBpZDogcHJvZmlsZS5pZCxcbiAgICAgICAgICBuYW1lOiBwcm9maWxlLmRpc3BsYXlfbmFtZSxcbiAgICAgICAgICBpbWFnZTogcHJvZmlsZS5waWNfdXJsLFxuICAgICAgICAgIGVtYWlsOiBwcm9maWxlLmVtYWlsLFxuICAgICAgICAgIGVtYWlsVmVyaWZpZWQ6IEJvb2xlYW4ocHJvZmlsZS52ZXJpZmllZCksXG4gICAgICAgICAgLi4udXNlck1hcFxuICAgICAgICB9LFxuICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgLi4ucHJvZmlsZVxuICAgICAgICB9XG4gICAgICB9O1xuICAgIH1cbiAgfTtcbn07XG5cbmNvbnN0IGtha2FvID0gKG9wdGlvbnMpID0+IHtcbiAgcmV0dXJuIHtcbiAgICBpZDogXCJrYWthb1wiLFxuICAgIG5hbWU6IFwiS2FrYW9cIixcbiAgICBjcmVhdGVBdXRob3JpemF0aW9uVVJMKHsgc3RhdGUsIHNjb3BlcywgcmVkaXJlY3RVUkkgfSkge1xuICAgICAgY29uc3QgX3Njb3BlcyA9IG9wdGlvbnMuZGlzYWJsZURlZmF1bHRTY29wZSA/IFtdIDogW1wiYWNjb3VudF9lbWFpbFwiLCBcInByb2ZpbGVfaW1hZ2VcIiwgXCJwcm9maWxlX25pY2tuYW1lXCJdO1xuICAgICAgb3B0aW9ucy5zY29wZSAmJiBfc2NvcGVzLnB1c2goLi4ub3B0aW9ucy5zY29wZSk7XG4gICAgICBzY29wZXMgJiYgX3Njb3Blcy5wdXNoKC4uLnNjb3Blcyk7XG4gICAgICByZXR1cm4gY3JlYXRlQXV0aG9yaXphdGlvblVSTCh7XG4gICAgICAgIGlkOiBcImtha2FvXCIsXG4gICAgICAgIG9wdGlvbnMsXG4gICAgICAgIGF1dGhvcml6YXRpb25FbmRwb2ludDogXCJodHRwczovL2thdXRoLmtha2FvLmNvbS9vYXV0aC9hdXRob3JpemVcIixcbiAgICAgICAgc2NvcGVzOiBfc2NvcGVzLFxuICAgICAgICBzdGF0ZSxcbiAgICAgICAgcmVkaXJlY3RVUklcbiAgICAgIH0pO1xuICAgIH0sXG4gICAgdmFsaWRhdGVBdXRob3JpemF0aW9uQ29kZTogYXN5bmMgKHsgY29kZSwgcmVkaXJlY3RVUkkgfSkgPT4ge1xuICAgICAgcmV0dXJuIHZhbGlkYXRlQXV0aG9yaXphdGlvbkNvZGUoe1xuICAgICAgICBjb2RlLFxuICAgICAgICByZWRpcmVjdFVSSSxcbiAgICAgICAgb3B0aW9ucyxcbiAgICAgICAgdG9rZW5FbmRwb2ludDogXCJodHRwczovL2thdXRoLmtha2FvLmNvbS9vYXV0aC90b2tlblwiXG4gICAgICB9KTtcbiAgICB9LFxuICAgIHJlZnJlc2hBY2Nlc3NUb2tlbjogb3B0aW9ucy5yZWZyZXNoQWNjZXNzVG9rZW4gPyBvcHRpb25zLnJlZnJlc2hBY2Nlc3NUb2tlbiA6IGFzeW5jIChyZWZyZXNoVG9rZW4pID0+IHtcbiAgICAgIHJldHVybiByZWZyZXNoQWNjZXNzVG9rZW4oe1xuICAgICAgICByZWZyZXNoVG9rZW4sXG4gICAgICAgIG9wdGlvbnM6IHtcbiAgICAgICAgICBjbGllbnRJZDogb3B0aW9ucy5jbGllbnRJZCxcbiAgICAgICAgICBjbGllbnRLZXk6IG9wdGlvbnMuY2xpZW50S2V5LFxuICAgICAgICAgIGNsaWVudFNlY3JldDogb3B0aW9ucy5jbGllbnRTZWNyZXRcbiAgICAgICAgfSxcbiAgICAgICAgdG9rZW5FbmRwb2ludDogXCJodHRwczovL2thdXRoLmtha2FvLmNvbS9vYXV0aC90b2tlblwiXG4gICAgICB9KTtcbiAgICB9LFxuICAgIGFzeW5jIGdldFVzZXJJbmZvKHRva2VuKSB7XG4gICAgICBpZiAob3B0aW9ucy5nZXRVc2VySW5mbykge1xuICAgICAgICByZXR1cm4gb3B0aW9ucy5nZXRVc2VySW5mbyh0b2tlbik7XG4gICAgICB9XG4gICAgICBjb25zdCB7IGRhdGE6IHByb2ZpbGUsIGVycm9yIH0gPSBhd2FpdCBiZXR0ZXJGZXRjaChcbiAgICAgICAgXCJodHRwczovL2thcGkua2FrYW8uY29tL3YyL3VzZXIvbWVcIixcbiAgICAgICAge1xuICAgICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAgIEF1dGhvcml6YXRpb246IGBCZWFyZXIgJHt0b2tlbi5hY2Nlc3NUb2tlbn1gXG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICApO1xuICAgICAgaWYgKGVycm9yIHx8ICFwcm9maWxlKSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgICAgfVxuICAgICAgY29uc3QgdXNlck1hcCA9IGF3YWl0IG9wdGlvbnMubWFwUHJvZmlsZVRvVXNlcj8uKHByb2ZpbGUpO1xuICAgICAgY29uc3QgYWNjb3VudCA9IHByb2ZpbGUua2FrYW9fYWNjb3VudCB8fCB7fTtcbiAgICAgIGNvbnN0IGtha2FvUHJvZmlsZSA9IGFjY291bnQucHJvZmlsZSB8fCB7fTtcbiAgICAgIGNvbnN0IHVzZXIgPSB7XG4gICAgICAgIGlkOiBTdHJpbmcocHJvZmlsZS5pZCksXG4gICAgICAgIG5hbWU6IGtha2FvUHJvZmlsZS5uaWNrbmFtZSB8fCBhY2NvdW50Lm5hbWUgfHwgdm9pZCAwLFxuICAgICAgICBlbWFpbDogYWNjb3VudC5lbWFpbCxcbiAgICAgICAgaW1hZ2U6IGtha2FvUHJvZmlsZS5wcm9maWxlX2ltYWdlX3VybCB8fCBrYWthb1Byb2ZpbGUudGh1bWJuYWlsX2ltYWdlX3VybCxcbiAgICAgICAgZW1haWxWZXJpZmllZDogISFhY2NvdW50LmlzX2VtYWlsX3ZhbGlkICYmICEhYWNjb3VudC5pc19lbWFpbF92ZXJpZmllZCxcbiAgICAgICAgLi4udXNlck1hcFxuICAgICAgfTtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHVzZXIsXG4gICAgICAgIGRhdGE6IHByb2ZpbGVcbiAgICAgIH07XG4gICAgfSxcbiAgICBvcHRpb25zXG4gIH07XG59O1xuXG5jb25zdCBuYXZlciA9IChvcHRpb25zKSA9PiB7XG4gIHJldHVybiB7XG4gICAgaWQ6IFwibmF2ZXJcIixcbiAgICBuYW1lOiBcIk5hdmVyXCIsXG4gICAgY3JlYXRlQXV0aG9yaXphdGlvblVSTCh7IHN0YXRlLCBzY29wZXMsIHJlZGlyZWN0VVJJIH0pIHtcbiAgICAgIGNvbnN0IF9zY29wZXMgPSBvcHRpb25zLmRpc2FibGVEZWZhdWx0U2NvcGUgPyBbXSA6IFtcInByb2ZpbGVcIiwgXCJlbWFpbFwiXTtcbiAgICAgIG9wdGlvbnMuc2NvcGUgJiYgX3Njb3Blcy5wdXNoKC4uLm9wdGlvbnMuc2NvcGUpO1xuICAgICAgc2NvcGVzICYmIF9zY29wZXMucHVzaCguLi5zY29wZXMpO1xuICAgICAgcmV0dXJuIGNyZWF0ZUF1dGhvcml6YXRpb25VUkwoe1xuICAgICAgICBpZDogXCJuYXZlclwiLFxuICAgICAgICBvcHRpb25zLFxuICAgICAgICBhdXRob3JpemF0aW9uRW5kcG9pbnQ6IFwiaHR0cHM6Ly9uaWQubmF2ZXIuY29tL29hdXRoMi4wL2F1dGhvcml6ZVwiLFxuICAgICAgICBzY29wZXM6IF9zY29wZXMsXG4gICAgICAgIHN0YXRlLFxuICAgICAgICByZWRpcmVjdFVSSVxuICAgICAgfSk7XG4gICAgfSxcbiAgICB2YWxpZGF0ZUF1dGhvcml6YXRpb25Db2RlOiBhc3luYyAoeyBjb2RlLCByZWRpcmVjdFVSSSB9KSA9PiB7XG4gICAgICByZXR1cm4gdmFsaWRhdGVBdXRob3JpemF0aW9uQ29kZSh7XG4gICAgICAgIGNvZGUsXG4gICAgICAgIHJlZGlyZWN0VVJJLFxuICAgICAgICBvcHRpb25zLFxuICAgICAgICB0b2tlbkVuZHBvaW50OiBcImh0dHBzOi8vbmlkLm5hdmVyLmNvbS9vYXV0aDIuMC90b2tlblwiXG4gICAgICB9KTtcbiAgICB9LFxuICAgIHJlZnJlc2hBY2Nlc3NUb2tlbjogb3B0aW9ucy5yZWZyZXNoQWNjZXNzVG9rZW4gPyBvcHRpb25zLnJlZnJlc2hBY2Nlc3NUb2tlbiA6IGFzeW5jIChyZWZyZXNoVG9rZW4pID0+IHtcbiAgICAgIHJldHVybiByZWZyZXNoQWNjZXNzVG9rZW4oe1xuICAgICAgICByZWZyZXNoVG9rZW4sXG4gICAgICAgIG9wdGlvbnM6IHtcbiAgICAgICAgICBjbGllbnRJZDogb3B0aW9ucy5jbGllbnRJZCxcbiAgICAgICAgICBjbGllbnRLZXk6IG9wdGlvbnMuY2xpZW50S2V5LFxuICAgICAgICAgIGNsaWVudFNlY3JldDogb3B0aW9ucy5jbGllbnRTZWNyZXRcbiAgICAgICAgfSxcbiAgICAgICAgdG9rZW5FbmRwb2ludDogXCJodHRwczovL25pZC5uYXZlci5jb20vb2F1dGgyLjAvdG9rZW5cIlxuICAgICAgfSk7XG4gICAgfSxcbiAgICBhc3luYyBnZXRVc2VySW5mbyh0b2tlbikge1xuICAgICAgaWYgKG9wdGlvbnMuZ2V0VXNlckluZm8pIHtcbiAgICAgICAgcmV0dXJuIG9wdGlvbnMuZ2V0VXNlckluZm8odG9rZW4pO1xuICAgICAgfVxuICAgICAgY29uc3QgeyBkYXRhOiBwcm9maWxlLCBlcnJvciB9ID0gYXdhaXQgYmV0dGVyRmV0Y2goXG4gICAgICAgIFwiaHR0cHM6Ly9vcGVuYXBpLm5hdmVyLmNvbS92MS9uaWQvbWVcIixcbiAgICAgICAge1xuICAgICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAgIEF1dGhvcml6YXRpb246IGBCZWFyZXIgJHt0b2tlbi5hY2Nlc3NUb2tlbn1gXG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICApO1xuICAgICAgaWYgKGVycm9yIHx8ICFwcm9maWxlIHx8IHByb2ZpbGUucmVzdWx0Y29kZSAhPT0gXCIwMFwiKSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgICAgfVxuICAgICAgY29uc3QgdXNlck1hcCA9IGF3YWl0IG9wdGlvbnMubWFwUHJvZmlsZVRvVXNlcj8uKHByb2ZpbGUpO1xuICAgICAgY29uc3QgcmVzID0gcHJvZmlsZS5yZXNwb25zZSB8fCB7fTtcbiAgICAgIGNvbnN0IHVzZXIgPSB7XG4gICAgICAgIGlkOiByZXMuaWQsXG4gICAgICAgIG5hbWU6IHJlcy5uYW1lIHx8IHJlcy5uaWNrbmFtZSxcbiAgICAgICAgZW1haWw6IHJlcy5lbWFpbCxcbiAgICAgICAgaW1hZ2U6IHJlcy5wcm9maWxlX2ltYWdlLFxuICAgICAgICBlbWFpbFZlcmlmaWVkOiBmYWxzZSxcbiAgICAgICAgLi4udXNlck1hcFxuICAgICAgfTtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHVzZXIsXG4gICAgICAgIGRhdGE6IHByb2ZpbGVcbiAgICAgIH07XG4gICAgfSxcbiAgICBvcHRpb25zXG4gIH07XG59O1xuXG5jb25zdCBsaW5lID0gKG9wdGlvbnMpID0+IHtcbiAgY29uc3QgYXV0aG9yaXphdGlvbkVuZHBvaW50ID0gXCJodHRwczovL2FjY2Vzcy5saW5lLm1lL29hdXRoMi92Mi4xL2F1dGhvcml6ZVwiO1xuICBjb25zdCB0b2tlbkVuZHBvaW50ID0gXCJodHRwczovL2FwaS5saW5lLm1lL29hdXRoMi92Mi4xL3Rva2VuXCI7XG4gIGNvbnN0IHVzZXJJbmZvRW5kcG9pbnQgPSBcImh0dHBzOi8vYXBpLmxpbmUubWUvb2F1dGgyL3YyLjEvdXNlcmluZm9cIjtcbiAgY29uc3QgdmVyaWZ5SWRUb2tlbkVuZHBvaW50ID0gXCJodHRwczovL2FwaS5saW5lLm1lL29hdXRoMi92Mi4xL3ZlcmlmeVwiO1xuICByZXR1cm4ge1xuICAgIGlkOiBcImxpbmVcIixcbiAgICBuYW1lOiBcIkxJTkVcIixcbiAgICBhc3luYyBjcmVhdGVBdXRob3JpemF0aW9uVVJMKHtcbiAgICAgIHN0YXRlLFxuICAgICAgc2NvcGVzLFxuICAgICAgY29kZVZlcmlmaWVyLFxuICAgICAgcmVkaXJlY3RVUkksXG4gICAgICBsb2dpbkhpbnRcbiAgICB9KSB7XG4gICAgICBjb25zdCBfc2NvcGVzID0gb3B0aW9ucy5kaXNhYmxlRGVmYXVsdFNjb3BlID8gW10gOiBbXCJvcGVuaWRcIiwgXCJwcm9maWxlXCIsIFwiZW1haWxcIl07XG4gICAgICBvcHRpb25zLnNjb3BlICYmIF9zY29wZXMucHVzaCguLi5vcHRpb25zLnNjb3BlKTtcbiAgICAgIHNjb3BlcyAmJiBfc2NvcGVzLnB1c2goLi4uc2NvcGVzKTtcbiAgICAgIHJldHVybiBhd2FpdCBjcmVhdGVBdXRob3JpemF0aW9uVVJMKHtcbiAgICAgICAgaWQ6IFwibGluZVwiLFxuICAgICAgICBvcHRpb25zLFxuICAgICAgICBhdXRob3JpemF0aW9uRW5kcG9pbnQsXG4gICAgICAgIHNjb3BlczogX3Njb3BlcyxcbiAgICAgICAgc3RhdGUsXG4gICAgICAgIGNvZGVWZXJpZmllcixcbiAgICAgICAgcmVkaXJlY3RVUkksXG4gICAgICAgIGxvZ2luSGludFxuICAgICAgfSk7XG4gICAgfSxcbiAgICB2YWxpZGF0ZUF1dGhvcml6YXRpb25Db2RlOiBhc3luYyAoeyBjb2RlLCBjb2RlVmVyaWZpZXIsIHJlZGlyZWN0VVJJIH0pID0+IHtcbiAgICAgIHJldHVybiB2YWxpZGF0ZUF1dGhvcml6YXRpb25Db2RlKHtcbiAgICAgICAgY29kZSxcbiAgICAgICAgY29kZVZlcmlmaWVyLFxuICAgICAgICByZWRpcmVjdFVSSSxcbiAgICAgICAgb3B0aW9ucyxcbiAgICAgICAgdG9rZW5FbmRwb2ludFxuICAgICAgfSk7XG4gICAgfSxcbiAgICByZWZyZXNoQWNjZXNzVG9rZW46IG9wdGlvbnMucmVmcmVzaEFjY2Vzc1Rva2VuID8gb3B0aW9ucy5yZWZyZXNoQWNjZXNzVG9rZW4gOiBhc3luYyAocmVmcmVzaFRva2VuKSA9PiB7XG4gICAgICByZXR1cm4gcmVmcmVzaEFjY2Vzc1Rva2VuKHtcbiAgICAgICAgcmVmcmVzaFRva2VuLFxuICAgICAgICBvcHRpb25zOiB7XG4gICAgICAgICAgY2xpZW50SWQ6IG9wdGlvbnMuY2xpZW50SWQsXG4gICAgICAgICAgY2xpZW50U2VjcmV0OiBvcHRpb25zLmNsaWVudFNlY3JldFxuICAgICAgICB9LFxuICAgICAgICB0b2tlbkVuZHBvaW50XG4gICAgICB9KTtcbiAgICB9LFxuICAgIGFzeW5jIHZlcmlmeUlkVG9rZW4odG9rZW4sIG5vbmNlKSB7XG4gICAgICBpZiAob3B0aW9ucy5kaXNhYmxlSWRUb2tlblNpZ25Jbikge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9XG4gICAgICBpZiAob3B0aW9ucy52ZXJpZnlJZFRva2VuKSB7XG4gICAgICAgIHJldHVybiBvcHRpb25zLnZlcmlmeUlkVG9rZW4odG9rZW4sIG5vbmNlKTtcbiAgICAgIH1cbiAgICAgIGNvbnN0IGJvZHkgPSBuZXcgVVJMU2VhcmNoUGFyYW1zKCk7XG4gICAgICBib2R5LnNldChcImlkX3Rva2VuXCIsIHRva2VuKTtcbiAgICAgIGJvZHkuc2V0KFwiY2xpZW50X2lkXCIsIG9wdGlvbnMuY2xpZW50SWQpO1xuICAgICAgaWYgKG5vbmNlKSBib2R5LnNldChcIm5vbmNlXCIsIG5vbmNlKTtcbiAgICAgIGNvbnN0IHsgZGF0YSwgZXJyb3IgfSA9IGF3YWl0IGJldHRlckZldGNoKFxuICAgICAgICB2ZXJpZnlJZFRva2VuRW5kcG9pbnQsXG4gICAgICAgIHtcbiAgICAgICAgICBtZXRob2Q6IFwiUE9TVFwiLFxuICAgICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAgIFwiY29udGVudC10eXBlXCI6IFwiYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkXCJcbiAgICAgICAgICB9LFxuICAgICAgICAgIGJvZHlcbiAgICAgICAgfVxuICAgICAgKTtcbiAgICAgIGlmIChlcnJvciB8fCAhZGF0YSkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9XG4gICAgICBpZiAoZGF0YS5hdWQgIT09IG9wdGlvbnMuY2xpZW50SWQpIHJldHVybiBmYWxzZTtcbiAgICAgIGlmIChub25jZSAmJiBkYXRhLm5vbmNlICYmIGRhdGEubm9uY2UgIT09IG5vbmNlKSByZXR1cm4gZmFsc2U7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9LFxuICAgIGFzeW5jIGdldFVzZXJJbmZvKHRva2VuKSB7XG4gICAgICBpZiAob3B0aW9ucy5nZXRVc2VySW5mbykge1xuICAgICAgICByZXR1cm4gb3B0aW9ucy5nZXRVc2VySW5mbyh0b2tlbik7XG4gICAgICB9XG4gICAgICBsZXQgcHJvZmlsZSA9IG51bGw7XG4gICAgICBpZiAodG9rZW4uaWRUb2tlbikge1xuICAgICAgICB0cnkge1xuICAgICAgICAgIHByb2ZpbGUgPSBkZWNvZGVKd3QodG9rZW4uaWRUb2tlbik7XG4gICAgICAgIH0gY2F0Y2gge1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBpZiAoIXByb2ZpbGUpIHtcbiAgICAgICAgY29uc3QgeyBkYXRhIH0gPSBhd2FpdCBiZXR0ZXJGZXRjaCh1c2VySW5mb0VuZHBvaW50LCB7XG4gICAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICAgYXV0aG9yaXphdGlvbjogYEJlYXJlciAke3Rva2VuLmFjY2Vzc1Rva2VufWBcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICBwcm9maWxlID0gZGF0YSB8fCBudWxsO1xuICAgICAgfVxuICAgICAgaWYgKCFwcm9maWxlKSByZXR1cm4gbnVsbDtcbiAgICAgIGNvbnN0IHVzZXJNYXAgPSBhd2FpdCBvcHRpb25zLm1hcFByb2ZpbGVUb1VzZXI/Lihwcm9maWxlKTtcbiAgICAgIGNvbnN0IGlkID0gcHJvZmlsZS5zdWIgfHwgcHJvZmlsZS51c2VySWQ7XG4gICAgICBjb25zdCBuYW1lID0gcHJvZmlsZS5uYW1lIHx8IHByb2ZpbGUuZGlzcGxheU5hbWU7XG4gICAgICBjb25zdCBpbWFnZSA9IHByb2ZpbGUucGljdHVyZSB8fCBwcm9maWxlLnBpY3R1cmVVcmwgfHwgdm9pZCAwO1xuICAgICAgY29uc3QgZW1haWwgPSBwcm9maWxlLmVtYWlsO1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgdXNlcjoge1xuICAgICAgICAgIGlkLFxuICAgICAgICAgIG5hbWUsXG4gICAgICAgICAgZW1haWwsXG4gICAgICAgICAgaW1hZ2UsXG4gICAgICAgICAgLy8gTElORSBkb2VzIG5vdCBleHBvc2UgZW1haWwgdmVyaWZpY2F0aW9uIHN0YXR1cyBpbiBJRCB0b2tlbi91c2VyaW5mb1xuICAgICAgICAgIGVtYWlsVmVyaWZpZWQ6IGZhbHNlLFxuICAgICAgICAgIC4uLnVzZXJNYXBcbiAgICAgICAgfSxcbiAgICAgICAgZGF0YTogcHJvZmlsZVxuICAgICAgfTtcbiAgICB9LFxuICAgIG9wdGlvbnNcbiAgfTtcbn07XG5cbmNvbnN0IHBheXBhbCA9IChvcHRpb25zKSA9PiB7XG4gIGNvbnN0IGVudmlyb25tZW50ID0gb3B0aW9ucy5lbnZpcm9ubWVudCB8fCBcInNhbmRib3hcIjtcbiAgY29uc3QgaXNTYW5kYm94ID0gZW52aXJvbm1lbnQgPT09IFwic2FuZGJveFwiO1xuICBjb25zdCBhdXRob3JpemF0aW9uRW5kcG9pbnQgPSBpc1NhbmRib3ggPyBcImh0dHBzOi8vd3d3LnNhbmRib3gucGF5cGFsLmNvbS9zaWduaW4vYXV0aG9yaXplXCIgOiBcImh0dHBzOi8vd3d3LnBheXBhbC5jb20vc2lnbmluL2F1dGhvcml6ZVwiO1xuICBjb25zdCB0b2tlbkVuZHBvaW50ID0gaXNTYW5kYm94ID8gXCJodHRwczovL2FwaS1tLnNhbmRib3gucGF5cGFsLmNvbS92MS9vYXV0aDIvdG9rZW5cIiA6IFwiaHR0cHM6Ly9hcGktbS5wYXlwYWwuY29tL3YxL29hdXRoMi90b2tlblwiO1xuICBjb25zdCB1c2VySW5mb0VuZHBvaW50ID0gaXNTYW5kYm94ID8gXCJodHRwczovL2FwaS1tLnNhbmRib3gucGF5cGFsLmNvbS92MS9pZGVudGl0eS9vYXV0aDIvdXNlcmluZm9cIiA6IFwiaHR0cHM6Ly9hcGktbS5wYXlwYWwuY29tL3YxL2lkZW50aXR5L29hdXRoMi91c2VyaW5mb1wiO1xuICByZXR1cm4ge1xuICAgIGlkOiBcInBheXBhbFwiLFxuICAgIG5hbWU6IFwiUGF5UGFsXCIsXG4gICAgYXN5bmMgY3JlYXRlQXV0aG9yaXphdGlvblVSTCh7IHN0YXRlLCBjb2RlVmVyaWZpZXIsIHJlZGlyZWN0VVJJIH0pIHtcbiAgICAgIGlmICghb3B0aW9ucy5jbGllbnRJZCB8fCAhb3B0aW9ucy5jbGllbnRTZWNyZXQpIHtcbiAgICAgICAgbG9nZ2VyLmVycm9yKFxuICAgICAgICAgIFwiQ2xpZW50IElkIGFuZCBDbGllbnQgU2VjcmV0IGlzIHJlcXVpcmVkIGZvciBQYXlQYWwuIE1ha2Ugc3VyZSB0byBwcm92aWRlIHRoZW0gaW4gdGhlIG9wdGlvbnMuXCJcbiAgICAgICAgKTtcbiAgICAgICAgdGhyb3cgbmV3IEJldHRlckF1dGhFcnJvcihcIkNMSUVOVF9JRF9BTkRfU0VDUkVUX1JFUVVJUkVEXCIpO1xuICAgICAgfVxuICAgICAgY29uc3QgX3Njb3BlcyA9IFtdO1xuICAgICAgY29uc3QgdXJsID0gYXdhaXQgY3JlYXRlQXV0aG9yaXphdGlvblVSTCh7XG4gICAgICAgIGlkOiBcInBheXBhbFwiLFxuICAgICAgICBvcHRpb25zLFxuICAgICAgICBhdXRob3JpemF0aW9uRW5kcG9pbnQsXG4gICAgICAgIHNjb3BlczogX3Njb3BlcyxcbiAgICAgICAgc3RhdGUsXG4gICAgICAgIGNvZGVWZXJpZmllcixcbiAgICAgICAgcmVkaXJlY3RVUkksXG4gICAgICAgIHByb21wdDogb3B0aW9ucy5wcm9tcHRcbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIHVybDtcbiAgICB9LFxuICAgIHZhbGlkYXRlQXV0aG9yaXphdGlvbkNvZGU6IGFzeW5jICh7IGNvZGUsIHJlZGlyZWN0VVJJIH0pID0+IHtcbiAgICAgIGNvbnN0IGNyZWRlbnRpYWxzID0gYmFzZTY0LmVuY29kZShcbiAgICAgICAgYCR7b3B0aW9ucy5jbGllbnRJZH06JHtvcHRpb25zLmNsaWVudFNlY3JldH1gXG4gICAgICApO1xuICAgICAgdHJ5IHtcbiAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBiZXR0ZXJGZXRjaCh0b2tlbkVuZHBvaW50LCB7XG4gICAgICAgICAgbWV0aG9kOiBcIlBPU1RcIixcbiAgICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgICBBdXRob3JpemF0aW9uOiBgQmFzaWMgJHtjcmVkZW50aWFsc31gLFxuICAgICAgICAgICAgQWNjZXB0OiBcImFwcGxpY2F0aW9uL2pzb25cIixcbiAgICAgICAgICAgIFwiQWNjZXB0LUxhbmd1YWdlXCI6IFwiZW5fVVNcIixcbiAgICAgICAgICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkXCJcbiAgICAgICAgICB9LFxuICAgICAgICAgIGJvZHk6IG5ldyBVUkxTZWFyY2hQYXJhbXMoe1xuICAgICAgICAgICAgZ3JhbnRfdHlwZTogXCJhdXRob3JpemF0aW9uX2NvZGVcIixcbiAgICAgICAgICAgIGNvZGUsXG4gICAgICAgICAgICByZWRpcmVjdF91cmk6IHJlZGlyZWN0VVJJXG4gICAgICAgICAgfSkudG9TdHJpbmcoKVxuICAgICAgICB9KTtcbiAgICAgICAgaWYgKCFyZXNwb25zZS5kYXRhKSB7XG4gICAgICAgICAgdGhyb3cgbmV3IEJldHRlckF1dGhFcnJvcihcIkZBSUxFRF9UT19HRVRfQUNDRVNTX1RPS0VOXCIpO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGRhdGEgPSByZXNwb25zZS5kYXRhO1xuICAgICAgICBjb25zdCByZXN1bHQgPSB7XG4gICAgICAgICAgYWNjZXNzVG9rZW46IGRhdGEuYWNjZXNzX3Rva2VuLFxuICAgICAgICAgIHJlZnJlc2hUb2tlbjogZGF0YS5yZWZyZXNoX3Rva2VuLFxuICAgICAgICAgIGFjY2Vzc1Rva2VuRXhwaXJlc0F0OiBkYXRhLmV4cGlyZXNfaW4gPyBuZXcgRGF0ZShEYXRlLm5vdygpICsgZGF0YS5leHBpcmVzX2luICogMWUzKSA6IHZvaWQgMCxcbiAgICAgICAgICBpZFRva2VuOiBkYXRhLmlkX3Rva2VuXG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICBsb2dnZXIuZXJyb3IoXCJQYXlQYWwgdG9rZW4gZXhjaGFuZ2UgZmFpbGVkOlwiLCBlcnJvcik7XG4gICAgICAgIHRocm93IG5ldyBCZXR0ZXJBdXRoRXJyb3IoXCJGQUlMRURfVE9fR0VUX0FDQ0VTU19UT0tFTlwiKTtcbiAgICAgIH1cbiAgICB9LFxuICAgIHJlZnJlc2hBY2Nlc3NUb2tlbjogb3B0aW9ucy5yZWZyZXNoQWNjZXNzVG9rZW4gPyBvcHRpb25zLnJlZnJlc2hBY2Nlc3NUb2tlbiA6IGFzeW5jIChyZWZyZXNoVG9rZW4pID0+IHtcbiAgICAgIGNvbnN0IGNyZWRlbnRpYWxzID0gYmFzZTY0LmVuY29kZShcbiAgICAgICAgYCR7b3B0aW9ucy5jbGllbnRJZH06JHtvcHRpb25zLmNsaWVudFNlY3JldH1gXG4gICAgICApO1xuICAgICAgdHJ5IHtcbiAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBiZXR0ZXJGZXRjaCh0b2tlbkVuZHBvaW50LCB7XG4gICAgICAgICAgbWV0aG9kOiBcIlBPU1RcIixcbiAgICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgICBBdXRob3JpemF0aW9uOiBgQmFzaWMgJHtjcmVkZW50aWFsc31gLFxuICAgICAgICAgICAgQWNjZXB0OiBcImFwcGxpY2F0aW9uL2pzb25cIixcbiAgICAgICAgICAgIFwiQWNjZXB0LUxhbmd1YWdlXCI6IFwiZW5fVVNcIixcbiAgICAgICAgICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkXCJcbiAgICAgICAgICB9LFxuICAgICAgICAgIGJvZHk6IG5ldyBVUkxTZWFyY2hQYXJhbXMoe1xuICAgICAgICAgICAgZ3JhbnRfdHlwZTogXCJyZWZyZXNoX3Rva2VuXCIsXG4gICAgICAgICAgICByZWZyZXNoX3Rva2VuOiByZWZyZXNoVG9rZW5cbiAgICAgICAgICB9KS50b1N0cmluZygpXG4gICAgICAgIH0pO1xuICAgICAgICBpZiAoIXJlc3BvbnNlLmRhdGEpIHtcbiAgICAgICAgICB0aHJvdyBuZXcgQmV0dGVyQXV0aEVycm9yKFwiRkFJTEVEX1RPX1JFRlJFU0hfQUNDRVNTX1RPS0VOXCIpO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGRhdGEgPSByZXNwb25zZS5kYXRhO1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIGFjY2Vzc1Rva2VuOiBkYXRhLmFjY2Vzc190b2tlbixcbiAgICAgICAgICByZWZyZXNoVG9rZW46IGRhdGEucmVmcmVzaF90b2tlbixcbiAgICAgICAgICBhY2Nlc3NUb2tlbkV4cGlyZXNBdDogZGF0YS5leHBpcmVzX2luID8gbmV3IERhdGUoRGF0ZS5ub3coKSArIGRhdGEuZXhwaXJlc19pbiAqIDFlMykgOiB2b2lkIDBcbiAgICAgICAgfTtcbiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIGxvZ2dlci5lcnJvcihcIlBheVBhbCB0b2tlbiByZWZyZXNoIGZhaWxlZDpcIiwgZXJyb3IpO1xuICAgICAgICB0aHJvdyBuZXcgQmV0dGVyQXV0aEVycm9yKFwiRkFJTEVEX1RPX1JFRlJFU0hfQUNDRVNTX1RPS0VOXCIpO1xuICAgICAgfVxuICAgIH0sXG4gICAgYXN5bmMgdmVyaWZ5SWRUb2tlbih0b2tlbiwgbm9uY2UpIHtcbiAgICAgIGlmIChvcHRpb25zLmRpc2FibGVJZFRva2VuU2lnbkluKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH1cbiAgICAgIGlmIChvcHRpb25zLnZlcmlmeUlkVG9rZW4pIHtcbiAgICAgICAgcmV0dXJuIG9wdGlvbnMudmVyaWZ5SWRUb2tlbih0b2tlbiwgbm9uY2UpO1xuICAgICAgfVxuICAgICAgdHJ5IHtcbiAgICAgICAgY29uc3QgcGF5bG9hZCA9IGRlY29kZUp3dCh0b2tlbik7XG4gICAgICAgIHJldHVybiAhIXBheWxvYWQuc3ViO1xuICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgbG9nZ2VyLmVycm9yKFwiRmFpbGVkIHRvIHZlcmlmeSBQYXlQYWwgSUQgdG9rZW46XCIsIGVycm9yKTtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfVxuICAgIH0sXG4gICAgYXN5bmMgZ2V0VXNlckluZm8odG9rZW4pIHtcbiAgICAgIGlmIChvcHRpb25zLmdldFVzZXJJbmZvKSB7XG4gICAgICAgIHJldHVybiBvcHRpb25zLmdldFVzZXJJbmZvKHRva2VuKTtcbiAgICAgIH1cbiAgICAgIGlmICghdG9rZW4uYWNjZXNzVG9rZW4pIHtcbiAgICAgICAgbG9nZ2VyLmVycm9yKFwiQWNjZXNzIHRva2VuIGlzIHJlcXVpcmVkIHRvIGZldGNoIFBheVBhbCB1c2VyIGluZm9cIik7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgICAgfVxuICAgICAgdHJ5IHtcbiAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBiZXR0ZXJGZXRjaChcbiAgICAgICAgICBgJHt1c2VySW5mb0VuZHBvaW50fT9zY2hlbWE9cGF5cGFsdjEuMWAsXG4gICAgICAgICAge1xuICAgICAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICAgICBBdXRob3JpemF0aW9uOiBgQmVhcmVyICR7dG9rZW4uYWNjZXNzVG9rZW59YCxcbiAgICAgICAgICAgICAgQWNjZXB0OiBcImFwcGxpY2F0aW9uL2pzb25cIlxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgKTtcbiAgICAgICAgaWYgKCFyZXNwb25zZS5kYXRhKSB7XG4gICAgICAgICAgbG9nZ2VyLmVycm9yKFwiRmFpbGVkIHRvIGZldGNoIHVzZXIgaW5mbyBmcm9tIFBheVBhbFwiKTtcbiAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCB1c2VySW5mbyA9IHJlc3BvbnNlLmRhdGE7XG4gICAgICAgIGNvbnN0IHVzZXJNYXAgPSBhd2FpdCBvcHRpb25zLm1hcFByb2ZpbGVUb1VzZXI/Lih1c2VySW5mbyk7XG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IHtcbiAgICAgICAgICB1c2VyOiB7XG4gICAgICAgICAgICBpZDogdXNlckluZm8udXNlcl9pZCxcbiAgICAgICAgICAgIG5hbWU6IHVzZXJJbmZvLm5hbWUsXG4gICAgICAgICAgICBlbWFpbDogdXNlckluZm8uZW1haWwsXG4gICAgICAgICAgICBpbWFnZTogdXNlckluZm8ucGljdHVyZSxcbiAgICAgICAgICAgIGVtYWlsVmVyaWZpZWQ6IHVzZXJJbmZvLmVtYWlsX3ZlcmlmaWVkLFxuICAgICAgICAgICAgLi4udXNlck1hcFxuICAgICAgICAgIH0sXG4gICAgICAgICAgZGF0YTogdXNlckluZm9cbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIGxvZ2dlci5lcnJvcihcIkZhaWxlZCB0byBmZXRjaCB1c2VyIGluZm8gZnJvbSBQYXlQYWw6XCIsIGVycm9yKTtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICB9XG4gICAgfSxcbiAgICBvcHRpb25zXG4gIH07XG59O1xuXG5jb25zdCBzb2NpYWxQcm92aWRlcnMgPSB7XG4gIGFwcGxlLFxuICBhdGxhc3NpYW4sXG4gIGNvZ25pdG8sXG4gIGRpc2NvcmQsXG4gIGZhY2Vib29rLFxuICBmaWdtYSxcbiAgZ2l0aHViLFxuICBtaWNyb3NvZnQsXG4gIGdvb2dsZSxcbiAgaHVnZ2luZ2ZhY2UsXG4gIHNsYWNrLFxuICBzcG90aWZ5LFxuICB0d2l0Y2gsXG4gIHR3aXR0ZXIsXG4gIGRyb3Bib3gsXG4gIGtpY2ssXG4gIGxpbmVhcixcbiAgbGlua2VkaW4sXG4gIGdpdGxhYixcbiAgdGlrdG9rLFxuICByZWRkaXQsXG4gIHJvYmxveCxcbiAgc2FsZXNmb3JjZSxcbiAgdmssXG4gIHpvb20sXG4gIG5vdGlvbixcbiAga2FrYW8sXG4gIG5hdmVyLFxuICBsaW5lLFxuICBwYXlwYWxcbn07XG5jb25zdCBzb2NpYWxQcm92aWRlckxpc3QgPSBPYmplY3Qua2V5cyhzb2NpYWxQcm92aWRlcnMpO1xuY29uc3QgU29jaWFsUHJvdmlkZXJMaXN0RW51bSA9IHouZW51bShzb2NpYWxQcm92aWRlckxpc3QpLm9yKHouc3RyaW5nKCkpO1xuXG5leHBvcnQgeyBTb2NpYWxQcm92aWRlckxpc3RFbnVtLCBhcHBsZSwgYXRsYXNzaWFuLCBjb2duaXRvLCBkaXNjb3JkLCBkcm9wYm94LCBmYWNlYm9vaywgZmlnbWEsIGdldEFwcGxlUHVibGljS2V5LCBnZXRDb2duaXRvUHVibGljS2V5LCBnaXRodWIsIGdpdGxhYiwgZ29vZ2xlLCBodWdnaW5nZmFjZSwga2FrYW8sIGtpY2ssIGxpbmUsIGxpbmVhciwgbGlua2VkaW4sIG1pY3Jvc29mdCwgbmF2ZXIsIG5vdGlvbiwgcGF5cGFsLCByZWRkaXQsIHJvYmxveCwgc2FsZXNmb3JjZSwgc2xhY2ssIHNvY2lhbFByb3ZpZGVyTGlzdCwgc29jaWFsUHJvdmlkZXJzLCBzcG90aWZ5LCB0aWt0b2ssIHR3aXRjaCwgdHdpdHRlciwgdmssIHpvb20gfTtcbiJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOlswXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/@better-auth/core/dist/social-providers/index.mjs\n");

/***/ }),

/***/ "(rsc)/./node_modules/@better-auth/core/dist/utils/index.mjs":
/*!*************************************************************!*\
  !*** ./node_modules/@better-auth/core/dist/utils/index.mjs ***!
  \*************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   defineErrorCodes: () => (/* binding */ defineErrorCodes)\n/* harmony export */ });\nfunction defineErrorCodes(codes) {\n  return codes;\n}\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvQGJldHRlci1hdXRoL2NvcmUvZGlzdC91dGlscy9pbmRleC5tanMiLCJtYXBwaW5ncyI6Ijs7OztBQUFBO0FBQ0E7QUFDQTs7QUFFNEIiLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcc2lkMDFcXE9uZURyaXZlXFxEZXNrdG9wXFxhbWQtdGVsZXBob255LXN5c3RlbVxcZnJvbnRlbmRcXG5vZGVfbW9kdWxlc1xcQGJldHRlci1hdXRoXFxjb3JlXFxkaXN0XFx1dGlsc1xcaW5kZXgubWpzIl0sInNvdXJjZXNDb250ZW50IjpbImZ1bmN0aW9uIGRlZmluZUVycm9yQ29kZXMoY29kZXMpIHtcbiAgcmV0dXJuIGNvZGVzO1xufVxuXG5leHBvcnQgeyBkZWZpbmVFcnJvckNvZGVzIH07XG4iXSwibmFtZXMiOltdLCJpZ25vcmVMaXN0IjpbMF0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/@better-auth/core/dist/utils/index.mjs\n");

/***/ }),

/***/ "(rsc)/./node_modules/@better-auth/telemetry/dist/index.mjs":
/*!************************************************************!*\
  !*** ./node_modules/@better-auth/telemetry/dist/index.mjs ***!
  \************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createTelemetry: () => (/* binding */ createTelemetry),\n/* harmony export */   getTelemetryAuthConfig: () => (/* binding */ getTelemetryAuthConfig)\n/* harmony export */ });\n/* harmony import */ var _better_auth_core_env__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @better-auth/core/env */ \"(rsc)/./node_modules/@better-auth/core/dist/env/index.mjs\");\n/* harmony import */ var _better_auth_utils_random__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @better-auth/utils/random */ \"(rsc)/./node_modules/@better-auth/utils/dist/random.mjs\");\n/* harmony import */ var _better_auth_utils_hash__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @better-auth/utils/hash */ \"(rsc)/./node_modules/@better-auth/utils/dist/hash.mjs\");\n/* harmony import */ var _better_auth_utils_base64__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @better-auth/utils/base64 */ \"(rsc)/./node_modules/@better-auth/utils/dist/base64.mjs\");\n/* harmony import */ var _better_fetch_fetch__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @better-fetch/fetch */ \"(rsc)/./node_modules/@better-fetch/fetch/dist/index.js\");\n\n\n\n\n\n\nconst generateId = (size) => {\n  return (0,_better_auth_utils_random__WEBPACK_IMPORTED_MODULE_1__.createRandomStringGenerator)(\"a-z\", \"A-Z\", \"0-9\")(size);\n};\n\nasync function hashToBase64(data) {\n  const buffer = await (0,_better_auth_utils_hash__WEBPACK_IMPORTED_MODULE_2__.createHash)(\"SHA-256\").digest(data);\n  return _better_auth_utils_base64__WEBPACK_IMPORTED_MODULE_3__.base64.encode(buffer);\n}\n\nlet packageJSONCache;\nasync function readRootPackageJson() {\n  if (packageJSONCache) return packageJSONCache;\n  try {\n    const cwd = typeof process !== \"undefined\" && typeof process.cwd === \"function\" ? process.cwd() : \"\";\n    if (!cwd) return void 0;\n    const importRuntime = (m) => Function(\"mm\", \"return import(mm)\")(m);\n    const [{ default: fs }, { default: path }] = await Promise.all([\n      importRuntime(\"fs/promises\"),\n      importRuntime(\"path\")\n    ]);\n    const raw = await fs.readFile(path.join(cwd, \"package.json\"), \"utf-8\");\n    packageJSONCache = JSON.parse(raw);\n    return packageJSONCache;\n  } catch {\n  }\n  return void 0;\n}\nasync function getPackageVersion(pkg) {\n  if (packageJSONCache) {\n    return packageJSONCache.dependencies?.[pkg] || packageJSONCache.devDependencies?.[pkg] || packageJSONCache.peerDependencies?.[pkg];\n  }\n  try {\n    const cwd = typeof process !== \"undefined\" && typeof process.cwd === \"function\" ? process.cwd() : \"\";\n    if (!cwd) throw new Error(\"no-cwd\");\n    const importRuntime = (m) => Function(\"mm\", \"return import(mm)\")(m);\n    const [{ default: fs }, { default: path }] = await Promise.all([\n      importRuntime(\"fs/promises\"),\n      importRuntime(\"path\")\n    ]);\n    const pkgJsonPath = path.join(cwd, \"node_modules\", pkg, \"package.json\");\n    const raw = await fs.readFile(pkgJsonPath, \"utf-8\");\n    const json = JSON.parse(raw);\n    const resolved = json.version || await getVersionFromLocalPackageJson(pkg) || void 0;\n    return resolved;\n  } catch {\n  }\n  const fromRoot = await getVersionFromLocalPackageJson(pkg);\n  return fromRoot;\n}\nasync function getVersionFromLocalPackageJson(pkg) {\n  const json = await readRootPackageJson();\n  if (!json) return void 0;\n  const allDeps = {\n    ...json.dependencies,\n    ...json.devDependencies,\n    ...json.peerDependencies\n  };\n  return allDeps[pkg];\n}\nasync function getNameFromLocalPackageJson() {\n  const json = await readRootPackageJson();\n  return json?.name;\n}\n\nlet projectIdCached = null;\nasync function getProjectId(baseUrl) {\n  if (projectIdCached) return projectIdCached;\n  const projectName = await getNameFromLocalPackageJson();\n  if (projectName) {\n    projectIdCached = await hashToBase64(\n      baseUrl ? baseUrl + projectName : projectName\n    );\n    return projectIdCached;\n  }\n  if (baseUrl) {\n    projectIdCached = await hashToBase64(baseUrl);\n    return projectIdCached;\n  }\n  projectIdCached = generateId(32);\n  return projectIdCached;\n}\n\nconst importRuntime = (m) => {\n  return Function(\"mm\", \"return import(mm)\")(m);\n};\n\nfunction getVendor() {\n  const hasAny = (...keys) => keys.some((k) => Boolean(_better_auth_core_env__WEBPACK_IMPORTED_MODULE_0__.env[k]));\n  if (hasAny(\"CF_PAGES\", \"CF_PAGES_URL\", \"CF_ACCOUNT_ID\") || typeof navigator !== \"undefined\" && navigator.userAgent === \"Cloudflare-Workers\") {\n    return \"cloudflare\";\n  }\n  if (hasAny(\"VERCEL\", \"VERCEL_URL\", \"VERCEL_ENV\")) return \"vercel\";\n  if (hasAny(\"NETLIFY\", \"NETLIFY_URL\")) return \"netlify\";\n  if (hasAny(\n    \"RENDER\",\n    \"RENDER_URL\",\n    \"RENDER_INTERNAL_HOSTNAME\",\n    \"RENDER_SERVICE_ID\"\n  )) {\n    return \"render\";\n  }\n  if (hasAny(\"AWS_LAMBDA_FUNCTION_NAME\", \"AWS_EXECUTION_ENV\", \"LAMBDA_TASK_ROOT\")) {\n    return \"aws\";\n  }\n  if (hasAny(\n    \"GOOGLE_CLOUD_FUNCTION_NAME\",\n    \"GOOGLE_CLOUD_PROJECT\",\n    \"GCP_PROJECT\",\n    \"K_SERVICE\"\n  )) {\n    return \"gcp\";\n  }\n  if (hasAny(\n    \"AZURE_FUNCTION_NAME\",\n    \"FUNCTIONS_WORKER_RUNTIME\",\n    \"WEBSITE_INSTANCE_ID\",\n    \"WEBSITE_SITE_NAME\"\n  )) {\n    return \"azure\";\n  }\n  if (hasAny(\"DENO_DEPLOYMENT_ID\", \"DENO_REGION\")) return \"deno-deploy\";\n  if (hasAny(\"FLY_APP_NAME\", \"FLY_REGION\", \"FLY_ALLOC_ID\")) return \"fly-io\";\n  if (hasAny(\"RAILWAY_STATIC_URL\", \"RAILWAY_ENVIRONMENT_NAME\"))\n    return \"railway\";\n  if (hasAny(\"DYNO\", \"HEROKU_APP_NAME\")) return \"heroku\";\n  if (hasAny(\"DO_DEPLOYMENT_ID\", \"DO_APP_NAME\", \"DIGITALOCEAN\"))\n    return \"digitalocean\";\n  if (hasAny(\"KOYEB\", \"KOYEB_DEPLOYMENT_ID\", \"KOYEB_APP_NAME\")) return \"koyeb\";\n  return null;\n}\nasync function detectSystemInfo() {\n  try {\n    if (getVendor() === \"cloudflare\") return \"cloudflare\";\n    const os = await importRuntime(\"os\");\n    const cpus = os.cpus();\n    return {\n      deploymentVendor: getVendor(),\n      systemPlatform: os.platform(),\n      systemRelease: os.release(),\n      systemArchitecture: os.arch(),\n      cpuCount: cpus.length,\n      cpuModel: cpus.length ? cpus[0].model : null,\n      cpuSpeed: cpus.length ? cpus[0].speed : null,\n      memory: os.totalmem(),\n      isWSL: await isWsl(),\n      isDocker: await isDocker(),\n      isTTY: typeof process !== \"undefined\" && process.stdout ? process.stdout.isTTY : null\n    };\n  } catch (e) {\n    return {\n      systemPlatform: null,\n      systemRelease: null,\n      systemArchitecture: null,\n      cpuCount: null,\n      cpuModel: null,\n      cpuSpeed: null,\n      memory: null,\n      isWSL: null,\n      isDocker: null,\n      isTTY: null\n    };\n  }\n}\nlet isDockerCached;\nasync function hasDockerEnv() {\n  if (getVendor() === \"cloudflare\") return false;\n  try {\n    const fs = await importRuntime(\"fs\");\n    fs.statSync(\"/.dockerenv\");\n    return true;\n  } catch {\n    return false;\n  }\n}\nasync function hasDockerCGroup() {\n  if (getVendor() === \"cloudflare\") return false;\n  try {\n    const fs = await importRuntime(\"fs\");\n    return fs.readFileSync(\"/proc/self/cgroup\", \"utf8\").includes(\"docker\");\n  } catch {\n    return false;\n  }\n}\nasync function isDocker() {\n  if (getVendor() === \"cloudflare\") return false;\n  if (isDockerCached === void 0) {\n    isDockerCached = await hasDockerEnv() || await hasDockerCGroup();\n  }\n  return isDockerCached;\n}\nasync function isWsl() {\n  try {\n    if (getVendor() === \"cloudflare\") return false;\n    if (typeof process === \"undefined\" || process?.platform !== \"linux\") {\n      return false;\n    }\n    const fs = await importRuntime(\"fs\");\n    const os = await importRuntime(\"os\");\n    if (os.release().toLowerCase().includes(\"microsoft\")) {\n      if (await isInsideContainer()) {\n        return false;\n      }\n      return true;\n    }\n    return fs.readFileSync(\"/proc/version\", \"utf8\").toLowerCase().includes(\"microsoft\") ? !await isInsideContainer() : false;\n  } catch {\n    return false;\n  }\n}\nlet isInsideContainerCached;\nconst hasContainerEnv = async () => {\n  if (getVendor() === \"cloudflare\") return false;\n  try {\n    const fs = await importRuntime(\"fs\");\n    fs.statSync(\"/run/.containerenv\");\n    return true;\n  } catch {\n    return false;\n  }\n};\nasync function isInsideContainer() {\n  if (isInsideContainerCached === void 0) {\n    isInsideContainerCached = await hasContainerEnv() || await isDocker();\n  }\n  return isInsideContainerCached;\n}\nfunction isCI() {\n  return _better_auth_core_env__WEBPACK_IMPORTED_MODULE_0__.env.CI !== \"false\" && (\"BUILD_ID\" in _better_auth_core_env__WEBPACK_IMPORTED_MODULE_0__.env || // Jenkins, Cloudbees\n  \"BUILD_NUMBER\" in _better_auth_core_env__WEBPACK_IMPORTED_MODULE_0__.env || // Jenkins, TeamCity (fixed typo: extra space removed)\n  \"CI\" in _better_auth_core_env__WEBPACK_IMPORTED_MODULE_0__.env || // Travis CI, CircleCI, Cirrus CI, Gitlab CI, Appveyor, CodeShip, dsari, Cloudflare\n  \"CI_APP_ID\" in _better_auth_core_env__WEBPACK_IMPORTED_MODULE_0__.env || // Appflow\n  \"CI_BUILD_ID\" in _better_auth_core_env__WEBPACK_IMPORTED_MODULE_0__.env || // Appflow\n  \"CI_BUILD_NUMBER\" in _better_auth_core_env__WEBPACK_IMPORTED_MODULE_0__.env || // Appflow\n  \"CI_NAME\" in _better_auth_core_env__WEBPACK_IMPORTED_MODULE_0__.env || // Codeship and others\n  \"CONTINUOUS_INTEGRATION\" in _better_auth_core_env__WEBPACK_IMPORTED_MODULE_0__.env || // Travis CI, Cirrus CI\n  \"RUN_ID\" in _better_auth_core_env__WEBPACK_IMPORTED_MODULE_0__.env);\n}\n\nfunction detectRuntime() {\n  if (typeof Deno !== \"undefined\") {\n    const denoVersion = Deno?.version?.deno ?? null;\n    return { name: \"deno\", version: denoVersion };\n  }\n  if (typeof Bun !== \"undefined\") {\n    const bunVersion = Bun?.version ?? null;\n    return { name: \"bun\", version: bunVersion };\n  }\n  if (typeof process !== \"undefined\" && process?.versions?.node) {\n    return { name: \"node\", version: process.versions.node ?? null };\n  }\n  return { name: \"edge\", version: null };\n}\nfunction detectEnvironment() {\n  return (0,_better_auth_core_env__WEBPACK_IMPORTED_MODULE_0__.getEnvVar)(\"NODE_ENV\") === \"production\" ? \"production\" : isCI() ? \"ci\" : (0,_better_auth_core_env__WEBPACK_IMPORTED_MODULE_0__.isTest)() ? \"test\" : \"development\";\n}\n\nconst DATABASES = {\n  pg: \"postgresql\",\n  mysql: \"mysql\",\n  mariadb: \"mariadb\",\n  sqlite3: \"sqlite\",\n  \"better-sqlite3\": \"sqlite\",\n  \"@prisma/client\": \"prisma\",\n  mongoose: \"mongodb\",\n  mongodb: \"mongodb\",\n  \"drizzle-orm\": \"drizzle\"\n};\nasync function detectDatabase() {\n  for (const [pkg, name] of Object.entries(DATABASES)) {\n    const version = await getPackageVersion(pkg);\n    if (version) return { name, version };\n  }\n  return void 0;\n}\n\nconst FRAMEWORKS = {\n  next: \"next\",\n  nuxt: \"nuxt\",\n  \"@remix-run/server-runtime\": \"remix\",\n  astro: \"astro\",\n  \"@sveltejs/kit\": \"sveltekit\",\n  \"solid-start\": \"solid-start\",\n  \"tanstack-start\": \"tanstack-start\",\n  hono: \"hono\",\n  express: \"express\",\n  elysia: \"elysia\",\n  expo: \"expo\"\n};\nasync function detectFramework() {\n  for (const [pkg, name] of Object.entries(FRAMEWORKS)) {\n    const version = await getPackageVersion(pkg);\n    if (version) return { name, version };\n  }\n  return void 0;\n}\n\nfunction detectPackageManager() {\n  const userAgent = _better_auth_core_env__WEBPACK_IMPORTED_MODULE_0__.env.npm_config_user_agent;\n  if (!userAgent) {\n    return void 0;\n  }\n  const pmSpec = userAgent.split(\" \")[0];\n  const separatorPos = pmSpec.lastIndexOf(\"/\");\n  const name = pmSpec.substring(0, separatorPos);\n  return {\n    name: name === \"npminstall\" ? \"cnpm\" : name,\n    version: pmSpec.substring(separatorPos + 1)\n  };\n}\n\nfunction getTelemetryAuthConfig(options, context) {\n  return {\n    database: context?.database,\n    adapter: context?.adapter,\n    emailVerification: {\n      sendVerificationEmail: !!options.emailVerification?.sendVerificationEmail,\n      sendOnSignUp: !!options.emailVerification?.sendOnSignUp,\n      sendOnSignIn: !!options.emailVerification?.sendOnSignIn,\n      autoSignInAfterVerification: !!options.emailVerification?.autoSignInAfterVerification,\n      expiresIn: options.emailVerification?.expiresIn,\n      onEmailVerification: !!options.emailVerification?.onEmailVerification,\n      afterEmailVerification: !!options.emailVerification?.afterEmailVerification\n    },\n    emailAndPassword: {\n      enabled: !!options.emailAndPassword?.enabled,\n      disableSignUp: !!options.emailAndPassword?.disableSignUp,\n      requireEmailVerification: !!options.emailAndPassword?.requireEmailVerification,\n      maxPasswordLength: options.emailAndPassword?.maxPasswordLength,\n      minPasswordLength: options.emailAndPassword?.minPasswordLength,\n      sendResetPassword: !!options.emailAndPassword?.sendResetPassword,\n      resetPasswordTokenExpiresIn: options.emailAndPassword?.resetPasswordTokenExpiresIn,\n      onPasswordReset: !!options.emailAndPassword?.onPasswordReset,\n      password: {\n        hash: !!options.emailAndPassword?.password?.hash,\n        verify: !!options.emailAndPassword?.password?.verify\n      },\n      autoSignIn: !!options.emailAndPassword?.autoSignIn,\n      revokeSessionsOnPasswordReset: !!options.emailAndPassword?.revokeSessionsOnPasswordReset\n    },\n    socialProviders: Object.keys(options.socialProviders || {}).map((p) => {\n      const provider = options.socialProviders?.[p];\n      if (!provider) return {};\n      return {\n        id: p,\n        mapProfileToUser: !!provider.mapProfileToUser,\n        disableDefaultScope: !!provider.disableDefaultScope,\n        disableIdTokenSignIn: !!provider.disableIdTokenSignIn,\n        disableImplicitSignUp: provider.disableImplicitSignUp,\n        disableSignUp: provider.disableSignUp,\n        getUserInfo: !!provider.getUserInfo,\n        overrideUserInfoOnSignIn: !!provider.overrideUserInfoOnSignIn,\n        prompt: provider.prompt,\n        verifyIdToken: !!provider.verifyIdToken,\n        scope: provider.scope,\n        refreshAccessToken: !!provider.refreshAccessToken\n      };\n    }),\n    plugins: options.plugins?.map((p) => p.id.toString()),\n    user: {\n      modelName: options.user?.modelName,\n      fields: options.user?.fields,\n      additionalFields: options.user?.additionalFields,\n      changeEmail: {\n        enabled: options.user?.changeEmail?.enabled,\n        sendChangeEmailVerification: !!options.user?.changeEmail?.sendChangeEmailVerification\n      }\n    },\n    verification: {\n      modelName: options.verification?.modelName,\n      disableCleanup: options.verification?.disableCleanup,\n      fields: options.verification?.fields\n    },\n    session: {\n      modelName: options.session?.modelName,\n      additionalFields: options.session?.additionalFields,\n      cookieCache: {\n        enabled: options.session?.cookieCache?.enabled,\n        maxAge: options.session?.cookieCache?.maxAge\n      },\n      disableSessionRefresh: options.session?.disableSessionRefresh,\n      expiresIn: options.session?.expiresIn,\n      fields: options.session?.fields,\n      freshAge: options.session?.freshAge,\n      preserveSessionInDatabase: options.session?.preserveSessionInDatabase,\n      storeSessionInDatabase: options.session?.storeSessionInDatabase,\n      updateAge: options.session?.updateAge\n    },\n    account: {\n      modelName: options.account?.modelName,\n      fields: options.account?.fields,\n      encryptOAuthTokens: options.account?.encryptOAuthTokens,\n      updateAccountOnSignIn: options.account?.updateAccountOnSignIn,\n      accountLinking: {\n        enabled: options.account?.accountLinking?.enabled,\n        trustedProviders: options.account?.accountLinking?.trustedProviders,\n        updateUserInfoOnLink: options.account?.accountLinking?.updateUserInfoOnLink,\n        allowUnlinkingAll: options.account?.accountLinking?.allowUnlinkingAll\n      }\n    },\n    hooks: {\n      after: !!options.hooks?.after,\n      before: !!options.hooks?.before\n    },\n    secondaryStorage: !!options.secondaryStorage,\n    advanced: {\n      cookiePrefix: !!options.advanced?.cookiePrefix,\n      //this shouldn't be tracked\n      cookies: !!options.advanced?.cookies,\n      crossSubDomainCookies: {\n        domain: !!options.advanced?.crossSubDomainCookies?.domain,\n        enabled: options.advanced?.crossSubDomainCookies?.enabled,\n        additionalCookies: options.advanced?.crossSubDomainCookies?.additionalCookies\n      },\n      database: {\n        useNumberId: !!options.advanced?.database?.useNumberId,\n        generateId: options.advanced?.database?.generateId,\n        defaultFindManyLimit: options.advanced?.database?.defaultFindManyLimit\n      },\n      useSecureCookies: options.advanced?.useSecureCookies,\n      ipAddress: {\n        disableIpTracking: options.advanced?.ipAddress?.disableIpTracking,\n        ipAddressHeaders: options.advanced?.ipAddress?.ipAddressHeaders\n      },\n      disableCSRFCheck: options.advanced?.disableCSRFCheck,\n      cookieAttributes: {\n        expires: options.advanced?.defaultCookieAttributes?.expires,\n        secure: options.advanced?.defaultCookieAttributes?.secure,\n        sameSite: options.advanced?.defaultCookieAttributes?.sameSite,\n        domain: !!options.advanced?.defaultCookieAttributes?.domain,\n        path: options.advanced?.defaultCookieAttributes?.path,\n        httpOnly: options.advanced?.defaultCookieAttributes?.httpOnly\n      }\n    },\n    trustedOrigins: options.trustedOrigins?.length,\n    rateLimit: {\n      storage: options.rateLimit?.storage,\n      modelName: options.rateLimit?.modelName,\n      window: options.rateLimit?.window,\n      customStorage: !!options.rateLimit?.customStorage,\n      enabled: options.rateLimit?.enabled,\n      max: options.rateLimit?.max\n    },\n    onAPIError: {\n      errorURL: options.onAPIError?.errorURL,\n      onError: !!options.onAPIError?.onError,\n      throw: options.onAPIError?.throw\n    },\n    logger: {\n      disabled: options.logger?.disabled,\n      level: options.logger?.level,\n      log: !!options.logger?.log\n    },\n    databaseHooks: {\n      user: {\n        create: {\n          after: !!options.databaseHooks?.user?.create?.after,\n          before: !!options.databaseHooks?.user?.create?.before\n        },\n        update: {\n          after: !!options.databaseHooks?.user?.update?.after,\n          before: !!options.databaseHooks?.user?.update?.before\n        }\n      },\n      session: {\n        create: {\n          after: !!options.databaseHooks?.session?.create?.after,\n          before: !!options.databaseHooks?.session?.create?.before\n        },\n        update: {\n          after: !!options.databaseHooks?.session?.update?.after,\n          before: !!options.databaseHooks?.session?.update?.before\n        }\n      },\n      account: {\n        create: {\n          after: !!options.databaseHooks?.account?.create?.after,\n          before: !!options.databaseHooks?.account?.create?.before\n        },\n        update: {\n          after: !!options.databaseHooks?.account?.update?.after,\n          before: !!options.databaseHooks?.account?.update?.before\n        }\n      },\n      verification: {\n        create: {\n          after: !!options.databaseHooks?.verification?.create?.after,\n          before: !!options.databaseHooks?.verification?.create?.before\n        },\n        update: {\n          after: !!options.databaseHooks?.verification?.update?.after,\n          before: !!options.databaseHooks?.verification?.update?.before\n        }\n      }\n    }\n  };\n}\n\nasync function createTelemetry(options, context) {\n  const debugEnabled = options.telemetry?.debug || (0,_better_auth_core_env__WEBPACK_IMPORTED_MODULE_0__.getBooleanEnvVar)(\"BETTER_AUTH_TELEMETRY_DEBUG\", false);\n  const TELEMETRY_ENDPOINT = _better_auth_core_env__WEBPACK_IMPORTED_MODULE_0__.ENV.BETTER_AUTH_TELEMETRY_ENDPOINT;\n  const track = async (event) => {\n    try {\n      if (context?.customTrack) {\n        await context.customTrack(event);\n      } else {\n        if (debugEnabled) {\n          await Promise.resolve(\n            _better_auth_core_env__WEBPACK_IMPORTED_MODULE_0__.logger.info(\"telemetry event\", JSON.stringify(event, null, 2))\n          );\n        } else {\n          await (0,_better_fetch_fetch__WEBPACK_IMPORTED_MODULE_4__.betterFetch)(TELEMETRY_ENDPOINT, {\n            method: \"POST\",\n            body: event\n          });\n        }\n      }\n    } catch {\n    }\n  };\n  const isEnabled = async () => {\n    const telemetryEnabled = options.telemetry?.enabled !== void 0 ? options.telemetry.enabled : false;\n    const envEnabled = (0,_better_auth_core_env__WEBPACK_IMPORTED_MODULE_0__.getBooleanEnvVar)(\"BETTER_AUTH_TELEMETRY\", false);\n    return (envEnabled || telemetryEnabled) && (context?.skipTestCheck || !(0,_better_auth_core_env__WEBPACK_IMPORTED_MODULE_0__.isTest)());\n  };\n  const enabled = await isEnabled();\n  let anonymousId;\n  if (enabled) {\n    anonymousId = await getProjectId(options.baseURL);\n    const payload = {\n      config: getTelemetryAuthConfig(options),\n      runtime: detectRuntime(),\n      database: await detectDatabase(),\n      framework: await detectFramework(),\n      environment: detectEnvironment(),\n      systemInfo: await detectSystemInfo(),\n      packageManager: detectPackageManager()\n    };\n    void track({ type: \"init\", payload, anonymousId });\n  }\n  return {\n    publish: async (event) => {\n      if (!enabled) return;\n      if (!anonymousId) {\n        anonymousId = await getProjectId(options.baseURL);\n      }\n      await track({\n        type: event.type,\n        payload: event.payload,\n        anonymousId\n      });\n    }\n  };\n}\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvQGJldHRlci1hdXRoL3RlbGVtZXRyeS9kaXN0L2luZGV4Lm1qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7O0FBQThGO0FBQ3RCO0FBQ25CO0FBQ0Y7QUFDRDs7QUFFbEQ7QUFDQSxTQUFTLHNGQUEyQjtBQUNwQzs7QUFFQTtBQUNBLHVCQUF1QixtRUFBVTtBQUNqQyxTQUFTLDZEQUFNO0FBQ2Y7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhLGFBQWEsSUFBSSxlQUFlO0FBQzdDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYSxhQUFhLElBQUksZUFBZTtBQUM3QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLHVEQUF1RCxzREFBRztBQUMxRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTLHNEQUFHLG9CQUFvQixvRUFBaUI7QUFDakQsRUFBRSx3RUFBcUI7QUFDdkIsRUFBRSw4REFBVztBQUNiLEVBQUUscUVBQWtCO0FBQ3BCLEVBQUUsdUVBQW9CO0FBQ3RCLEVBQUUsMkVBQXdCO0FBQzFCLEVBQUUsbUVBQWdCO0FBQ2xCLEVBQUUsa0ZBQStCO0FBQ2pDLEVBQUUsa0VBQWU7QUFDakI7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQSxTQUFTLGdFQUFTLCtEQUErRCw2REFBTTtBQUN2Rjs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMEJBQTBCO0FBQzFCO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBCQUEwQjtBQUMxQjtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxvQkFBb0Isc0RBQUc7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQSxLQUFLO0FBQ0wsOERBQThEO0FBQzlEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLG1EQUFtRCx1RUFBZ0I7QUFDbkUsNkJBQTZCLHNEQUFHO0FBQ2hDO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBUTtBQUNSO0FBQ0E7QUFDQSxZQUFZLHlEQUFNO0FBQ2xCO0FBQ0EsVUFBVTtBQUNWLGdCQUFnQixnRUFBVztBQUMzQjtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0E7QUFDQSx1QkFBdUIsdUVBQWdCO0FBQ3ZDLDJFQUEyRSw2REFBTTtBQUNqRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCLG9DQUFvQztBQUNyRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTs7QUFFbUQiLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcc2lkMDFcXE9uZURyaXZlXFxEZXNrdG9wXFxhbWQtdGVsZXBob255LXN5c3RlbVxcZnJvbnRlbmRcXG5vZGVfbW9kdWxlc1xcQGJldHRlci1hdXRoXFx0ZWxlbWV0cnlcXGRpc3RcXGluZGV4Lm1qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBlbnYsIGdldEVudlZhciwgaXNUZXN0LCBnZXRCb29sZWFuRW52VmFyLCBFTlYsIGxvZ2dlciB9IGZyb20gJ0BiZXR0ZXItYXV0aC9jb3JlL2Vudic7XG5pbXBvcnQgeyBjcmVhdGVSYW5kb21TdHJpbmdHZW5lcmF0b3IgfSBmcm9tICdAYmV0dGVyLWF1dGgvdXRpbHMvcmFuZG9tJztcbmltcG9ydCB7IGNyZWF0ZUhhc2ggfSBmcm9tICdAYmV0dGVyLWF1dGgvdXRpbHMvaGFzaCc7XG5pbXBvcnQgeyBiYXNlNjQgfSBmcm9tICdAYmV0dGVyLWF1dGgvdXRpbHMvYmFzZTY0JztcbmltcG9ydCB7IGJldHRlckZldGNoIH0gZnJvbSAnQGJldHRlci1mZXRjaC9mZXRjaCc7XG5cbmNvbnN0IGdlbmVyYXRlSWQgPSAoc2l6ZSkgPT4ge1xuICByZXR1cm4gY3JlYXRlUmFuZG9tU3RyaW5nR2VuZXJhdG9yKFwiYS16XCIsIFwiQS1aXCIsIFwiMC05XCIpKHNpemUpO1xufTtcblxuYXN5bmMgZnVuY3Rpb24gaGFzaFRvQmFzZTY0KGRhdGEpIHtcbiAgY29uc3QgYnVmZmVyID0gYXdhaXQgY3JlYXRlSGFzaChcIlNIQS0yNTZcIikuZGlnZXN0KGRhdGEpO1xuICByZXR1cm4gYmFzZTY0LmVuY29kZShidWZmZXIpO1xufVxuXG5sZXQgcGFja2FnZUpTT05DYWNoZTtcbmFzeW5jIGZ1bmN0aW9uIHJlYWRSb290UGFja2FnZUpzb24oKSB7XG4gIGlmIChwYWNrYWdlSlNPTkNhY2hlKSByZXR1cm4gcGFja2FnZUpTT05DYWNoZTtcbiAgdHJ5IHtcbiAgICBjb25zdCBjd2QgPSB0eXBlb2YgcHJvY2VzcyAhPT0gXCJ1bmRlZmluZWRcIiAmJiB0eXBlb2YgcHJvY2Vzcy5jd2QgPT09IFwiZnVuY3Rpb25cIiA/IHByb2Nlc3MuY3dkKCkgOiBcIlwiO1xuICAgIGlmICghY3dkKSByZXR1cm4gdm9pZCAwO1xuICAgIGNvbnN0IGltcG9ydFJ1bnRpbWUgPSAobSkgPT4gRnVuY3Rpb24oXCJtbVwiLCBcInJldHVybiBpbXBvcnQobW0pXCIpKG0pO1xuICAgIGNvbnN0IFt7IGRlZmF1bHQ6IGZzIH0sIHsgZGVmYXVsdDogcGF0aCB9XSA9IGF3YWl0IFByb21pc2UuYWxsKFtcbiAgICAgIGltcG9ydFJ1bnRpbWUoXCJmcy9wcm9taXNlc1wiKSxcbiAgICAgIGltcG9ydFJ1bnRpbWUoXCJwYXRoXCIpXG4gICAgXSk7XG4gICAgY29uc3QgcmF3ID0gYXdhaXQgZnMucmVhZEZpbGUocGF0aC5qb2luKGN3ZCwgXCJwYWNrYWdlLmpzb25cIiksIFwidXRmLThcIik7XG4gICAgcGFja2FnZUpTT05DYWNoZSA9IEpTT04ucGFyc2UocmF3KTtcbiAgICByZXR1cm4gcGFja2FnZUpTT05DYWNoZTtcbiAgfSBjYXRjaCB7XG4gIH1cbiAgcmV0dXJuIHZvaWQgMDtcbn1cbmFzeW5jIGZ1bmN0aW9uIGdldFBhY2thZ2VWZXJzaW9uKHBrZykge1xuICBpZiAocGFja2FnZUpTT05DYWNoZSkge1xuICAgIHJldHVybiBwYWNrYWdlSlNPTkNhY2hlLmRlcGVuZGVuY2llcz8uW3BrZ10gfHwgcGFja2FnZUpTT05DYWNoZS5kZXZEZXBlbmRlbmNpZXM/Lltwa2ddIHx8IHBhY2thZ2VKU09OQ2FjaGUucGVlckRlcGVuZGVuY2llcz8uW3BrZ107XG4gIH1cbiAgdHJ5IHtcbiAgICBjb25zdCBjd2QgPSB0eXBlb2YgcHJvY2VzcyAhPT0gXCJ1bmRlZmluZWRcIiAmJiB0eXBlb2YgcHJvY2Vzcy5jd2QgPT09IFwiZnVuY3Rpb25cIiA/IHByb2Nlc3MuY3dkKCkgOiBcIlwiO1xuICAgIGlmICghY3dkKSB0aHJvdyBuZXcgRXJyb3IoXCJuby1jd2RcIik7XG4gICAgY29uc3QgaW1wb3J0UnVudGltZSA9IChtKSA9PiBGdW5jdGlvbihcIm1tXCIsIFwicmV0dXJuIGltcG9ydChtbSlcIikobSk7XG4gICAgY29uc3QgW3sgZGVmYXVsdDogZnMgfSwgeyBkZWZhdWx0OiBwYXRoIH1dID0gYXdhaXQgUHJvbWlzZS5hbGwoW1xuICAgICAgaW1wb3J0UnVudGltZShcImZzL3Byb21pc2VzXCIpLFxuICAgICAgaW1wb3J0UnVudGltZShcInBhdGhcIilcbiAgICBdKTtcbiAgICBjb25zdCBwa2dKc29uUGF0aCA9IHBhdGguam9pbihjd2QsIFwibm9kZV9tb2R1bGVzXCIsIHBrZywgXCJwYWNrYWdlLmpzb25cIik7XG4gICAgY29uc3QgcmF3ID0gYXdhaXQgZnMucmVhZEZpbGUocGtnSnNvblBhdGgsIFwidXRmLThcIik7XG4gICAgY29uc3QganNvbiA9IEpTT04ucGFyc2UocmF3KTtcbiAgICBjb25zdCByZXNvbHZlZCA9IGpzb24udmVyc2lvbiB8fCBhd2FpdCBnZXRWZXJzaW9uRnJvbUxvY2FsUGFja2FnZUpzb24ocGtnKSB8fCB2b2lkIDA7XG4gICAgcmV0dXJuIHJlc29sdmVkO1xuICB9IGNhdGNoIHtcbiAgfVxuICBjb25zdCBmcm9tUm9vdCA9IGF3YWl0IGdldFZlcnNpb25Gcm9tTG9jYWxQYWNrYWdlSnNvbihwa2cpO1xuICByZXR1cm4gZnJvbVJvb3Q7XG59XG5hc3luYyBmdW5jdGlvbiBnZXRWZXJzaW9uRnJvbUxvY2FsUGFja2FnZUpzb24ocGtnKSB7XG4gIGNvbnN0IGpzb24gPSBhd2FpdCByZWFkUm9vdFBhY2thZ2VKc29uKCk7XG4gIGlmICghanNvbikgcmV0dXJuIHZvaWQgMDtcbiAgY29uc3QgYWxsRGVwcyA9IHtcbiAgICAuLi5qc29uLmRlcGVuZGVuY2llcyxcbiAgICAuLi5qc29uLmRldkRlcGVuZGVuY2llcyxcbiAgICAuLi5qc29uLnBlZXJEZXBlbmRlbmNpZXNcbiAgfTtcbiAgcmV0dXJuIGFsbERlcHNbcGtnXTtcbn1cbmFzeW5jIGZ1bmN0aW9uIGdldE5hbWVGcm9tTG9jYWxQYWNrYWdlSnNvbigpIHtcbiAgY29uc3QganNvbiA9IGF3YWl0IHJlYWRSb290UGFja2FnZUpzb24oKTtcbiAgcmV0dXJuIGpzb24/Lm5hbWU7XG59XG5cbmxldCBwcm9qZWN0SWRDYWNoZWQgPSBudWxsO1xuYXN5bmMgZnVuY3Rpb24gZ2V0UHJvamVjdElkKGJhc2VVcmwpIHtcbiAgaWYgKHByb2plY3RJZENhY2hlZCkgcmV0dXJuIHByb2plY3RJZENhY2hlZDtcbiAgY29uc3QgcHJvamVjdE5hbWUgPSBhd2FpdCBnZXROYW1lRnJvbUxvY2FsUGFja2FnZUpzb24oKTtcbiAgaWYgKHByb2plY3ROYW1lKSB7XG4gICAgcHJvamVjdElkQ2FjaGVkID0gYXdhaXQgaGFzaFRvQmFzZTY0KFxuICAgICAgYmFzZVVybCA/IGJhc2VVcmwgKyBwcm9qZWN0TmFtZSA6IHByb2plY3ROYW1lXG4gICAgKTtcbiAgICByZXR1cm4gcHJvamVjdElkQ2FjaGVkO1xuICB9XG4gIGlmIChiYXNlVXJsKSB7XG4gICAgcHJvamVjdElkQ2FjaGVkID0gYXdhaXQgaGFzaFRvQmFzZTY0KGJhc2VVcmwpO1xuICAgIHJldHVybiBwcm9qZWN0SWRDYWNoZWQ7XG4gIH1cbiAgcHJvamVjdElkQ2FjaGVkID0gZ2VuZXJhdGVJZCgzMik7XG4gIHJldHVybiBwcm9qZWN0SWRDYWNoZWQ7XG59XG5cbmNvbnN0IGltcG9ydFJ1bnRpbWUgPSAobSkgPT4ge1xuICByZXR1cm4gRnVuY3Rpb24oXCJtbVwiLCBcInJldHVybiBpbXBvcnQobW0pXCIpKG0pO1xufTtcblxuZnVuY3Rpb24gZ2V0VmVuZG9yKCkge1xuICBjb25zdCBoYXNBbnkgPSAoLi4ua2V5cykgPT4ga2V5cy5zb21lKChrKSA9PiBCb29sZWFuKGVudltrXSkpO1xuICBpZiAoaGFzQW55KFwiQ0ZfUEFHRVNcIiwgXCJDRl9QQUdFU19VUkxcIiwgXCJDRl9BQ0NPVU5UX0lEXCIpIHx8IHR5cGVvZiBuYXZpZ2F0b3IgIT09IFwidW5kZWZpbmVkXCIgJiYgbmF2aWdhdG9yLnVzZXJBZ2VudCA9PT0gXCJDbG91ZGZsYXJlLVdvcmtlcnNcIikge1xuICAgIHJldHVybiBcImNsb3VkZmxhcmVcIjtcbiAgfVxuICBpZiAoaGFzQW55KFwiVkVSQ0VMXCIsIFwiVkVSQ0VMX1VSTFwiLCBcIlZFUkNFTF9FTlZcIikpIHJldHVybiBcInZlcmNlbFwiO1xuICBpZiAoaGFzQW55KFwiTkVUTElGWVwiLCBcIk5FVExJRllfVVJMXCIpKSByZXR1cm4gXCJuZXRsaWZ5XCI7XG4gIGlmIChoYXNBbnkoXG4gICAgXCJSRU5ERVJcIixcbiAgICBcIlJFTkRFUl9VUkxcIixcbiAgICBcIlJFTkRFUl9JTlRFUk5BTF9IT1NUTkFNRVwiLFxuICAgIFwiUkVOREVSX1NFUlZJQ0VfSURcIlxuICApKSB7XG4gICAgcmV0dXJuIFwicmVuZGVyXCI7XG4gIH1cbiAgaWYgKGhhc0FueShcIkFXU19MQU1CREFfRlVOQ1RJT05fTkFNRVwiLCBcIkFXU19FWEVDVVRJT05fRU5WXCIsIFwiTEFNQkRBX1RBU0tfUk9PVFwiKSkge1xuICAgIHJldHVybiBcImF3c1wiO1xuICB9XG4gIGlmIChoYXNBbnkoXG4gICAgXCJHT09HTEVfQ0xPVURfRlVOQ1RJT05fTkFNRVwiLFxuICAgIFwiR09PR0xFX0NMT1VEX1BST0pFQ1RcIixcbiAgICBcIkdDUF9QUk9KRUNUXCIsXG4gICAgXCJLX1NFUlZJQ0VcIlxuICApKSB7XG4gICAgcmV0dXJuIFwiZ2NwXCI7XG4gIH1cbiAgaWYgKGhhc0FueShcbiAgICBcIkFaVVJFX0ZVTkNUSU9OX05BTUVcIixcbiAgICBcIkZVTkNUSU9OU19XT1JLRVJfUlVOVElNRVwiLFxuICAgIFwiV0VCU0lURV9JTlNUQU5DRV9JRFwiLFxuICAgIFwiV0VCU0lURV9TSVRFX05BTUVcIlxuICApKSB7XG4gICAgcmV0dXJuIFwiYXp1cmVcIjtcbiAgfVxuICBpZiAoaGFzQW55KFwiREVOT19ERVBMT1lNRU5UX0lEXCIsIFwiREVOT19SRUdJT05cIikpIHJldHVybiBcImRlbm8tZGVwbG95XCI7XG4gIGlmIChoYXNBbnkoXCJGTFlfQVBQX05BTUVcIiwgXCJGTFlfUkVHSU9OXCIsIFwiRkxZX0FMTE9DX0lEXCIpKSByZXR1cm4gXCJmbHktaW9cIjtcbiAgaWYgKGhhc0FueShcIlJBSUxXQVlfU1RBVElDX1VSTFwiLCBcIlJBSUxXQVlfRU5WSVJPTk1FTlRfTkFNRVwiKSlcbiAgICByZXR1cm4gXCJyYWlsd2F5XCI7XG4gIGlmIChoYXNBbnkoXCJEWU5PXCIsIFwiSEVST0tVX0FQUF9OQU1FXCIpKSByZXR1cm4gXCJoZXJva3VcIjtcbiAgaWYgKGhhc0FueShcIkRPX0RFUExPWU1FTlRfSURcIiwgXCJET19BUFBfTkFNRVwiLCBcIkRJR0lUQUxPQ0VBTlwiKSlcbiAgICByZXR1cm4gXCJkaWdpdGFsb2NlYW5cIjtcbiAgaWYgKGhhc0FueShcIktPWUVCXCIsIFwiS09ZRUJfREVQTE9ZTUVOVF9JRFwiLCBcIktPWUVCX0FQUF9OQU1FXCIpKSByZXR1cm4gXCJrb3llYlwiO1xuICByZXR1cm4gbnVsbDtcbn1cbmFzeW5jIGZ1bmN0aW9uIGRldGVjdFN5c3RlbUluZm8oKSB7XG4gIHRyeSB7XG4gICAgaWYgKGdldFZlbmRvcigpID09PSBcImNsb3VkZmxhcmVcIikgcmV0dXJuIFwiY2xvdWRmbGFyZVwiO1xuICAgIGNvbnN0IG9zID0gYXdhaXQgaW1wb3J0UnVudGltZShcIm9zXCIpO1xuICAgIGNvbnN0IGNwdXMgPSBvcy5jcHVzKCk7XG4gICAgcmV0dXJuIHtcbiAgICAgIGRlcGxveW1lbnRWZW5kb3I6IGdldFZlbmRvcigpLFxuICAgICAgc3lzdGVtUGxhdGZvcm06IG9zLnBsYXRmb3JtKCksXG4gICAgICBzeXN0ZW1SZWxlYXNlOiBvcy5yZWxlYXNlKCksXG4gICAgICBzeXN0ZW1BcmNoaXRlY3R1cmU6IG9zLmFyY2goKSxcbiAgICAgIGNwdUNvdW50OiBjcHVzLmxlbmd0aCxcbiAgICAgIGNwdU1vZGVsOiBjcHVzLmxlbmd0aCA/IGNwdXNbMF0ubW9kZWwgOiBudWxsLFxuICAgICAgY3B1U3BlZWQ6IGNwdXMubGVuZ3RoID8gY3B1c1swXS5zcGVlZCA6IG51bGwsXG4gICAgICBtZW1vcnk6IG9zLnRvdGFsbWVtKCksXG4gICAgICBpc1dTTDogYXdhaXQgaXNXc2woKSxcbiAgICAgIGlzRG9ja2VyOiBhd2FpdCBpc0RvY2tlcigpLFxuICAgICAgaXNUVFk6IHR5cGVvZiBwcm9jZXNzICE9PSBcInVuZGVmaW5lZFwiICYmIHByb2Nlc3Muc3Rkb3V0ID8gcHJvY2Vzcy5zdGRvdXQuaXNUVFkgOiBudWxsXG4gICAgfTtcbiAgfSBjYXRjaCAoZSkge1xuICAgIHJldHVybiB7XG4gICAgICBzeXN0ZW1QbGF0Zm9ybTogbnVsbCxcbiAgICAgIHN5c3RlbVJlbGVhc2U6IG51bGwsXG4gICAgICBzeXN0ZW1BcmNoaXRlY3R1cmU6IG51bGwsXG4gICAgICBjcHVDb3VudDogbnVsbCxcbiAgICAgIGNwdU1vZGVsOiBudWxsLFxuICAgICAgY3B1U3BlZWQ6IG51bGwsXG4gICAgICBtZW1vcnk6IG51bGwsXG4gICAgICBpc1dTTDogbnVsbCxcbiAgICAgIGlzRG9ja2VyOiBudWxsLFxuICAgICAgaXNUVFk6IG51bGxcbiAgICB9O1xuICB9XG59XG5sZXQgaXNEb2NrZXJDYWNoZWQ7XG5hc3luYyBmdW5jdGlvbiBoYXNEb2NrZXJFbnYoKSB7XG4gIGlmIChnZXRWZW5kb3IoKSA9PT0gXCJjbG91ZGZsYXJlXCIpIHJldHVybiBmYWxzZTtcbiAgdHJ5IHtcbiAgICBjb25zdCBmcyA9IGF3YWl0IGltcG9ydFJ1bnRpbWUoXCJmc1wiKTtcbiAgICBmcy5zdGF0U3luYyhcIi8uZG9ja2VyZW52XCIpO1xuICAgIHJldHVybiB0cnVlO1xuICB9IGNhdGNoIHtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cbn1cbmFzeW5jIGZ1bmN0aW9uIGhhc0RvY2tlckNHcm91cCgpIHtcbiAgaWYgKGdldFZlbmRvcigpID09PSBcImNsb3VkZmxhcmVcIikgcmV0dXJuIGZhbHNlO1xuICB0cnkge1xuICAgIGNvbnN0IGZzID0gYXdhaXQgaW1wb3J0UnVudGltZShcImZzXCIpO1xuICAgIHJldHVybiBmcy5yZWFkRmlsZVN5bmMoXCIvcHJvYy9zZWxmL2Nncm91cFwiLCBcInV0ZjhcIikuaW5jbHVkZXMoXCJkb2NrZXJcIik7XG4gIH0gY2F0Y2gge1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxufVxuYXN5bmMgZnVuY3Rpb24gaXNEb2NrZXIoKSB7XG4gIGlmIChnZXRWZW5kb3IoKSA9PT0gXCJjbG91ZGZsYXJlXCIpIHJldHVybiBmYWxzZTtcbiAgaWYgKGlzRG9ja2VyQ2FjaGVkID09PSB2b2lkIDApIHtcbiAgICBpc0RvY2tlckNhY2hlZCA9IGF3YWl0IGhhc0RvY2tlckVudigpIHx8IGF3YWl0IGhhc0RvY2tlckNHcm91cCgpO1xuICB9XG4gIHJldHVybiBpc0RvY2tlckNhY2hlZDtcbn1cbmFzeW5jIGZ1bmN0aW9uIGlzV3NsKCkge1xuICB0cnkge1xuICAgIGlmIChnZXRWZW5kb3IoKSA9PT0gXCJjbG91ZGZsYXJlXCIpIHJldHVybiBmYWxzZTtcbiAgICBpZiAodHlwZW9mIHByb2Nlc3MgPT09IFwidW5kZWZpbmVkXCIgfHwgcHJvY2Vzcz8ucGxhdGZvcm0gIT09IFwibGludXhcIikge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICBjb25zdCBmcyA9IGF3YWl0IGltcG9ydFJ1bnRpbWUoXCJmc1wiKTtcbiAgICBjb25zdCBvcyA9IGF3YWl0IGltcG9ydFJ1bnRpbWUoXCJvc1wiKTtcbiAgICBpZiAob3MucmVsZWFzZSgpLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoXCJtaWNyb3NvZnRcIikpIHtcbiAgICAgIGlmIChhd2FpdCBpc0luc2lkZUNvbnRhaW5lcigpKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH1cbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgICByZXR1cm4gZnMucmVhZEZpbGVTeW5jKFwiL3Byb2MvdmVyc2lvblwiLCBcInV0ZjhcIikudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhcIm1pY3Jvc29mdFwiKSA/ICFhd2FpdCBpc0luc2lkZUNvbnRhaW5lcigpIDogZmFsc2U7XG4gIH0gY2F0Y2gge1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxufVxubGV0IGlzSW5zaWRlQ29udGFpbmVyQ2FjaGVkO1xuY29uc3QgaGFzQ29udGFpbmVyRW52ID0gYXN5bmMgKCkgPT4ge1xuICBpZiAoZ2V0VmVuZG9yKCkgPT09IFwiY2xvdWRmbGFyZVwiKSByZXR1cm4gZmFsc2U7XG4gIHRyeSB7XG4gICAgY29uc3QgZnMgPSBhd2FpdCBpbXBvcnRSdW50aW1lKFwiZnNcIik7XG4gICAgZnMuc3RhdFN5bmMoXCIvcnVuLy5jb250YWluZXJlbnZcIik7XG4gICAgcmV0dXJuIHRydWU7XG4gIH0gY2F0Y2gge1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxufTtcbmFzeW5jIGZ1bmN0aW9uIGlzSW5zaWRlQ29udGFpbmVyKCkge1xuICBpZiAoaXNJbnNpZGVDb250YWluZXJDYWNoZWQgPT09IHZvaWQgMCkge1xuICAgIGlzSW5zaWRlQ29udGFpbmVyQ2FjaGVkID0gYXdhaXQgaGFzQ29udGFpbmVyRW52KCkgfHwgYXdhaXQgaXNEb2NrZXIoKTtcbiAgfVxuICByZXR1cm4gaXNJbnNpZGVDb250YWluZXJDYWNoZWQ7XG59XG5mdW5jdGlvbiBpc0NJKCkge1xuICByZXR1cm4gZW52LkNJICE9PSBcImZhbHNlXCIgJiYgKFwiQlVJTERfSURcIiBpbiBlbnYgfHwgLy8gSmVua2lucywgQ2xvdWRiZWVzXG4gIFwiQlVJTERfTlVNQkVSXCIgaW4gZW52IHx8IC8vIEplbmtpbnMsIFRlYW1DaXR5IChmaXhlZCB0eXBvOiBleHRyYSBzcGFjZSByZW1vdmVkKVxuICBcIkNJXCIgaW4gZW52IHx8IC8vIFRyYXZpcyBDSSwgQ2lyY2xlQ0ksIENpcnJ1cyBDSSwgR2l0bGFiIENJLCBBcHB2ZXlvciwgQ29kZVNoaXAsIGRzYXJpLCBDbG91ZGZsYXJlXG4gIFwiQ0lfQVBQX0lEXCIgaW4gZW52IHx8IC8vIEFwcGZsb3dcbiAgXCJDSV9CVUlMRF9JRFwiIGluIGVudiB8fCAvLyBBcHBmbG93XG4gIFwiQ0lfQlVJTERfTlVNQkVSXCIgaW4gZW52IHx8IC8vIEFwcGZsb3dcbiAgXCJDSV9OQU1FXCIgaW4gZW52IHx8IC8vIENvZGVzaGlwIGFuZCBvdGhlcnNcbiAgXCJDT05USU5VT1VTX0lOVEVHUkFUSU9OXCIgaW4gZW52IHx8IC8vIFRyYXZpcyBDSSwgQ2lycnVzIENJXG4gIFwiUlVOX0lEXCIgaW4gZW52KTtcbn1cblxuZnVuY3Rpb24gZGV0ZWN0UnVudGltZSgpIHtcbiAgaWYgKHR5cGVvZiBEZW5vICE9PSBcInVuZGVmaW5lZFwiKSB7XG4gICAgY29uc3QgZGVub1ZlcnNpb24gPSBEZW5vPy52ZXJzaW9uPy5kZW5vID8/IG51bGw7XG4gICAgcmV0dXJuIHsgbmFtZTogXCJkZW5vXCIsIHZlcnNpb246IGRlbm9WZXJzaW9uIH07XG4gIH1cbiAgaWYgKHR5cGVvZiBCdW4gIT09IFwidW5kZWZpbmVkXCIpIHtcbiAgICBjb25zdCBidW5WZXJzaW9uID0gQnVuPy52ZXJzaW9uID8/IG51bGw7XG4gICAgcmV0dXJuIHsgbmFtZTogXCJidW5cIiwgdmVyc2lvbjogYnVuVmVyc2lvbiB9O1xuICB9XG4gIGlmICh0eXBlb2YgcHJvY2VzcyAhPT0gXCJ1bmRlZmluZWRcIiAmJiBwcm9jZXNzPy52ZXJzaW9ucz8ubm9kZSkge1xuICAgIHJldHVybiB7IG5hbWU6IFwibm9kZVwiLCB2ZXJzaW9uOiBwcm9jZXNzLnZlcnNpb25zLm5vZGUgPz8gbnVsbCB9O1xuICB9XG4gIHJldHVybiB7IG5hbWU6IFwiZWRnZVwiLCB2ZXJzaW9uOiBudWxsIH07XG59XG5mdW5jdGlvbiBkZXRlY3RFbnZpcm9ubWVudCgpIHtcbiAgcmV0dXJuIGdldEVudlZhcihcIk5PREVfRU5WXCIpID09PSBcInByb2R1Y3Rpb25cIiA/IFwicHJvZHVjdGlvblwiIDogaXNDSSgpID8gXCJjaVwiIDogaXNUZXN0KCkgPyBcInRlc3RcIiA6IFwiZGV2ZWxvcG1lbnRcIjtcbn1cblxuY29uc3QgREFUQUJBU0VTID0ge1xuICBwZzogXCJwb3N0Z3Jlc3FsXCIsXG4gIG15c3FsOiBcIm15c3FsXCIsXG4gIG1hcmlhZGI6IFwibWFyaWFkYlwiLFxuICBzcWxpdGUzOiBcInNxbGl0ZVwiLFxuICBcImJldHRlci1zcWxpdGUzXCI6IFwic3FsaXRlXCIsXG4gIFwiQHByaXNtYS9jbGllbnRcIjogXCJwcmlzbWFcIixcbiAgbW9uZ29vc2U6IFwibW9uZ29kYlwiLFxuICBtb25nb2RiOiBcIm1vbmdvZGJcIixcbiAgXCJkcml6emxlLW9ybVwiOiBcImRyaXp6bGVcIlxufTtcbmFzeW5jIGZ1bmN0aW9uIGRldGVjdERhdGFiYXNlKCkge1xuICBmb3IgKGNvbnN0IFtwa2csIG5hbWVdIG9mIE9iamVjdC5lbnRyaWVzKERBVEFCQVNFUykpIHtcbiAgICBjb25zdCB2ZXJzaW9uID0gYXdhaXQgZ2V0UGFja2FnZVZlcnNpb24ocGtnKTtcbiAgICBpZiAodmVyc2lvbikgcmV0dXJuIHsgbmFtZSwgdmVyc2lvbiB9O1xuICB9XG4gIHJldHVybiB2b2lkIDA7XG59XG5cbmNvbnN0IEZSQU1FV09SS1MgPSB7XG4gIG5leHQ6IFwibmV4dFwiLFxuICBudXh0OiBcIm51eHRcIixcbiAgXCJAcmVtaXgtcnVuL3NlcnZlci1ydW50aW1lXCI6IFwicmVtaXhcIixcbiAgYXN0cm86IFwiYXN0cm9cIixcbiAgXCJAc3ZlbHRlanMva2l0XCI6IFwic3ZlbHRla2l0XCIsXG4gIFwic29saWQtc3RhcnRcIjogXCJzb2xpZC1zdGFydFwiLFxuICBcInRhbnN0YWNrLXN0YXJ0XCI6IFwidGFuc3RhY2stc3RhcnRcIixcbiAgaG9ubzogXCJob25vXCIsXG4gIGV4cHJlc3M6IFwiZXhwcmVzc1wiLFxuICBlbHlzaWE6IFwiZWx5c2lhXCIsXG4gIGV4cG86IFwiZXhwb1wiXG59O1xuYXN5bmMgZnVuY3Rpb24gZGV0ZWN0RnJhbWV3b3JrKCkge1xuICBmb3IgKGNvbnN0IFtwa2csIG5hbWVdIG9mIE9iamVjdC5lbnRyaWVzKEZSQU1FV09SS1MpKSB7XG4gICAgY29uc3QgdmVyc2lvbiA9IGF3YWl0IGdldFBhY2thZ2VWZXJzaW9uKHBrZyk7XG4gICAgaWYgKHZlcnNpb24pIHJldHVybiB7IG5hbWUsIHZlcnNpb24gfTtcbiAgfVxuICByZXR1cm4gdm9pZCAwO1xufVxuXG5mdW5jdGlvbiBkZXRlY3RQYWNrYWdlTWFuYWdlcigpIHtcbiAgY29uc3QgdXNlckFnZW50ID0gZW52Lm5wbV9jb25maWdfdXNlcl9hZ2VudDtcbiAgaWYgKCF1c2VyQWdlbnQpIHtcbiAgICByZXR1cm4gdm9pZCAwO1xuICB9XG4gIGNvbnN0IHBtU3BlYyA9IHVzZXJBZ2VudC5zcGxpdChcIiBcIilbMF07XG4gIGNvbnN0IHNlcGFyYXRvclBvcyA9IHBtU3BlYy5sYXN0SW5kZXhPZihcIi9cIik7XG4gIGNvbnN0IG5hbWUgPSBwbVNwZWMuc3Vic3RyaW5nKDAsIHNlcGFyYXRvclBvcyk7XG4gIHJldHVybiB7XG4gICAgbmFtZTogbmFtZSA9PT0gXCJucG1pbnN0YWxsXCIgPyBcImNucG1cIiA6IG5hbWUsXG4gICAgdmVyc2lvbjogcG1TcGVjLnN1YnN0cmluZyhzZXBhcmF0b3JQb3MgKyAxKVxuICB9O1xufVxuXG5mdW5jdGlvbiBnZXRUZWxlbWV0cnlBdXRoQ29uZmlnKG9wdGlvbnMsIGNvbnRleHQpIHtcbiAgcmV0dXJuIHtcbiAgICBkYXRhYmFzZTogY29udGV4dD8uZGF0YWJhc2UsXG4gICAgYWRhcHRlcjogY29udGV4dD8uYWRhcHRlcixcbiAgICBlbWFpbFZlcmlmaWNhdGlvbjoge1xuICAgICAgc2VuZFZlcmlmaWNhdGlvbkVtYWlsOiAhIW9wdGlvbnMuZW1haWxWZXJpZmljYXRpb24/LnNlbmRWZXJpZmljYXRpb25FbWFpbCxcbiAgICAgIHNlbmRPblNpZ25VcDogISFvcHRpb25zLmVtYWlsVmVyaWZpY2F0aW9uPy5zZW5kT25TaWduVXAsXG4gICAgICBzZW5kT25TaWduSW46ICEhb3B0aW9ucy5lbWFpbFZlcmlmaWNhdGlvbj8uc2VuZE9uU2lnbkluLFxuICAgICAgYXV0b1NpZ25JbkFmdGVyVmVyaWZpY2F0aW9uOiAhIW9wdGlvbnMuZW1haWxWZXJpZmljYXRpb24/LmF1dG9TaWduSW5BZnRlclZlcmlmaWNhdGlvbixcbiAgICAgIGV4cGlyZXNJbjogb3B0aW9ucy5lbWFpbFZlcmlmaWNhdGlvbj8uZXhwaXJlc0luLFxuICAgICAgb25FbWFpbFZlcmlmaWNhdGlvbjogISFvcHRpb25zLmVtYWlsVmVyaWZpY2F0aW9uPy5vbkVtYWlsVmVyaWZpY2F0aW9uLFxuICAgICAgYWZ0ZXJFbWFpbFZlcmlmaWNhdGlvbjogISFvcHRpb25zLmVtYWlsVmVyaWZpY2F0aW9uPy5hZnRlckVtYWlsVmVyaWZpY2F0aW9uXG4gICAgfSxcbiAgICBlbWFpbEFuZFBhc3N3b3JkOiB7XG4gICAgICBlbmFibGVkOiAhIW9wdGlvbnMuZW1haWxBbmRQYXNzd29yZD8uZW5hYmxlZCxcbiAgICAgIGRpc2FibGVTaWduVXA6ICEhb3B0aW9ucy5lbWFpbEFuZFBhc3N3b3JkPy5kaXNhYmxlU2lnblVwLFxuICAgICAgcmVxdWlyZUVtYWlsVmVyaWZpY2F0aW9uOiAhIW9wdGlvbnMuZW1haWxBbmRQYXNzd29yZD8ucmVxdWlyZUVtYWlsVmVyaWZpY2F0aW9uLFxuICAgICAgbWF4UGFzc3dvcmRMZW5ndGg6IG9wdGlvbnMuZW1haWxBbmRQYXNzd29yZD8ubWF4UGFzc3dvcmRMZW5ndGgsXG4gICAgICBtaW5QYXNzd29yZExlbmd0aDogb3B0aW9ucy5lbWFpbEFuZFBhc3N3b3JkPy5taW5QYXNzd29yZExlbmd0aCxcbiAgICAgIHNlbmRSZXNldFBhc3N3b3JkOiAhIW9wdGlvbnMuZW1haWxBbmRQYXNzd29yZD8uc2VuZFJlc2V0UGFzc3dvcmQsXG4gICAgICByZXNldFBhc3N3b3JkVG9rZW5FeHBpcmVzSW46IG9wdGlvbnMuZW1haWxBbmRQYXNzd29yZD8ucmVzZXRQYXNzd29yZFRva2VuRXhwaXJlc0luLFxuICAgICAgb25QYXNzd29yZFJlc2V0OiAhIW9wdGlvbnMuZW1haWxBbmRQYXNzd29yZD8ub25QYXNzd29yZFJlc2V0LFxuICAgICAgcGFzc3dvcmQ6IHtcbiAgICAgICAgaGFzaDogISFvcHRpb25zLmVtYWlsQW5kUGFzc3dvcmQ/LnBhc3N3b3JkPy5oYXNoLFxuICAgICAgICB2ZXJpZnk6ICEhb3B0aW9ucy5lbWFpbEFuZFBhc3N3b3JkPy5wYXNzd29yZD8udmVyaWZ5XG4gICAgICB9LFxuICAgICAgYXV0b1NpZ25JbjogISFvcHRpb25zLmVtYWlsQW5kUGFzc3dvcmQ/LmF1dG9TaWduSW4sXG4gICAgICByZXZva2VTZXNzaW9uc09uUGFzc3dvcmRSZXNldDogISFvcHRpb25zLmVtYWlsQW5kUGFzc3dvcmQ/LnJldm9rZVNlc3Npb25zT25QYXNzd29yZFJlc2V0XG4gICAgfSxcbiAgICBzb2NpYWxQcm92aWRlcnM6IE9iamVjdC5rZXlzKG9wdGlvbnMuc29jaWFsUHJvdmlkZXJzIHx8IHt9KS5tYXAoKHApID0+IHtcbiAgICAgIGNvbnN0IHByb3ZpZGVyID0gb3B0aW9ucy5zb2NpYWxQcm92aWRlcnM/LltwXTtcbiAgICAgIGlmICghcHJvdmlkZXIpIHJldHVybiB7fTtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIGlkOiBwLFxuICAgICAgICBtYXBQcm9maWxlVG9Vc2VyOiAhIXByb3ZpZGVyLm1hcFByb2ZpbGVUb1VzZXIsXG4gICAgICAgIGRpc2FibGVEZWZhdWx0U2NvcGU6ICEhcHJvdmlkZXIuZGlzYWJsZURlZmF1bHRTY29wZSxcbiAgICAgICAgZGlzYWJsZUlkVG9rZW5TaWduSW46ICEhcHJvdmlkZXIuZGlzYWJsZUlkVG9rZW5TaWduSW4sXG4gICAgICAgIGRpc2FibGVJbXBsaWNpdFNpZ25VcDogcHJvdmlkZXIuZGlzYWJsZUltcGxpY2l0U2lnblVwLFxuICAgICAgICBkaXNhYmxlU2lnblVwOiBwcm92aWRlci5kaXNhYmxlU2lnblVwLFxuICAgICAgICBnZXRVc2VySW5mbzogISFwcm92aWRlci5nZXRVc2VySW5mbyxcbiAgICAgICAgb3ZlcnJpZGVVc2VySW5mb09uU2lnbkluOiAhIXByb3ZpZGVyLm92ZXJyaWRlVXNlckluZm9PblNpZ25JbixcbiAgICAgICAgcHJvbXB0OiBwcm92aWRlci5wcm9tcHQsXG4gICAgICAgIHZlcmlmeUlkVG9rZW46ICEhcHJvdmlkZXIudmVyaWZ5SWRUb2tlbixcbiAgICAgICAgc2NvcGU6IHByb3ZpZGVyLnNjb3BlLFxuICAgICAgICByZWZyZXNoQWNjZXNzVG9rZW46ICEhcHJvdmlkZXIucmVmcmVzaEFjY2Vzc1Rva2VuXG4gICAgICB9O1xuICAgIH0pLFxuICAgIHBsdWdpbnM6IG9wdGlvbnMucGx1Z2lucz8ubWFwKChwKSA9PiBwLmlkLnRvU3RyaW5nKCkpLFxuICAgIHVzZXI6IHtcbiAgICAgIG1vZGVsTmFtZTogb3B0aW9ucy51c2VyPy5tb2RlbE5hbWUsXG4gICAgICBmaWVsZHM6IG9wdGlvbnMudXNlcj8uZmllbGRzLFxuICAgICAgYWRkaXRpb25hbEZpZWxkczogb3B0aW9ucy51c2VyPy5hZGRpdGlvbmFsRmllbGRzLFxuICAgICAgY2hhbmdlRW1haWw6IHtcbiAgICAgICAgZW5hYmxlZDogb3B0aW9ucy51c2VyPy5jaGFuZ2VFbWFpbD8uZW5hYmxlZCxcbiAgICAgICAgc2VuZENoYW5nZUVtYWlsVmVyaWZpY2F0aW9uOiAhIW9wdGlvbnMudXNlcj8uY2hhbmdlRW1haWw/LnNlbmRDaGFuZ2VFbWFpbFZlcmlmaWNhdGlvblxuICAgICAgfVxuICAgIH0sXG4gICAgdmVyaWZpY2F0aW9uOiB7XG4gICAgICBtb2RlbE5hbWU6IG9wdGlvbnMudmVyaWZpY2F0aW9uPy5tb2RlbE5hbWUsXG4gICAgICBkaXNhYmxlQ2xlYW51cDogb3B0aW9ucy52ZXJpZmljYXRpb24/LmRpc2FibGVDbGVhbnVwLFxuICAgICAgZmllbGRzOiBvcHRpb25zLnZlcmlmaWNhdGlvbj8uZmllbGRzXG4gICAgfSxcbiAgICBzZXNzaW9uOiB7XG4gICAgICBtb2RlbE5hbWU6IG9wdGlvbnMuc2Vzc2lvbj8ubW9kZWxOYW1lLFxuICAgICAgYWRkaXRpb25hbEZpZWxkczogb3B0aW9ucy5zZXNzaW9uPy5hZGRpdGlvbmFsRmllbGRzLFxuICAgICAgY29va2llQ2FjaGU6IHtcbiAgICAgICAgZW5hYmxlZDogb3B0aW9ucy5zZXNzaW9uPy5jb29raWVDYWNoZT8uZW5hYmxlZCxcbiAgICAgICAgbWF4QWdlOiBvcHRpb25zLnNlc3Npb24/LmNvb2tpZUNhY2hlPy5tYXhBZ2VcbiAgICAgIH0sXG4gICAgICBkaXNhYmxlU2Vzc2lvblJlZnJlc2g6IG9wdGlvbnMuc2Vzc2lvbj8uZGlzYWJsZVNlc3Npb25SZWZyZXNoLFxuICAgICAgZXhwaXJlc0luOiBvcHRpb25zLnNlc3Npb24/LmV4cGlyZXNJbixcbiAgICAgIGZpZWxkczogb3B0aW9ucy5zZXNzaW9uPy5maWVsZHMsXG4gICAgICBmcmVzaEFnZTogb3B0aW9ucy5zZXNzaW9uPy5mcmVzaEFnZSxcbiAgICAgIHByZXNlcnZlU2Vzc2lvbkluRGF0YWJhc2U6IG9wdGlvbnMuc2Vzc2lvbj8ucHJlc2VydmVTZXNzaW9uSW5EYXRhYmFzZSxcbiAgICAgIHN0b3JlU2Vzc2lvbkluRGF0YWJhc2U6IG9wdGlvbnMuc2Vzc2lvbj8uc3RvcmVTZXNzaW9uSW5EYXRhYmFzZSxcbiAgICAgIHVwZGF0ZUFnZTogb3B0aW9ucy5zZXNzaW9uPy51cGRhdGVBZ2VcbiAgICB9LFxuICAgIGFjY291bnQ6IHtcbiAgICAgIG1vZGVsTmFtZTogb3B0aW9ucy5hY2NvdW50Py5tb2RlbE5hbWUsXG4gICAgICBmaWVsZHM6IG9wdGlvbnMuYWNjb3VudD8uZmllbGRzLFxuICAgICAgZW5jcnlwdE9BdXRoVG9rZW5zOiBvcHRpb25zLmFjY291bnQ/LmVuY3J5cHRPQXV0aFRva2VucyxcbiAgICAgIHVwZGF0ZUFjY291bnRPblNpZ25Jbjogb3B0aW9ucy5hY2NvdW50Py51cGRhdGVBY2NvdW50T25TaWduSW4sXG4gICAgICBhY2NvdW50TGlua2luZzoge1xuICAgICAgICBlbmFibGVkOiBvcHRpb25zLmFjY291bnQ/LmFjY291bnRMaW5raW5nPy5lbmFibGVkLFxuICAgICAgICB0cnVzdGVkUHJvdmlkZXJzOiBvcHRpb25zLmFjY291bnQ/LmFjY291bnRMaW5raW5nPy50cnVzdGVkUHJvdmlkZXJzLFxuICAgICAgICB1cGRhdGVVc2VySW5mb09uTGluazogb3B0aW9ucy5hY2NvdW50Py5hY2NvdW50TGlua2luZz8udXBkYXRlVXNlckluZm9PbkxpbmssXG4gICAgICAgIGFsbG93VW5saW5raW5nQWxsOiBvcHRpb25zLmFjY291bnQ/LmFjY291bnRMaW5raW5nPy5hbGxvd1VubGlua2luZ0FsbFxuICAgICAgfVxuICAgIH0sXG4gICAgaG9va3M6IHtcbiAgICAgIGFmdGVyOiAhIW9wdGlvbnMuaG9va3M/LmFmdGVyLFxuICAgICAgYmVmb3JlOiAhIW9wdGlvbnMuaG9va3M/LmJlZm9yZVxuICAgIH0sXG4gICAgc2Vjb25kYXJ5U3RvcmFnZTogISFvcHRpb25zLnNlY29uZGFyeVN0b3JhZ2UsXG4gICAgYWR2YW5jZWQ6IHtcbiAgICAgIGNvb2tpZVByZWZpeDogISFvcHRpb25zLmFkdmFuY2VkPy5jb29raWVQcmVmaXgsXG4gICAgICAvL3RoaXMgc2hvdWxkbid0IGJlIHRyYWNrZWRcbiAgICAgIGNvb2tpZXM6ICEhb3B0aW9ucy5hZHZhbmNlZD8uY29va2llcyxcbiAgICAgIGNyb3NzU3ViRG9tYWluQ29va2llczoge1xuICAgICAgICBkb21haW46ICEhb3B0aW9ucy5hZHZhbmNlZD8uY3Jvc3NTdWJEb21haW5Db29raWVzPy5kb21haW4sXG4gICAgICAgIGVuYWJsZWQ6IG9wdGlvbnMuYWR2YW5jZWQ/LmNyb3NzU3ViRG9tYWluQ29va2llcz8uZW5hYmxlZCxcbiAgICAgICAgYWRkaXRpb25hbENvb2tpZXM6IG9wdGlvbnMuYWR2YW5jZWQ/LmNyb3NzU3ViRG9tYWluQ29va2llcz8uYWRkaXRpb25hbENvb2tpZXNcbiAgICAgIH0sXG4gICAgICBkYXRhYmFzZToge1xuICAgICAgICB1c2VOdW1iZXJJZDogISFvcHRpb25zLmFkdmFuY2VkPy5kYXRhYmFzZT8udXNlTnVtYmVySWQsXG4gICAgICAgIGdlbmVyYXRlSWQ6IG9wdGlvbnMuYWR2YW5jZWQ/LmRhdGFiYXNlPy5nZW5lcmF0ZUlkLFxuICAgICAgICBkZWZhdWx0RmluZE1hbnlMaW1pdDogb3B0aW9ucy5hZHZhbmNlZD8uZGF0YWJhc2U/LmRlZmF1bHRGaW5kTWFueUxpbWl0XG4gICAgICB9LFxuICAgICAgdXNlU2VjdXJlQ29va2llczogb3B0aW9ucy5hZHZhbmNlZD8udXNlU2VjdXJlQ29va2llcyxcbiAgICAgIGlwQWRkcmVzczoge1xuICAgICAgICBkaXNhYmxlSXBUcmFja2luZzogb3B0aW9ucy5hZHZhbmNlZD8uaXBBZGRyZXNzPy5kaXNhYmxlSXBUcmFja2luZyxcbiAgICAgICAgaXBBZGRyZXNzSGVhZGVyczogb3B0aW9ucy5hZHZhbmNlZD8uaXBBZGRyZXNzPy5pcEFkZHJlc3NIZWFkZXJzXG4gICAgICB9LFxuICAgICAgZGlzYWJsZUNTUkZDaGVjazogb3B0aW9ucy5hZHZhbmNlZD8uZGlzYWJsZUNTUkZDaGVjayxcbiAgICAgIGNvb2tpZUF0dHJpYnV0ZXM6IHtcbiAgICAgICAgZXhwaXJlczogb3B0aW9ucy5hZHZhbmNlZD8uZGVmYXVsdENvb2tpZUF0dHJpYnV0ZXM/LmV4cGlyZXMsXG4gICAgICAgIHNlY3VyZTogb3B0aW9ucy5hZHZhbmNlZD8uZGVmYXVsdENvb2tpZUF0dHJpYnV0ZXM/LnNlY3VyZSxcbiAgICAgICAgc2FtZVNpdGU6IG9wdGlvbnMuYWR2YW5jZWQ/LmRlZmF1bHRDb29raWVBdHRyaWJ1dGVzPy5zYW1lU2l0ZSxcbiAgICAgICAgZG9tYWluOiAhIW9wdGlvbnMuYWR2YW5jZWQ/LmRlZmF1bHRDb29raWVBdHRyaWJ1dGVzPy5kb21haW4sXG4gICAgICAgIHBhdGg6IG9wdGlvbnMuYWR2YW5jZWQ/LmRlZmF1bHRDb29raWVBdHRyaWJ1dGVzPy5wYXRoLFxuICAgICAgICBodHRwT25seTogb3B0aW9ucy5hZHZhbmNlZD8uZGVmYXVsdENvb2tpZUF0dHJpYnV0ZXM/Lmh0dHBPbmx5XG4gICAgICB9XG4gICAgfSxcbiAgICB0cnVzdGVkT3JpZ2luczogb3B0aW9ucy50cnVzdGVkT3JpZ2lucz8ubGVuZ3RoLFxuICAgIHJhdGVMaW1pdDoge1xuICAgICAgc3RvcmFnZTogb3B0aW9ucy5yYXRlTGltaXQ/LnN0b3JhZ2UsXG4gICAgICBtb2RlbE5hbWU6IG9wdGlvbnMucmF0ZUxpbWl0Py5tb2RlbE5hbWUsXG4gICAgICB3aW5kb3c6IG9wdGlvbnMucmF0ZUxpbWl0Py53aW5kb3csXG4gICAgICBjdXN0b21TdG9yYWdlOiAhIW9wdGlvbnMucmF0ZUxpbWl0Py5jdXN0b21TdG9yYWdlLFxuICAgICAgZW5hYmxlZDogb3B0aW9ucy5yYXRlTGltaXQ/LmVuYWJsZWQsXG4gICAgICBtYXg6IG9wdGlvbnMucmF0ZUxpbWl0Py5tYXhcbiAgICB9LFxuICAgIG9uQVBJRXJyb3I6IHtcbiAgICAgIGVycm9yVVJMOiBvcHRpb25zLm9uQVBJRXJyb3I/LmVycm9yVVJMLFxuICAgICAgb25FcnJvcjogISFvcHRpb25zLm9uQVBJRXJyb3I/Lm9uRXJyb3IsXG4gICAgICB0aHJvdzogb3B0aW9ucy5vbkFQSUVycm9yPy50aHJvd1xuICAgIH0sXG4gICAgbG9nZ2VyOiB7XG4gICAgICBkaXNhYmxlZDogb3B0aW9ucy5sb2dnZXI/LmRpc2FibGVkLFxuICAgICAgbGV2ZWw6IG9wdGlvbnMubG9nZ2VyPy5sZXZlbCxcbiAgICAgIGxvZzogISFvcHRpb25zLmxvZ2dlcj8ubG9nXG4gICAgfSxcbiAgICBkYXRhYmFzZUhvb2tzOiB7XG4gICAgICB1c2VyOiB7XG4gICAgICAgIGNyZWF0ZToge1xuICAgICAgICAgIGFmdGVyOiAhIW9wdGlvbnMuZGF0YWJhc2VIb29rcz8udXNlcj8uY3JlYXRlPy5hZnRlcixcbiAgICAgICAgICBiZWZvcmU6ICEhb3B0aW9ucy5kYXRhYmFzZUhvb2tzPy51c2VyPy5jcmVhdGU/LmJlZm9yZVxuICAgICAgICB9LFxuICAgICAgICB1cGRhdGU6IHtcbiAgICAgICAgICBhZnRlcjogISFvcHRpb25zLmRhdGFiYXNlSG9va3M/LnVzZXI/LnVwZGF0ZT8uYWZ0ZXIsXG4gICAgICAgICAgYmVmb3JlOiAhIW9wdGlvbnMuZGF0YWJhc2VIb29rcz8udXNlcj8udXBkYXRlPy5iZWZvcmVcbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIHNlc3Npb246IHtcbiAgICAgICAgY3JlYXRlOiB7XG4gICAgICAgICAgYWZ0ZXI6ICEhb3B0aW9ucy5kYXRhYmFzZUhvb2tzPy5zZXNzaW9uPy5jcmVhdGU/LmFmdGVyLFxuICAgICAgICAgIGJlZm9yZTogISFvcHRpb25zLmRhdGFiYXNlSG9va3M/LnNlc3Npb24/LmNyZWF0ZT8uYmVmb3JlXG4gICAgICAgIH0sXG4gICAgICAgIHVwZGF0ZToge1xuICAgICAgICAgIGFmdGVyOiAhIW9wdGlvbnMuZGF0YWJhc2VIb29rcz8uc2Vzc2lvbj8udXBkYXRlPy5hZnRlcixcbiAgICAgICAgICBiZWZvcmU6ICEhb3B0aW9ucy5kYXRhYmFzZUhvb2tzPy5zZXNzaW9uPy51cGRhdGU/LmJlZm9yZVxuICAgICAgICB9XG4gICAgICB9LFxuICAgICAgYWNjb3VudDoge1xuICAgICAgICBjcmVhdGU6IHtcbiAgICAgICAgICBhZnRlcjogISFvcHRpb25zLmRhdGFiYXNlSG9va3M/LmFjY291bnQ/LmNyZWF0ZT8uYWZ0ZXIsXG4gICAgICAgICAgYmVmb3JlOiAhIW9wdGlvbnMuZGF0YWJhc2VIb29rcz8uYWNjb3VudD8uY3JlYXRlPy5iZWZvcmVcbiAgICAgICAgfSxcbiAgICAgICAgdXBkYXRlOiB7XG4gICAgICAgICAgYWZ0ZXI6ICEhb3B0aW9ucy5kYXRhYmFzZUhvb2tzPy5hY2NvdW50Py51cGRhdGU/LmFmdGVyLFxuICAgICAgICAgIGJlZm9yZTogISFvcHRpb25zLmRhdGFiYXNlSG9va3M/LmFjY291bnQ/LnVwZGF0ZT8uYmVmb3JlXG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgICB2ZXJpZmljYXRpb246IHtcbiAgICAgICAgY3JlYXRlOiB7XG4gICAgICAgICAgYWZ0ZXI6ICEhb3B0aW9ucy5kYXRhYmFzZUhvb2tzPy52ZXJpZmljYXRpb24/LmNyZWF0ZT8uYWZ0ZXIsXG4gICAgICAgICAgYmVmb3JlOiAhIW9wdGlvbnMuZGF0YWJhc2VIb29rcz8udmVyaWZpY2F0aW9uPy5jcmVhdGU/LmJlZm9yZVxuICAgICAgICB9LFxuICAgICAgICB1cGRhdGU6IHtcbiAgICAgICAgICBhZnRlcjogISFvcHRpb25zLmRhdGFiYXNlSG9va3M/LnZlcmlmaWNhdGlvbj8udXBkYXRlPy5hZnRlcixcbiAgICAgICAgICBiZWZvcmU6ICEhb3B0aW9ucy5kYXRhYmFzZUhvb2tzPy52ZXJpZmljYXRpb24/LnVwZGF0ZT8uYmVmb3JlXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH07XG59XG5cbmFzeW5jIGZ1bmN0aW9uIGNyZWF0ZVRlbGVtZXRyeShvcHRpb25zLCBjb250ZXh0KSB7XG4gIGNvbnN0IGRlYnVnRW5hYmxlZCA9IG9wdGlvbnMudGVsZW1ldHJ5Py5kZWJ1ZyB8fCBnZXRCb29sZWFuRW52VmFyKFwiQkVUVEVSX0FVVEhfVEVMRU1FVFJZX0RFQlVHXCIsIGZhbHNlKTtcbiAgY29uc3QgVEVMRU1FVFJZX0VORFBPSU5UID0gRU5WLkJFVFRFUl9BVVRIX1RFTEVNRVRSWV9FTkRQT0lOVDtcbiAgY29uc3QgdHJhY2sgPSBhc3luYyAoZXZlbnQpID0+IHtcbiAgICB0cnkge1xuICAgICAgaWYgKGNvbnRleHQ/LmN1c3RvbVRyYWNrKSB7XG4gICAgICAgIGF3YWl0IGNvbnRleHQuY3VzdG9tVHJhY2soZXZlbnQpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgaWYgKGRlYnVnRW5hYmxlZCkge1xuICAgICAgICAgIGF3YWl0IFByb21pc2UucmVzb2x2ZShcbiAgICAgICAgICAgIGxvZ2dlci5pbmZvKFwidGVsZW1ldHJ5IGV2ZW50XCIsIEpTT04uc3RyaW5naWZ5KGV2ZW50LCBudWxsLCAyKSlcbiAgICAgICAgICApO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGF3YWl0IGJldHRlckZldGNoKFRFTEVNRVRSWV9FTkRQT0lOVCwge1xuICAgICAgICAgICAgbWV0aG9kOiBcIlBPU1RcIixcbiAgICAgICAgICAgIGJvZHk6IGV2ZW50XG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9IGNhdGNoIHtcbiAgICB9XG4gIH07XG4gIGNvbnN0IGlzRW5hYmxlZCA9IGFzeW5jICgpID0+IHtcbiAgICBjb25zdCB0ZWxlbWV0cnlFbmFibGVkID0gb3B0aW9ucy50ZWxlbWV0cnk/LmVuYWJsZWQgIT09IHZvaWQgMCA/IG9wdGlvbnMudGVsZW1ldHJ5LmVuYWJsZWQgOiBmYWxzZTtcbiAgICBjb25zdCBlbnZFbmFibGVkID0gZ2V0Qm9vbGVhbkVudlZhcihcIkJFVFRFUl9BVVRIX1RFTEVNRVRSWVwiLCBmYWxzZSk7XG4gICAgcmV0dXJuIChlbnZFbmFibGVkIHx8IHRlbGVtZXRyeUVuYWJsZWQpICYmIChjb250ZXh0Py5za2lwVGVzdENoZWNrIHx8ICFpc1Rlc3QoKSk7XG4gIH07XG4gIGNvbnN0IGVuYWJsZWQgPSBhd2FpdCBpc0VuYWJsZWQoKTtcbiAgbGV0IGFub255bW91c0lkO1xuICBpZiAoZW5hYmxlZCkge1xuICAgIGFub255bW91c0lkID0gYXdhaXQgZ2V0UHJvamVjdElkKG9wdGlvbnMuYmFzZVVSTCk7XG4gICAgY29uc3QgcGF5bG9hZCA9IHtcbiAgICAgIGNvbmZpZzogZ2V0VGVsZW1ldHJ5QXV0aENvbmZpZyhvcHRpb25zKSxcbiAgICAgIHJ1bnRpbWU6IGRldGVjdFJ1bnRpbWUoKSxcbiAgICAgIGRhdGFiYXNlOiBhd2FpdCBkZXRlY3REYXRhYmFzZSgpLFxuICAgICAgZnJhbWV3b3JrOiBhd2FpdCBkZXRlY3RGcmFtZXdvcmsoKSxcbiAgICAgIGVudmlyb25tZW50OiBkZXRlY3RFbnZpcm9ubWVudCgpLFxuICAgICAgc3lzdGVtSW5mbzogYXdhaXQgZGV0ZWN0U3lzdGVtSW5mbygpLFxuICAgICAgcGFja2FnZU1hbmFnZXI6IGRldGVjdFBhY2thZ2VNYW5hZ2VyKClcbiAgICB9O1xuICAgIHZvaWQgdHJhY2soeyB0eXBlOiBcImluaXRcIiwgcGF5bG9hZCwgYW5vbnltb3VzSWQgfSk7XG4gIH1cbiAgcmV0dXJuIHtcbiAgICBwdWJsaXNoOiBhc3luYyAoZXZlbnQpID0+IHtcbiAgICAgIGlmICghZW5hYmxlZCkgcmV0dXJuO1xuICAgICAgaWYgKCFhbm9ueW1vdXNJZCkge1xuICAgICAgICBhbm9ueW1vdXNJZCA9IGF3YWl0IGdldFByb2plY3RJZChvcHRpb25zLmJhc2VVUkwpO1xuICAgICAgfVxuICAgICAgYXdhaXQgdHJhY2soe1xuICAgICAgICB0eXBlOiBldmVudC50eXBlLFxuICAgICAgICBwYXlsb2FkOiBldmVudC5wYXlsb2FkLFxuICAgICAgICBhbm9ueW1vdXNJZFxuICAgICAgfSk7XG4gICAgfVxuICB9O1xufVxuXG5leHBvcnQgeyBjcmVhdGVUZWxlbWV0cnksIGdldFRlbGVtZXRyeUF1dGhDb25maWcgfTtcbiJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOlswXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/@better-auth/telemetry/dist/index.mjs\n");

/***/ }),

/***/ "(rsc)/./node_modules/@better-auth/utils/dist/base64.mjs":
/*!*********************************************************!*\
  !*** ./node_modules/@better-auth/utils/dist/base64.mjs ***!
  \*********************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   base64: () => (/* binding */ base64),\n/* harmony export */   base64Url: () => (/* binding */ base64Url)\n/* harmony export */ });\nfunction getAlphabet(urlSafe) {\n  return urlSafe ? \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_\" : \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\";\n}\nfunction base64Encode(data, alphabet, padding) {\n  let result = \"\";\n  let buffer = 0;\n  let shift = 0;\n  for (const byte of data) {\n    buffer = buffer << 8 | byte;\n    shift += 8;\n    while (shift >= 6) {\n      shift -= 6;\n      result += alphabet[buffer >> shift & 63];\n    }\n  }\n  if (shift > 0) {\n    result += alphabet[buffer << 6 - shift & 63];\n  }\n  if (padding) {\n    const padCount = (4 - result.length % 4) % 4;\n    result += \"=\".repeat(padCount);\n  }\n  return result;\n}\nfunction base64Decode(data, alphabet) {\n  const decodeMap = /* @__PURE__ */ new Map();\n  for (let i = 0; i < alphabet.length; i++) {\n    decodeMap.set(alphabet[i], i);\n  }\n  const result = [];\n  let buffer = 0;\n  let bitsCollected = 0;\n  for (const char of data) {\n    if (char === \"=\")\n      break;\n    const value = decodeMap.get(char);\n    if (value === void 0) {\n      throw new Error(`Invalid Base64 character: ${char}`);\n    }\n    buffer = buffer << 6 | value;\n    bitsCollected += 6;\n    if (bitsCollected >= 8) {\n      bitsCollected -= 8;\n      result.push(buffer >> bitsCollected & 255);\n    }\n  }\n  return Uint8Array.from(result);\n}\nconst base64 = {\n  encode(data, options = {}) {\n    const alphabet = getAlphabet(false);\n    const buffer = typeof data === \"string\" ? new TextEncoder().encode(data) : new Uint8Array(data);\n    return base64Encode(buffer, alphabet, options.padding ?? true);\n  },\n  decode(data) {\n    if (typeof data !== \"string\") {\n      data = new TextDecoder().decode(data);\n    }\n    const urlSafe = data.includes(\"-\") || data.includes(\"_\");\n    const alphabet = getAlphabet(urlSafe);\n    return base64Decode(data, alphabet);\n  }\n};\nconst base64Url = {\n  encode(data, options = {}) {\n    const alphabet = getAlphabet(true);\n    const buffer = typeof data === \"string\" ? new TextEncoder().encode(data) : new Uint8Array(data);\n    return base64Encode(buffer, alphabet, options.padding ?? true);\n  },\n  decode(data) {\n    const urlSafe = data.includes(\"-\") || data.includes(\"_\");\n    const alphabet = getAlphabet(urlSafe);\n    return base64Decode(data, alphabet);\n  }\n};\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvQGJldHRlci1hdXRoL3V0aWxzL2Rpc3QvYmFzZTY0Lm1qcyIsIm1hcHBpbmdzIjoiOzs7OztBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQkFBa0IscUJBQXFCO0FBQ3ZDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbURBQW1ELEtBQUs7QUFDeEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJCQUEyQjtBQUMzQjtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwyQkFBMkI7QUFDM0I7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFNkIiLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcc2lkMDFcXE9uZURyaXZlXFxEZXNrdG9wXFxhbWQtdGVsZXBob255LXN5c3RlbVxcZnJvbnRlbmRcXG5vZGVfbW9kdWxlc1xcQGJldHRlci1hdXRoXFx1dGlsc1xcZGlzdFxcYmFzZTY0Lm1qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJmdW5jdGlvbiBnZXRBbHBoYWJldCh1cmxTYWZlKSB7XG4gIHJldHVybiB1cmxTYWZlID8gXCJBQkNERUZHSElKS0xNTk9QUVJTVFVWV1hZWmFiY2RlZmdoaWprbG1ub3BxcnN0dXZ3eHl6MDEyMzQ1Njc4OS1fXCIgOiBcIkFCQ0RFRkdISUpLTE1OT1BRUlNUVVZXWFlaYWJjZGVmZ2hpamtsbW5vcHFyc3R1dnd4eXowMTIzNDU2Nzg5Ky9cIjtcbn1cbmZ1bmN0aW9uIGJhc2U2NEVuY29kZShkYXRhLCBhbHBoYWJldCwgcGFkZGluZykge1xuICBsZXQgcmVzdWx0ID0gXCJcIjtcbiAgbGV0IGJ1ZmZlciA9IDA7XG4gIGxldCBzaGlmdCA9IDA7XG4gIGZvciAoY29uc3QgYnl0ZSBvZiBkYXRhKSB7XG4gICAgYnVmZmVyID0gYnVmZmVyIDw8IDggfCBieXRlO1xuICAgIHNoaWZ0ICs9IDg7XG4gICAgd2hpbGUgKHNoaWZ0ID49IDYpIHtcbiAgICAgIHNoaWZ0IC09IDY7XG4gICAgICByZXN1bHQgKz0gYWxwaGFiZXRbYnVmZmVyID4+IHNoaWZ0ICYgNjNdO1xuICAgIH1cbiAgfVxuICBpZiAoc2hpZnQgPiAwKSB7XG4gICAgcmVzdWx0ICs9IGFscGhhYmV0W2J1ZmZlciA8PCA2IC0gc2hpZnQgJiA2M107XG4gIH1cbiAgaWYgKHBhZGRpbmcpIHtcbiAgICBjb25zdCBwYWRDb3VudCA9ICg0IC0gcmVzdWx0Lmxlbmd0aCAlIDQpICUgNDtcbiAgICByZXN1bHQgKz0gXCI9XCIucmVwZWF0KHBhZENvdW50KTtcbiAgfVxuICByZXR1cm4gcmVzdWx0O1xufVxuZnVuY3Rpb24gYmFzZTY0RGVjb2RlKGRhdGEsIGFscGhhYmV0KSB7XG4gIGNvbnN0IGRlY29kZU1hcCA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgTWFwKCk7XG4gIGZvciAobGV0IGkgPSAwOyBpIDwgYWxwaGFiZXQubGVuZ3RoOyBpKyspIHtcbiAgICBkZWNvZGVNYXAuc2V0KGFscGhhYmV0W2ldLCBpKTtcbiAgfVxuICBjb25zdCByZXN1bHQgPSBbXTtcbiAgbGV0IGJ1ZmZlciA9IDA7XG4gIGxldCBiaXRzQ29sbGVjdGVkID0gMDtcbiAgZm9yIChjb25zdCBjaGFyIG9mIGRhdGEpIHtcbiAgICBpZiAoY2hhciA9PT0gXCI9XCIpXG4gICAgICBicmVhaztcbiAgICBjb25zdCB2YWx1ZSA9IGRlY29kZU1hcC5nZXQoY2hhcik7XG4gICAgaWYgKHZhbHVlID09PSB2b2lkIDApIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihgSW52YWxpZCBCYXNlNjQgY2hhcmFjdGVyOiAke2NoYXJ9YCk7XG4gICAgfVxuICAgIGJ1ZmZlciA9IGJ1ZmZlciA8PCA2IHwgdmFsdWU7XG4gICAgYml0c0NvbGxlY3RlZCArPSA2O1xuICAgIGlmIChiaXRzQ29sbGVjdGVkID49IDgpIHtcbiAgICAgIGJpdHNDb2xsZWN0ZWQgLT0gODtcbiAgICAgIHJlc3VsdC5wdXNoKGJ1ZmZlciA+PiBiaXRzQ29sbGVjdGVkICYgMjU1KTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIFVpbnQ4QXJyYXkuZnJvbShyZXN1bHQpO1xufVxuY29uc3QgYmFzZTY0ID0ge1xuICBlbmNvZGUoZGF0YSwgb3B0aW9ucyA9IHt9KSB7XG4gICAgY29uc3QgYWxwaGFiZXQgPSBnZXRBbHBoYWJldChmYWxzZSk7XG4gICAgY29uc3QgYnVmZmVyID0gdHlwZW9mIGRhdGEgPT09IFwic3RyaW5nXCIgPyBuZXcgVGV4dEVuY29kZXIoKS5lbmNvZGUoZGF0YSkgOiBuZXcgVWludDhBcnJheShkYXRhKTtcbiAgICByZXR1cm4gYmFzZTY0RW5jb2RlKGJ1ZmZlciwgYWxwaGFiZXQsIG9wdGlvbnMucGFkZGluZyA/PyB0cnVlKTtcbiAgfSxcbiAgZGVjb2RlKGRhdGEpIHtcbiAgICBpZiAodHlwZW9mIGRhdGEgIT09IFwic3RyaW5nXCIpIHtcbiAgICAgIGRhdGEgPSBuZXcgVGV4dERlY29kZXIoKS5kZWNvZGUoZGF0YSk7XG4gICAgfVxuICAgIGNvbnN0IHVybFNhZmUgPSBkYXRhLmluY2x1ZGVzKFwiLVwiKSB8fCBkYXRhLmluY2x1ZGVzKFwiX1wiKTtcbiAgICBjb25zdCBhbHBoYWJldCA9IGdldEFscGhhYmV0KHVybFNhZmUpO1xuICAgIHJldHVybiBiYXNlNjREZWNvZGUoZGF0YSwgYWxwaGFiZXQpO1xuICB9XG59O1xuY29uc3QgYmFzZTY0VXJsID0ge1xuICBlbmNvZGUoZGF0YSwgb3B0aW9ucyA9IHt9KSB7XG4gICAgY29uc3QgYWxwaGFiZXQgPSBnZXRBbHBoYWJldCh0cnVlKTtcbiAgICBjb25zdCBidWZmZXIgPSB0eXBlb2YgZGF0YSA9PT0gXCJzdHJpbmdcIiA/IG5ldyBUZXh0RW5jb2RlcigpLmVuY29kZShkYXRhKSA6IG5ldyBVaW50OEFycmF5KGRhdGEpO1xuICAgIHJldHVybiBiYXNlNjRFbmNvZGUoYnVmZmVyLCBhbHBoYWJldCwgb3B0aW9ucy5wYWRkaW5nID8/IHRydWUpO1xuICB9LFxuICBkZWNvZGUoZGF0YSkge1xuICAgIGNvbnN0IHVybFNhZmUgPSBkYXRhLmluY2x1ZGVzKFwiLVwiKSB8fCBkYXRhLmluY2x1ZGVzKFwiX1wiKTtcbiAgICBjb25zdCBhbHBoYWJldCA9IGdldEFscGhhYmV0KHVybFNhZmUpO1xuICAgIHJldHVybiBiYXNlNjREZWNvZGUoZGF0YSwgYWxwaGFiZXQpO1xuICB9XG59O1xuXG5leHBvcnQgeyBiYXNlNjQsIGJhc2U2NFVybCB9O1xuIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6WzBdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/@better-auth/utils/dist/base64.mjs\n");

/***/ }),

/***/ "(rsc)/./node_modules/@better-auth/utils/dist/binary.mjs":
/*!*********************************************************!*\
  !*** ./node_modules/@better-auth/utils/dist/binary.mjs ***!
  \*********************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   binary: () => (/* binding */ binary)\n/* harmony export */ });\nconst decoders = /* @__PURE__ */ new Map();\nconst encoder = new TextEncoder();\nconst binary = {\n  decode: (data, encoding = \"utf-8\") => {\n    if (!decoders.has(encoding)) {\n      decoders.set(encoding, new TextDecoder(encoding));\n    }\n    const decoder = decoders.get(encoding);\n    return decoder.decode(data);\n  },\n  encode: encoder.encode\n};\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvQGJldHRlci1hdXRoL3V0aWxzL2Rpc3QvYmluYXJ5Lm1qcyIsIm1hcHBpbmdzIjoiOzs7O0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7O0FBRWtCIiwic291cmNlcyI6WyJDOlxcVXNlcnNcXHNpZDAxXFxPbmVEcml2ZVxcRGVza3RvcFxcYW1kLXRlbGVwaG9ueS1zeXN0ZW1cXGZyb250ZW5kXFxub2RlX21vZHVsZXNcXEBiZXR0ZXItYXV0aFxcdXRpbHNcXGRpc3RcXGJpbmFyeS5tanMiXSwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgZGVjb2RlcnMgPSAvKiBAX19QVVJFX18gKi8gbmV3IE1hcCgpO1xuY29uc3QgZW5jb2RlciA9IG5ldyBUZXh0RW5jb2RlcigpO1xuY29uc3QgYmluYXJ5ID0ge1xuICBkZWNvZGU6IChkYXRhLCBlbmNvZGluZyA9IFwidXRmLThcIikgPT4ge1xuICAgIGlmICghZGVjb2RlcnMuaGFzKGVuY29kaW5nKSkge1xuICAgICAgZGVjb2RlcnMuc2V0KGVuY29kaW5nLCBuZXcgVGV4dERlY29kZXIoZW5jb2RpbmcpKTtcbiAgICB9XG4gICAgY29uc3QgZGVjb2RlciA9IGRlY29kZXJzLmdldChlbmNvZGluZyk7XG4gICAgcmV0dXJuIGRlY29kZXIuZGVjb2RlKGRhdGEpO1xuICB9LFxuICBlbmNvZGU6IGVuY29kZXIuZW5jb2RlXG59O1xuXG5leHBvcnQgeyBiaW5hcnkgfTtcbiJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOlswXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/@better-auth/utils/dist/binary.mjs\n");

/***/ }),

/***/ "(rsc)/./node_modules/@better-auth/utils/dist/hash.mjs":
/*!*******************************************************!*\
  !*** ./node_modules/@better-auth/utils/dist/hash.mjs ***!
  \*******************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createHash: () => (/* binding */ createHash)\n/* harmony export */ });\n/* harmony import */ var _base64_mjs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./base64.mjs */ \"(rsc)/./node_modules/@better-auth/utils/dist/base64.mjs\");\n/* harmony import */ var _index_mjs__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./index.mjs */ \"(rsc)/./node_modules/@better-auth/utils/dist/index.mjs\");\n\n\n\nfunction createHash(algorithm, encoding) {\n  return {\n    digest: async (input) => {\n      const encoder = new TextEncoder();\n      const data = typeof input === \"string\" ? encoder.encode(input) : input;\n      const hashBuffer = await (0,_index_mjs__WEBPACK_IMPORTED_MODULE_1__.getWebcryptoSubtle)().digest(algorithm, data);\n      if (encoding === \"hex\") {\n        const hashArray = Array.from(new Uint8Array(hashBuffer));\n        const hashHex = hashArray.map((b) => b.toString(16).padStart(2, \"0\")).join(\"\");\n        return hashHex;\n      }\n      if (encoding === \"base64\" || encoding === \"base64url\" || encoding === \"base64urlnopad\") {\n        if (encoding.includes(\"url\")) {\n          return _base64_mjs__WEBPACK_IMPORTED_MODULE_0__.base64Url.encode(hashBuffer, {\n            padding: encoding !== \"base64urlnopad\"\n          });\n        }\n        const hashBase64 = _base64_mjs__WEBPACK_IMPORTED_MODULE_0__.base64.encode(hashBuffer);\n        return hashBase64;\n      }\n      return hashBuffer;\n    }\n  };\n}\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvQGJldHRlci1hdXRoL3V0aWxzL2Rpc3QvaGFzaC5tanMiLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQWlEO0FBQ0E7O0FBRWpEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwrQkFBK0IsOERBQWtCO0FBQ2pEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCLGtEQUFTO0FBQzFCO0FBQ0EsV0FBVztBQUNYO0FBQ0EsMkJBQTJCLCtDQUFNO0FBQ2pDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFc0IiLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcc2lkMDFcXE9uZURyaXZlXFxEZXNrdG9wXFxhbWQtdGVsZXBob255LXN5c3RlbVxcZnJvbnRlbmRcXG5vZGVfbW9kdWxlc1xcQGJldHRlci1hdXRoXFx1dGlsc1xcZGlzdFxcaGFzaC5tanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgYmFzZTY0VXJsLCBiYXNlNjQgfSBmcm9tICcuL2Jhc2U2NC5tanMnO1xuaW1wb3J0IHsgZ2V0V2ViY3J5cHRvU3VidGxlIH0gZnJvbSAnLi9pbmRleC5tanMnO1xuXG5mdW5jdGlvbiBjcmVhdGVIYXNoKGFsZ29yaXRobSwgZW5jb2RpbmcpIHtcbiAgcmV0dXJuIHtcbiAgICBkaWdlc3Q6IGFzeW5jIChpbnB1dCkgPT4ge1xuICAgICAgY29uc3QgZW5jb2RlciA9IG5ldyBUZXh0RW5jb2RlcigpO1xuICAgICAgY29uc3QgZGF0YSA9IHR5cGVvZiBpbnB1dCA9PT0gXCJzdHJpbmdcIiA/IGVuY29kZXIuZW5jb2RlKGlucHV0KSA6IGlucHV0O1xuICAgICAgY29uc3QgaGFzaEJ1ZmZlciA9IGF3YWl0IGdldFdlYmNyeXB0b1N1YnRsZSgpLmRpZ2VzdChhbGdvcml0aG0sIGRhdGEpO1xuICAgICAgaWYgKGVuY29kaW5nID09PSBcImhleFwiKSB7XG4gICAgICAgIGNvbnN0IGhhc2hBcnJheSA9IEFycmF5LmZyb20obmV3IFVpbnQ4QXJyYXkoaGFzaEJ1ZmZlcikpO1xuICAgICAgICBjb25zdCBoYXNoSGV4ID0gaGFzaEFycmF5Lm1hcCgoYikgPT4gYi50b1N0cmluZygxNikucGFkU3RhcnQoMiwgXCIwXCIpKS5qb2luKFwiXCIpO1xuICAgICAgICByZXR1cm4gaGFzaEhleDtcbiAgICAgIH1cbiAgICAgIGlmIChlbmNvZGluZyA9PT0gXCJiYXNlNjRcIiB8fCBlbmNvZGluZyA9PT0gXCJiYXNlNjR1cmxcIiB8fCBlbmNvZGluZyA9PT0gXCJiYXNlNjR1cmxub3BhZFwiKSB7XG4gICAgICAgIGlmIChlbmNvZGluZy5pbmNsdWRlcyhcInVybFwiKSkge1xuICAgICAgICAgIHJldHVybiBiYXNlNjRVcmwuZW5jb2RlKGhhc2hCdWZmZXIsIHtcbiAgICAgICAgICAgIHBhZGRpbmc6IGVuY29kaW5nICE9PSBcImJhc2U2NHVybG5vcGFkXCJcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBoYXNoQmFzZTY0ID0gYmFzZTY0LmVuY29kZShoYXNoQnVmZmVyKTtcbiAgICAgICAgcmV0dXJuIGhhc2hCYXNlNjQ7XG4gICAgICB9XG4gICAgICByZXR1cm4gaGFzaEJ1ZmZlcjtcbiAgICB9XG4gIH07XG59XG5cbmV4cG9ydCB7IGNyZWF0ZUhhc2ggfTtcbiJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOlswXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/@better-auth/utils/dist/hash.mjs\n");

/***/ }),

/***/ "(rsc)/./node_modules/@better-auth/utils/dist/hex.mjs":
/*!******************************************************!*\
  !*** ./node_modules/@better-auth/utils/dist/hex.mjs ***!
  \******************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   hex: () => (/* binding */ hex)\n/* harmony export */ });\nconst hexadecimal = \"0123456789abcdef\";\nconst hex = {\n  encode: (data) => {\n    if (typeof data === \"string\") {\n      data = new TextEncoder().encode(data);\n    }\n    if (data.byteLength === 0) {\n      return \"\";\n    }\n    const buffer = new Uint8Array(data);\n    let result = \"\";\n    for (const byte of buffer) {\n      result += byte.toString(16).padStart(2, \"0\");\n    }\n    return result;\n  },\n  decode: (data) => {\n    if (!data) {\n      return \"\";\n    }\n    if (typeof data === \"string\") {\n      if (data.length % 2 !== 0) {\n        throw new Error(\"Invalid hexadecimal string\");\n      }\n      if (!new RegExp(`^[${hexadecimal}]+$`).test(data)) {\n        throw new Error(\"Invalid hexadecimal string\");\n      }\n      const result = new Uint8Array(data.length / 2);\n      for (let i = 0; i < data.length; i += 2) {\n        result[i / 2] = parseInt(data.slice(i, i + 2), 16);\n      }\n      return new TextDecoder().decode(result);\n    }\n    return new TextDecoder().decode(data);\n  }\n};\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvQGJldHRlci1hdXRoL3V0aWxzL2Rpc3QvaGV4Lm1qcyIsIm1hcHBpbmdzIjoiOzs7O0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwyQkFBMkIsWUFBWTtBQUN2QztBQUNBO0FBQ0E7QUFDQSxzQkFBc0IsaUJBQWlCO0FBQ3ZDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVlIiwic291cmNlcyI6WyJDOlxcVXNlcnNcXHNpZDAxXFxPbmVEcml2ZVxcRGVza3RvcFxcYW1kLXRlbGVwaG9ueS1zeXN0ZW1cXGZyb250ZW5kXFxub2RlX21vZHVsZXNcXEBiZXR0ZXItYXV0aFxcdXRpbHNcXGRpc3RcXGhleC5tanMiXSwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgaGV4YWRlY2ltYWwgPSBcIjAxMjM0NTY3ODlhYmNkZWZcIjtcbmNvbnN0IGhleCA9IHtcbiAgZW5jb2RlOiAoZGF0YSkgPT4ge1xuICAgIGlmICh0eXBlb2YgZGF0YSA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgZGF0YSA9IG5ldyBUZXh0RW5jb2RlcigpLmVuY29kZShkYXRhKTtcbiAgICB9XG4gICAgaWYgKGRhdGEuYnl0ZUxlbmd0aCA9PT0gMCkge1xuICAgICAgcmV0dXJuIFwiXCI7XG4gICAgfVxuICAgIGNvbnN0IGJ1ZmZlciA9IG5ldyBVaW50OEFycmF5KGRhdGEpO1xuICAgIGxldCByZXN1bHQgPSBcIlwiO1xuICAgIGZvciAoY29uc3QgYnl0ZSBvZiBidWZmZXIpIHtcbiAgICAgIHJlc3VsdCArPSBieXRlLnRvU3RyaW5nKDE2KS5wYWRTdGFydCgyLCBcIjBcIik7XG4gICAgfVxuICAgIHJldHVybiByZXN1bHQ7XG4gIH0sXG4gIGRlY29kZTogKGRhdGEpID0+IHtcbiAgICBpZiAoIWRhdGEpIHtcbiAgICAgIHJldHVybiBcIlwiO1xuICAgIH1cbiAgICBpZiAodHlwZW9mIGRhdGEgPT09IFwic3RyaW5nXCIpIHtcbiAgICAgIGlmIChkYXRhLmxlbmd0aCAlIDIgIT09IDApIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiSW52YWxpZCBoZXhhZGVjaW1hbCBzdHJpbmdcIik7XG4gICAgICB9XG4gICAgICBpZiAoIW5ldyBSZWdFeHAoYF5bJHtoZXhhZGVjaW1hbH1dKyRgKS50ZXN0KGRhdGEpKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcIkludmFsaWQgaGV4YWRlY2ltYWwgc3RyaW5nXCIpO1xuICAgICAgfVxuICAgICAgY29uc3QgcmVzdWx0ID0gbmV3IFVpbnQ4QXJyYXkoZGF0YS5sZW5ndGggLyAyKTtcbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgZGF0YS5sZW5ndGg7IGkgKz0gMikge1xuICAgICAgICByZXN1bHRbaSAvIDJdID0gcGFyc2VJbnQoZGF0YS5zbGljZShpLCBpICsgMiksIDE2KTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBuZXcgVGV4dERlY29kZXIoKS5kZWNvZGUocmVzdWx0KTtcbiAgICB9XG4gICAgcmV0dXJuIG5ldyBUZXh0RGVjb2RlcigpLmRlY29kZShkYXRhKTtcbiAgfVxufTtcblxuZXhwb3J0IHsgaGV4IH07XG4iXSwibmFtZXMiOltdLCJpZ25vcmVMaXN0IjpbMF0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/@better-auth/utils/dist/hex.mjs\n");

/***/ }),

/***/ "(rsc)/./node_modules/@better-auth/utils/dist/hmac.mjs":
/*!*******************************************************!*\
  !*** ./node_modules/@better-auth/utils/dist/hmac.mjs ***!
  \*******************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createHMAC: () => (/* binding */ createHMAC)\n/* harmony export */ });\n/* harmony import */ var _hex_mjs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./hex.mjs */ \"(rsc)/./node_modules/@better-auth/utils/dist/hex.mjs\");\n/* harmony import */ var _base64_mjs__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./base64.mjs */ \"(rsc)/./node_modules/@better-auth/utils/dist/base64.mjs\");\n/* harmony import */ var _index_mjs__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./index.mjs */ \"(rsc)/./node_modules/@better-auth/utils/dist/index.mjs\");\n\n\n\n\nconst createHMAC = (algorithm = \"SHA-256\", encoding = \"none\") => {\n  const hmac = {\n    importKey: async (key, keyUsage) => {\n      return (0,_index_mjs__WEBPACK_IMPORTED_MODULE_2__.getWebcryptoSubtle)().importKey(\n        \"raw\",\n        typeof key === \"string\" ? new TextEncoder().encode(key) : key,\n        { name: \"HMAC\", hash: { name: algorithm } },\n        false,\n        [keyUsage]\n      );\n    },\n    sign: async (hmacKey, data) => {\n      if (typeof hmacKey === \"string\") {\n        hmacKey = await hmac.importKey(hmacKey, \"sign\");\n      }\n      const signature = await (0,_index_mjs__WEBPACK_IMPORTED_MODULE_2__.getWebcryptoSubtle)().sign(\n        \"HMAC\",\n        hmacKey,\n        typeof data === \"string\" ? new TextEncoder().encode(data) : data\n      );\n      if (encoding === \"hex\") {\n        return _hex_mjs__WEBPACK_IMPORTED_MODULE_0__.hex.encode(signature);\n      }\n      if (encoding === \"base64\" || encoding === \"base64url\" || encoding === \"base64urlnopad\") {\n        return _base64_mjs__WEBPACK_IMPORTED_MODULE_1__.base64Url.encode(signature, {\n          padding: encoding !== \"base64urlnopad\"\n        });\n      }\n      return signature;\n    },\n    verify: async (hmacKey, data, signature) => {\n      if (typeof hmacKey === \"string\") {\n        hmacKey = await hmac.importKey(hmacKey, \"verify\");\n      }\n      if (encoding === \"hex\") {\n        signature = _hex_mjs__WEBPACK_IMPORTED_MODULE_0__.hex.decode(signature);\n      }\n      if (encoding === \"base64\" || encoding === \"base64url\" || encoding === \"base64urlnopad\") {\n        signature = await _base64_mjs__WEBPACK_IMPORTED_MODULE_1__.base64.decode(signature);\n      }\n      return (0,_index_mjs__WEBPACK_IMPORTED_MODULE_2__.getWebcryptoSubtle)().verify(\n        \"HMAC\",\n        hmacKey,\n        typeof signature === \"string\" ? new TextEncoder().encode(signature) : signature,\n        typeof data === \"string\" ? new TextEncoder().encode(data) : data\n      );\n    }\n  };\n  return hmac;\n};\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvQGJldHRlci1hdXRoL3V0aWxzL2Rpc3QvaG1hYy5tanMiLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUFnQztBQUNpQjtBQUNBOztBQUVqRDtBQUNBO0FBQ0E7QUFDQSxhQUFhLDhEQUFrQjtBQUMvQjtBQUNBO0FBQ0EsVUFBVSxzQkFBc0IsbUJBQW1CO0FBQ25EO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBLDhCQUE4Qiw4REFBa0I7QUFDaEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWUseUNBQUc7QUFDbEI7QUFDQTtBQUNBLGVBQWUsa0RBQVM7QUFDeEI7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0JBQW9CLHlDQUFHO0FBQ3ZCO0FBQ0E7QUFDQSwwQkFBMEIsK0NBQU07QUFDaEM7QUFDQSxhQUFhLDhEQUFrQjtBQUMvQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRXNCIiwic291cmNlcyI6WyJDOlxcVXNlcnNcXHNpZDAxXFxPbmVEcml2ZVxcRGVza3RvcFxcYW1kLXRlbGVwaG9ueS1zeXN0ZW1cXGZyb250ZW5kXFxub2RlX21vZHVsZXNcXEBiZXR0ZXItYXV0aFxcdXRpbHNcXGRpc3RcXGhtYWMubWpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGhleCB9IGZyb20gJy4vaGV4Lm1qcyc7XG5pbXBvcnQgeyBiYXNlNjRVcmwsIGJhc2U2NCB9IGZyb20gJy4vYmFzZTY0Lm1qcyc7XG5pbXBvcnQgeyBnZXRXZWJjcnlwdG9TdWJ0bGUgfSBmcm9tICcuL2luZGV4Lm1qcyc7XG5cbmNvbnN0IGNyZWF0ZUhNQUMgPSAoYWxnb3JpdGhtID0gXCJTSEEtMjU2XCIsIGVuY29kaW5nID0gXCJub25lXCIpID0+IHtcbiAgY29uc3QgaG1hYyA9IHtcbiAgICBpbXBvcnRLZXk6IGFzeW5jIChrZXksIGtleVVzYWdlKSA9PiB7XG4gICAgICByZXR1cm4gZ2V0V2ViY3J5cHRvU3VidGxlKCkuaW1wb3J0S2V5KFxuICAgICAgICBcInJhd1wiLFxuICAgICAgICB0eXBlb2Yga2V5ID09PSBcInN0cmluZ1wiID8gbmV3IFRleHRFbmNvZGVyKCkuZW5jb2RlKGtleSkgOiBrZXksXG4gICAgICAgIHsgbmFtZTogXCJITUFDXCIsIGhhc2g6IHsgbmFtZTogYWxnb3JpdGhtIH0gfSxcbiAgICAgICAgZmFsc2UsXG4gICAgICAgIFtrZXlVc2FnZV1cbiAgICAgICk7XG4gICAgfSxcbiAgICBzaWduOiBhc3luYyAoaG1hY0tleSwgZGF0YSkgPT4ge1xuICAgICAgaWYgKHR5cGVvZiBobWFjS2V5ID09PSBcInN0cmluZ1wiKSB7XG4gICAgICAgIGhtYWNLZXkgPSBhd2FpdCBobWFjLmltcG9ydEtleShobWFjS2V5LCBcInNpZ25cIik7XG4gICAgICB9XG4gICAgICBjb25zdCBzaWduYXR1cmUgPSBhd2FpdCBnZXRXZWJjcnlwdG9TdWJ0bGUoKS5zaWduKFxuICAgICAgICBcIkhNQUNcIixcbiAgICAgICAgaG1hY0tleSxcbiAgICAgICAgdHlwZW9mIGRhdGEgPT09IFwic3RyaW5nXCIgPyBuZXcgVGV4dEVuY29kZXIoKS5lbmNvZGUoZGF0YSkgOiBkYXRhXG4gICAgICApO1xuICAgICAgaWYgKGVuY29kaW5nID09PSBcImhleFwiKSB7XG4gICAgICAgIHJldHVybiBoZXguZW5jb2RlKHNpZ25hdHVyZSk7XG4gICAgICB9XG4gICAgICBpZiAoZW5jb2RpbmcgPT09IFwiYmFzZTY0XCIgfHwgZW5jb2RpbmcgPT09IFwiYmFzZTY0dXJsXCIgfHwgZW5jb2RpbmcgPT09IFwiYmFzZTY0dXJsbm9wYWRcIikge1xuICAgICAgICByZXR1cm4gYmFzZTY0VXJsLmVuY29kZShzaWduYXR1cmUsIHtcbiAgICAgICAgICBwYWRkaW5nOiBlbmNvZGluZyAhPT0gXCJiYXNlNjR1cmxub3BhZFwiXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHNpZ25hdHVyZTtcbiAgICB9LFxuICAgIHZlcmlmeTogYXN5bmMgKGhtYWNLZXksIGRhdGEsIHNpZ25hdHVyZSkgPT4ge1xuICAgICAgaWYgKHR5cGVvZiBobWFjS2V5ID09PSBcInN0cmluZ1wiKSB7XG4gICAgICAgIGhtYWNLZXkgPSBhd2FpdCBobWFjLmltcG9ydEtleShobWFjS2V5LCBcInZlcmlmeVwiKTtcbiAgICAgIH1cbiAgICAgIGlmIChlbmNvZGluZyA9PT0gXCJoZXhcIikge1xuICAgICAgICBzaWduYXR1cmUgPSBoZXguZGVjb2RlKHNpZ25hdHVyZSk7XG4gICAgICB9XG4gICAgICBpZiAoZW5jb2RpbmcgPT09IFwiYmFzZTY0XCIgfHwgZW5jb2RpbmcgPT09IFwiYmFzZTY0dXJsXCIgfHwgZW5jb2RpbmcgPT09IFwiYmFzZTY0dXJsbm9wYWRcIikge1xuICAgICAgICBzaWduYXR1cmUgPSBhd2FpdCBiYXNlNjQuZGVjb2RlKHNpZ25hdHVyZSk7XG4gICAgICB9XG4gICAgICByZXR1cm4gZ2V0V2ViY3J5cHRvU3VidGxlKCkudmVyaWZ5KFxuICAgICAgICBcIkhNQUNcIixcbiAgICAgICAgaG1hY0tleSxcbiAgICAgICAgdHlwZW9mIHNpZ25hdHVyZSA9PT0gXCJzdHJpbmdcIiA/IG5ldyBUZXh0RW5jb2RlcigpLmVuY29kZShzaWduYXR1cmUpIDogc2lnbmF0dXJlLFxuICAgICAgICB0eXBlb2YgZGF0YSA9PT0gXCJzdHJpbmdcIiA/IG5ldyBUZXh0RW5jb2RlcigpLmVuY29kZShkYXRhKSA6IGRhdGFcbiAgICAgICk7XG4gICAgfVxuICB9O1xuICByZXR1cm4gaG1hYztcbn07XG5cbmV4cG9ydCB7IGNyZWF0ZUhNQUMgfTtcbiJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOlswXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/@better-auth/utils/dist/hmac.mjs\n");

/***/ }),

/***/ "(rsc)/./node_modules/@better-auth/utils/dist/index.mjs":
/*!********************************************************!*\
  !*** ./node_modules/@better-auth/utils/dist/index.mjs ***!
  \********************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   getWebcryptoSubtle: () => (/* binding */ getWebcryptoSubtle)\n/* harmony export */ });\nfunction getWebcryptoSubtle() {\n  const cr = typeof globalThis !== \"undefined\" && globalThis.crypto;\n  if (cr && typeof cr.subtle === \"object\" && cr.subtle != null)\n    return cr.subtle;\n  throw new Error(\"crypto.subtle must be defined\");\n}\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvQGJldHRlci1hdXRoL3V0aWxzL2Rpc3QvaW5kZXgubWpzIiwibWFwcGluZ3MiOiI7Ozs7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRThCIiwic291cmNlcyI6WyJDOlxcVXNlcnNcXHNpZDAxXFxPbmVEcml2ZVxcRGVza3RvcFxcYW1kLXRlbGVwaG9ueS1zeXN0ZW1cXGZyb250ZW5kXFxub2RlX21vZHVsZXNcXEBiZXR0ZXItYXV0aFxcdXRpbHNcXGRpc3RcXGluZGV4Lm1qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJmdW5jdGlvbiBnZXRXZWJjcnlwdG9TdWJ0bGUoKSB7XG4gIGNvbnN0IGNyID0gdHlwZW9mIGdsb2JhbFRoaXMgIT09IFwidW5kZWZpbmVkXCIgJiYgZ2xvYmFsVGhpcy5jcnlwdG87XG4gIGlmIChjciAmJiB0eXBlb2YgY3Iuc3VidGxlID09PSBcIm9iamVjdFwiICYmIGNyLnN1YnRsZSAhPSBudWxsKVxuICAgIHJldHVybiBjci5zdWJ0bGU7XG4gIHRocm93IG5ldyBFcnJvcihcImNyeXB0by5zdWJ0bGUgbXVzdCBiZSBkZWZpbmVkXCIpO1xufVxuXG5leHBvcnQgeyBnZXRXZWJjcnlwdG9TdWJ0bGUgfTtcbiJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOlswXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/@better-auth/utils/dist/index.mjs\n");

/***/ }),

/***/ "(rsc)/./node_modules/@better-auth/utils/dist/random.mjs":
/*!*********************************************************!*\
  !*** ./node_modules/@better-auth/utils/dist/random.mjs ***!
  \*********************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createRandomStringGenerator: () => (/* binding */ createRandomStringGenerator)\n/* harmony export */ });\nfunction expandAlphabet(alphabet) {\n  switch (alphabet) {\n    case \"a-z\":\n      return \"abcdefghijklmnopqrstuvwxyz\";\n    case \"A-Z\":\n      return \"ABCDEFGHIJKLMNOPQRSTUVWXYZ\";\n    case \"0-9\":\n      return \"0123456789\";\n    case \"-_\":\n      return \"-_\";\n    default:\n      throw new Error(`Unsupported alphabet: ${alphabet}`);\n  }\n}\nfunction createRandomStringGenerator(...baseAlphabets) {\n  const baseCharSet = baseAlphabets.map(expandAlphabet).join(\"\");\n  if (baseCharSet.length === 0) {\n    throw new Error(\n      \"No valid characters provided for random string generation.\"\n    );\n  }\n  const baseCharSetLength = baseCharSet.length;\n  return (length, ...alphabets) => {\n    if (length <= 0) {\n      throw new Error(\"Length must be a positive integer.\");\n    }\n    let charSet = baseCharSet;\n    let charSetLength = baseCharSetLength;\n    if (alphabets.length > 0) {\n      charSet = alphabets.map(expandAlphabet).join(\"\");\n      charSetLength = charSet.length;\n    }\n    const maxValid = Math.floor(256 / charSetLength) * charSetLength;\n    const buf = new Uint8Array(length * 2);\n    const bufLength = buf.length;\n    let result = \"\";\n    let bufIndex = bufLength;\n    let rand;\n    while (result.length < length) {\n      if (bufIndex >= bufLength) {\n        crypto.getRandomValues(buf);\n        bufIndex = 0;\n      }\n      rand = buf[bufIndex++];\n      if (rand < maxValid) {\n        result += charSet[rand % charSetLength];\n      }\n    }\n    return result;\n  };\n}\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvQGJldHRlci1hdXRoL3V0aWxzL2Rpc3QvcmFuZG9tLm1qcyIsIm1hcHBpbmdzIjoiOzs7O0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLCtDQUErQyxTQUFTO0FBQ3hEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFdUMiLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcc2lkMDFcXE9uZURyaXZlXFxEZXNrdG9wXFxhbWQtdGVsZXBob255LXN5c3RlbVxcZnJvbnRlbmRcXG5vZGVfbW9kdWxlc1xcQGJldHRlci1hdXRoXFx1dGlsc1xcZGlzdFxccmFuZG9tLm1qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJmdW5jdGlvbiBleHBhbmRBbHBoYWJldChhbHBoYWJldCkge1xuICBzd2l0Y2ggKGFscGhhYmV0KSB7XG4gICAgY2FzZSBcImEtelwiOlxuICAgICAgcmV0dXJuIFwiYWJjZGVmZ2hpamtsbW5vcHFyc3R1dnd4eXpcIjtcbiAgICBjYXNlIFwiQS1aXCI6XG4gICAgICByZXR1cm4gXCJBQkNERUZHSElKS0xNTk9QUVJTVFVWV1hZWlwiO1xuICAgIGNhc2UgXCIwLTlcIjpcbiAgICAgIHJldHVybiBcIjAxMjM0NTY3ODlcIjtcbiAgICBjYXNlIFwiLV9cIjpcbiAgICAgIHJldHVybiBcIi1fXCI7XG4gICAgZGVmYXVsdDpcbiAgICAgIHRocm93IG5ldyBFcnJvcihgVW5zdXBwb3J0ZWQgYWxwaGFiZXQ6ICR7YWxwaGFiZXR9YCk7XG4gIH1cbn1cbmZ1bmN0aW9uIGNyZWF0ZVJhbmRvbVN0cmluZ0dlbmVyYXRvciguLi5iYXNlQWxwaGFiZXRzKSB7XG4gIGNvbnN0IGJhc2VDaGFyU2V0ID0gYmFzZUFscGhhYmV0cy5tYXAoZXhwYW5kQWxwaGFiZXQpLmpvaW4oXCJcIik7XG4gIGlmIChiYXNlQ2hhclNldC5sZW5ndGggPT09IDApIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoXG4gICAgICBcIk5vIHZhbGlkIGNoYXJhY3RlcnMgcHJvdmlkZWQgZm9yIHJhbmRvbSBzdHJpbmcgZ2VuZXJhdGlvbi5cIlxuICAgICk7XG4gIH1cbiAgY29uc3QgYmFzZUNoYXJTZXRMZW5ndGggPSBiYXNlQ2hhclNldC5sZW5ndGg7XG4gIHJldHVybiAobGVuZ3RoLCAuLi5hbHBoYWJldHMpID0+IHtcbiAgICBpZiAobGVuZ3RoIDw9IDApIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihcIkxlbmd0aCBtdXN0IGJlIGEgcG9zaXRpdmUgaW50ZWdlci5cIik7XG4gICAgfVxuICAgIGxldCBjaGFyU2V0ID0gYmFzZUNoYXJTZXQ7XG4gICAgbGV0IGNoYXJTZXRMZW5ndGggPSBiYXNlQ2hhclNldExlbmd0aDtcbiAgICBpZiAoYWxwaGFiZXRzLmxlbmd0aCA+IDApIHtcbiAgICAgIGNoYXJTZXQgPSBhbHBoYWJldHMubWFwKGV4cGFuZEFscGhhYmV0KS5qb2luKFwiXCIpO1xuICAgICAgY2hhclNldExlbmd0aCA9IGNoYXJTZXQubGVuZ3RoO1xuICAgIH1cbiAgICBjb25zdCBtYXhWYWxpZCA9IE1hdGguZmxvb3IoMjU2IC8gY2hhclNldExlbmd0aCkgKiBjaGFyU2V0TGVuZ3RoO1xuICAgIGNvbnN0IGJ1ZiA9IG5ldyBVaW50OEFycmF5KGxlbmd0aCAqIDIpO1xuICAgIGNvbnN0IGJ1Zkxlbmd0aCA9IGJ1Zi5sZW5ndGg7XG4gICAgbGV0IHJlc3VsdCA9IFwiXCI7XG4gICAgbGV0IGJ1ZkluZGV4ID0gYnVmTGVuZ3RoO1xuICAgIGxldCByYW5kO1xuICAgIHdoaWxlIChyZXN1bHQubGVuZ3RoIDwgbGVuZ3RoKSB7XG4gICAgICBpZiAoYnVmSW5kZXggPj0gYnVmTGVuZ3RoKSB7XG4gICAgICAgIGNyeXB0by5nZXRSYW5kb21WYWx1ZXMoYnVmKTtcbiAgICAgICAgYnVmSW5kZXggPSAwO1xuICAgICAgfVxuICAgICAgcmFuZCA9IGJ1ZltidWZJbmRleCsrXTtcbiAgICAgIGlmIChyYW5kIDwgbWF4VmFsaWQpIHtcbiAgICAgICAgcmVzdWx0ICs9IGNoYXJTZXRbcmFuZCAlIGNoYXJTZXRMZW5ndGhdO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gcmVzdWx0O1xuICB9O1xufVxuXG5leHBvcnQgeyBjcmVhdGVSYW5kb21TdHJpbmdHZW5lcmF0b3IgfTtcbiJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOlswXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/@better-auth/utils/dist/random.mjs\n");

/***/ })

};
;